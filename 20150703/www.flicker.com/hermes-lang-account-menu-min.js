YUI.add("flickr-people-getGroupsWithStatus-fetcher",function(e,t){"use strict";function n(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=r.groups,a=n.id,f,l={},c=[];if(u)return e.Array.each(u,function(t,r){var i,u,a,l=s.parseGroupModel(n.id,n.pathAlias,t);i=s.exists(t.id)?s.proxy(t.id):s.add(l),c.push(i),t.viewDates?(t.viewDates.pool!=="0"?u=e.moment(t.viewDates.pool,"X"):u=o.getDefaultViewedDate(),t.viewDates.discussions!=="0"?a=e.moment(t.viewDates.discussions,"X"):a=o.getDefaultViewedDate(),a.isValid()||(a=o.getDefaultViewedDate()),u.isValid()||(u=o.getDefaultViewedDate())):(u=o.getDefaultViewedDate(),a=o.getDefaultViewedDate()),f={id:l.id,viewedPool:u,viewedDiscussions:a,group:i},o.exists(f.id)||o.add(f)}),l={id:a,memberCount:r.members?r.members:null,moderatorCount:0,adminCount:0,invitedCount:0},l[n.attribute]=c,i.exists(a)?i.setValue(a,n.attribute,l[n.attribute]):i.add(l),l[n.attribute]}function r(n,r){var i=this,s={extras:e.APIHelper.request.getRebootGroupExtras()+", icon_urls, date_activity, date_last_viewed",user_id:n.id,status:n.status};return n.id!==r.getViewer().nsid&&(s.public_only=1,s.status="2,3,4"),e.Promise.all([r.callAPI("flickr.people.getGroupsWithStatus",s,!0),r.getModelRegistry("person-groups-models"),r.getModelRegistry("group-models"),r.getModelRegistry("group-activity-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-people-getGroupsWithStatus"]={run:r,_processResponse:n}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["person-groups-models","group-models"]});
YUI.add("person-groups-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},faveGroup:function(t,n){return e.ModelFetchers["flickr-groups-fave"].run(t,n)},unfaveGroup:function(t,n){return e.ModelFetchers["flickr-groups-unfave"].run(t,n)}},faveGroup:function(e){var t=this,n=e.group_id,r=e.user_id;return this.remote.faveGroup(e,this.appContext).then(null,function(){t.appContext.getModel("group-models",n).then(function(e){t.getValue(r,"groupsFaved").removeFromList(n)})}),this.appContext.getModel("group-models",n).then(function(e){t.getValue(r,"groupsFaved").appendToList(e)})},unfaveGroup:function(e){var t=e.group_id,n=e.user_id,r=this;return this.remote.unfaveGroup(e,this.appContext).then(null,function(){r.appContext.getModel("group-models",t).then(function(e){r.getValue(n,"groupsFaved").appendToList(e)})}),this.appContext.getModel("group-models",t).then(function(e){r.getValue(n,"groupsFaved").removeFromList(t)})},attributes:{id:{},memberCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},moderatorCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},adminCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},invitedCount:{validator:function(t){return e.AttributeHelpers.validateInteger(t)},setter:function(t){return e.AttributeHelpers.coerceInteger(t)}},groups:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-groups-pools-getGroups"]}},groupsAdministered:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsModerated:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsBelongingTo:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}},groupsFaved:{isListProxy:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getGroupsWithStatus"]}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-groups-pools-getGroups-fetcher","flickr-people-getInfo-fetcher","flickr-groups-fave-fetcher","flickr-groups-unfave-fetcher","flickr-people-getGroupsWithStatus-fetcher"]});
YUI.add("flickr-licensing-curation-passOverUser-updater",function(e,t){"use strict";function n(n,r){return r.callAPI("flickr.licensing.curation.passOverUser",n).then(null,e.FetcherErrorLogger(t))}e.namespace("ModelUpdaters")["flickr-licensing-curation-passOverUser"]={run:n}},"@VERSION@",{requires:["flickr-promise"]});
YUI.add("person-curation-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r={user_id:t};return"canPassOver"in n?e.ModelUpdaters["flickr-licensing-curation-passOverUser"].run(r,this.appContext):e.Promise.resolve()}},attributes:{enrollmentStatus:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},canPassOver:{validator:function(t,n){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-licensing-curation-passOverUser-updater","attribute-helpers"]});
YUI.add("flickr-photos-getContext-fetcher",function(e,t){"use strict";function n(t,n){var r={photo_id:t.photoId,num_prev:t.numNext,num_next:t.numPrev,extras:e.APIHelper.request.getRebootPhotoExtras().concat(["can_download","can_share","o_dims"])};return t.viewAs&&(r.view_as=t.viewAs),t.orderBy&&(r.order_by=t.orderBy),r}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=[],f=[],l=s.proxy(n.photoId),c=l.getValue("owner"),h,p,d,v,m,g,y=[];return h=r.prevphotos,p=r.nextphotos,f=e.APIHelper.response.parsePhotos({photos:h.photo,existingPerson:c,photoModelRegistry:s,photoEngagementModelRegistry:o,photoStatsModelRegistry:u}),a=e.APIHelper.response.parsePhotos({photos:p.photo,existingPerson:c,photoModelRegistry:s,photoEngagementModelRegistry:o,photoStatsModelRegistry:u}),v=i.getValue(n.id,"photoContextList"),m=v.hasMinBoundary?v.hasMinBoundary():!1,g=v.hasMaxBoundary?v.hasMaxBoundary():!1,d=v.getList(),y=e.APIHelper.response.addOrReplaceListByContext({model:l,next:f,prev:a.reverse(),hasMin:m,hasMax:g,current:d,numNext:n.numNext,numPrev:n.numPrev}),i.setValue(n.id,"photoContextList",y),{next:f,previous:a.reverse()}}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.photos.getContext",this._processParams(n,r),!0),r.getModelRegistry("photostream-models"),r.getModelRegistry("photo-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-photos-getContext"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photostream-models","photo-models","photo-engagement-models","photo-stats-models"]});
YUI.add("flickr-people-getPhotos-fetcher",function(e,t){"use strict";function n(t){var n={per_page:t.perPage||20,page:t.page||1,extras:e.APIHelper.request.getRebootPhotoExtras(),get_user_info:1,jump_to:t.withPhotoId||""};return t.id||t.userId?n.user_id=(t.id||t.userId).split("-")[0]:t.pathAlias&&(n.path_alias=t.pathAlias),t.privacyFilter&&(n.privacy_filter=t.privacyFilter),t.viewAs&&(n.view_as=t.viewAs),t.orderBy&&(t.orderBy==="datetaken"?n.sort="date-taken-desc":n.sort=t.orderBy),t.safeSearch&&(n.safe_search=t.safeSearch),t.media&&(n.media=t.media),t.withPhotoId&&(n.jump_to=t.withPhotoId),t.contentType&&(n.content_type=t.contentType),n}function r(t,n){var r=t[0],i=t[1],s=t[2],o=t[3],u=t[4],a=t[5],f,l,c=r.user.nsid,h=n.id||n.userId;return l={id:c,pathAlias:r.user.pathAlias,owner:e.APIHelper.response.parsePerson(r.user),totalItems:r.photos.total},h&&h!==c&&(l.id=h),s.addOrUpdate(l.owner),l.owner=s.proxy(l.owner.id),f=e.APIHelper.response.parsePhotos({photos:r.photos.photo,ownerID:r.photos.owner,personModelRegistry:s,photoModelRegistry:i,photoEngagementModelRegistry:u,photoStatsModelRegistry:a}),l.photoPageList={perPage:r.photos.perpage,page:r.photos.page,pageContent:f,totalItems:r.photos.total},o.exists(l.id)?(o.setValue(l.id,"photoPageList",l.photoPageList),o.setValue(l.id,"totalItems",parseInt(r.photos.total,10)||0)):o.add(l),f}function i(n,r){var i=this;return e.Promise.all([r.callAPI("flickr.people.getPhotos",this._processParams(n),!0),r.getModelRegistry("photo-models"),r.getModelRegistry("person-models"),r.getModelRegistry("photostream-models"),r.getModelRegistry("photo-engagement-models"),r.getModelRegistry("photo-stats-models")]).then(function(e){return i._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ListFetchers")["flickr-people-getPhotos"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise","api-helper"],optional:["photo-models","person-models","photostream-models","photo-engagement-models","photo-stats-models"]});
YUI.add("photostream-models",function(e,t){function n(e){n.superclass.constructor.call(this,e)}e.Models[this.name]=n,e.extend(n,e.FlickrModelRegistry,{langBundles:this.details.langBundles,name:this.name,remote:{read:function(t){return e.ListFetchers["flickr-people-getPhotos"].run(t,this.appContext)}},attributes:{normalizedId:{readOnly:!0,defaultFn:function(e){return e.split("-")[0]}},displayType:{readOnly:!0,defaultFn:function(){return"photostream"}},title:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.appContext.getViewer(),n=this.getValue(e,"normalizedId"),r;return t&&t.nsid===n?this.intlMessage({intlName:"models.YOUR_PHOTOSTREAM"}):(r=this.getValue(e,"owner"),r?this.intlMessage({intlName:"models.USER_PHOTOSTREAM",name:r.getValue("displayname")}):this.intlMessage({intlName:"models.PHOTOSTREAM"}))}},pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return this.getValue(e,"normalizedId")}},owner:{isModel:!0},isOwner:e.PhotoModelHelper.attributes.isOwner,photoPageList:{isCollection:!0,pageFetch:{listFetcher:e.ListFetchers["flickr-people-getPhotos"]}},photoContextList:{isListProxy:!0,contextFetch:{listFetcher:e.ListFetchers["flickr-photos-getContext"],listItemIdField:"photoId"}},url:{readOnly:!0,derivedBy:["owner","normalizedId"],defaultFn:function(e){var t=this.getValue(e,"owner"),n=this.getValue(e,"normalizedId"),r=t?t.getValue("pathAlias"):n;return"/photos/"+r+"/"}},totalItems:{defaultFn:function(){return null}},urlSuffix:{readOnly:!0,defaultFn:function(e){var t,r=n.splitCompoundId(e);return r.orderBy?(t=r.orderBy,r.viewAs?t+="-"+r.viewAs:r.orderBy==="dateposted"&&(t="photostream")):t="photostream",t}}}},{buildCompoundId:function(e,t,n){var r=e;return t&&(r+="-"+t),n&&(t||(r+="-dateposted"),r+="-"+n),r},splitCompoundId:function(e){var t=e.split("-");return{nsid:t[0],orderBy:t[1],viewAs:t[2]}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-promise","flickr-photos-getContext-fetcher","flickr-people-getPhotos-fetcher","photo-model-helper"],langBundles:["models"]});
YUI.add("person-model-helper",function(e){e.PersonModelHelper={attributes:{pathAlias:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)||undefined},defaultFn:function(e){return e}},username:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},realname:{validator:function(t,n){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},displayname:{readOnly:!0,derivedBy:["username","realname"],getter:function(e,t){return this.getValue(t,"realname")||this.getValue(t,"username")}},nsid:{readOnly:!0,defaultFn:function(e){return e}},url:{readOnly:!0,derivedBy:["pathAlias"],defaultFn:function(e){var t=this.getValue(e,"pathAlias");return"/photos/"+t+"/"}},isMe:{readOnly:!0,defaultFn:function(e){var t=this.appContext.getViewer();return t.signedIn&&t.nsid===e}}}}},"@VERSION@",{requires:[]});
YUI.add("person-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)}},attributes:{pathAlias:e.PersonModelHelper.attributes.pathAlias,username:e.PersonModelHelper.attributes.username,realname:e.PersonModelHelper.attributes.realname,displayname:e.PersonModelHelper.attributes.displayname,nsid:e.PersonModelHelper.attributes.nsid,url:e.PersonModelHelper.attributes.url,isMe:e.PersonModelHelper.attributes.isMe,buddyicon:{},isPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},canBuyPro:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultFn:function(){return!1}},isAdFree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},isNoAds:{derivedBy:["isPro","isAdFree"],readOnly:!0,getter:function(e,t){var n=this.getValue(t,"isPro"),r=this.getValue(t,"isAdFree");return n||r}},hasStats:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasAdfree:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has1TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},has2TB:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeStandardShipping:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},hasFreeEducationalResources:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)}},dateCreated:{validator:function(t){return e.AttributeHelpers.validateDate(t)},setter:function(t){return e.AttributeHelpers.coerceDate(t)},serialize:function(e){return e.format("X")},deserialize:function(t){return e.moment(t,"X")}},location:{defaultFn:function(){return""}},curation:{isModel:!0}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","attribute-helpers","person-model-helper","person-curation-models"]});
YUI.add("flickr-people-getInfo-fetcher",function(e,t){"use strict";function n(t,n){var r={datecreate:1};r.extras=e.APIHelper.request.getRebootPeopleExtras(),YUI.Env.isServer&&t.id===n.request.probableUser&&(r.storage=1,r.extras+=", classic_user_id, active_group_membership, timezone_dst, unified_search_view_pref, photostream_view_order_pref, photostream_view_as_pref, album_view_layout",n.flipper.isFlipped("enable-new-pro")&&(r.extras+=", products_features")),t.extras&&typeof t.extras=="string"&&t.extras.length>0&&(r.extras=r.extras+","+t.extras);if(t.id)r.user_id=t.id;else{if(!t.pathAlias)throw new Error("`fetch` is missing required params.");r.path_alias=t.pathAlias}return t.storage&&(r.storage=t.storage),r.extras||(r.extras=""),r.extras+=", has_stats",r}function r(t,n,r){var i=t.apiResponse,s=t.personModelRegistry,o=t.personRelationshipModelRegistry,u=t.personProfileModelRegistry,a=t.personPreferencesModelRegistry,f=t.personGroupsModelRegistry,l=t.personNotificationsModelRegistry,c=t.personCurationModelRegistry,h=t.photostreamModelRegistry,p,d=i.person,v,m=r.getViewer(),g=d.id;return s.exists(g)||s.add({id:g,pathAlias:d.pathAlias,username:d.username&&d.username._content,realname:d.realname&&d.realname._content,buddyicon:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(d.iconurls),isAdFree:d.isAdFree,isPro:d.ispro,canBuyPro:d.canBuyPro,hasStats:d.hasStats,location:d.location&&d.location._content,hasAdfree:d.hasAdfree,has1TB:d.has1TB,has2TB:d.has2TB,hasFreeStandardShipping:d.hasFreeStandardShipping,hasFreeEducationalResources:d.hasFreeEducationalResources,dateCreated:d.datecreate._content}),l.exists(g)?l.setValue(g,"unreadNotificationCount",3):l.add({id:g,unreadNotificationCount:0,unreadFlickrMailCount:0}),o.exists(g)||o.add({id:g,pathAlias:d.pathAlias,isContact:d.contact,isFriend:d.friend,isFamily:d.family,isIgnored:d.ignored,isIgnoredBy:d.ignoredby}),m&&m.signedIn&&g===m.nsid&&(v={id:g},d.safeSearch&&(v.safeSearch=(d.safeSearch||1)-1),d.viewPrefs&&(v.unifiedSearchViewPref=d.viewPrefs.unifiedSearchViewPref,v.photostreamViewOrderPref=d.viewPrefs.photostreamViewOrderPref,v.photostreamViewAsPref=d.viewPrefs.photostreamViewAsPref,v.albumViewLayoutPref=d.viewPrefs.albumViewLayout),a.exists(g)?a.setValues(g,v):a.add(v)),u.exists(g)||(p={id:g,coverPhotoUrls:e.APIHelper.response.agnosticizeFarmPathTransferProtocol(d.coverphoto_url),photoCount:d.photos.count.content,location:d.location?d.location.content:null},d.storage&&(p.storageUsed=d.storage.used.content,p.storageTotal=d.storage.total.content),d.unreadMessages&&(p.unreadMessages=d.unreadMessages.content),u.add(p)),f.exists(g)||f.add({id:g,memberCount:d.groupMemberships?d.groupMemberships.member:null,moderatorCount:d.groupMemberships?d.groupMemberships.moderator:null,adminCount:d.groupMemberships?d.groupMemberships.admin:null,invitedCount:d.groupMemberships?d.groupMemberships.invited:null}),c.exists(g)&&c.remove(g),c.add({id:g,enrollmentStatus:d.curation&&d.curation.status_name||"",canPassOver:d.curation&&d.curation.can_pass_over||!1}),h.exists(g)||h.add({id:g,pathAlias:d.pathAlias,owner:s.proxy(g),totalItems:d.photos.count&&d.photos.count.content}),d}function i(n,r){var i=this,s=r.getViewer();return s&&s.signedIn&&(n.id===s.nsid||n.nsid===s.nsid)&&(n.storage=1),(new e.FlickrPromise({apiResponse:r.callAPI("flickr.people.getInfo",this._processParams(n,r)),personModelRegistry:r.getModelRegistry("person-models"),personRelationshipModelRegistry:r.getModelRegistry("person-relationship-models"),personProfileModelRegistry:r.getModelRegistry("person-profile-models"),personPreferencesModelRegistry:r.getModelRegistry("person-preferences-models"),personGroupsModelRegistry:r.getModelRegistry("person-groups-models"),personNotificationsModelRegistry:r.getModelRegistry("person-notifications-models"),personCurationModelRegistry:r.getModelRegistry("person-curation-models"),photostreamModelRegistry:r.getModelRegistry("photostream-models")})).then(function(e){return i._processResponse(e,n,r)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-people-getInfo"]={run:i,_processParams:n,_processResponse:r}},"@VERSION@",{requires:["flickr-promise"],optional:["person-models","person-relationship-models","person-preferences-models","person-profile-models","person-groups-models","person-curation-models","photostream-models","api-helper"]});
YUI.add("person-relationship-models",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-people-getInfo"].run(t,this.appContext)},update:function(t,n){var r=[],i={};if(e.Lang.isObject(n,!0)){i.user_id=t,i.friend=this.getValue(t,"isFriend"),i.family=this.getValue(t,"isFamily"),"isContact"in n&&(n.isContact.newVal?r.push(e.ModelUpdaters["flickr-contacts-add"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-remove"].run(i,this.appContext)));if("isFriend"in n||"isFamily"in n)"isFriend"in n&&(i.friend=n.isFriend.newVal),"isFamily"in n&&(i.family=n.isFamily.newVal),r.push(e.ModelUpdaters["flickr-contacts-edit"].run(i,this.appContext));"isIgnored"in n&&(n.isIgnored.newVal===!0?r.push(e.ModelUpdaters["flickr-contacts-block"].run(i,this.appContext)):r.push(e.ModelUpdaters["flickr-contacts-unblock"].run(i,this.appContext)))}return e.Promise.all(r)}},toggleFollowing:function(e){var t=this.getValue(e,"isContact");t?this.setValue(e,"isContact",!1):this.setValue(e,"isContact",!0)},toggleFriend:function(e){var t=this.getValue(e,"isFriend");t?this.setValue(e,"isFriend",!1):this.setValue(e,"isFriend",!0)},toggleFamily:function(e){var t=this.getValue(e,"isFamily");t?this.setValue(e,"isFamily",!1):this.setValue(e,"isFamily",!0)},toggleIgnore:function(e){var t=this.getValue(e,"isIgnored");t?this.setValue(e,"isIgnored",!1):this.setValue(e,"isIgnored",!0)},attributes:{pathAlias:{validator:function(t){return e.AttributeHelpers.validateString(t)},setter:function(t){return e.AttributeHelpers.coerceString(t)}},isContact:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFriend:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isFamily:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnoredBy:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isIgnored:{validator:function(t){return e.AttributeHelpers.validateBoolean(t)},setter:function(t){return e.AttributeHelpers.coerceBoolean(t)},defaultValue:!1},isMe:{readOnly:!0,getter:function(e,t){var n=this.appContext.getViewer();return!!n&&this.getValue(t,"nsid")===n.nsid}},nsid:{readOnly:!0,defaultFn:function(e){return e}}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-people-getInfo-fetcher","flickr-contacts-add-updater","flickr-contacts-remove-updater","flickr-contacts-edit-updater","flickr-contacts-block-updater","flickr-contacts-unblock-updater","attribute-helpers"]});
YUI.add("account-menu-view",function(e){"use strict";e.namespace("Views")[this.name]=e.Base.create("account-menu-view",e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(e){return this},loadState:function(){var t=this,n=[],r=this.appContext.getViewer();return r.signedIn?(t.set("user",{signedIn:!0,csrf:this.appContext.auth.csrf?this.appContext.auth.csrf:""}),n.push(this.appContext.getModel("person-models",r.nsid).then(function(n){var r=n.toJSON();Object.keys(r.buddyicon||{}).forEach(function(e){r.buddyicon[e]||(r.buddyicon[e]=r.buddyicon["default"])}),t.set("user",e.merge(t.get("user"),r))})),n.push(t.appContext.getModel("person-profile-models",r.nsid).then(function(n){var r=n.toJSON();r.unreadMessages=parseInt(r.unreadMessages,10),r.storageUsed=parseInt(r.storageUsed,10),t.get("user").isPro?t.get("user").hasAdfree||t.get("user").has1TB||t.get("user").has2TB?r.storageTotal=parseInt(r.storageTotal,10):r.storageTotal=-1:r.storageTotal=parseInt(r.storageTotal,10),t.set("user",e.merge(t.get("user"),r))})),e.Promise.all(n)):(t.set("user",{signedIn:!1}),e.Promise.resolve())},buildContainer:function(){var e=this.templates("account-menu")(this.toJSON());return this.setContainerHTML(e),this},toJSON:function(){var t=e.merge(this.get("user"));return parseInt(t.photoCount,10)>1?t.pluralPhotos=!0:t.pluralPhotos=!1,parseInt(t.photoCount,10)<1&&(t.photoCount=!1),t.photoCount>1e3&&(t.photoCount=Math.round(t.photoCount/1e3),t.oneK=!0),t.storageUsedPercentage=Math.floor(1e3*t.storageUsed/t.storageTotal)/10||"0.0",t.storageTotalFormatted=t.storageTotal<0?"":e.Handlebars.helpers.friendlyDataSize(t.storageTotal),t.storageUsedFormatted=e.Handlebars.helpers.friendlyDataSize(t.storageUsed),t.barWidth=Math.floor(293*(t.storageUsedPercentage/100)),t.unreadMessages=t.unreadMessages>9999?"9999+":t.unreadMessages,{user:t,flippers:this.appContext.flipper.toJSON()}},activate:function(){setTimeout(function(){this.get("container").on("click",function(e){this.openMenu(e)},this)}.bind(this),350)},openMenu:function(t){var n=this.get("container"),r,i=this,s;return t.preventDefault(),this.fire("open"),this.accountMenuDialog||(this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list")?(r=this.templates("account-menu-card"),this.accountMenuDialog=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,showOverlay:!1,width:322,observePageResize:!0,anchorElement:n.one(".c-account-menu"),htmlMessage:r({attrs:this.toJSON()}),positionFixed:!0})):r=this.templates("account-menu-dialog-styleguide"),this.accountMenuDialog||(this.accountMenuDialog=e.Views.dialog.getNewInstance("dialog-tooltip",{id:"AccountMenuDialog",positioning:!1,arrow:"topright",attrs:this.toJSON(),content:r,parent:this,anchorTo:n.one(".c-account-menu"),appendCurtainTo:n.ancestor(".global-nav-content")}),s=function(){i.accountMenuDialog.get("curtain").on("click",function(){i.closeMenu.bind(i)})},this.accountMenuDialog.on("show",function(){setTimeout(s,100)}))),this.accountMenuDialog.show(),this},closeMenu:function(e){e&&e.preventDefault(),this.accountMenuDialog&&this.accountMenuDialog.hide()},destructor:function(){this.accountMenuDialog&&(this.accountMenuDialog.destroy(),this.accountMenuDialog=null)}})},"@VERSION@",{requires:["flickr-view","account-menu-css","flickrui-css","dialog","account-menu-card-css","hermes-template-account-menu","hermes-template-account-menu-dialog","hermes-template-account-menu-dialog-styleguide","hermes-template-account-menu-card","fluid-droparound-view"],optional:["person-models","person-profile-models"],langBundles:["account-menu","common"]});
YUI.add("hermes-lang-account-menu",function(e,t){e.Intl.add("hermes/account-menu","en-US",{SPACE_USED:["Using ","${percentage}","% of ","${total}"],SPACE_USED_STYLEGUIDE:["${percentage}","% used of ","${total}"],SPACE_USED_UNLIMITED:["Using ","${used}"," of your unlimited storage"],PHOTO_COUNT_MANY:[{type:"number",valueName:"num"}," photos"],PHOTO_COUNT_ONE:["One photo"],PHOTO_COUNT_NONE:["No photos"],PHOTO_COUNT_1K:[{type:"number",valueName:"num"},"k photos"],ADDMORESPACE:["Add more space"],GOADFREE:["Go Ad Free"],GOPRO:["Go Pro"],GREETING_CAPTION_SPANISH:["Now you know how to greet people in Spanish"],GREETING_CAPTION_GERMAN:["Now you know how to greet people in German"],GREETING_CAPTION_AUSTRALIAN:["Now you know how to greet people in Australian"],GREETING_CAPTION_DUTCH:["Now you know how to greet people in Dutch"],GREETING_CAPTION_ENGLISH:["Now you know how to greet people in English"],GREETING_CAPTION_ARABIC:["Now you know how to greet people in Arabic"],GREETING_CAPTION_FRENCH:["Now you know how to greet people in French"],GREETING_CAPTION_ITALIAN:["Now you know how to greet people in Italian"],GREETING_CAPTION_SWEDISH:["Now you know how to greet people in Swedish"],GREETING_CAPTION_HAWAIIAN:["Now you know how to greet people in Hawaiian"],GREETING_CAPTION_TAGALOG:["Now you know how to greet people in Tagalog"],GREETING_CAPTION_HEBREW:["Now you know how to greet people in Hebrew"],GREETING_CAPTION_HINDI:["Now you know how to greet people in Hindi"],GREETING_CAPTION_MANDARIN:["Now you know how to greet people in Mandarin"],GREETING_CAPTION_PORTUGUESE:["Now you know how to greet people in Portuguese"],GREETING_CAPTION_ALBANIAN:["Now you know how to greet people in Albanian"],GREETING_CAPTION_ESTONIAN:["Now you know how to greet people in Estonian"],GREETING_CAPTION_GREEK:["Now you know how to greet people in Greek"],GREETING_CAPTION_HUNGARIAN:["Now you know how to greet people in Hungarian"],GREETING_CAPTION_LINGALA:["Now you know how to greet people in Lingala"],GREETING_CAPTION_SWAHILI:["Now you know how to greet people in Swahili"],GREETING_CAPTION_TSHILUBA:["Now you know how to greet people in Tshiluba"],GREETING_CAPTION_TURKISH:["Now you know how to greet people in Turkish"],GREETING_CAPTION_BURMESE:["Now you know how to greet people in Burmese"],GREETING_CAPTION_ICELANDIC:["Now you know how to greet people in Icelandic"],GREETING_CAPTION_ZULU:["Now you know how to greet people in Zulu"],GREETING_CAPTION_KOREAN:["Now you know how to greet people in Korean"],GREETING_CAPTION_IRISH:["Now you know how to greet people in Irish"],GREETING_CAPTION_LATVIAN:["Now you know how to greet people in Latvian"],GREETING_CAPTION_BASQUE:["Now you know how to greet people in Basque"],GREETING_CAPTION_BENGALI:["Now you know how to greet people in Bengali"],GREETING_CAPTION_BULGARIAN:["Now you know how to greet people in Bulgarian"],GREETING_CAPTION_CROATIAN:["Now you know how to greet people in Croatian"],GREETING_CAPTION_CZECH:["Now you know how to greet people in Czech"],GREETING_CAPTION_DANISH:["Now you know how to greet people in Danish"],GREETING_CAPTION_FINNISH:["Now you know how to greet people in Finnish"],GREETING_CAPTION_HOPI:["Now you know how to greet people in Hopi"],GREETING_CAPTION_INDONESIAN:["Now you know how to greet people in Indonesian"],GREETING_CAPTION_KANNADA:["Now you know how to greet people in Kannada"],GREETING_CAPTION_KURDISH:["Now you know how to greet people in Kurdish"],GREETING_CAPTION_LITHUANIAN:["Now you know how to greet people in Lithuanian"],GREETING_CAPTION_MALAYSIAN:["Now you know how to greet people in Malaysian"],GREETING_CAPTION_NORWEGIAN:["Now you know how to greet people in Norwegian"],GREETING_CAPTION_POLISH:["Now you know how to greet people in Polish"],GREETING_CAPTION_ROMANIAN:["Now you know how to greet people in Romanian"],GREETING_CAPTION_RUSSIAN:["Now you know how to greet people in Russian"],GREETING_CAPTION_SERBIAN:["Now you know how to greet people in Serbian"],GREETING_CAPTION_SLOVAKIAN:["Now you know how to greet people in Slovakian"],GREETING_CAPTION_UKRAINIAN:["Now you know how to greet people in Ukrainian"],GREETING_CAPTION_VIETNAMESE:["Now you know how to greet people in Vietnamese"]})},"@VERSION@",{requires:["intl"]});
