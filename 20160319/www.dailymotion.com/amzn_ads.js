/* Amazon DTB Javascript API - v1.0.0 - 2016-02-08 11:14:51 PM */function amzn_ads(a){"use strict";try{amznads.updateAds(a)}catch(b){try{}catch(c){}}}function aax_write(a,b){a.write(b),a.close()}function aax_render_ad(a){var b,c,d,e,f,g,h;if(a.passback)return void aax_write(document,a.html);if(b=a.slotSize,!b)return void aax_write(document,a.html);c=b.indexOf("x"),d=b.substring(0,c),e=b.substring(c+1),f="amznad"+Math.round(1e6*Math.random()),aax_write(document,'<iframe id="'+f+'" width="'+d+'" height="'+e+'" src="javascript:\'\'" scrolling="no" frameborder="0" marginwidth="0" marginheight="0" bgcolor="#FFFFFF" topmargin="0" leftmargin="0" rightmargin="0" bottommargin="0"></iframe>');try{g=document.getElementById(f),h=g.contentWindow||g.contentDocument,h.document&&(h=h.document),aax_write(h,a.html)}catch(i){g&&(g.style.display="none")}}var amznads=function(a,b,c){"use strict";function d(b,c,e){this.startTime=null,this.stopTime=null,this.sourceId=c,this.sync=b,this.mode=e,this.latency=null,d.prototype.startTimer=function(){this.startTime=Date.now()},d.prototype.stopTimer=function(){this.stopTime=Date.now()},d.prototype.stopTimerAndReportLatency=function(){this.stopTimer(),this.calculateLatency(),this.isThrottled()||this.reportLatency()},d.prototype.calculateLatency=function(){this.latency=this.stopTime-this.startTime},d.prototype.isThrottled=function(){var b,c=parseInt(a.latencySamplingRate,10);if(!isNaN(c)){if(0==c)return!0;if(100==c)return!1;if(b=100*Math.random(),c>=b)return!1}return!0},d.prototype.reportLatency=function(){var b,c;null!=this.latency&&this.latency>0&&(b='/{"c":"dtb","src":"'+this.sourceId+'","'+(this.sync?"bls":"bla")+'":"'+this.latency+'","m":"'+this.mode+'"}',c=a.protocol+a.host+a.px_svc+"PH"+b,(new Image).src=c)}}var e="https:"===b.location.protocol;return a.latencyUtil=a.latencyUtil||null,a.protocol=e?"https://":"http://",a.DEFAULT_HOST="aax.amazon-adsystem.com",a.host=a.DEFAULT_HOST,a.dtb_svc="/e/dtb/bid",a.pb_svc="/x/getad",a.px_svc="/x/px/",a.debug_mode=a.debug_mode||!1,a.MIN_TIMEOUT=0,a.DEFAULT_TIMEOUT=1e3,a.targetingKey="amznslots",a.latencySamplingRate=1,a.vidKey="amzn_vid",a.tasks=a.tasks||[],a.VIEWABILITY_CUTOFF_AREA=a.VIEWABILITY_CUTOFF_AREA||.5,a.VIEWABILITY_CUTOFF_DURATION_SEC=a.VIEWABILITY_CUTOFF_DURATION_SEC||1,a.CSM_JS="//c.amazon-adsystem.com/aax2/csm.js.gz",a.ads||(a.ads={}),a.updateAds=function(b){if(a.ads=b.ads,a.ev=b.ev,b.vads){a.ads||(a.ads={});var c;for(c in b.vads)b.vads.hasOwnProperty(c)&&(a.ads[c]=b.vads[c],a.amzn_vid=b.vads[c])}a.doAllTasks(),a.tasks.push=function(b){a.doTask(b)};try{b.lsr&&(a.latencySamplingRate=b.lsr),null!=a.latencyUtil&&a.latencyUtil.stopTimerAndReportLatency()}catch(d){}},a.saveAds=function(b){a.saved_ads=b.ads,a.updateAds(b)},a.getAdForSlot=function(c,d,e){var f,g,h,i;a.src_id=c,f=f||{},g=f.u,g||(g=a.getReferrerURL()),g&&-1!==g.indexOf("amzn_debug_mode")&&(a.debug_mode=!0),h="src="+a.src_id+"&slot_uuid="+d+"&c=100&u="+g+"&cb="+Math.round(1e7*Math.random()),i=a.protocol+a.host+a.pb_svc+"?jsd=1&"+h,e?a.appendScriptTag(i):aax_write(b,"<script type='text/javascript' src='"+i+"'></script>")},a.getAdsCallback=function(b,c,d,e,f){var g=null;f=f||{};try{c&&"function"==typeof c&&(g=a.handleCallBack(c,d))}catch(h){}f.to||(f.to=d),a.doGetAdsAsync(b,e,f,g)},a.getVideoAdsCallback=function(b,c,d,e,f){var f=f||{};f.mt="V",a.getAdsCallback(b,c,d,e,f)},a.getDisplayAdsCallback=function(b,c,d,e,f){var f=f||{};f.mt="D",a.getAdsCallback(b,c,d,e,f)},a.getAdsAsync=function(b,c,d){a.doGetAdsAsync(b,c,d)},a.getVideoAdsAsync=function(b,c,d){var d=d||{};d.mt="V",a.getAdsAsync(b,c,d)},a.getDisplayAdsAsync=function(b,c,d){var d=d||{};d.mt="D",a.getAdsAsync(b,c,d)},a.handleCallBack=function(b,d){var e=!1,f=null,g=function(a){if(!e){try{b(a),f&&clearTimeout(f)}catch(c){}e=!0}},h=a.getValidMilliseconds(d);return f=h?c.setTimeout(g,h):c.setTimeout(g,a.DEFAULT_TIMEOUT),g},a.getValidMilliseconds=function(b){if(!b)return!1;try{var c=~~Number(b);if(c>a.MIN_TIMEOUT)return c}catch(d){return!1}return!1},a.getAds=function(c,e,f,g){if(g)return void a.doGetAdsAsync(c,e,f);var h=a.getScriptSource(c,e,f);try{a.latencyUtil=new d(!0,c,f&&f.mt?f.mt:"DV"),a.latencyUtil.startTimer()}catch(i){}aax_write(b,"<script type='text/javascript' src='"+h+"'></script>")},a.getVideoAds=function(b,c,d,e){var d=d||{};d.mt="V",a.getAds(b,c,d,e)},a.getDisplayAds=function(b,c,d,e){var d=d||{};d.mt="D",a.getAds(b,c,d,e)},a.doGetAdsAsync=function(b,c,e,f){var g=a.getScriptSource(b,c,e);try{a.latencyUtil=new d(!1,b,e&&e.mt?e.mt:"DV"),a.latencyUtil.startTimer()}catch(h){}a.appendScriptTag(g,f)},a.getScriptSource=function(c,d,e){var f,g,h,i,j,k;if(a.src_id=c,e=e||{},f=e.u,g=e.d,h=e.to,i=e.mt,f||(f=a.getReferrerURL()),f&&-1!==f.indexOf("amzn_debug_mode")&&(a.debug_mode=!0),a.ads&&(a.clearTargetingFromGPTAsync(),a.ads={}),a.saved_ads&&(a.ads=a.saved_ads),g)try{b.domain=g}catch(l){}return j="src="+c+"&u="+f+"&cb="+Math.round(1e7*Math.random()),d&&(j+="&sz="+d),h&&(j+="&t="+h),i&&(j+="&mt="+i),k=a.protocol+a.host+a.dtb_svc+"?"+j},a.getReferrerURL=function(){var d=encodeURIComponent(b.documentURI);try{d=encodeURIComponent(c.top.location.href),d&&"undefined"!=d||(d=a.detectIframeAndGetURL())}catch(e){d=a.detectIframeAndGetURL()}return d},a.detectIframeAndGetURL=function(){try{if(c.top!==c.self)return encodeURIComponent(b.referrer)}catch(a){return encodeURIComponent(b.documentURI)}},a.appendScriptTag=function(a,c){var d=b.getElementsByTagName("script")[0],e=b.createElement("script");e.type="text/javascript",e.async=!0,e.src=a;try{c&&"function"==typeof c&&(e.readyState?e.onreadystatechange=function(){("loaded"==e.readyState||"complete"==e.readyState)&&(e.onreadystatechange=null,c(!0))}:e.onload=function(){c(!0)})}catch(f){}d.parentNode.insertBefore(e,d)},a.renderAd=function(b,c){var d,e,f,g,h,i;if(a.ads[c])d=a.ads[c],a.ev&&(e="amznad"+Math.round(1e6*Math.random()),d=d.replace("window.top.amznads.detectViewability","window.amzncsm.rmD"),d=d.replace(/id=[^ ]*/,'id="'+e+'"'),f="<script type='text/javascript' src='"+a.CSM_JS+"'></script>\n",a.host!=a.DEFAULT_HOST&&(f+="<script type='text/javascript'>try{amzncsm.host=window.top.amznads.host;}catch(e){amzncsm.host=amznads.host;}</script>\n"),d=f+d),aax_write(b,d);else{g=new Object,g.c="dtb",g.src=a.src_id,g.kvmismatch=1,g.pubReturnedKey=c,g.aaxReturnedKeys=a.getTokens(),g.cb=Math.round(1e7*Math.random());try{g.u=encodeURIComponent(location.host+location.pathname),navigator&&(g.ua=encodeURIComponent(navigator.userAgent))}catch(j){}h=encodeURIComponent(JSON.stringify(g)),i=a.protocol+a.host+"/x/px/p/0/"+h,aax_write(b,"<img src='"+i+"'/>")}},a.hasAds=function(b){var c;if(!b)try{return Object.keys(a.ads).length>0}catch(d){for(c in a.ads)if(a.ads.hasOwnProperty(c))return!0}for(c in a.ads)if(a.ads.hasOwnProperty(c)&&c.indexOf(b)>0)return!0;return!1},a.getTargeting=function(b){var c={};return a.getTokens()&&a.getTokens().length>0&&(c[a.targetingKey]=a.getTokens(),a.amzn_vid&&(c[a.vidKey]=a.amzn_vid)),c},a.setTargeting=function(b,c){var d;for(d in a.ads)if(a.ads.hasOwnProperty(d)){if(c&&d.indexOf(c)<0)continue;b(d,"1")}},a.setTargetingForGPTAsync=function(b){var c,d;try{if(b)a.targetingKey=b,c=a.getTokens(),"undefined"!=typeof c&&c.length>0&&googletag.cmd.push(function(){googletag.pubads().setTargeting(b,c),a.amzn_vid&&googletag.pubads().setTargeting(a.vidKey,a.amzn_vid)});else for(d in a.ads)a.ads.hasOwnProperty(d)&&!function(){var b=d;googletag.cmd.push(function(){amznads.debug_mode,googletag.pubads().setTargeting(b,"1"),a.amzn_vid&&googletag.pubads().setTargeting(a.vidKey,a.amzn_vid)})}()}catch(e){}},a.setTargetingForGPTSync=function(b){var c,d;try{if(b)a.targetingKey=b,c=a.getTokens(),"undefined"!=typeof c&&c.length>0&&(googletag.pubads().setTargeting(b,c),a.amzn_vid&&googletag.pubads().setTargeting(a.vidKey,a.amzn_vid));else for(d in a.ads)a.ads.hasOwnProperty(d)&&(googletag.pubads().setTargeting(d,"1"),a.amzn_vid&&googletag.pubads().setTargeting(a.vidKey,a.amzn_vid))}catch(e){}},a.clearTargetingFromGPTAsync=function(){try{googletag&&googletag.pubads()&&googletag.pubads().clearTargeting(a.targetingKey),googletag.pubads().clearTargeting(a.vidKey)}catch(b){}},a.appendTargetingToAdServerUrl=function(b){var c;try{-1===b.indexOf("?")&&(b+="?");for(c in a.ads)a.ads.hasOwnProperty(c)&&(b+="&"+c+"=1")}catch(d){}return b},a.appendTargetingToQueryString=function(b){var c;try{for(c in a.ads)a.ads.hasOwnProperty(c)&&(b+="&"+c+"=1")}catch(d){}return b},a.getTokens=function(b){var c,d=[];try{for(c in a.ads)if(a.ads.hasOwnProperty(c)){if(b&&c.indexOf(b)<0)continue;d.push(c)}}catch(e){}return d},a.getKeys=a.getTokens,a.getVid=function(){return a.amzn_vid},a.doAllTasks=function(){for(;a.tasks.length>0;){var b=a.tasks.shift();a.doTask(b)}},a.doTask=function(a){try{a.call()}catch(b){}},a.tryGetAdsAsync=function(){a.asyncParams&&a.getAdsCallback(a.asyncParams.id,a.asyncParams.callbackFn,a.asyncParams.timeout,a.asyncParams.size,a.asyncParams.data)},a}(amznads||{},document,window);amznads.tryGetAdsAsync(),window.amzn_ads=amzn_ads,window.amznads=amznads;