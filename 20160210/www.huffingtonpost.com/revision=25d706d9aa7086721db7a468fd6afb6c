!function(){"use strict";function e(){try{var e=window.piximedia&&window.piximedia.pam?window.piximedia.pam:{},t=(e.globalOptions||{}).pageLoadStart||new Date(0),i=((new Date-t)/1e3).toString();return i.match(/\..$/)&&(i+="00"),i.match(/\...$/)&&(i+="0"),"[pam]["+i+"] "}catch(o){return"[pam] "}}function t(i,o){t.trail=t.trail||[],t.trail.push("["+i+"] "+e()+Array.prototype.slice.call(o).join(", "))}function i(){if(t("debug",arguments),B){var i=Array.prototype.slice.call(arguments);i[0]&&(i[0]=e()+i[0]),_.console&&_.console.log&&(_.console.log.apply?_.console.log.apply(_.console,i):_.console.log(i[0]))}}function o(){if(t("error",arguments),B){var i=Array.prototype.slice.call(arguments);i[0]&&(i[0]=e()+i[0]),_.console&&_.console.error&&(_.console.error.apply?_.console.error.apply(_.console,i):_.console.error(i[0]))}}function n(){if(t("log",arguments),B){var i=Array.prototype.slice.call(arguments);i[0]&&(i[0]=e()+i[0]),_.console&&_.console.log&&(_.console.log.apply?_.console.log.apply(_.console,i):_.console.log(i[0]))}}function a(e){return"document.write('"+e.replace(/\\/g,"\\\\").replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/'/g,"\\'")+"');"}function r(e){for(var t=e.replace(/\\r/g,"\n").split("\n"),i="",o=0;o<t.length;o++){var n=t[o];n&&(i+="document.write('"+n.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"');")}return i}function s(e){return"[object Array]"===Object.prototype.toString.call(e)}function c(e,t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t);for(var i=0;i<e.length;i++)if(e[i]===t)return i;return-1}function l(e,t,i){for(var o=[],n=0;n<e.length;n++){var a,r=e[n];a="function"==typeof t?t(r):i?r[t]===i:r===t,a||o.push(r)}return o}function p(e){var t=new Image;_._piximedia.images.push(t),t.src=e}function d(e){var t=(e||"").split("."),i=t.shift();return t.sort(function(e,t){var i=e.match(/^[0-9]+$/),o=t.match(/^[0-9]+$/);if(i&&o){var n=parseInt(e,10),a=parseInt(t,10);return a>n?-1:n>a?1:0}return o&&!i?-1:i&&!o?1:t>e?-1:e>t?1:0}),i+(t.length?"."+t.join("."):"")}function m(e){var t=e.match(/^ *([a-zA-Z0-9_.-]+) *=>/);return t?t[1]:e}function u(e){return e.toString().match(/^[0-9]+%$/)?parseInt(e,10)+"pct":parseInt(e,10)}function h(e){if(Object.keys)return Object.keys(e);var t=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable("toString"),o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=o.length;if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var a,r,s=[];for(a in e)t.call(e,a)&&s.push(a);if(i)for(r=0;n>r;r++)t.call(e,o[r])&&s.push(o[r]);return s}function f(e){switch(e.nodeType){case Node.DOCUMENT_NODE:return f(e.documentElement||e.children[0]);case Node.ELEMENT_NODE:var t={name:e.nodeName,children:[]},i=e.attributes;for(var o in i)if(i.hasOwnProperty(o)){var n=i[o];t[n.nodeName]=n.nodeValue}for(var a={},r=0;r<e.childNodes.length;r++){var s=f(e.childNodes[r]);"object"==typeof s&&(a[s.name]=!0,t[s.name]=t[s.name]||[],t[s.name].push(s)),t.children.push(s)}1===t.children.length&&(t.value=t.children[0]);for(var c in a)a.hasOwnProperty(c)&&1===t[c].length&&(t[c+"_value"]=t[c][0]);return t;case Node.TEXT_NODE:case Node.CDATA_SECTION_NODE:return e.textContent}}function v(e){e.style.margin=0,e.style.padding=0,e.style.border=0,e.style.position="relative",e.style.overflow="visible",e.style.cursor="default",e.style.lineHeight="normal",e.style.wordSpacing="normal",e.style.fontSize="11px",e.style.fontStyle="normal",e.style.letterSpacing="0px",e.style.WebkitFontSmoothing="antialiased",e.style.MozOsxFontSmoothing="grayscale",e.style.fontFamily="Arial, Helvetica, sans-serif",e.style.left=e.style.right=0,e.style.textAlign="left",e.style.display="block",e.style.clear="both",e.style.maxWidth="none"}function g(e,t){this.events={},this.id=t,this.target=e||this}function y(e,t){var i=this;this.pam=e;for(var o in t)t.hasOwnProperty(o)&&(this[o]=t[o]);e&&e.eventEmitterForObject&&(e.eventEmitterForObject(this,this.uniqid),i.pam.master&&(e.on("something-has-been-seen",function(){i.somethingHasBeenSeen()}),i.on("send-cpmview-click",function(){i.sendCpmviewClick()}),i.on("load-event-once",function(e,t,o){i.loadEventOnce(e,t,o)})))}function b(e,t,i){y.call(this,e,i),this.position=t}function w(e,t){for(var i in e)e.hasOwnProperty(i)&&(this[i]=e[i]);this.cgAd=e,this.cgOptions=t,this.cgOptions.id_reporting&&(this.creativeId=this.cgOptions.id_reporting),this.cgOptions.args&&(this.args=this.cgOptions.args)}function x(e,t,a){var r=this;this.pam=e,this.options=a||{},this.position=t,this.active=!0,t.iframes=t.iframes||[],t.iframes.push(this),this.pam.eventEmitterForObject(this,"iframe:"+t.positionId),r.pam.master&&(this.on("host-room",function(e,t){r.hostRoom(e,t)}),this.on("enable-responsive-events",function(){r.enableResponsiveEvents()}),this.on("remove",function(){r.pam.emit("iframe:remove",t.positionId),t.decoratedBy&&t.decoratedBy.emit("iframe:remove",t.positionId)})),this.trackVisibility=this.pam.master&&t.decoratedBy?t.decoratedBy.getAllVisibilityForPixiPositionId(t.pixiPositionId||t.decoratedBy.getPixiPositionIdForPositionId(t.positionId)):[],this.trackingVisibility=!1,this.on("error",function(e){r.lastError=e}),this.options.doNotResize||this.on("resize",function(a){if(r.active){var s=function(){if(!r.iframe)return setTimeout(s,50);if(r.pam.master)if(a.onlyIfNoSurface&&(parseInt(r.iframe.style.width,10)||0)>1&&(parseInt(r.iframe.style.height,10)||0)>1)i("Not resizing iframe because it already has a surface");else if(setTimeout(function(){e.emit("position-has-been-decorated",t.positionId),e.tryAndActivateAds()},0),a.animation)r.pam.loadLibrary("sweetlib.js",function(){_.piximedia.SweetLib.animate(r.iframe,a.animation).play()}),r.pam.log("** Resizing iframe for PAM "+r.pam.siteId+"/"+r.pam.placementId+":"+r.pam.mode+" to animation="+JSON.stringify(a.animation),r.iframe);else{var c,l,p,d,m,h,f,g,y=a.css||{},b=y.position,w=!1;if(r.position.positionId.match(/^room\./))for(var x=r.iframe.parentNode;x&&void 0!==x.className;x=x.parentNode)if(x.className.match(/pmRoom|pmBodyPosition/)){c=x;break}for(var I=r.iframe.parentNode;I&&void 0!==I.className;I=I.parentNode)if(I.className.match(/pmContainer/)){l=I;break}l&&l.parentNode&&l.parentNode.parentNode&&l.parentNode.parentNode.className.match(/pmMarkerContainer/)&&(p=l.parentNode.parentNode),l&&l.parentNode&&l.parentNode&&l.parentNode.className.match(/pmMarkerContainer/)&&(p=l.parentNode),l&&l.parentNode&&l.parentNode&&l.parentNode.className.match(/pmFillerRoomContainer/)&&(d=l.parentNode),a.width&&(a.width.toString().match(/^.*%$/)?(f=a.width,m=1):m=parseInt(a.width,10)),a.height&&(a.height.toString().match(/^.*%$/)?(g=a.height,w=!0,h=1):h=parseInt(a.height,10)),m&&d&&d.parentNode&&(d.parentNode.style.width=f||m+"px"),(m||h)&&l&&(a.resizeParent||l.className.match(/pmZeroSurface/))&&(l.className=l.className.replace(/pmZeroSurface/,""),l.style.position="relative"),y.hasOwnProperty("display")&&(""===y.display||"none"===y.display||"block"===y.display)&&l&&(l.style.display=y.display),function(e){return a.wallpaper?(a.container=a.container||{},a.container.css=a.container.css||{},a.container.css.position=a.container.css.position||"relative",a.container.css.overflow=a.container.css.overflow||"hidden",a.container.css.left=a.container.css.left||"50%",a.container.css.right=a.container.css.right||"",a.container.css.marginLeft=a.container.css.marginLeft||-m/2+"px",a.container.css.maxWidth=a.container.css.maxWidth||m+"px",r.pam.loadLibrary("sweetlib.js",function(){var i=_.piximedia.SweetLib,n=function(e){for(e=e.parentNode;e;e=e.nextSibling)if(e.children&&e.children.length&&!(e.id||"").match(/^(pm|pixi)/)){for(var t,n=0;n<e.children.length;n++){var a=e.children[n];if(a&&!(a.id||"").match(/^(pm|pixi)/)&&!(a.className||"").match(/pm|pixi/)){t=!0;break}}if(!t)continue;var r=i.gbcr(e);if(r.width&&r.height)return e}o("Couldn't find page container after marker")};r.pam.loadMarkerForPosition(t,function(o){var s,c=n(o);return i.fixPageContainerForWallpaper(c),void 0!==a.moveTop&&(s=i.moveTopOfPageContainer(c,a.moveTop,a.moveTopOptions),r.pageContainer=c,r.moveTop=a.moveTop),a.bodyBackgroundColor&&i.setBodyBackgroundColor({color:a.bodyBackgroundColor}),s&&!s.pmHostedRoom&&(s.pmHostedRoom=!0,r.pam.hostRoom("pcfiller",{masterPositionId:t.positionId},function(){var e=s.ownerDocument.createElement("div");return e.className="pmFillerRoomContainer",v(e),s.style.marginLeft="auto",s.style.marginRight="auto",s.appendChild(e),e})),e()})}),void 0):e()}(function(){if(m){var e,o=(f||"").match(/^([0-9]+)%$/);o&&(e=parseFloat(o[1],10)),"absolute"!==b||a.takeover||(r.iframe.parentNode.style.width=f||m+"px"),i("Resizing iframe to width="+(f||m),r.iframe),r.iframe.style.width=f||m+"px",r.iframe.style.maxWidth="none",l&&(t.decoratedBy&&t.decoratedBy.shouldBeBeforeBody&&t.decoratedBy.shouldBeBeforeBody(t)?(e?l.style.left=(100-e)/2+"%":(l.style.left="50%",l.style.marginLeft=-parseFloat(r.iframe.style.width,10)/2+"px"),l.style.marginRight=""):(parseInt(l.style.width||0,10)<=1||a.wallpaper)&&(l.style.width=f||m+"px",l.style.marginLeft=l.style.marginRight="auto")),c&&(c.style.width=f||m+"px",c.className.match(/pmCentered/)&&(c.style.marginLeft=Math.round(-m/2)+"px"))}h&&("absolute"!==b||a.takeover||(r.iframe.parentNode.style.height=g||h+"px"),i("Resizing iframe to height="+(g||h),r.iframe),r.iframe.style.height=c&&w?"100%":g||h+"px",c&&!a.takeover&&(c.style.height=g||h+"px"),c&&w&&(c.style.height=g||h+"px",l&&(l.style.height="100%")));for(var n in y)if(y.hasOwnProperty(n))try{r.iframe.style[n]=y[n]}catch(s){}if(l){var d="pmContainerSurface"+u(r.iframe.style.width||0)+"x"+u(r.iframe.style.height||0);if(l.className=(l.className||"").replace(/ +pmContainerSurface[0-9%pct]+x[0-9%pct]+/g,"")+" "+d,a.wallpaper&&(l.className=(l.className||"").replace(/ +pmContainerSurfaceWallpaper/,"")+" pmContainerSurfaceWallpaper"),a.container){var v=a.container.css;if(v)for(var x in v)if(v.hasOwnProperty(x))try{l.style[x]=v[x]}catch(s){}}}r.pam.log("** Resizing iframe for PAM "+r.pam.siteId+"/"+r.pam.placementId+":"+r.pam.mode+" to width="+a.width+", height="+a.height,r.iframe),!a.dontCenter&&a.width,r.pam.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;e.breakOverflow(r.iframe,a)}),a.stickToTop?r.pam.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;if("mobile"!==e.device.name){var t=function(){var t,i,o,n,s,c,l=_.piximedia.SweetLib.gbcrfp(r.iframe).top,d=function(t){if(t){var i=r.iframe.parentNode.style.paddingTop;r.iframe.parentNode.style.paddingTop="0px";var o=e.gbcrfp(r.iframe.parentNode);r.iframe.parentNode.style.paddingTop=i;var n=o.top,a=Math.max(0,t-n);Math.round(parseFloat(r.iframe.parentNode.style.paddingTop,10)||0)!==Math.round(a)&&(r.iframe.parentNode.style.hasOwnProperty("transition")?(r.iframe.parentNode.style.transition="padding 0.2s",r.iframe.parentNode.style.paddingTop=a+"px",_.piximedia.SweetLib.addEventOnce(r.iframe.parentNode,"transitionend",function(){r.iframe.parentNode.style.transition=""})):r.iframe.parentNode.style.paddingTop=a+"px")}else r.iframe.parentNode.style.paddingTop=""},m=function(){if(r.iframe.pmFixed)r.iframe.pmFixed=!1,r.iframe.style.position="",r.iframe.style.marginTop="",r.iframe.parentNode.style.position=t,r.iframe.parentNode.style.height=i,r.iframe.parentNode.style.top=o,p&&(p.style.position=n,p.style.top=s,p.style.overflow=c);else{var e=_.piximedia.SweetLib.gbcrfp(r.iframe).top;e&&(l=e)}},u=function(e){r.iframe.pmFixed||(r.iframe.pmFixed=!0,r.iframe.style.position="relative",r.iframe.style.top="0px",t=r.iframe.parentNode.style.position,i=r.iframe.parentNode.style.height,o=r.iframe.parentNode.style.top,r.iframe.parentNode.style.position="fixed",r.iframe.parentNode.style.top=-(e.translateX||0)+"px",r.iframe.parentNode.style.height=(parseFloat(r.iframe.style.height,10)||0)+(parseFloat(r.iframe.parentNode.style.paddingTop,10)||0)+"px",p&&(n=p.style.position,s=p.style.top,c=p.style.overflow,p.style.position="fixed",p.style.top=0,p.style.overflow=""))},h=function(){if(!(r.iframe.ownerDocument.body.className||"").match(/pmBodyAnimation/)&&!(r.pam.getTopmostDocument().body.className||"").match(/pmBodyAnimation/)){var e=r.iframe.ownerDocument.getElementById("pmFiller"),t=0,i=0;if(e)if(t=_.piximedia.SweetLib.gbcr(e).top,a.stickToTopFromTop)t+=a.stickToTopFromTop,i=-a.stickToTopFromTop;else if(a.stickToTopOnPCTop){var o=_.piximedia.SweetLib.gbcr(e);t=o.bottom,i=-o.height}else t=_.piximedia.SweetLib.gbcr(e).top;var n=_.piximedia.SweetLib.getHeightOfPositionFixedHeaders(r.iframe.ownerDocument,void 0,{force:!0})||0;d(n),Math.round(t)>Math.round(n)?m():u({hopfh:n,translateX:-i})}};h();var f=setInterval(h,100);return{remove:function(){clearInterval(f),m()}}};r.scrollToTheTop&&r.scrollToTheTop.remove(),r.scrollToTheTop=t()}}):a.stickToTop===!1&&r.pam.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;if("mobile"!==e.device.name){var t=function(){var t=function(){var t=r.iframe.ownerDocument.getElementById("pmFiller"),i=_.piximedia.SweetLib.getHeightOfPositionFixedHeaders(r.iframe.ownerDocument,void 0,{force:!0})||0;if(t){t.style.marginTop="0px";var o=e.gbcrfp(t).top;t.style.marginTop=Math.max(0,i-o)+"px"}var n=e.gbcrfp(r.iframe).top;r.iframe.parentNode.style.paddingTop=Math.max(0,(parseFloat(r.iframe.parentNode.style.paddingTop,10)||0)+i-n)+"px"},i=setInterval(t,100);return{remove:function(){clearInterval(i),t()}}};r.scrollToTheTop&&r.scrollToTheTop.remove(),r.scrollToTheTop=t()}})})}else{r.iframe.style.width="100%",r.iframe.style.height="100%";var k=r.iframe.parentNode,P=r.iframe.contentDocument&&r.iframe.contentDocument.body?r.iframe.contentDocument.body:void 0,A=P?P.parentNode:void 0;k&&(k.style.width="100%",k.style.height="100%"),P&&(P.style.width="100%",P.style.height="100%"),A&&(A.style.width="100%",A.style.height="100%"),a&&a.css&&a.css.background&&(r.iframe.style.background=a.css.background)}if(r.trackVisibility.length&&!r.trackingVisibility&&parseInt(r.iframe.style.width,10)&&parseInt(r.iframe.style.height,10)){r.trackingVisibility=!0,n("Tracking visibility for",r);var O=function(e){return function(){if(n("Reached visibility for position"),t.loadEventWait(e.event?e.event:10===e.duration&&.6===e.threshold?"AP_VIEWABLE":"AP_VIEWABLE:"+Math.round(100*e.threshold)+"PCT:"+e.duration+"S",{detail:t.pixiPositionId||t.decoratedBy.getPixiPositionIdForPositionId(t.positionId)||t.positionId}),.5===e.threshold&&1===e.duration){var i="isAnyViewable50pct1sForCampaign"+(t.decoratedBy||t.decoratedByCG||{}).campaignId;r.pam[i]||(r.pam[i]=!0,t.loadEventWait("AP_VIEWABLE:50PCT:1S:CAMPAIGN"))}}};r.pam.loadLibrary("sweetlib.js",function(){for(var e=0;e<r.trackVisibility.length;e++){var t=r.trackVisibility[e];t.threshold||(t.threshold=.6),t.duration||(t.duration=10),_.piximedia.SweetLib.bindViewTracker({object:r.iframe,threshold:100*t.threshold,duration:t.duration},O(t))}})}};s()}else i("(not resizing inactive iframe)")}),r.pam.master&&(this.on("set-message-duration",function(e){return r.setMessageDuration(e)}),this.on("register-visibility-callback",function(e){var t=e.callback;r.pam.loadLibrary("sweetlib.js",function(){if(!r.iframe)return void(r.visibilityCallbackOnHold=e);var i={object:r.iframe};for(var o in e)if(e.hasOwnProperty(o))switch(o){case"callback":break;default:i[o]=e[o]}_.piximedia.SweetLib.bindVisibilityTracker(i,function(e){r.emit(t,e)})})}))}function I(e,t){var n=this;this.pam=e,this.eventQueue=[];for(var a in t)t.hasOwnProperty(a)&&(this[a]=t[a]);this.pam.eventEmitterForObject(this,"position:"+this.positionId),this.pam.master&&(this.on("start-timetracker-hover",function(){n.startTimetrackerHover()}),this.on("stop-timetracker-hover",function(){n.stopTimetrackerHover()}),this.on("load-event-once",function(e,t,i){n.loadEventOnce(e,t,i)})),this.on("expand",function(){if(n.expandedCount=(n.expandedCount||0)+1,n.pam.master&&1===n.expandedCount&&n.decoratedBy){var e=n.pixiPositionId||n.decoratedBy.getPixiPositionIdForPositionId(n.positionId);n.loadEventWait("EXPAND",{detail:e}),n.pam.loadLibrary("sweetlib.js",function(){n.timetrackerExpand=_.piximedia.SweetLib.setTimer("EXPAND",function(t,i){n.decoratedBy&&n.loadEventWait("TIMETRACKER::"+t,{duration:i,detail:e})}),n.timetrackerExpand.start()})}}),this.on("collapse",function(){if(!n.expandedCount)return o("Position has been collapsed, but was not expanded",n);if(!--n.expandedCount&&n.pam.master){var e=n.pixiPositionId||n.decoratedBy.getPixiPositionIdForPositionId(n.positionId);n.loadEventWait("COLLAPSE",{detail:e}),n.pam.loadLibrary("sweetlib.js",function(){n.timetrackerExpand.stop(),n.timetrackerExpand=void 0})}}),this.on("responsive",function(e){e.pageContainerWidth&&(this.pageContainerWidth=e.pageContainerWidth)}),this.pam.master&&(this.on("injected-into-pixi-position-id",function(e){i("Host injected as "+e),n.pixiPositionId=e}),this.on("injected-into-creative-group",function(e){i("Host injected as create group member"),n.setDecoratedByCG(new w(n.decoratedBy,e))}))}function k(e){if(this.pam=e,this.deferredObjects=[],_.pmAdData&&_.pmAdData.ajax)for(;_.pmAdData.ajax.length>0;){var t=_.pmAdData.ajax.shift();t&&(this.pam.msie&&6===this.pam.msie&&(t.use_pb=!0),this.loadAd(t))}}function P(e,t,i,a,r){var s,l,p,d=this,m=(a||{}).mode||"alliance",u=e+"/"+t+":"+m,h=a&&a.uniqid?a.uniqid:"pam"+Math.round(1e16*Math.random());if(this.numberOfEventsSent={},this.birthdateCookie=this.getBirthdateCookie(),this.birthdateLS=this.getBirthdateLS(),_.piximedia._.pams=_.piximedia._.pams||{},_.piximedia._.pams[u]=_.piximedia._.pams[h]=_.piximedia.pam=this,!a.pageLoadStart){var f=this.getTopmostWindow();f.performance&&f.performance.timing&&f.performance.timing.responseStart?a.pageLoadStart=f.performance.timing.responseStart:a.pageLoadStart=new Date}if(this.msie=function(){var e=!1;if("Microsoft Internet Explorer"===navigator.appName){var t=navigator.userAgent,i=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=i.exec(t)&&(e=parseFloat(RegExp.$1))}return e}(),this.chrome=function(){try{return navigator.userAgent.search("Chrome")>=0?parseInt(navigator.userAgent.match(/Chrome\/([0-9]+)/)[1],10):void 0}catch(e){}return void 0}(),this.safari=function(){try{return-1===navigator.userAgent.search("Chrome")&&navigator.userAgent.search("Safari")>=0?parseInt(navigator.userAgent.match(/Version\/([.0-9]+)/)[1],10):void 0}catch(e){}return void 0}(),this.firefox=function(){try{return navigator.userAgent.search("Firefox")>=0?parseInt(navigator.userAgent.match(/Firefox\/([0-9]+)/)[1],10):void 0}catch(e){}return void 0}(),this.cssCalc=!(this.msie&&this.msie<9||this.safari&&this.safari<8||this.firefox&&this.firefox<31||this.chrome&&this.chrome<34),this.window=_,this.document=S,this.pixelQueue=[],this.animations={},this.containerClassName=B?"pmContainer_"+u.replace(/[^A-Za-z0-9]/g,"-"):"",this.globalEmitter=new g,this.globalOptions=a||{},this.master=!this.globalOptions.hosted,this.mode=m,this.positions={},this.winlostIframeIds={},this.allAvailableAds=i,this.explicitlyRegisteredPositionIds={},this.trackingAdPixelsCalled={},this.trackingAdCreativePixelsCalled={},this.availableAds=[],this.decorativeAds=[],this.realAds=[],this.clickUrl=r,this.siteId=e,this.placementId=t,this.uniqKey=h,this.globalOptions.uniqid=h,this.campaignIdsWithImpressions={},this.adIdsWithImpressions={},this.checkTopDomain(),this.numberOfExplicitPositions=0,this.globalOptions.loadPixelRandom=this.globalOptions.loadPixelRandom||Math.random(),this.master&&!this.globalOptions.location)try{this.globalOptions.location=this.getTopmostWindow().location.toString()}catch(v){}if(this.globalOptions.autoFacetPosition)try{(function(){var e=this.getTopmostWindow();"resources.pm"===e.location.hostname&&"/tools/preview/"===e.location.pathname&&(this.globalOptions.autoFacetPosition=void 0,this.globalOptions.facets=void 0)}).apply(this)}catch(v){}if(this.globalOptions.autoFacetPosition)switch(this.facets=JSON.parse(JSON.stringify(this.globalOptions.facets||[])),this.currentFacetIndex=0,this.globalOptions.autoFacetPosition){case"shuffle":this.facets=this.facets.sort(function(){return Math.random()<.5})}this.eventEmitterForObject(this,"pam:"+this.globalOptions.uniqid),a.hasOwnProperty("documentHasFocus")&&(this.documentHasFocus=a.documentHasFocus),this.syncDocumentHasFocus(),this.master&&(this.on("js-impression-ad-campaign",function(e,t,i,o){d.sendJSImpressionAdCampaign(e,t,i,o)}),this.on("create-opaque-animation",function(e,t,i){d.createOpaqueAnimation(e,t,i)}),this.on("play-opaque-animation",function(e,t,i){d.playOpaqueAnimation(e,t,i)}),this.on("reverse-opaque-animation",function(e,t,i){d.reverseOpaqueAnimation(e,t,i)}),this.on("clear-opaque-animation",function(e){d.clearOpaqueAnimation(e)}),this.on("wait-top-dom-loaded",function(e){d.waitTopDomLoaded(function(){d.emit(e)})}),this.on("bind-visibility-tracker",function(e,t,i,o){d.bindVisibilityTracker(e,t,i,o)}),this.on("start-navigation-tracking",function(e){d.startNavigationTracking(e)}));var b=!1;try{var w=d.getTopmostWindow().name;(w||"").match(/pmpassback/)&&(b=!0)}catch(v){}for(s=0;s<i.length;s++){if(p=i[s],p.uniqid||(p.uniqid="ad"+this.rand()),p.remapSnippets&&p.remapSnippets.length)for(var x=0;x<p.remapSnippets.length;x++){var I=p.remapSnippets[x];try{new Function(["pam"],I).call(p,d)}catch(v){o(v)}}var P=!0;if(p.require&&p.require.context)for(l=0;l<p.require.context.length;l++)if(!p.require.context[l]()){P=!1;break}if(b&&!p.passback&&(P=!1),P){var A=new y(this,p);this.availableAds.push(A),A.passback||this.realAds.push(A),p.require&&p.require.positions&&p.require.positions.length||!p.use||!p.use.positions||!p.use.positions.length||this.decorativeAds.push(A)}}if(!this.realAds.length&&this.globalOptions.keepAdringForRTA){S.cookie="pixi_rta_pos=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_rta_pos=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT";var O=this.globalOptions.pixiAdrName;S.cookie=O+"=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie=O="=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"}_.piximedia.request_pos=_.piximedia.request_pos||{},_.piximedia.request_pos_sp=_.piximedia.request_pos_sp||{},_.piximedia.request_pos_sp[this.siteId]=_.piximedia.request_pos_sp[this.siteId]||{};var T=this.request_pos=_.piximedia.request_pos_sp[this.siteId][this.placementId]=_.piximedia.request_pos_sp[this.siteId][this.placementId]||{},E=this.globalOptions.rtaPositionsToRequestOnlyWhenRequired||[];for(s=0;s<this.availableAds.length;s++){if(p=this.availableAds[s],p.require&&p.require.positions)for(var C=this.parseRequestedPositions(p.require.positions),D=0;D<C.length;D++){T[C[D]]=!0,_.piximedia.request_pos[C[D]]=!0;var M=d.getPrerequisiteVirtualPosition(C[D]);M&&(T[M]=!0,_.piximedia.request_pos[M]=!0)}if(!p.passback&&p.use&&p.use.positions)for(var j=this.parseRequestedPositions(p.use.positions),F=0;F<j.length;F++){var L=j[F];if(-1===c(E,L)){T[L]=!0,_.piximedia.request_pos[L]=!0;var R=d.getPrerequisiteVirtualPosition(L);R&&(T[R]=!0,_.piximedia.request_pos[R]=!0)}}}if(this.globalOptions.requestPosJSSnippet)try{new Function(["request_pos","pam"],this.globalOptions.requestPosJSSnippet).call(d,_.piximedia.request_pos,d),new Function(["request_pos","pam"],this.globalOptions.requestPosJSSnippet).call(d,T,d)}catch(U){n("Could not execute request_pos JS snippet: ",U)}if(m.match(/^alliance/)){_.piximedia.core||(_.piximedia.core=new k(this));var W=this.siteId+"|"+this.placementId,H=setInterval(function(){try{var e=d.getTopmostWindow();e&&e.pmLoopBlocker&&e.pmLoopBlocker.hasOwnProperty(W)&&(clearInterval(H),d.loadEvent("PANIC",void 0,void 0,{fail_reason:"both_v1_and_position_tags"}))}catch(t){}},2e3);setTimeout(function(){d.sendStatistics()},1.5*(this.globalOptions.rendezvous_duration||N))}if(this.globalOptions.enableFooter&&this.hello({implicit:!0,ajax:!0,positionId:"footer"}),this.globalOptions.bwd_probability&&Math.random()<this.globalOptions.bwd_probability)try{var V=q.getData();this.loadEvent("BWD",void 0,void 0,{c1:V.browser_name,c2:V.browser_major_version,c3:V.os_name})}catch(v){}n(this.master?"Master PAM Created":"Hosted PAM Created"),this.globalOptions.pamela&&this.waitDomLoaded(function(){var e=d.getTopmostDocument(),t=e.createElement("script");e.body.appendChild(t),t.src="http://resources.pm/tools/pamela/pamelight.js"}),this.runPixeldisTest()}function A(e,t){for(var i=d(e.positionId||""),o=d(t.positionId||""),n=i.split("."),a=o.split("."),r=0;r<n.length;r++){if(r>=a.length)return 1;var s=n[r],c=a[r];if(s.match(/^[0-9]+$/)&&c.match(/^[0-9]+$/)&&(s=parseInt(s,10),c=parseInt(c,10)),c>s)return-1;if(s>c)return 1}return a.length>n.length?-1:0}function O(e,t,i,n){var a,r=e.split(":"),s=[],l=[];a=r[0].split(".");for(var p in i)if(i.hasOwnProperty(p)){var m=i[p],u=m.positionId,h=u.split("."),f=h.slice(1);if(""===a[0]||"*"===a[0]||a[0]===h[0]){for(var v=!0,g=1;g<a.length;g++)if(-1===c(f,a[g])){v=!1;break}if(v){if(s.push(m),t.activeAndNotUsed&&(!m.active||m.used))continue;if(t.notRequestedByActiveAd&&(!m.active||m.used||m.requested))continue;if(t.decoratedBy&&m.decoratedBy!==t.decoratedBy)continue;l.push(m)}}}l.sort(A);for(var y=1;y<r.length;y++){var b=r[y];if("free_mp"===b&&(b=n?"optional":"free"),l.length){switch(b){case"odd":b="mod2=0";break;case"even":b="mod2=1"}if("first"===b)l=[l[0]];else if("last"===b)l=[l[l.length-1]];else if("#"===b.charAt(0)){var w=parseInt(b.substr(1),10);l=l[w-1]?[l[w-1]]:[]}else if("optional"===b)l.length||l.push({});else if("decorated"===b){for(var x=[],I=0;I<l.length;I++)for(var k=l[I].iframes||[],P=0;P<k.length;P++){var O=k[P].iframe;O&&parseInt(O.style.width,10)>1&&parseInt(O.style.height,10)>1&&x.push(l[I])}l=x}else if("used"===b||"free"===b){for(var _="used"===b,S=[],T=!0,E=0;E<s.length;E++)(s[E].used?!0:!1)!==_&&(T=!1);if(T)for(var C=0;C<l.length;C++)(l[C].used?!0:!1)===_&&S.push(l[C]);l=S}else if("exact"===b){for(var N=d(r[0]),D=[],M=0;M<l.length;M++){var j=d(l[M].positionId||"");N===j&&D.push(l[M])}l=D}else if("primaryposition"===b)l=l;else{var B=b.match(/^mod([0-9]+)={1,3}([0-9]+)$/);if(B){for(var F=parseInt(B[1],10),L=parseInt(B[2],10),R=[],q=0;q<l.length;q++)q%F===L&&R.push(l[q]);l=R}else o("Unknown restrictive: "+b),l=[]}}else switch(b){case"free":case"optional":if(!t.positions){var U=!0;if("free"===b)for(var W=0;W<s.length;W++)s[W].used&&(U=!1);U&&l.push({})}}}return l}var _=window,S=document;if(!_.piximedia){try{!_.piximedia&&parent.piximedia&&(_.piximedia=parent.piximedia)}catch(T){}try{!_.piximedia&&parent.parent.piximedia&&(_.piximedia=parent.parent.piximedia)}catch(T){}try{!_.piximedia&&top.piximedia&&(_.piximedia=top.piximedia)}catch(T){}_.piximedia=_.piximedia||{};try{parent.piximedia=_.piximedia}catch(T){}try{parent.parent.piximedia=_.piximedia}catch(T){}try{top.piximedia=_.piximedia}catch(T){}}_.piximedia._=_.piximedia._||{},_._piximedia=_._piximedia||{},_._piximedia.images=_._piximedia.images||[];var E,C=2014031001,N=1e3,D="http://static.adserver.pm/host.html/revision=25d706d9aa7086721db7a468fd6afb6c",M="ad.piximedia.com",j="static.adserver.pm",B=!1,F=1200,L=.05;t.get=function(){return t.trail||[]};var R="margin: 0; padding: 0; border: 0; position: relative; overflow: visible; cursor: default; word-spacing: normal; font-size: 11px; font-style: normal; letter-spacing: 0px; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; font-family: Arial, Helvetica, sans-serif; left: 0; right: 0; /*top: 0; bottom: 0;*/ text-align: left; display: block; clear: both",q=function(){"use strict;";function e(e){var t=S.createElement("a");return t.href=e,t}function t(){try{return""===top.document.referrer?!0:e(top.document.referrer).hostname==top.window.location.hostname?!1:!0}catch(t){}try{return""===S.referrer?!0:e(S.referrer).hostname==_.location.hostname?!1:!0}catch(t){return!1}}function i(){var e="",t="";return _.screen&&_.screen.width&&_.screen.height&&(e=_.screen.width,t=_.screen.height),{width:e,height:t,resolution:parseInt(e,10)&&parseInt(t,10)?e+"x"+t:"n/a"}}function o(){try{var e,t,i=parent.window?parent.window:window;return"undefined"!=typeof i.innerWidth?(e=i.innerWidth,t=i.innerHeight):"undefined"!=typeof i.document.documentElement&&"undefined"!=typeof i.document.documentElement.clientWidth&&0!==i.document.documentElement.clientWidth?(e=i.document.documentElement.clientWidth,t=i.document.documentElement.clientHeight):(e=i.document.getElementsByTagName("body")[0].clientWidth,t=i.document.getElementsByTagName("body")[0].clientHeight),{width:e,height:t}}catch(o){return{width:"",height:""}}}function n(){var e="unknown";return-1!=navigator.appVersion.indexOf("Win")?e="windows":-1!=navigator.appVersion.indexOf("Mac")?e="mac_os":-1!=navigator.appVersion.indexOf("X11")?e="unix":-1!=navigator.appVersion.indexOf("Linux")&&(e="linux"),{name:e}}function a(){var e,t,i,o=navigator.userAgent,n=navigator.appName,a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10);return-1!=(t=o.indexOf("Opera"))?(n="opera",a=o.substring(t+6),-1!=(t=o.indexOf("Version"))&&(a=o.substring(t+8))):-1!=(t=o.indexOf("MSIE"))?(n="msie",a=o.substring(t+5)):-1!=(t=o.indexOf("Edge"))?(n="edge",a=o.substring(t+5)):-1!=(t=o.indexOf("Trident"))?(n="trident",a=o.substring(t+8)):-1!=(t=o.indexOf("Chrome"))?(n="chrome",a=o.substring(t+7)):-1!=(t=o.indexOf("Safari"))?(n="safari",a=o.substring(t+7),-1!=(t=o.indexOf("Version"))&&(a=o.substring(t+8))):-1!=(t=o.indexOf("Firefox"))?(n="firefox",a=o.substring(t+8)):(e=o.lastIndexOf(" ")+1)<(t=o.lastIndexOf("/"))&&(n=o.substring(e,t),a=o.substring(t+1),n.toLowerCase()==n.toUpperCase()&&(n=navigator.appName)),-1!=(i=a.indexOf(";"))&&(a=a.substring(0,i)),-1!=(i=a.indexOf(" "))&&(a=a.substring(0,i)),r=parseInt(""+a,10),isNaN(r)&&(a=""+parseFloat(navigator.appVersion),r=parseInt(navigator.appVersion,10)),r>100&&(r=""),n.indexOf("/")>=0&&(n=n.split("/")[0]),{name:n,full_version:a,major_version:r}}function r(){var e=new Date;return{hour:e.getHours(),week_day:e.getDay()}}function s(){var e=_.name,t=/^pm\-(\S*)\-(\S*)\-(\d*)\-(\d*)\-(\S*)\-(\d*)$/,i=[];return e&&""!==e&&t.exec(e)?(i=t.exec(e),{site_id:i[1]&&""!==i[1]?i[1]:"",placement_id:i[2]&&""!==i[2]?i[2]:"",ad_id:i[3]&&""!==i[3]?i[3]:"",creative_id:i[4]&&""!==i[4]?i[4]:"",options:i[5]&&""!==i[5]?i[5]:"",sequence_number:i[6]&&""!==i[6]?i[6]:""}):{site_id:"",placement_id:"",ad_id:"",creative_id:"",options:"",sequence_number:""}}function c(){return{adr:function(){return void 0}()||""}}function l(){try{return window.top._piximediaiframetest=!0,window&&window.parent&&window.hasOwnProperty&&!window.parent.hasOwnProperty?!0:!1}catch(e){return!0}}function p(){var e,i;try{e=top.location.hostname,i=top.location.pathname}catch(o){}if(!e)try{e=parent.parent.parent.location.hostname,i=parent.parent.parent.location.pathname}catch(o){}if(!e)try{e=parent.parent.location.hostname,i=parent.parent.location.pathname}catch(o){}if(!e)try{e=parent.location.hostname,i=parent.location.pathname}catch(o){}if(!e)try{e=window.location.hostname,i=window.location.pathname}catch(o){}return{crossdomain:l()?1:0,hostname:e,path:(i||"").substring(0,128),section:(((i||"").match(/^\/([a-z0-9]+)/)||[])[1]||"").substring(0,32),firstpage:t()?1:0}}function d(e){var t,i,o={};if(e){for(t in e)if(e.hasOwnProperty(t)&&h[t])if("all"===e[t])for(i in h[t])h[t].hasOwnProperty(i)&&(o[t+"_"+i]=h[t][i]);else for(i in e[t])e[t].hasOwnProperty(i)&&h[t][i]&&(o[t+"_"+i]=h[t][i])}else for(t in h)if(h.hasOwnProperty(t))for(i in h[t])h[t].hasOwnProperty(i)&&(o[t+"_"+i]=h[t][i]);return o}var m={flash_major:"F",flash_minor:"f",flash_release:"r",viewport_width:"w",viewport_height:"h",screen_width:"W",screen_height:"H",screen_resolution:"R",os_name:"O",browser_name:"b",browser_full_version:"U",browser_major_version:"u",external_site_id:"s",external_placement_id:"p",external_ad_id:"a",external_creative_id:"c",external_options:"o",external_sequence_number:"n",time_hour:"T",time_week_day:"y",location_crossdomain:"X",location_hostname:"N",location_section:"S",
location_path:"P",location_firstpage:"i",alliance_adr:"A",alliance_rtapos:"x"},u=function(){var e="undefined",t="object",i="Shockwave Flash",o="ShockwaveFlash.ShockwaveFlash",n="application/x-shockwave-flash",a=window,r=document,s=navigator,c=!1,l=function(){var l=typeof r.getElementById!=e&&typeof r.getElementsByTagName!=e&&typeof r.createElement!=e,p=s.userAgent.toLowerCase(),d=s.platform.toLowerCase(),m=d?/win/.test(d):/win/.test(p),u=d?/mac/.test(d):/mac/.test(p),h=/webkit/.test(p)?parseFloat(p.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,f=!function(){return 1}(),v=[0,0,0],g=null;if(typeof s.plugins!=e&&typeof s.plugins[i]==t)g=s.plugins[i].description,!g||typeof s.mimeTypes!=e&&s.mimeTypes[n]&&!s.mimeTypes[n].enabledPlugin||(c=!0,f=!1,g=g.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),v[0]=parseInt(g.replace(/^(.*)\..*$/,"$1"),10),v[1]=parseInt(g.replace(/^.*\.(.*)\s.*$/,"$1"),10),v[2]=/[a-zA-Z]/.test(g)?parseInt(g.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof a.ActiveXObject!=e)try{var y=new a.ActiveXObject(o);y&&(g=y.GetVariable("$version"),g&&(f=!0,g=g.split(" ")[1].split(","),v=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)]))}catch(b){}return{w3:l,pv:v,wk:h,ie:f,win:m,mac:u}}();return{getFlashPlayerVersion:function(){return{major:l.pv[0],minor:l.pv[1],release:l.pv[2]}}}}(),h={};h.flash=u.getFlashPlayerVersion(),h.viewport=o(),h.screen=i(),h.os=n(),h.browser=a(),h.external=s(),h.time=r(),h.location=p(),h.alliance=c();var f="";return{getData:function(){var e=arguments[0]||!1;return d(e)},setId:function(e){f=e},toString:function(e,t){e=e||!1;var i,o=t?t:this.getData(e),n="";for(i in o)o.hasOwnProperty(i)&&(n+=(m[i]?m[i]:i)+"="+o[i].toString().replace(/\||%7c/gi,"-")+";");return n+=f+";"}}}();g.globalEmitter=new g,g.forObject=function(e,t,i){if(i=i||{},e._eventEmitter&&!i.purge)return e._eventEmitter;var o=new g(e);if(e.fire=e.emit=function(){return o.fire.apply(o,arguments)},e.fireLocal=e.emitLocal=function(){return o.fireLocal.apply(o,arguments)},e.addListener=e.on=function(){return o.addListener.apply(o,arguments)},e.removeListener=function(){return o.removeListener.apply(o,arguments)},e.removeAllListeners=function(){return o.removeAllListeners.apply(o,arguments)},e._eventEmitter=o,t){o.id=t;var n=i.globalEmitter||g.globalEmitter;o.globalEmitter=n,n.ids=n.ids||{},n.ids[t]=e}return o},g.getID=function(e){return e instanceof g?e.id:e._eventEmitter?e._eventEmitter.id:void 0},g.prototype.fireEventToID=function(e,t,i){if(i=i||{},this.ids&&this.ids.hasOwnProperty(e)){var n=this.ids[e];try{for(var a=[],r=0;r<t.length;r++)a.push(t[r]);"string"==typeof t[0]&&(t[0]={name:t[0]}),i.exceptTo&&(t[0].exceptTo=i.exceptTo),n.fire.apply(n,t)}catch(s){o("Caught error when handling event",s)}}},g.prototype.fire=function(e){var t,i=arguments.length-1,o=this.target||this;"string"==typeof e&&(e={name:e}),t=e.name;var n=this.globalEmitter||g.globalEmitter;if(this!==n&&!e.local&&!this.ids){for(var a=[],r=0;r<arguments.length;r++)a.push(arguments[r]);n.fire({name:"event",exceptTo:e.exceptTo},o,a)}if(this.events[t]){var s,c=[];for(s=0;s<this.events[t].length;s++)c.push(this.events[t][s]);for(s=0;s<c.length;s++){var l,p=c[s];if(!e.exceptTo||e.exceptTo!==p){switch(i){case 0:l=p.call(o);break;case 1:l=p.call(o,arguments[1]);break;case 2:l=p.call(o,arguments[1],arguments[2]);break;default:for(var d=[],m=0;i>m;m++)d[m]=arguments[m+1];try{l=p.apply(o,d)}catch(u){}}if(void 0!==l)return l}}}return void 0},g.prototype.fireLocal=function(e){for(var t=[{name:e,local:!0}],i=1;i<arguments.length;i++)t.push(arguments[i]);return this.fire.apply(this,t)},g.prototype.emit=g.prototype.fire,g.prototype.emitLocal=g.prototype.fireLocal,g.prototype.addListener=function(e,t){return this.events[e]=this.events[e]||[],this.events[e].push(t),this.target},g.prototype.on=g.prototype.addListener,g.prototype.removeListener=function(e,t){var i=this.events[e];if(i){for(var o=[],n=i.length-1;n>=0;n--){var a=i[n];a!==t&&o.push(a)}this.events[e]=o}return this.target},g.prototype.removeAllListeners=function(){return this.events={},this.target},y.prototype.queryPosition=function(e){return this.pam.queryPosition(e,{decoratedBy:this})},y.prototype.sendCpmviewClick=function(){var e=this;return e.pam.master?void(this.cpmviewClickSent||(this.loadEvent("CLICK",{c5:"cpmview"}),this.cpmviewClickSent=!0)):void(e.emit&&e.emit("send-cpmview-click"))},y.prototype.somethingHasBeenSeen=function(){var e=this;return e.pam.master?void("string"==typeof e.args.delayed_display&&"{}"!==e.args.delayed_display&&(window.pmBypassImpression||e.sentImpression||(e.pam.loadPixel(e.args.impression_pixel),e.sentImpression=!0))):void(e.emit&&e.emit("something-has-been-seen"))},y.prototype.purgeEventEmitter=function(){this.pam.eventEmitterForObject(this,this.uniqid,{purge:!0})},y.prototype.inject=function(e,t,i){"function"!=typeof t||i||(i=t,t={}),t.pixiPositionId||(t.pixiPositionId=m(e)),t.room&&(e="room."+t.room),void 0===t.future&&(t.future=!0),t.future&&(t.present=!0),this.rooms&&this.rooms[e]&&(i=this.makeHostRooms(i,this.rooms[e]));var o;if("string"==typeof e||s(e)){if("string"==typeof e){t.future&&this.injectFuture(e,t,i);var a=this.remapPositions||{};for(var r in a)if(a.hasOwnProperty(r)){var c=new RegExp("\\b"+r+"\\b","g");e=e.replace(c,a[r])}}o=_.piximedia.preview?this.pam.queryPositions("*"):this.positions,o=this.pam.queryPositions(e,{positions:o})}else"object"==typeof e&&(o=[e]);for(var l=0;l<o.length;l++){var p=o[l];p.decoratedBy&&p.decoratedBy!==this&&p.decoratedBy!==this.cgAd||!p.active||p.hosted||(n("Injecting contents into "+p.positionId),t.present&&!p.used&&(p.decoratedBy=this,p.decoratedAt=p.decoratedAt||new Date,p.used=!0,p.justUsed&&p.justUsed(),n("Taking position "+p.positionId),this.positions.push(p)),this.cgOptions&&!p.decoratedByCG&&(p.setDecoratedByCG(this),this.pam.master||p.emit("injected-into-creative-group",this.cgOptions)),p.pixiPositionId=t.pixiPositionId,this.pam.master||p.emit("injected-into-pixi-position-id",p.pixiPositionId||e),this.shouldHostPosition(p)?this.pam.hostPosition(this,p):this.injectPosition(p,t,i))}},y.prototype.injectFuture=function(e,t,i){"function"!=typeof t||i||(i=t,t={});var o=this,a=this.remapPositions||{};for(var r in a)if(a.hasOwnProperty(r)){var s=new RegExp("\\b"+r+"\\b","g");e=e.replace(s,a[r])}var c=function(e){n("Injecting contents into future "+e.positionId),e.decoratedBy=o,e.decoratedAt=e.decoratedAt||new Date,o.cgOptions&&e.setDecoratedByCG(o),e.pixiPositionId=t.pixiPositionId,o.shouldHostPosition(e)?o.pam.hostPosition(o,e):o.injectPosition(e,t,i)};if(this.on("hello",function(t){if(!o.disabled){var i={};i[t.positionId]=t;var a=o.pam.queryPositions(e,{positions:i,ignoreConditions:!0});if(a.length){var r=o.pam.queryPositions(e,{positions:i,conditionPositions:o.pam.positions});if(r.length)c(t);else{n("Found a position to inject that fails to meet its condition, waiting for future positions");var s=!1;o.pam.on("pre-hello",function(){if(!s){var n=o.pam.queryPositions(e,{positions:i,conditionPositions:o.pam.positions});n.length&&(s=!0,c(t))}})}return n("Grabbing position "+t.positionId),o.positions.push(t),t.decoratedAt=new Date,!0}}}),e.match(/=>/)){var l=function(){var t=o.pam.queryPosition(e,{positions:o.positions});t.length&&(o.pam.removeListener("position-has-been-decorated",l),c(t[0]))};o.pam.on("position-has-been-decorated",l)}},y.prototype.makeHostRooms=function(e,t){return function(i,n,a,r){try{e.apply(this,arguments)}catch(s){o("Could not execute callback: "+s)}for(var c=0;c<t.length;c++){var l=t[c];r.hostRoom(l.id,l)}}},y.prototype.makeInject=function(e,t){var i=this;return function(n,a){try{if(i.pam.log("Calling makeInject()"),!e.clickUrl&&e.positionId.match(/^room\./)&&e.pixiPositionId){var r=e.pixiPositionId,c=this.remapPositions||{};for(var l in c)if(c.hasOwnProperty(l)){var p=new RegExp("\\b"+l+"\\b","g");r=r.replace(p,c[l])}e.clickUrl=e.allClickUrls&&e.allClickUrls[r]||i.pam.positions[r]&&i.pam.positions[r].clickUrl,e.advertiserClickUrl=e.allAdvertiserClickUrls&&e.allAdvertiserClickUrls[r]||i.pam.positions[r]&&i.pam.positions[r].advertiserClickUrl}t.call(e,n,a,e,a.framedIframe);var d=(i.args||{})["position-css"];d&&i.pam.loadLibrary("sweetlib.js",function(){if(s(d))for(var e=0;e<d.length;e++)_.piximedia.SweetLib.createCSSs(d[e],n);else _.piximedia.SweetLib.createCSSs(d,n)})}catch(m){o("Could not inject position "+e.positionId+": "+m)}}},y.prototype.injectPosition=function(e,t,i){var o=this;i?t=t||{}:(i=t,t={}),o.pam.log("Injecting into "+e.positionId);var a=t.htmlComments,r="inject"+this.pam.rand();_.piximedia._[r]=this.makeInject(e,i);var s={name:"pmInject_"+e.positionId,javascript:"window.piximedia._."+r+"(document,window)"};a&&(s.htmlComments=a);for(var c in t)t.hasOwnProperty(c)&&(s[c]=t[c]);if(e.decoratedBy||(e.decoratedBy=this,e.decoratedAt=e.decoratedAt||new Date,n("Marking position not yet marked decorated by any ad"),this.positions.push(e)),this.cgOptions&&!e.decoratedByCG&&e.setDecoratedByCG(this),e.decoratedBy&&e.decoratedBy.masterPosition&&e.decoratedBy.iframe&&e.positionId===e.decoratedBy.masterPosition.positionId&&(e.decoratedBy.iframe.doNotSendPixels=!0),this.pam.master&&(e.injectionIndex=e.injectionIndex||0),!e.hosted&&!e.injectionIndex){e.loadEvent("JS:IMPRESSION",{detail:this.getPixiPositionIdForPositionId(e.positionId)});var l=o.campaignId,p=o.adId;if(o.pam.sendJSImpressionAdCampaign(l,p,e.positionId,this.getPixiPositionIdForPositionId(e.positionId)),e.decoratedAt){var d=Math.round((new Date-e.decoratedAt)/1e3);e.loadEvent("JS:DELAY:IMPRESSION",{detail:this.getPixiPositionIdForPositionId(e.positionId),duration:d})}}var m=function(){var t,i=function(){n("Position removed",e),o.pam.unloadPosition(e)},a=function(){n("Position winlost: "+e.positionId,e),e.injectionIndex++,t.unload({hide:!0}),t.removeListener("remove",i),t.removeListener("winlose",a);for(var o=!1,r=0;r<(e.iframes||[]).length;r++)if(e.iframes[r]===t){o=!0;break}o?(n("ZZZ Position still active, reloading"),m()):n("ZZZ Position no longer active")};t=o.pam.injectFriendlyContent(e,s,o).on("remove",i).on("winlose",a)};m()},y.prototype.getTrackedUrl=function(e,t,i){return i=i||{},i=JSON.parse(JSON.stringify(i)),i.detail&&(i.detail=m(i.detail)),!i.c1&&this.args&&this.args.c1&&(i.c1=this.args.c1.toString()),!i.c2&&this.args&&this.args.c2&&(i.c2=this.args.c2.toString()),!i.c3&&this.args&&this.args.c3&&(i.c3=this.args.c3.toString()),!i.c4&&this.args&&this.args.c4&&(i.c4=this.args.c4.toString()),!i.c5&&this.args&&this.args.c5&&(i.c5=this.args.c5.toString()),i.campaignIdAlliance=this.campaignId,i.adIdAlliance=this.adId,i.creativeIdAlliance=this.creativeId,this.pam.getTrackedUrl(e,t,i,this.ticketInfo)},y.prototype.loadEvent=function(e,t){t&&(t=JSON.parse(JSON.stringify(t)),t.detail&&(t.detail=m(t.detail))),!t.c1&&this.args&&this.args.c1&&(t.c1=this.args.c1.toString()),!t.c2&&this.args&&this.args.c2&&(t.c2=this.args.c2.toString()),!t.c3&&this.args&&this.args.c3&&(t.c3=this.args.c3.toString()),!t.c4&&this.args&&this.args.c4&&(t.c4=this.args.c4.toString()),!t.c5&&this.args&&this.args.c5&&(t.c5=this.args.c5.toString()),this.pam.loadEvent(e,{campaignIdAlliance:this.campaignId,adIdAlliance:this.adId,creativeIdAlliance:this.creativeId},this.ticketInfo,t),"AP_SOMETHINGHASBEENSEEN"===e&&this.somethingHasBeenSeen()},y.prototype.loadEventOnce=function(e,t,i){if(t=t||{},i=i||[],!this.pam.master)return this.emit("load-event-once",e,t,i);this.loadEventOnceSems=this.loadEventOnceSems||{};var o=[e,t.c1,t.c2,t.c3,t.c4,t.c5].join("|");if(!this.loadEventOnceSems.hasOwnProperty(o)){this.loadEventOnceSems[o]=!0,this.loadEvent(e,t);for(var n=0;n<i.length;n++)this.pam.loadPixel(i[n])}},y.prototype.getPixiPositionIdForPositionId=function(e){if(this.pam.positions&&this.pam.positions[e]&&this.pam.positions[e].pixiPositionId)return this.pam.positions[e].pixiPositionId;if(e.match(/^room\./))return e;var t=this.remapPositions||{},i={},o=e.split(".");o.length>1&&(e=o[0]),i[e]={positionId:e};var n=[];for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];this.pam.queryPositions(r,{positions:i}).length&&n.push(a)}return n.length?c(n,"mpu")>=0?"mpu":n[0]:e},y.prototype.queryAssets=function(e){var t=((this.args||{}).assets||{}).pool||[];return E.assetsMatchQuery(e,t)},b.prototype=new y({},{}),b.prototype.constructor=b,b.prototype.injectPosition=function(e,t){if(this.position.positionId===e.positionId&&this.pam.positionCurrentlyInline===e.positionId)try{t.call(e,this.framedDocument,this.framedWindow,e)}catch(i){o("Could not inject friendly position: "+e.positionId+": "+i)}else y.prototype.injectPosition.apply(this,arguments)},w.prototype=new y({},{}),w.prototype.constructor=w,x.prototype.registerResponsiveCallback=function(e){this.on("responsive",e),this.enableResponsiveEvents()},x.prototype.setMessageDuration=function(e){var t=this;return t.pam.master?void t.pam.loadLibrary("sweetlib.js",function i(){return t.iframe?void _.piximedia.SweetLib.bindViewTracker({object:t.iframe,threshold:50,duration:e},function(){t.position.loadEventWait("AP_CONSUMED");var e="isAnyConsumedForCampaign"+(t.position.decoratedBy||t.position.decoratedByCG||{}).campaignId;t.pam[e]||(t.pam[e]=!0,t.position.loadEventWait("AP_CONSUMED:CAMPAIGN"))}):setTimeout(i,500)}):t.emit("set-message-duration",e)},x.prototype.enableResponsiveEvents=function(){var e=this;return this.pam.master?void(this.responsiveEventsEnabled||(this.responsiveEventsEnabled=!0,this.pam.loadLibrary("sweetlib.js",function(){var t=_.piximedia.SweetLib,i=t.getPageContainer();t.enableResponsiveEventsForPageContainer(i,function(t){e.position.emit("responsive",t),e.emit("responsive",t)})}))):this.emit("enable-responsive-events")},x.prototype.hostRoom=function(e,t){if(t=t||{},!this.pam.master)return this.emit("host-room",e,t);var i=this;this.pam.hostRoom(e,{injectionIndex:this.position.injectionIndex},function(){var e=i.iframe,o=e.ownerDocument,n=o.createElement("div"),a=o.createElement("div");switch(n.className="pmRoomContainer",n.style.position="absolute",a.className="pmRoom",a.style.position="absolute",t.align||"center"){case"left":break;case"right":7===i.pam.msie&&(n.style.minWidth="100%"),n.style.width="100%",n.style.position="absolute",a.style.position="absolute",a.style.right=0;break;case"center":n.style.width="100%",7===i.pam.msie&&(n.style.minWidth="100%"),a.style.left="50%",a.className+=" pmCentered"}if(t.left&&(n.style.left=parseInt(t.left)+"px"),t.top&&(n.style.top=parseInt(t.top)+"px"),t.css)for(var r in t.css)if(t.css.hasOwnProperty(r))try{a.style[r]=t.css[r]}catch(s){}return n.appendChild(a),e.parentNode.insertBefore(n,e),a})},x.prototype.unload=function(e){var t=this;if(e=e||{},this.active=!1,i("Iframe.unload()"),this.iframe){if(this.pam.isInDOM(this.iframe))i("Iframe is still in DOM: "+this.iframe.id),e.hide?(this.iframe.style.display="none",i("Setting iframe display: none")):this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe);else{i("Iframe is no longer in DOM: "+this.iframe.id);var o=this.iframe.ownerDocument.getElementById(this.iframe.id);o?(i("Found winlost iframe in DOM: "+this.iframe.id),e.hide?(o.style.display="none",i("Setting iframe display: none")):o.parentNode&&o.parentNode.removeChild(o)):i("Winlost iframe not in DOM: "+this.iframe.id),e.hide?(this.iframe.style.display="none",i("Setting iframe display: none")):this.iframe.parentNode&&this.iframe.parentNode.removeChild(this.iframe)}if(this.moveTop&&this.pam.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;e.moveTopOfPageContainer(t.pageContainer,-t.moveTop)}),e.hide){var n=function(){var e=t.iframe.ownerDocument.getElementById(t.iframe.id);"none"!==e.style.display&&(i("Iframe must be hidden again: "+t.iframe.id),e.style.display="none")},a=setInterval(n,20);setTimeout(function(){clearInterval(a),setInterval(n,500)},1e4)}}else i("no known iframe")},x.prototype.setIframe=function(e){var t=this,o=e.id,a=e.ownerDocument;if(o||(o=e.id="pmAnonIframe"+this.pam.rand()),this.iframe=e,this.visibilityCallbackOnHold&&(this.emit("register-visibility-callback",this.visibilityCallbackOnHold),this.visibilityCallbackOnHold=void 0),t.pam.master&&(this.iframe.onmouseover=function(){t.emitLocal("mouseover")},this.iframe.onmouseout=function(){t.emitLocal("mouseout")},t.position&&t.position.decoratedBy&&t.position.decoratedBy.timetracker&&t.position.decoratedBy.timetracker.hover)){var r=t.position,s=t.position.decoratedBy,l=s.timetracker.hover,p=r.pixiPositionId||r.decoratedBy.getPixiPositionIdForPositionId(r.positionId);"string"==typeof l&&(l=l.split(/ +/)),c(l,p)>=0&&(this.on("mouseover",function(){r.startTimetrackerHover()}),this.on("mouseout",function(){r.stopTimetrackerHover()}))}var d=function(){t.active&&setTimeout(function(){var e=a.getElementById(o);return e?(n("Iframe has been winlost"),t.emitLocal("winlose"),void t.setIframe(e)):void(t.pam.winlostIframeIds[o]?(t.active=!1,n("Iframe has been removed by PAM because of a winlose"),t.emitLocal("winlose")):(n("Iframe has been removed"),t.emitLocal("remove")))},0)};(t.safari||t.chrome)&&e.addEventListener("DOMNodeRemovedFromDocument",function(){d()});var m=e.contentWindow,u=setInterval(function(){var n=a.getElementById(o),r=n?n.contentWindow:void 0;n!==e?(i("Iframe changed, is there a winlose?"),clearInterval(u),d()):t.active&&r!==m&&(i("Iframe content window has changed by an external JavaScript"),e.parentNode.innerHTML="<!--winlose-->"+e.parentNode.innerHTML+"<!--winlose-->")},50)},I.prototype.setDecoratedByCG=function(e){this.decoratedByCG=e;var t=this.eventQueue;this.eventQueue=[];for(var i=0;i<t.length;i++){var o=t[i];this.loadEvent(o.eventId,o.options)}},I.prototype.justUsed=function(){var e=this,t=e.positionId;if(e.pam&&e.pam.globalOptions&&e.pam.globalOptions.positionsUniqueOnPage&&c(e.pam.globalOptions.positionsUniqueOnPage,t)>=0)for(var i in window.piximedia._.pams)if(window.piximedia._.pams.hasOwnProperty(i)&&i.match(/^pam/)){var o=window.piximedia._.pams[i];o&&o.positions&&o.positions[t]&&(o.log("Registering this position "+t+" as being used"),o.positions[t].used=!0,o.positions[t].usedUniqueOnPage=!0)}if(e.pam.master&&!e.trackingPositionSent){e.trackingPositionSent=!0;var n=e.decoratedBy||{},a=function(t){if(t){"string"==typeof t&&e.pam.loadPixel(t);for(var i=0;i<t.length;i++)e.pam.loadPixel(t[i])}};n.args&&n.args["tracking.ad:impression"]&&n.args["tracking.ad:impression"].pixelUrl&&a(n.args["tracking.ad:impression"].pixelUrl),n.args&&n.args["tracking.creative:impression"]&&n.args["tracking.creative:impression"].pixelUrl&&a(n.args["tracking.creative:impression"].pixelUrl)}},I.prototype.getTrackedUrl=function(e,t,i){var o={};if(i)for(var n in i)i.hasOwnProperty(n)&&(o[n]=i[n]);return o.detail||(o.detail=this.pixiPositionId||(this.decoratedBy?this.decoratedBy.getPixiPositionIdForPositionId(this.positionId):void 0)),this.decoratedByCG&&this.decoratedByCG.getTrackedUrl?this.decoratedByCG.getTrackedUrl(e,t,o):this.decoratedBy&&this.decoratedBy.getTrackedUrl?this.decoratedBy.getTrackedUrl(e,t,o):this.pam.getTrackedUrl(e,t,o)},I.prototype.loadEvent=function(e,t){var i={};if(t)for(var o in t)t.hasOwnProperty(o)&&(i[o]=t[o]);i.detail||(i.detail=this.pixiPositionId||(this.decoratedBy?this.decoratedBy.getPixiPositionIdForPositionId(this.positionId):void 0)),this.decoratedByCG?this.decoratedByCG.loadEvent(e,i):this.decoratedBy?this.decoratedBy.loadEvent(e,i):this.pam.loadEvent(e,void 0,void 0,i)},I.prototype.loadEventOnce=function(e,t,i){if(t=t||{},i=i||[],!this.pam.master)return this.emit("load-event-once",e,t,i);this.loadEventOnceSems=this.loadEventOnceSems||{};var o=[e,t.c1,t.c2,t.c3,t.c4,t.c5].join("|");if(!this.loadEventOnceSems.hasOwnProperty(o)){this.loadEventOnceSems[o]=!0,this.loadEvent(e,t);for(var n=0;n<i.length;n++)this.pam.loadPixel(i[n])}},I.prototype.loadEventWait=function(e,t){return this.decoratedBy||o("Cannot use Position.loadEventWait() on positions not associated to an ad"),this.decoratedBy.is_creative_group?this.decoratedByCG?this.loadEvent(e,t):void this.eventQueue.push({eventId:e,options:t}):this.loadEvent(e,t)},I.prototype.startTimetrackerHover=function(){var e=this;if(!e.pam.master)return e.emit("start-timetracker-hover");if(!this.timetrackerHover){var t,i=0,o=0,n=function(){e.pam.loadLibrary("sweetlib.js",function(){i&&!o?t.pause():!i&&o&&(t?t.resume():(t=_.piximedia.SweetLib.setTimer("HOVER",function(t,i){e.loadEventWait("TIMETRACKER::"+t,{duration:i,detail:e.pixiPositionId||e.decoratedBy.getPixiPositionIdForPositionId(e.positionId)})}),t.start())),i=o})};this.timetrackerHover={start:function(){o++,n()},stop:function(){o--,n()}}}this.timetrackerHover.start()},I.prototype.stopTimetrackerHover=function(){return this.pam.master?void(this.timetrackerHover&&this.timetrackerHover.stop()):this.emit("start-timetracker-hover")},k.prototype.loadActivity=function(e){this.pam.loadActivityPixel(e)},k.prototype.loadAd=function(e){var t=this.getUrl(e);if(e.dw)try{S.write('<script type="text/javascript" src="'+t+'"></script>')}catch(i){}else e.defer&&"complete"!==S.readyState?this.deferObj(e):(_.pmIsAlreadyActive&&(e.use_pb=!0,t=this.getUrl(e)),this.pam.loadScript(t))},k.prototype.getUrl=function(e){var t="";return e.use_pb&&(t+=";pb=1"),this.pam.globalOptions.serialId&&(t+=";serial_id="+this.pam.globalOptions.serialId),"//"+M+"/ads_js/stage2.php?"+e.mode+"|"+e.site_id+"|"+e.placement_id+"|"+e.params+t+"|"+q.toString()+"|"+this.pam.rand()+"|click="+e.click},k.prototype.deferObj=function U(e){var t=this;this.deferredObjects.push(e),U.listening||(U.listening=!0,this.pam.waitDomLoaded(function(){t.loadDeferedObjects()}))},k.prototype.loadDeferedObjects=function(){if(!this.deferredObjectsLoaded){this.deferredObjectsLoaded=!0;for(var e=0;e<this.deferredObjects.length;e++)this.loadDeferedAd(this.deferredObjects[e])}},k.prototype.loadDeferedAd=function(e){_.pmIsAlreadyActive&&(e.use_pb=!0),_.pmIsAlreadyActive=!0;var t=this.getUrl(e);this.loadScript(t)},k.prototype.getClickCommand=function(){for(var e=0;e<this.pam.positions.length;e++){var t=this.pam.positions[e];if(t.clickUrl)return t.clickUrl}return this.pam.clickUrl},k.prototype.loadEvent=function(e,t){this.pam.loadEvent(e,t,this.ticketInfos)},k.prototype.loadEventWithPrefix=function(e,t){this.pam.loadEvent(e,t,this.ticketInfos,{prefixURI:this.getClickCommand()})},k.prototype.loadScript=function(e){try{var t=S.createElement("script");t.type="text/javascript",t.async="async",t.src=e,S.getElementsByTagName("head")[0].appendChild(t)}catch(i){}},k.prototype.setTicket=function(e,t){this.ticketInfos={ticket:e,signature:t}},E=P,P.prototype.runPixeldisTest=function(){var e=this.getTopmostWindow();if(this.master&&e===top&&!(Math.random()<.9)){var t;switch(Math.round(5*Math.random())+1){case 1:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/a.html";break;case 2:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/b.html";break;case 3:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/c.html";break;case 4:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/d.html";break;case 5:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/e.html";break;default:case 6:t="//d26ljjbiopow12.cloudfront.net/alliance/sandbox/pixeldis/f.html"}this.waitDomMutable(function(){var i=e.document.getElementsByTagName("head");if(1===i.length){var o=i[0],n=e.document.createElement("iframe");n.id="pixipixeldis",n.src=t,o.appendChild(n)}})}},P.prototype.sendJSImpressionAdCampaign=function(e,t,i,o){if(!this.master)return this.emit("js-impression-ad-campaign",e,t,i,o);var n=this.positions[i];e&&!this.campaignIdsWithImpressions[e]&&(this.campaignIdsWithImpressions[e]=e,n.loadEvent("JS:IMPRESSION:CAMPAIGN",{detail:o})),t&&!this.adIdsWithImpressions[t]&&(this.adIdsWithImpressions[t]=t,n.loadEvent("JS:IMPRESSION:AD",{detail:o}))},P.prototype.log=n,P.prototype.error=o,P.prototype.debug=i,P.prototype.loadPixel=function(e){if(e&&" "!==e&&"PIXEL_URL"!==e){var t=e.toString().match(/^([0-9.]+)%:(.*)/);if(t){var i=parseFloat(t[1],10)/100;if(this.globalOptions.loadPixelRandom>i)return;e=t[2]}p(e.replace(/%n|\[random_number\]|\[random\]|\[timestamp\]/gi,Math.round(1e16*Math.random()).toString()))}},P.prototype.eventEmitterForObject=function(e,t,i){var o={};if(i)for(var n in o)o.hasOwnProperty(n)&&(o[n]=i[n]);return o.globalEmitter=this.globalEmitter,g.forObject(e,t,o)},P.prototype.syncDocumentHasFocus=function(){var e=this;if(this.master){var t=e.getTopmostDocument();e.documentHasFocus=t.hasFocus(),setInterval(function(){var i=t.hasFocus();i!==e.documentHasFocus&&(e.documentHasFocus=i,e.emit("focus-change",i))},1e3)}else this.on("focus-change",function(t){e.documentHasFocus=t})},P.prototype.cleanupPixiRTAPosCookie=function(e){e=e||{};var t=_.piximedia.request_pos_sp[this.siteId][this.placementId],i=!1;for(var o in t)if(t.hasOwnProperty(o)){i=!0;break}i||"alliance"!==this.mode||(e.keepRTAPos||(S.cookie="pixi_rta_pos=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_rta_pos=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"),S.cookie="pixi_adr=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_adr=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",this.globalOptions.pixiAdrName&&(S.cookie=this.globalOptions.pixiAdrName+"=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie=this.globalOptions.pixiAdrName+"=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"))},P.prototype.getBirthdateCookie=function(){for(var e=S.cookie.split(/; */),t=/pixi_birthdate=(.*)/,i=e.length-1;i>=0;i--){var o=e[i].match(t);if(o&&o[1])return parseInt(o[1],10)}},P.prototype.getBirthdateLS=function(){try{if(_.localStorage&&_.localStorage.getItem)return parseInt(_.localStorage.getItem("pixi_birthdate"),10)||void 0}catch(e){}},P.prototype.exposePixiRTAPosCookie=function(e){e=e||{},e.expires||(e.expires=new Date((new Date).getTime()+1e3*F)),e.pixiRTAPosExpires||(e.pixiRTAPosExpires=new Date((new Date).getTime()+1e3*(this.globalOptions.pixiRTAPosExpires||F)));var t=[];for(var i in _.piximedia.request_pos)_.piximedia.request_pos.hasOwnProperty(i)&&t.push(i);if(S.cookie="pixi_rta_pos=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_rta_pos="+escape(t.join(";"))+"; path=/; "+this.getDomainPartForCookies()+(e.pixiRTAPosExpires?"; expires="+e.pixiRTAPosExpires.toUTCString():""),S.cookie="pixi_rta_v="+escape("1;"+(new Date).getTime())+"; path=/; "+this.getDomainPartForCookies()+(e.expires?"; expires="+e.expires.toUTCString():""),this.globalOptions.exposeRTAPosHelperJS){var n=this.getTopmostWindow();try{n.Function(["req_pos","window","document"],this.globalOptions.exposeRTAPosHelperJS).call(n,t,n,n.document)}catch(a){o("Could not execute RTA position helper: "+a)}}var r=+new Date,s=void 0!==this.getBirthdateCookie();s||(S.cookie="pixi_birthdate="+escape(r)+"; path=/; "+this.getDomainPartForCookies()+"; expires="+new Date((new Date).getTime()+31536e6).toUTCString());try{_.localStorage&&_.localStorage.getItem&&_.localStorage.setItem&&(_.localStorage.getItem("pixi_birthdate")||_.localStorage.setItem("pixi_birthdate",r))}catch(c){}},P.prototype.stringify=function(e){return void 0===e?"undefined":null===e?"null":"number"==typeof e?e:(e=e.toString(),'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"')},P.get=P.prototype.get=function(e,t,i){var o=e+"/"+t+":"+(i||"alliance");return(_.piximedia._.pams||{})[o]},P.prototype.loadActivityPixel=function(e,t){t=t||{};var i=_.piximedia._.contextBySP?_.piximedia._.contextBySP[this.siteId+"/"+this.placementId]:void 0;p("//"+M+"/activity/?|||advertiser_id="+e.advertiser_id+";page_id="+e.page_id+";activity_type="+e.activity_type+";sale_amount="+e.sale_amount+";sale_quantity="+e.sale_quantity+";sale_currency="+e.sale_currency+";customer_user_id="+e.customer_user_id+";http_secure="+_.location.protocol+";save_last_url="+(e.save_last_url?"true":"false")+";|"+i+"|"+this.rand()+"|")},P.prototype.getTrackedUrl=function(e,t,i,o){i=i||{};var n=(void 0===i.c1?"":i.c1.toString()).replace(/;/g,","),a=(void 0===i.c2?"":i.c2.toString()).replace(/;/g,","),r=(void 0===i.c3?"":i.c3.toString()).replace(/;/g,","),s=(void 0===i.c4?"":i.c4.toString()).replace(/;/g,","),c=(void 0===i.c5?"":i.c5.toString()).replace(/;/g,","),l=(this.globalOptions.l_id?this.globalOptions.l_id.toString():"").replace(/;/g,","),p=void 0===i.firstOnAd?"":i.firstOnAd?1:0,d=void 0===i.firstOnUnit?"":i.firstOnUnit?1:0,m=void 0===i.duration?"":i.duration.toString(),u=void 0===i.fail_reason?"":i.fail_reason.toString(),h=void 0===i.detail?"":i.detail.toString(),f=";c1="+n+";c2="+a+";c3="+r+";c4="+s+";c5="+c+";l_id="+l+";duration="+m+";first_on_ad="+p+";first_on_unit="+d+";detail="+h+";error="+u;i.campaignIdAlliance&&(f+=";campaign_id="+i.campaignIdAlliance),i.adIdAlliance&&(f+=";ad_id="+i.adIdAlliance),i.creativeIdAlliance&&(f+=";creative_id="+i.creativeIdAlliance);var v=_.piximedia._.contextBySP?_.piximedia._.contextBySP[this.siteId+"/"+this.placementId]:void 0;return v||(v=q.toString(),_.piximedia._.contextBySP=_.piximedia._.contextBySP||{},_.piximedia._.contextBySP[this.siteId+"/"+this.placementId]=v),(this.globalOptions.protocol||"http")+"://"+M+"/event/?P|"+this.siteId+"|"+this.placementId+"|event="+e+f+(o?";ticket="+o.ticket+";signature="+o.signature:"")+"|"+v+"|"+this.rand()+"|click="+t},P.prototype.loadEvent=function(e,t,i,n){switch(n=n||{},e){case"IMPRESSION":case"CLICK":break;default:if(this.numberOfEventsSent[e]=(this.numberOfEventsSent[e]||0)+1,this.numberOfEventsSent[e]>=50){if(50!==this.numberOfEventsSent[e])return;n.detail=(n.detail||"").toString()+":"+e,e="TOO_MANY_EVENTS"}}!t||i&&i.ticket&&i.signature||n.noTicket||this.globalOptions.noTicket||!this.mode.match(/^alliance/)||o("Required ticketInfos");var a,r=_.piximedia._.contextBySP?_.piximedia._.contextBySP[this.siteId+"/"+this.placementId]:void 0;if(r||(r=q.toString(),_.piximedia._.contextBySP=_.piximedia._.contextBySP||{},_.piximedia._.contextBySP[this.siteId+"/"+this.placementId]=r),t&&t.params)a=";"+t.params;else{var s=(void 0===n.c1?"":n.c1.toString()).replace(/;/g,","),c=(void 0===n.c2?"":n.c2.toString()).replace(/;/g,","),l=(void 0===n.c3?"":n.c3.toString()).replace(/;/g,","),d=(void 0===n.c4?"":n.c4.toString()).replace(/;/g,","),m=(void 0===n.c5?"":n.c5.toString()).replace(/;/g,","),u=(void 0===this.globalOptions.l_id?"":this.globalOptions.l_id.toString()).replace(/;/g,","),h=void 0===n.firstOnAd?"":n.firstOnAd?1:0,f=void 0===n.firstOnUnit?"":n.firstOnUnit?1:0,v=void 0===n.duration?"":n.duration.toString(),g=void 0===n.fail_reason?"":n.fail_reason.toString(),y=void 0===n.detail?"":n.detail.toString();a=";c1="+s+";c2="+c+";c3="+l+";c4="+d+";c5="+m+";l_id="+u+";duration="+v+";first_on_ad="+h+";first_on_unit="+f+";detail="+y+";error="+g,t&&(a+=";campaign_id="+t.campaignIdAlliance+";ad_id="+t.adIdAlliance+";creative_id="+t.creativeIdAlliance)}this.globalOptions.serialId&&(a+=";serial_id="+this.globalOptions.serialId);var b;if(n.prefixURI)b=!1;else switch(e){case"IMPRESSION":case"CLICK":case"AP_NAVIGATION":case"AP_NAV_10":case"AP_NAV_30":b=!1;break;default:b=!1}if(b){var w=this,x=a+(i?";ticket="+i.ticket+";signature="+i.signature:"");this.pixelQueue[x]=this.pixelQueue[x]||[],this.pixelQueue[x].push(e),this.pixelQueueTimer||(this.pixelQueueTimer=setTimeout(function(){w.pixelQueueTimer=void 0;var e=w.pixelQueue;w.pixelQueue=[];for(var t in e)e.hasOwnProperty(t)&&p("//"+M+"/eventq/?P|"+w.siteId+"|"+w.placementId+"|eventq="+e[t].join(",")+t+"|"+r+"|"+w.rand()+"|")},1500))}else p((n.prefixURI||"")+"//"+M+"/event/?P|"+this.siteId+"|"+this.placementId+"|event="+e+a+(i?";ticket="+i.ticket+";signature="+i.signature:"")+"|"+r+"|"+this.rand()+"|");switch(e){case"CLICK":case"AP_NAVIGATION":case"AP_NAV_10":case"AP_NAV_30":p("//"+M+"/profile/location.php?e="+e+"&p="+escape(a))}switch(e){case"JS:POSITION_USED":var I=(n.detail||"").toString(),k=Math.random()<L;if(I){var P=this.mode+"/"+this.siteId+"/"+this.placementId+"/"+I,A=this.getTopmostWindow();if(A.pmTimePositions&&A.pmTimePositions[P]){var O=A.pmTimePositions[P];
if(O.events=O.events||{},!O.events[e]){O.events[e]=!0;var S,T=Math.round((new Date-O.date)/1e3);if(T>=0&&120>T){switch(e){case"JS:POSITION_USED":S="JS:DELAY:POSITION_USED"}var E=q.getData();if(k&&this.loadEvent(S,t,i,{detail:I,duration:T,c1:E.browser_name,c2:E.browser_major_version}),"JS:POSITION_USED"===e&&A.performance&&A.performance.timing&&A.performance.timing.responseStart){var C=new Date(A.performance.timing.responseStart);T=Math.round((O.date-C)/1e3),T>=0&&120>T&&k&&this.loadEvent("JS:DELAY:POSITION",t,i,{detail:I,duration:T,c1:E.browser_name,c2:E.browser_major_version})}}}}}}},P.prototype.getDomainPartForCookies=function W(){if(W.cache)return W.cache;try{var e=this.getDocumentAndWindowInfos().window;switch(e.location.protocol){case"http:":case"https:":return W.cache="domain=."+e.location.hostname.split(".").slice(-2).join(".")+"; "}}catch(t){}return""},P.prototype.getTopmostWindow=function(){return this.getDocumentAndWindowInfos().window},P.prototype.watchForRemoval=function(e,t){var i=this;if(this.safari||this.chrome)e.addEventListener("DOMNodeRemovedFromDocument",t);else var o=setInterval(function(){return i.isInDOM(e)?void 0:(clearInterval(o),t())},500)},P.prototype.isInDOM=function(e){try{for(var t=e,i=0;100>i;i++,t=t.parentNode){if(!t.parentNode)return!1;if("HTML"===t.parentNode.tagName)return!0}}catch(t){return!1}},P.prototype.isInHead=function(e){for(var t=e,i=0;100>i;i++,t=t.parentNode){if(!t.parentNode)return!1;if("HEAD"===t.parentNode.tagName)return!0;if("HTML"===t.parentNode.tagName)return!1}},P.prototype.getTopmostDocument=function(){return this.getDocumentAndWindowInfos().document},P.prototype.loadLibraries=function(e,t){var i=this,o=function(){try{return t.call(i)}catch(e){return void n("Caught exception when calling loadLibraries() callback: "+e)}},a=e.length;if(!a)return o();for(var r=function(){return--a?void 0:o()},s=0;s<e.length;s++)this.loadLibrary(e[s],r)},P.prototype.getPmLoaderDoc=function(){var e,t=this.getTopmostDocument();if(this.msie&&this.msie<8)e=t;else{var i=t.getElementById("pmFiFLoader");if(!i){var o,n=t.getElementsByTagName("head")[0];i=t.createElement("iframe"),i.id="pmFiFLoader";var a=t.createElement("iframe"),r=t.createElement("iframe");a.id="pmFiFLoader_protect_before",r.id="pmFiFLoader_protect_after",a.className="this_should_be_empty web_designer",r.className="this_should_be_empty web_designer",n.appendChild(a),n.appendChild(i),n.appendChild(r);try{o=i.contentWindow,e=i.contentDocument||i.contentWindow.document}catch(s){var c=this.getTopmostDocument();try{i.src="javascript:document.write('<head><script>document.domain=\""+c.domain+"\";</script></head><body></body>')",e=i.contentDocument||i.contentWindow.document,o=i.contentWindow}catch(s){i.src="javascript:document.write('<head><script>document.domain=\""+i.ownerDocument.domain+"\";</script></head><body></body>')",e=i.contentDocument||i.contentWindow.document,o=i.contentWindow}}e.write("<html><head></head><body><script>setTimeout(function(){document.close();},0);</script></body></html>"),i.contentWindow._piximediaIsFiFLoader=!0}i.contentWindow.piximedia=i.contentWindow.piximedia||_.piximedia,e=i.contentDocument||i.contentWindow.document}return e},P.prototype.loadLibrary=function(e,t){if(s(e))return this.loadLibraries(e,t);var i,o=this,a=function(){try{return t.call(o)}catch(i){return void n("Caught exception when calling loadLibrary() callback for "+e+": "+i)}},r=_.piximedia.libraryLoader=_.piximedia.libraryLoader||{};if(r.hasOwnProperty(e))i=r[e],i.loaded?a():i.callbacks.push(a);else{var c=this.globalOptions.libs[e];c||(c="//"+j+"/lib/"+e+(B?"/debug":"")),i=r[e]={callbacks:[a]};var l=this.getPmLoaderDoc(),p=l.createElement("script");p.src=c;var d,m,u=function(){if(!i.loaded){i.loaded=!0;for(var t=i.callbacks,a=0;a<t.length;a++)t[a]();var s=setInterval(function(){if(!o.isInDOM(p)){var t=q.getData();o.loadEvent("PANIC",void 0,void 0,{fail_reason:"loader_winlost",c1:t.browser_name}),n("No longer in DOM: "+e),i.loaded=!1,delete r[e],clearInterval(s),o.loadLibrary(e,function(){n("Back in DOM: "+e)})}},50)}},h=function(){i.complete&&u()},f=function(){i.complete&&(m.clearInterval(d),u())};i.onloads=i.onloads||[],i.onloads.push(f);var v=function(){var e=l.getElementsByTagName("head")[0];if(e){e.appendChild(p);var t=o.getTopmostWindow();m=t,d=m.setInterval(f,50)}else _.setTimeout(v,50)};p.addEventListener?p.addEventListener("load",h,!1):p.readyState&&(p.onreadystatechange=h),v()}},P.prototype.loadCSSs=function(e,t){var i=this,o=function(){try{return t.call(i)}catch(e){return void n("Caught exception when calling loadCSSs() callback: "+e)}},a=e.length;if(!a)return o();for(var r=function(){return--a?void 0:o()},s=0;s<e.length;s++)this.loadCSS(e[s],r)},P.prototype.loadCSS=function(e,t){if(s(e))return this.loadCSSs(e,t);var i,o=this,a=function(){if(t)try{return t.call(o)}catch(i){return void n("Caught exception when calling loadLibrary() callback for "+e+": "+i)}},r=_.piximedia.cssLoader=_.piximedia.cssLoader||{};if(r.hasOwnProperty(e))i=r[e],i.loaded?a():i.callbacks.push(a);else{var c=this.globalOptions.css[e];if(!c)throw new Error("Unknown CSS: "+e);i=r[e]={callbacks:[a]};var l=this.getPmLoaderDoc(),p=l.createElement("script");p.src=c;var d=function(){if(!i.loaded){i.loaded=!0;for(var e=i.callbacks,t=0;t<e.length;t++)e[t]()}},m=function(){i.complete&&d()};i.onloads=i.onloads||[];var u,h,f=function(){i.complete&&(h.clearInterval(u),d())};i.onloads.push(f);var v=function(){var e=l.getElementsByTagName("head")[0];if(e){e.appendChild(p);var t=o.getTopmostWindow();h=t,u=h.setInterval(f,50)}else _.setTimeout(v,50)};p.addEventListener?p.addEventListener("load",m,!1):p.readyState&&(p.onreadystatechange=m),v()}},P.prototype.getDocumentAndWindowInfos=function H(){if(H._cache)return H._cache;var e,t={};if(!t.window)try{e=_.parent.parent.parent.document,e._piximediaiframetest=!0,t.window=_.parent.parent.parent.window}catch(i){}if(!t.window)try{e=_.parent.parent.document,e._piximediaiframetest=!0,t.window=_.parent.parent.window}catch(i){}if(!t.window)try{e=_.parent.document,e._piximediaiframetest=!0,t.window=_.parent.window}catch(i){}if(t.window||(t.window=window),!t.document)try{e=_.parent.parent.parent.document,e._piximediaiframetest=!0,t.document=e}catch(i){}if(!t.document)try{e=_.parent.parent.document,e._piximediaiframetest=!0,t.document=e}catch(i){}if(!t.document)try{e=_.parent.document,e._piximediaiframetest=!0,t.document=e}catch(i){}return t.document||(t.document=document),(!this.msie||this.msie>8)&&(H._cache=t),t},P.prototype.hello=function(e){var t=this;if(!e.implicit&&this.master)switch(this.globalOptions.autoFacetPosition){case"shuffle":case"sequence":var a=this.facets[this.currentFacetIndex++];this.currentFacetIndex>=this.facets.length&&(this.currentFacetIndex=0),e.positionId+="."+a;break;case"device":e.positionId+="."+t.globalOptions.device}if(t.globalOptions.addFacets&&(e.positionId+="."+t.globalOptions.addFacets.join(".")),i(e.positionId?'hello({positionId:"'+e.positionId+'"})':"hello()"),e||o("Missing options"),this.globalOptions.positionsUniqueOnPage&&c(this.globalOptions.positionsUniqueOnPage,e.positionId)>=0)for(var r in window.piximedia._.pams)if(window.piximedia._.pams.hasOwnProperty(r)&&r.match(/^pam/)){var s=window.piximedia._.pams[r];if(s&&s.positions&&s.positions[e.positionId]&&s.positions[e.positionId].used)return n("Cannot register "+e.positionId+" because another PAM has a used footer"),void this.loadEvent("PANIC",void 0,void 0,{fail_reason:"registered_multiple_"+e.positionId})}if(e.implicit){if(this.master){var l=function(e){if(e){"string"==typeof e&&t.loadPixel(e);for(var i=0;i<e.length;i++)t.loadPixel(e[i])}},d={};d[e.positionId]={positionId:e.positionId};for(var m in t.globalOptions.positionArgs||{})if(t.globalOptions.positionArgs.hasOwnProperty(m)&&t.queryPosition(m,{positions:d}).length){var u=t.globalOptions.positionArgs[m],h=u["tracking.position"],f=u["tracking.placement"];h&&(l(h.pixelUrl),e.advertiserClickUrl=((h["tracking.position"]||{}).clickUrl||[])[0]||e.advertiserClickUrl);var v=t.globalOptions.l_id||"";p("//"+M+"/event/?P|"+t.siteId+"|"+t.placementId+"|event=JS:POSITION:IMPLICIT;l_id="+v+";detail="+e.positionId+"||"+Math.random()+"|");try{var y=t.getTopmostWindow(),b=t.mode+"/"+t.siteId+"/"+t.placementId;y._piximedia=y._piximedia||{},y._piximedia.pixelSPSent=y._piximedia.pixelSPSent||{},y._piximedia.pixelSPSent[b]||(y._piximedia.pixelSPSent[b]=!0,f&&l(f.pixelUrl),p("//"+M+"/event/?P|"+t.siteId+"|"+t.placementId+"|event=JS:PLACEMENT;l_id="+v+";detail="+e.positionId+"||"+Math.random()+"|"))}catch(w){}break}}}else this.numberOfExplicitPositions++;if(this.mode.match(/^alliance/)&&!this.globalOptions.inline&&!this.globalOptions.enableRTA&&!this.globalOptions.legacyPosition)switch(e.positionId){case"default":case"footer":break;default:this.loadEvent("PANIC",void 0,void 0,{fail_reason:"registered_position_"+e.positionId+"_without_RTA_support"})}if(e.masterPositionId){var x=this.positions[e.masterPositionId];x&&(e.clickUrl||(e.clickUrl=x.clickUrl),e.advertiserClickUrl||(e.advertiserClickUrl=x.advertiserClickUrl))}if(!e.virtual&&this.globalOptions.virtualPositions&&this.globalOptions.virtualPositions.hasOwnProperty(e.positionId)&&(e.virtual=this.globalOptions.virtualPositions[e.positionId]),e.document,e.document&&!e.id&&!e.virtual)if(e.id="pixiMarker"+Math.round(1e16*Math.random()),e.element){var k=e.element.ownerDocument,P=k.createElement("div");P||o("markerDiv is not as real as expected: "+JSON.stringify(P)),P.id=e.id,this.isInHead(e.element)||!t.isInDOM(e.element)?(e.element.ownerDocument.body||e.element.ownerDocument.write("<body>"),e.element.ownerDocument.body.appendChild(P)):e.element.parentNode.insertBefore(P,e.element)}else e.document.write('<div style="display:none" id="'+e.id+'"></div>');var A,O=e.positionId;if(e.implicit||(t.explicitlyRegisteredPositionIds[O]=!0),this.positions.hasOwnProperty(O))for(var S=2;;S++)if(!this.positions.hasOwnProperty(O+"."+S)){O=O+"."+S,A=S;break}switch((e.virtual||{}).type){case"immediate":if(!e.implicit&&t.master)return n("Virtual position cannot be explicit: "+O),t.loadEvent("PANIC",void 0,void 0,{detail:O,fail_reason:"virtual_immediate_cannot_be_explicit"}),void setTimeout(function(){t.registerVirtualPositions()},0);break;case"override":if(A)return n("Virtual override cannot be multiple: "+O),void t.loadEvent("PANIC",void 0,void 0,{detail:O,fail_reason:"virtual_override_cannot_be_multiple"})}i("Registering position "+O+" on "+(this.master?"master pam":"hosted pam"));var T=new Date;this.firstPositionRegisteredAt||(this.firstPositionRegisteredAt=T);var E=this.positions[O]=new I(this,{positionId:O,registeredAt:T,active:!0,id:e.id,clickUrl:t.globalOptions.disablePublisherCC?"":e.clickUrl||this.clickUrl||"",advertiserClickUrl:e.advertiserClickUrl,document:e.document,window:e.window,implicit:e.implicit,virtual:e.virtual,injectionIndex:e.injectionIndex,pageContainerWidth:e.pageContainerWidth,decoratedAt:e.decoratedAt?new Date(e.decoratedAt):void 0,allAdvertiserClickUrls:e.allAdvertiserClickUrls,allClickUrls:e.allClickUrls,alwaysHosted:e.alwaysHosted,inlineScript:e.inlineScript,dynamicArgs:e.dynamicArgs});if(e.alwaysHosted&&(this.somePositionsAreAlwaysHosted=!0),g.forObject(E),e.window&&!e.window.piximedia&&(e.window.piximedia=_.piximedia),void 0!==e.implicit&&(E.implicit=e.implicit),"footer"!==O&&this.globalOptions.enableFooter&&this.positions.footer&&!this.positions.footer.clickUrl&&e.clickUrl&&!t.globalOptions.disablePublisherCC&&(this.positions.footer.clickUrl=e.clickUrl),e.ajax||(this.positionCurrentlyInline=O),e.last&&this.stopWaitingForOtherPositions(),E.implicit||t.registerVirtualPositions(),this.emitLocal("pre-hello",E),e.activateAds!==!1){var C,N=!1,D={};D[O]=E;for(var j=0;j<this.availableAds.length;j++){var B=this.availableAds[j];if(B.active){if(B.require&&B.require.positions&&this.queryPositions(B.require.positions,{positions:D,notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0}).length){N=!0,C=B;break}if(B.use&&B.use.positions&&this.queryPositions(B.use.positions,{conditionPositions:this.positions,positions:D,notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0}).length){N=!0,C=B;break}}else if(B.require&&B.require.positions){if(this.queryPositions(B.require.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0}).length){if(this.queryPositions(B.require.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,requireAll:!0}).length){N=!0,C=B;break}if(!this.performedRendezVous){N=!0,this.scheduleRendezVous();break}}else if(B.use&&B.use.positions&&this.queryPositions(B.use.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0}).length&&!this.performedRendezVous){N=!0,this.scheduleRendezVous();break}}else if(B.use&&B.use.positions){var F=!!this.queryPositions(B.use.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0,onlyActive:!0}).length;if(F){N=!0,C=B;break}}}if(N&&C)if(C.passback||this.numberOfExplicitPositions||this.globalOptions.allowActiveAdsWithNoExplicitPositions)if(C.active&&!C.disabled){if(C.active){E.requested=!0,E.requestedBy=C;var L=C.emitLocal("hello",E);E.used=!0,E.justUsed&&E.justUsed(),E.decoratedBy=C,!E.implicit&&this.mode.match(/^alliance/)&&E.loadEvent("JS:POSITION_USED",{detail:O}),L||(n("Pushing position "+E.positionId),C.positions.push(E))}}else this.activateAd(C);else this.performedRendezVous||this.scheduleRendezVous();if(t.globalOptions.reportPositionWithNoAds&&!E.implicit){var R,q,U,W=t.availableAds.length,H="",V=0;for(var J in t.positions)if(t.positions.hasOwnProperty(J)){var z=t.positions[J];if(H+=J+(z.used?".USED,":".NOTUSED,"),++V>4)break}if(t.availableAds.length){var G=t.availableAds[0];R=((G.require||{}).positions||[])[0],q=((G.use||{}).positions||[])[0],U="active="+(G.active?1:0)+","}var X=setInterval(function(){(!t.scheduledRendezVous||t.performedRendezVous)&&(clearInterval(X),(!E.used||E.decoratedBy&&E.decoratedBy.passback)&&t.loadEvent("JS:NO_ADS",void 0,void 0,{detail:E.positionId,c1:W,c2:R,c3:q,c4:U,c5:H}))},500)}}return this.positionCurrentlyInline=void 0,this.decorativeAds.length&&E.id&&(i("schedule rendez-vous because of decorative ads"),this.scheduleRendezVous()),this.emitLocal("post-hello",E),this.master&&E.positionId.match(/^1x1\b/)&&this.globalOptions.enableImplicitTakeover&&!this.registeredImplicitTakeover&&(this.registeredImplicitTakeover=!0,setTimeout(function(){t.hello({implicit:!0,ajax:!0,positionId:"takeover",advertiserClickUrl:E.advertiserClickUrl,clickUrl:E.clickUrl})},0)),this.master&&setTimeout(function(){E.used||E.sentBlank||E.implicit||(E.sentBlank=!0,t.loadEvent("JS:BLANK",void 0,void 0,{detail:E.positionId}),t.globalOptions.reportPositionWithNoAds&&t.loadEvent("JS:BLANK:UNEXPECTED",void 0,void 0,{detail:E.positionId}))},1e4),E},P.prototype.registerVirtualPositions=function(){var e=this;if(e.globalOptions.virtualPositions){var t,o=e.getTopmostDocument(),n=e.getTopmostWindow(),a=!1;for(var r in e.positions)if(e.positions.hasOwnProperty(r)){var s=e.positions[r];if(!s.implicit&&s.clickUrl){t=s.clickUrl;break}}var c=[];for(var l in e.globalOptions.virtualPositions)if(e.globalOptions.virtualPositions.hasOwnProperty(l)){if(e.positions.hasOwnProperty(l))continue;var p=e.globalOptions.virtualPositions[l];if(p.prerequisite&&!(e.queryPositions(p.prerequisite)||[]).length)continue;"override"!==p.type&&(p.immediate||"immediate"===p.type||e.performedRendezVous||p.prerequisite?(i("Registering virtual position"),c.push({siteId:e.siteId,placementId:e.placementId,positionId:l,clickUrl:t,document:o,window:n,id:null,ajax:!0,implicit:!0,virtual:p,advertiserClickUrl:((p["tracking.position"]||{}).clickUrl||[])[0]})):a=!0)}if(1===c.length)e.hello(c[0]);else if(c.length>1){for(var d=0;d<c.length;d++){var m=c[d];m.activateAds=!1,e.hello(m)}e.tryAndActivateAds()}a&&(i("Scheduling rendez-vous for non-immediate virtual position"),e.scheduleRendezVous())}},P.prototype.tryAndActivateAds=function(e){i("try and activate ads");var t=this;e=e||{};for(var o=[],n=function(e){return function(){e.passback||t.numberOfExplicitPositions||t.globalOptions.allowActiveAdsWithNoExplicitPositions?t.activateAd(e):t.performedRendezVous||t.scheduleRendezVous()}},a=0;a<this.availableAds.length;a++){var r=this.availableAds[a];if(!r.active){var s=n(r);if(r.require&&r.require.positions){var c=!!this.queryPositions(r.require.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0}).length;if(c){var l=!!this.queryPositions(r.require.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,requireAll:!0}).length;l?s():this.performedRendezVous||(o.push(r),this.scheduleRendezVous())}}else if(r.use&&r.use.positions&&r.use.positions.length&&!e.onlyConsiderRequires){var p=this.queryPositions(r.use.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,spaceIsOr:!0,onlyActive:!0});if(p.length){var d=!1;e:for(var m=0;m<o.length;m++){var u=o[m],h=!1,f=!1;if(u.require&&u.require.positions&&(h=!!this.queryPositions(u.require.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,seekOverlapWith:p}).length),u.use&&u.use.positions&&(f=!!this.queryPositions(u.use.positions,{notRequestedByActiveAd:!0,activeAndNotUsed:!0,seekOverlapWith:p}).length),h||f){d=!0;break e}}d||s()}}}}if(!this.scheduledRendezVous||this.performedRendezVous){var v=function(e){setTimeout(function(){e.used||e.sentBlank||e.implicit||(e.sentBlank=!0,t.loadEvent("JS:BLANK",void 0,void 0,{detail:e.positionId}),t.globalOptions.reportPositionWithNoAds&&t.loadEvent("JS:BLANK:UNEXPECTED",void 0,void 0,{detail:e.positionId}))},1e4)};for(var g in this.positions)this.positions.hasOwnProperty(g)&&v(this.positions[g])}},P.prototype.scheduleRendezVous=function(){var e=this;this.scheduledRendezVous||(i("Schedule rendez-vous"),this.scheduledRendezVous=!0,this.globalOptions.rendezvous_fast_duration&&(this.timeoutRendezVousFast=setTimeout(function(){i("Rendez-vous fast!"),e.tryAndActivateAds(),e.on("post-hello",function(){e.performedRendezVous||setTimeout(function(){e.tryAndActivateAds()},0)})},this.globalOptions.rendezvous_fast_duration)),this.timeoutRendezVous=setTimeout(function(){e.timeoutRendezVous=void 0,this.timeoutRendezVousFast&&(clearTimeout(this.timeoutRendezVousFast),this.timeoutRendezVousFast=void 0),i("Rendez-vous!"),e.performedRendezVous=!0,e.registerVirtualPositions(),e.tryAndActivateAds(),setTimeout(function(){e.sendStatistics()},2e3)},this.globalOptions.rendezvous_duration||N))},P.prototype.sendStatistics=function(){if(!this.sentStatistics&&(this.sentStatistics=!0,this.mode.match(/^alliance/)&&this.master&&!_.piximedia.preview)){for(var e=(this.globalOptions.context||{}).alliance_rtapos?",had_rta_pos":",no_rta_pos",t=h(this.explicitlyRegisteredPositionIds).length,i=h(this.explicitlyRegisteredPositionIds).sort().slice(0,10),o=h(this.positions).sort().slice(0,10),n=[],a=[],r=0;r<i.length;r++){var s=i[r].replace(/\.[0-9]+/,"");-1===c(n,s)&&n.push(s)}n=n.join(",");for(var l=0;l<o.length;l++){var p=o[l].replace(/\.[0-9]+/,"");-1===c(a,p)&&a.push(p)}a=this.numberOfExplicitPositions||this.globalOptions.allowActiveAdsWithNoExplicitPositions?a.join(","):"";var d=this.numberOfActiveAds||0;d>=3&&(d="3MORE");var m=this.realAds.length;if(m>=10?m="10MORE":m>=5?m="5-10":m>0&&(m="1-4"),this.loadEvent("JS:STATS",void 0,void 0,{c1:d||0,c2:m,c3:e,c4:n,c5:a,duration:t}),!this.numberOfActiveAds)for(var u=0;u<this.allAvailableAds.length;u++){var f=this.allAvailableAds[u];if(!f.passback&&f.args&&f.args.not_enough_pos_pixel){this.loadPixel(f.args.not_enough_pos_pixel);break}}}},P.prototype.stopWaitingForOtherPositions=function(){i("We no longer expect other positions"),this.timeoutRendezVousFast&&(clearTimeout(this.timeoutRendezVousFast),this.timeoutRendezVousFast=void 0),this.timeoutRendezVous&&(clearTimeout(this.timeoutRendezVous),this.timeoutRendezVous=void 0),this.scheduledRendezVous=!0,this.performedRendezVous=!0},P.prototype.queryPositions=function(e,t){"string"==typeof e&&(e=[e]),t=t||{};for(var i=[],o=0;o<e.length;o++){var n=this.queryPosition(e[o],t);if(t.requireAll&&!n.length)return[];if(t.seekOverlapWith)for(var a=0;a<n.length;a++)-1===c(i,n[a])&&-1!==c(t.seekOverlapWith,n[a])&&i.push(n[a]);else for(var r=0;r<n.length;r++)-1===c(i,n[r])&&i.push(n[r])}if(t.onlyActive){for(var s=[],l=0;l<i.length;l++)i[l].active&&s.push(i[l]);i=s}return i},P.prototype.parseRequestedPositions=function(e){s(e)||(e=[e]);for(var t=[],i=0;i<e.length;i++)for(var o=e[i].split(","),n=0;n<o.length;n++)for(var a=o[n],r=a.split(" "),l=0;l<r.length;l++){var p=r[l];if(p){var d=p.split(":"),m=d[0];-1===c(t,m)&&t.push(m)}}return t},P.prototype.queryPosition=function(e,t){if("string"!=typeof e)return this.queryPositions(e);var i,o=e.split(/ *=> */);if(o&&o.length>=2){for(var n=0;n<o.length-1;n++){var a=o[n];if(!t.ignoreConditions&&!this.queryPosition(a,{positions:t.conditionPositions||t.positions||this.positions}).length)return[]}i=o[o.length-1]}else i=e.replace(/, +/g,",");t=t||{};var r=t.positions||this.positions,s=i.split(" "),l=[];e:for(var p=0;p<s.length;p++){var d=s[p];if(d){for(var m=d.split(","),u=[],h=0;h<m.length;h++){var f=m[h];if(f)for(var v=O(f,t,r,this.globalOptions.isRedirect),g=0;g<v.length;g++)u.push(v[g])}if(!u.length&&!t.seekOverlapWith&&!t.spaceIsOr){l=[];break e}for(var y=0;y<u.length;y++)l.push(u[y])}}var b=[];if(t.seekOverlapWith)for(var w=0;w<l.length;w++)-1===c(b,l[w])&&-1!==c(t.seekOverlapWith,l[w])&&b.push(l[w]);else for(var x=0;x<l.length;x++)-1===c(b,l[x])&&b.push(l[x]);return b},P.prototype.addEvent=function(e,t,i){if(e)if(e.addEventListener)e.addEventListener(t,i,!1);else if(e.attachEvent)e.attachEvent("on"+t,i);else if(e["on"+t]){if("function"==typeof e["on"+t]){var o=e["on"+t];e["on"+t]=function(){i.apply(e,arguments),o.apply(e,arguments)}}}else e["on"+t]=i},P.prototype.removeEvent=function(e,t,i){e.removeEventListener?e.removeEventListener(t,i):e.detachEvent?e.detachEvent("on"+t,i):e["on"+t]===i&&(e["on"+t]=null)},P.prototype.waitTopDomLoaded=function(e){if(!this.master){var t="waitTopDomLoadedCallback"+this.rand();return this.emit("wait-top-dom-loaded",{callbackId:t})}var i=this.getTopmostWindow(),o=i.document,n=this,a=!1,r=function(){return a?void 0:(a=!0,"function"==typeof e?void e.apply(n):"string"==typeof e?void window[e].apply(n):!1)},s=function(){"complete"===o.readyState&&(o.detachEvent("onreadystatechange",s),r())};if("interactive"===o.readyState||"complete"===o.readyState)return void r();if(o.addEventListener?o.addEventListener("DOMContentLoaded",function(){r()},!1):o.all&&!_.opera&&o.attachEvent&&o.attachEvent("onreadystatechange",s),/Safari/i.test(navigator.userAgent))var c=i.setInterval(function(){/loaded|complete/.test(o.readyState)&&(r(),i.clearInterval(c))},50);this.addEvent(i,"load",r,!1)},P.prototype.waitDomLoaded=function V(e){var t=this,i=!1,o=function(){return i?void 0:(V.once=!0,i=!0,"function"==typeof e?void e.apply(t):"string"==typeof e?void window[e].apply(t):!1)},n=function(){"complete"===S.readyState&&(S.detachEvent("onreadystatechange",n),o())};if(V.once||"interactive"===S.readyState||"complete"===S.readyState)return void o();if(S.addEventListener?S.addEventListener("DOMContentLoaded",function(){o()},!1):S.all&&!_.opera&&S.attachEvent&&S.attachEvent("onreadystatechange",n),/Safari/i.test(navigator.userAgent))var a=t.getTopmostWindow(),r=a.setInterval(function(){/loaded|complete/.test(S.readyState)&&(o(),a.clearInterval(r))},50);this.addEvent(_,"load",o,!1)},P.prototype.waitDomMutable=function(e){var t=this;this.waitDomLoaded(function(){if(t.msie&&t.msie<=8&&-1===navigator.userAgent.search("Trident/"))var i=t.getTopmostDocument(),o=t.getTopmostWindow(),n=o.setInterval(function(){"complete"===i.readyState&&(o.clearInterval(n),e.apply(t))},50);else e.apply(t)})},P.prototype.getMarkerForPosition=function(e){var t;return this.loadMarkerForPosition(e,function(e){t=e}),t},P.prototype.loadMarkerForPosition=function(e,t){var i=this;if("function"!=typeof t&&o("cb should be a function"),"string"==typeof e){var n=this.queryPosition(e);if(1!==n.length)return t();e=n[0]}if(e.virtualMarker)return this.isInDOM(e.virtualMarker)?t(e.virtualMarker,e.virtualMarker2||e.virtualMarker):t(e.virtualMarker=e.virtualMarker.ownerDocument.getElementById(e.virtualMarker.id));var a,r,s=function(){var t,o=i.getTopmostWindow(),n=o.document;if(e.virtual.javascript)if(i.master){var r;try{r=n.localStorage.getItem("pixi_test_virtual_js_"+e.positionId)}catch(s){}r||(r=e.virtual.javascript);try{t=new Function("return function(document, window) {\n"+r+"\n}")()(n,o)}catch(s){}}else t=document.body;else e.virtual.getContainer&&(t=e.virtual.getContainer());if(t){var c=t.ownerDocument.createElement("div");e.id=c.id="pixiMarkerVirtual"+Math.round(1e16*Math.random()),t.appendChild(c),e.marker=e.virtualMarker=c,a=e.marker}};if(e.virtual&&"override"===e.virtual.type)s();else if(e.id&&e.document){var c=e.document.getElementById(e.id);if(c&&(a=c),e.window||(a=void 0),!a)try{a=e.window.parent.document.getElementById(e.id)}catch(l){a=void 0}if(a){var p=i.getTopmostFiFForElement(a);if(p){p.style.height=0,p.style.display="block",p.style.width=0,(p.id||"").match(/^sas_/)&&(p.className+=" pmIframeContainer",this.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;e.createCSS(".pmIframeContainer","height: 0 !important; width: 0 !important",p.ownerDocument)})),r=e.virtualMarker2=a;var d=p.ownerDocument.createElement("div");d.id="pixiMarkerTopmostIframe"+Math.round(1e16*Math.random()),v(d),p.parentNode.insertBefore(d,p),a=d}e.virtualMarker=a}}else a=e.marker?e.marker:void 0;if(!a&&e.virtual&&s(),!e.decoratedBy||!e.decoratedBy.shouldBeBeforePageContainer(e)){if(e.decoratedBy&&e.decoratedBy.shouldBeBeforeBody(e)){r=a,e.virtualMarker2=r;var m=i.getTopmostDocument(),u=m.getElementsByTagName("body")[0],h=m.createElement("div");v(h),h.className="pmTakeoverFiller";var f=m.createElement("div"),g=m.createElement("div");return f.appendChild(g),f.className="pmBodyPosition pmCentered",g.id="pixiMarkerBody"+Math.round(1e16*Math.random()),u.insertBefore(f,u.firstChild),u.insertBefore(h,f),e.virtualMarker=g,t(g,r)}return t(a)}r=a,e.virtualMarker2=r,this.loadLibrary("sweetlib.js",function(){var o=_.piximedia.SweetLib,n=i.getTopmostDocument();o.loadPageContainer({document:n,hints:i.globalOptions.pagecontainerHints},function(n,a){var s=n.ownerDocument,c=s.createElement("div"),l=s.createElement("div");l.className="pmMarkerContainer",l.id="pixiMarkerPCContainer"+Math.round(1e16*Math.random()),l.appendChild(c),v(l),l.style.position="absolute",l.style.overflow="hidden";var p=o.getScrollbarWidth();i.cssCalc?(l.style.width="calc(100vw - "+p+"px)",l.style.left="50%",l.style.marginLeft="calc(-50vw + "+p/2+"px)"):(l.style.left="50%",setInterval(function(){var e=o.getViewportSize()[0]-p;parseFloat(l.style.minWidth,10)!==e&&(l.style.minWidth=e+"px",l.style.marginLeft=-(e/2)+"px")},50)),c.id="pixiMarkerPC"+Math.round(1e16*Math.random());var d;for(d=n;d&&"pmFiller"!==d.id;d=d.previousSibling);n.parentNode.insertBefore(l,d||n),e.virtualMarker=c,e.pageContainerWidth=a.width;var m=o.getPropertyValue(n,"clear");if("left"===m||"right"===m||"both"===m){var u=l.ownerDocument.createElement("div");v(u),u.style.clear=m,l.parentElement.insertBefore(u,l)}return t(c,r)})})},P.prototype.loadMarkersForPositions=function(e,t){var i=[],o=this,n=0,a=function(){if(n===e.length)return t(i);var r=e[n];o.loadMarkerForPosition(r,function(e){i.push(e),n++,a()})};a()},P.prototype.rand=function(){return Math.round(1e16*Math.random())},P.prototype.htmlentities=function(e){return e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},P.prototype.injectFriendlyContent=function(e,t,o){_.piximedia.callbacks=_.piximedia.callbacks||{};var s,c,l,p=this,d=e.document,m="pmFif"+Math.round(1e16*Math.random()),u=0,h=0,f="callbackWrite"+m,g="callbackOnLoad"+m,y="";i("Injecting friendly contents");var b=t.htmlComments||null;c=new x(this,e,t.iframeOptions||{}),!o||o.iframe||e.hosted||(o.iframe=c),_.piximedia.callbacks[g]=function(e,t){var i=t.name||"untitled";n("["+i+"] Iframe loaded, checking surface ***",s);var o,a=function(){var r,s,l,f,v=e.body;p.globalOptions.ignoreSiteResizes&&(c.iframe&&parseFloat(c.iframe.width,10)&&parseFloat(c.iframe.width,10)>1&&(r=c.iframe.width,c.iframe.width=""),c.iframe&&parseFloat(c.iframe.height,10)&&parseFloat(c.iframe.height,10)>1&&(s=c.iframe.height,c.iframe.height=""),c.iframe&&c.iframe.style&&parseFloat(c.iframe.style.width,10)&&parseFloat(c.iframe.style.width,10)>1&&(l=c.iframe.style.width,c.iframe.style.width=""),c.iframe&&c.iframe.style&&parseFloat(c.iframe.style.height,10)&&parseFloat(c.iframe.style.height,10)>1&&(f=c.iframe.style.height,c.iframe.style.height=""));var g=v.scrollWidth,y=v.scrollHeight;if(p.globalOptions.ignoreSiteResizes&&(void 0!==r&&(c.iframe.width=r),void 0!==s&&(c.iframe.height=s),void 0!==l&&(c.iframe.style.width=l),void 0!==f&&(c.iframe.style.height=f)),g&&y&&g!==u&&y!==h){n("["+i+"] Found surface: "+g+"x"+y),o&&t.clearInterval(o);var b=(d||S).getElementById(m);n("["+i+"] Found iframe: ",b),c.options.doNotResize?n("["+i+"] (not resizing)"):(n("["+i+"] (resizing)"),c.emit("resize",{width:g,height:y,onlyIfNoSurface:!0}))}else o||(o=t.setInterval(a,10))};a()};var w,I="",k="",P="";if(_.piximedia._.iframes=_.piximedia._.iframes||{},_.piximedia._.iframes[m]=c,b&&(k+="<!-- Pixi Begin Javascript: "+b.label+"-->\n"),I+="window.inFIF=true; window.inDapIF=true;\n",I+="window.name="+this.stringify(t.name||"untitled")+";\n",I+="window.pmFIFID="+this.stringify(m)+";\n",I+="window.piximedia = parent.piximedia;\n",I+="window.framedPam = parent.piximedia._.pams["+this.stringify(this.uniqKey)+"];\n",I+="window.framedIframe = parent.piximedia._.iframes["+this.stringify(m)+"];\n",I+="window.pmContext = window.framedPam.globalOptions.context || {};\n",o&&o.injectedOnce&&(I+="window.pmBypassImpression = 1;\n"),o){var A="ad"+this.rand();_.piximedia._.ads=_.piximedia._.ads||{},_.piximedia._.ads[A]=o,I+="window.framedAd = parent.piximedia._.ads["+this.stringify(A)+"];\n",I+="window.framedAd.framedDocument=document;window.framedAd.framedWindow=window;\n"}var O="position"+this.rand();_.piximedia._.positions=_.piximedia._.positions||{},_.piximedia._.positions[O]=e,I+="window.framedPosition = parent.piximedia._.positions["+this.stringify(O)+"];\n",I+="try{for(var pmk in window.piximedia){if(window.piximedia.hasOwnProperty(pmk)){var s=pmk.toString();if(s.match(/^pmData/)){window[s]=window.piximedia[s];}}}}catch(e){}\n";for(var T in _)if(T.toString().match(/^pmData/)){var E=this.stringify(T);I+="window["+E+"] = parent["+E+"];\n"}return t.javascript?(t.javascript=t.javascript.replace(/MACRO_PUBLISHER_CLICK_COMMAND/g,e.clickUrl),w=this.msie?"<script>"+t.javascript+"</script><script>\nfunction pmCloseDocument() { setTimeout(function() { document.close(); }, 200); }\nfunction pmWaitAllScripts(secondTry) { document.pmWaiting = (document.pmWaiting || 0) + 1; var scripts = document.getElementsByTagName('script'), allComplete = true; for(var i = scripts.length - 1; i >= 0; i--) { if(scripts[i].readyState !== 'complete') { allComplete = false; break; } } if(allComplete) { setTimeout(function() { secondTry? pmCloseDocument(): pmWaitAllScripts(true); }, 1000); } else { setTimeout(pmWaitAllScripts, 1000); } }\nsetTimeout(pmWaitAllScripts, 1000);\n</script>":"<script>"+t.javascript+"</script><script>setTimeout(function() { document.close(); }, 200)</script>\n"):t.src&&(t.src=t.src.replace(/MACRO_PUBLISHER_CLICK_COMMAND/g,e.clickUrl),y+=this.msie?a("<script>\nfunction pmWaitAllScripts(secondTry) { var scripts = document.getElementsByTagName('script'), allComplete = true; for(var i = scripts.length - 1; i >= 0; i--) { if(scripts[i].readyState !== 'complete') { allComplete = false; break; } } if(allComplete) { setTimeout(function() { secondTry? document.close(): pmWaitAllScripts(true); }, 1000); } else { setTimeout(pmWaitAllScripts, 1000); } }\n</script><script src=\""+t.src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+'" onreadystatechange="pmWaitAllScripts()"></script>\n'):r('<script src="'+t.src.replace(/\\/g,"\\\\").replace(/'/g,"\\'")+'"></script>\n<script>setTimeout(function() { document.close(); }, 200); </script>\n')),
b&&(P+="\n<!-- Pixi End Javascript: "+b.label+"-->"),w?p.msie&&p.msie>6?(_.piximedia.callbacks[f+"_w"]=a("<head></head><body onload='if(parent.piximedia&&parent.piximedia.callbacks){return parent.piximedia.callbacks."+g+"(document,window)}'>\n"+k+"<script>"+I+"</script>\n"+w+P),_.piximedia.callbacks[f]=a("<script>setTimeout(function() { if(parent.piximedia&&parent.piximedia.callbacks)window.location.replace('javascript:new Function(parent.piximedia.callbacks."+f+"_w)()'); }, 0)\n</script>\n")):_.piximedia.callbacks[f]=a("<head></head><body onload='parent.piximedia.callbacks."+g+"(document,window)'>\n"+k+"<script>"+I+"</script>\n"+w+P):_.piximedia.callbacks[f]=r("<head></head>\n<body onload='parent.piximedia.callbacks."+g+"(document,window)'>\n"+k+"<script>"+I+"</script>\n")+y+r(P+"</body>\n"),this.msie&&(u=1,h=1),function(o){return e.positionId===p.positionCurrentlyInline&&e.document&&!p.globalOptions.ajax&&!t.container&&(i("Injecting inline position"),e.document.write('<div style="'+R+'"><iframe allowfullscreen name="'+t.name+'" src="javascript:false" class="pmFiF" id="'+m+'" style="display: block; background: white; height: '+h+"px; width: "+u+'px" marginwidth="0" marginheight="0" frameborder="0" scrolling="no" width="'+u+'" height="'+h+'"></iframe></div>'),s=e.document.getElementById(m))?o(s):void(s||p.waitDomMutable(function(){!function(i){return t.container?i(t.container):void p.loadMarkerForPosition(e,i)}(function(e,n){if(!e){var a=p.getTopmostDocument();e=a.createElement("div");var r="pixiMarkerAuto"+Math.round(1e16*Math.random());e.id=r,a.body.appendChild(e)}var d=e.ownerDocument;if(s=d.createElement("iframe"),s.name=t.name,s.id=m,s.className="pmFiF",s.style.display="block",s.style.background="white",s.style.height=h+"px",s.style.width=u+"px",s.marginWidth=0,s.marginHeight=0,s.frameBorder=0,s.scrolling="no",s.allowFullscreen=!0,s.width=u,s.height=h,"HEAD"===e.nodeName)e.appendChild(s);else{var f=d.createElement("div");if(f.className="pmFiFContainer pmContainer "+p.containerClassName,v(f),t.container?e.appendChild(f):e.parentNode.insertBefore(f,e),b&&(l=f.ownerDocument.createComment("Pixi Iframe Container: "+b.label),f.parentNode.insertBefore(l,f),l=f.ownerDocument.createComment("Pixi Iframe: "+b.label),f.appendChild(l)),f.appendChild(s),(u||h)&&7!==p.msie){f.style.position="absolute",f.className+=" pmZeroSurface";var g=d.defaultView||d.parentWindow,y=0,w=g.setInterval(function(){var e;try{e=f.getBoundingClientRect()}catch(t){return i("couldn't fetch getBoundingClientRect()"),void(y++>10&&clearInterval(w))}var o=e.right-e.left,n=e.bottom-e.top;o>1&&n>1&&(f.className.match(/pmZeroSurface/)&&(f.className=f.className.replace(/pmZeroSurface/,""),f.style.position="relative"),g.clearInterval(w))},50)}}return n&&p.watchForRemoval(n,function(){c.emit("remove")}),o(s)})}))}(function(e){e.onerror=function(){c.emit("error",arguments)};var t,i=p.getTopmostDocument();try{t=e.contentWindow.document}catch(o){p.log("Couldn't acess content document, probably because of mismatching document.domain");try{e.src="javascript:document.write('<head><script>document.domain=\""+i.domain+"\";</script></head><body></body>')",t=e.contentDocument||e.contentWindow.document}catch(o){try{p.log("Couldn't still access document, probably because of still mismatching document.domain"),e.src="javascript:document.write('<head><script>document.domain=\""+e.ownerDocument.domain+"\";</script></head><body></body>')",t=e.contentDocument||e.contentWindow.document}catch(o){p.log("Couldn't REALLY access document :-(")}}t=e.contentDocument||e.contentWindow.document}p.msie?t.open().write("<script>window.location.replace(\"javascript:var x;try{x=parent.piximedia.callbacks;}catch(e){document.domain='"+i.domain+"';}new Function(parent.piximedia.callbacks."+f+')()")</script>'):t.open().write("<script>new Function(parent.piximedia.callbacks."+f+")()</script>"),c.setIframe(e)}),o&&!o.passback&&(c.on("remove",function(){c.doNotSendPixels||(c.sentRemoved||(c.sentRemoved=!0,e.loadEvent("JS:REMOVED",{detail:e.positionId})),o.shouldBeBeforePageContainer(e)&&this.pam.loadLibrary("sweetlib.js",function(){var e=_.piximedia.SweetLib;e.setBodyBackgroundColor({color:null}),e.moveTopOfPageContainer(e.getPageContainer(),0)}))}),c.on("winlose",function C(){C.ids=C.ids||{},c.doNotSendPixels||C.ids[e.positionId]||(C.ids[e.positionId]=!0,e.loadEvent("JS:WINLOSE",{detail:e.positionId}),setTimeout(function(){C.ids[e.positionId]=!1},1e4))})),c},y.prototype.getAllVisibilityForPixiPositionId=function(e){if(!this.visibility)return[];var t={};t[e]={positionId:{}};for(var i in this.visibility)if(this.visibility.hasOwnProperty(i)&&this.pam.queryPositions(i,t).length)return this.visibility[i];return[]},y.prototype.loadLibrary=function(e,t){return s(e)?this.loadLibraries(e,t):void this.pam.loadLibrary(this.args[e]||e,t)},y.prototype.loadLibraries=function(e,t){var i=this,o=function(){try{return t.call(i)}catch(e){return void n("Caught exception when calling loadLibraries() callback: "+e)}},a=e.length;if(!a)return o();for(var r=function(){return--a?void 0:o()},s=0;s<e.length;s++)this.loadLibrary(e[s],r)},y.prototype.shouldHostPosition=function(e){var t=this.remapPositions||{};if(!this.pam.master)return!1;if(this.pam.msie&&this.pam.msie<8)return!1;if(this.pam.safari&&this.pam.safari<7)return!1;if("object"==typeof e&&e.alwaysHosted)return!0;if("string"==typeof e&&(this.pam.positions[e]||{}).alwaysHosted)return!0;var i=this.pam.getTopmostWindow();if("never-host"===i.name)return!1;if(!this.hosted_positions)return!1;var o=this.hosted_positions;"string"==typeof o&&(o=o.split(/ +/));for(var n=0;n<o.length;n++){var a=o[n];for(var r in t)if(t.hasOwnProperty(r)){var s=new RegExp("\\b"+r+"\\b","g");a=a.replace(s,t[r])}var c={};c[e.positionId]=e;var l=!1;if(this.require&&this.require.positions&&this.pam.queryPositions(this.require.positions,{positions:c,seekOverlapWith:[e]}).length&&(l=!0),this.use&&this.use.positions&&this.pam.queryPositions(this.use.positions,{positions:c,seekOverlapWith:[e]}).length&&(l=!0),l&&this.pam.queryPositions(a,{positions:c}).length)return!0}return!1},y.prototype.shouldBeBeforeBody=function(e){if(!this.pam.master)return!1;var t=this.remapPositions||{};if(!this.positions_before_body)return!1;var i=this.positions_before_body;"string"==typeof i&&(i=i.split(/ +/));for(var o=0;o<i.length;o++){var n=i[o];for(var a in t)if(t.hasOwnProperty(a)){var r=new RegExp("\\b"+a+"\\b","g");n=n.replace(r,t[a])}var s={};if(s[e.positionId]=e,this.pam.queryPositions(n,{positions:s}).length)return!0}return!1},y.prototype.shouldBeBeforePageContainer=function(e){if(!this.pam.master)return!1;var t=this.remapPositions||{};if(!this.positions_before_page_container)return!1;var i=this.positions_before_page_container;"string"==typeof i&&(i=i.split(/ +/));for(var o=0;o<i.length;o++){var n=i[o];for(var a in t)if(t.hasOwnProperty(a)){var r=new RegExp("\\b"+a+"\\b","g");n=n.replace(r,t[a])}var s={};if(s[e.positionId]=e,this.pam.queryPositions(n,{positions:s}).length)return!0}return!1},P.prototype.activateAd=function(e,t){var a=this;t=t||{},i("Activating ad: ",e);var r=new Date;if(e.active&&n("Ad was already active"),e.active=!e.alwaysAvailable,!e.passback){if(a.numberOfActiveAds=a.numberOfActiveAds||0,a.numberOfActiveAds++,a.globalOptions.enableActiveAdsCapping&&void 0!==a.globalOptions.numberOfActiveAdsCapping&&a.globalOptions.numberOfActiveAdsCapping>=a.numberOfActiveAds){n("Deactivating other ads because capping was met");for(var c=0;c<a.availableAds.length;c++){var l=a.availableAds[c];l===e||l.passback||l.active||(l.require={positions:["disabled-ad-capping"]},l.disabledBecauseAdCapping=!0,l.disabledBecauseAdCappingLog="active-ads-capping")}}if(a.globalOptions.enableTvCodeProtection&&e.tv_code){n("Deactivating other ads with code "+e.tv_code);for(var p=0;p<a.availableAds.length;p++){var d=a.availableAds[p];d===e||d.passback||d.active||d.tv_code!==e.tv_code||d.campaignId===e.campaignId||(d.require={positions:["disabled-tv-code"]},d.disabledBecauseAdCapping=!0,d.disabledBecauseAdCappingLog="tv-code")}}a.globalOptions.keepAdringForRTA||(S.cookie="pixi_rta_pos=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_rta_pos=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"),S.cookie="pixi_adr=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie="pixi_adr=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",this.globalOptions.pixiAdrName&&(a.globalOptions.keepAdringForRTA||(S.cookie=this.globalOptions.pixiAdrName+"=; path=/; "+this.getDomainPartForCookies()+"expires=Thu, 01 Jan 1970 00:00:00 GMT",S.cookie=this.globalOptions.pixiAdrName+"=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT"))}if(e.active&&e.use&&e.use.positions&&a.on("hello",function(t){var i={};i[t.positionId]=t,a.queryPositions(e.use.positions,{spaceIsOr:!0,positions:i}).length&&(t.requested=!0,t.requestedBy=e)}),t.positions){e.positions=t.positions;for(var m=0;m<e.positions.length;m++){var u=e.positions[m];this.positions.hasOwnProperty(u.positionId)||(this.positions[u.positionId]=u)}}else{if(e.positions=[],e.require&&e.require.positions)for(var h=this.queryPositions(e.require.positions,{activeAndNotUsed:!0,requireAll:!0}),v=0;v<h.length&&!e.disabled;v++){var g=h[v];g.active&&(n("Associating required position "+g.positionId),g.used=!0,g.decoratedBy=e,g.decoratedAt=r,g.justUsed&&g.justUsed(),e.positions.push(g))}if(e.use&&e.use.positions)for(var y=this.queryPositions(e.use.positions,{activeAndNotUsed:!0,spaceIsOr:!0}),b=0;b<y.length&&!e.disabled;b++){var w=y[b];w.active&&(n("Associating used position "+y[b]),e.positions.push(w))}}for(var x=0;x<e.positions.length;x++)if(e.positions[x].used=!0,e.positions[x].decoratedBy=e,e.positions[x].decoratedAt=r,e.positions[x].justUsed&&e.positions[x].justUsed(),!e.positions[x].implicit&&!e.passback&&this.mode.match(/^alliance/)){var I=e.positions[x];this.master?void 0===I.injectionIndex&&I.loadEvent("JS:POSITION_USED",{detail:I.positionId}):I.loadEvent("JS:POSITION_USED:HOSTED",{detail:I.positionId})}if(this.master){var k=function(e){if(e){"string"==typeof e&&a.loadPixel(e);for(var t=0;t<e.length;t++)a.loadPixel(e[t])}};this.trackingAdPixelsCalled[e.adId]||(this.trackingAdPixelsCalled[e.adId]=!0,e.loadEvent("JS:ACTIVATE:AD",{}),e.args&&e.args["tracking.ad"]&&e.args["tracking.ad"].pixelUrl&&k(e.args["tracking.ad"].pixelUrl)),this.trackingAdCreativePixelsCalled[e.adId+"|"+e.creativeId]||(this.trackingAdCreativePixelsCalled[e.adId+"|"+e.creativeId]=!0,e.loadEvent("JS:ACTIVATE:CREATIVE",{}),e.args&&e.args["tracking.creative"]&&e.args["tracking.creative"].pixelUrl&&k(e.args["tracking.creative"].pixelUrl))}!function(t){if(!a.master)return t();for(var i=e.args&&e.args.assets&&e.args.assets.pool?e.args.assets.pool:[],o=0,n=function(){return o--,o?void 0:t()},r=function(t){var i=!1,r=!1,s=function(){return i=!0,n()};t.name.match(/^vast/)&&(r=!0,setTimeout(function(){var i=t.uri,o=new window.XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState&&200===o.status){"object"!=typeof t.metadata&&(t.metadata={}),t.metadata.vast=f(o.responseXML);try{var i=t.metadata.vast.Ad_value.InLine_value.Impression;e.loadEvent("JS:IMPRESSION:VAST_LOADED",{c3:"asset:"+t.asset_id});for(var n=0;n<i.length;n++){var r=i[n].value;a.loadPixel(r)}}catch(c){}return s()}},o.open("GET",i,!0),o.send()},0)),r&&(setTimeout(function(){i||e.loadEvent("COULD_NOT_LOAD_ASSET",{c1:t.id})},1e4),o++)},s=0;s<i.length;s++)r(i[s]);return o?void 0:t()}(function(){a.loadMarkersForPositions(e.positions,function(t){try{if(e.tag)e.tag.apply(a,t);else if(e.fif){var c=e.positions[0];if(a.master){var l=[],p=null,d=!!e.main_js_in_head,m=!!e.main_js_always_in_head;if(a.somePositionsAreAlwaysHosted||e.hosted_positions&&e.hosted_positions.length){e.shouldHostPosition(c)?l.push(c):p=c,e.on("hello",function(t){return e.shouldHostPosition(t)?(t.decoratedBy=e,t.decoratedAt=t.decoratedAt||new Date,a.hostPosition(e,t),!1):void 0});for(var u=1;u<e.positions.length;u++){var h=e.positions[u];e.shouldHostPosition(h)?l.push(h):p||(p=h)}}else p=c;for(var f=0;f<l.length;f++){var v=l[f];v.decoratedBy=e,v.decoratedAt=new Date,a.hostPosition(e,v)}if(p||m){if(d||m){var g=a.getTopmostDocument();a.injectFriendlyContent({positionId:"head",document:g,marker:g.head},e.fif,e)}else e.masterPosition=p||c,a.injectFriendlyContent(e.masterPosition,e.fif,e);e.iframe.on("remove",function(){n("Ad has been removed from DOM"),a.unloadAd(e)}).on("winlose",function(){n("Ad has been winlost");var t=e.positions;a.unloadAd(e,{hide:!0}),a.activateAd(e,{positions:t})}),e.injectedOnce=!0}}else a.injectFriendlyContent(c,e.fif,e)}else if(e.passback){e.active=!1;var y={htmlComments:{label:"Passback for "+(e.use||{}).positions}};switch(e.passback.type){case"javascript":case"inline":i("Activating JavaScript passback");var b;switch(e.passback.type){case"javascript":b=e.passback.contents;break;case"inline":b="new Function(window.framedPosition.inlineScript)()"}if(b){var w;w="for(var k in parent){ if((!parent.hasOwnProperty || parent.hasOwnProperty(k)) && k.match(/^(sas|Smart|weborama_url_backup)/) && !k.match(/^(sas_ajax)$/)){ window[k] = parent[k]; } }\n";try{"pmdebugpassback"===top.window.name&&(w+="debugger;\n")}catch(x){}y.javascript=w+b}else y=void 0;break;case"redirect":i("Activating redirect passback"),e.passback.contents?y.src=e.passback.contents:y=void 0;break;default:y=void 0}if(y)for(var I=function(e,t,i){var o=a.injectFriendlyContent(e,t,i);o.iframe&&o.iframe.style&&(o.iframe.style.marginLeft="auto",o.iframe.style.marginRight="auto"),o.on("winlose",function(){n("Passback has been winlost"),e.injectionIndex=(e.injectionIndex||0)+1,a.loadEvent("JS:PASSBACK_WINLOST",void 0,void 0,{detail:e.positionId});var r=o.iframe.ownerDocument.getElementById(o.iframe.id);r&&r.parentNode.removeChild(r),I(e,t,i)}),o.on("error",function(){n("Passback error",arguments),a.loadEvent("JS:PASSBACK_ERROR",void 0,void 0,{detail:e.positionId});try{var t=o.iframe.contentDocument.createComment("Passback Failed To Load (Error)");o.iframe.contentDocument.body.appendChild(t),t=o.iframe.ownerDocument.createComment("Pixi Iframe: Passback Failed To Load (Error)"),o.iframe.parentNode.insertBefore(t,o.iframe),t=o.iframe.ownerDocument.createComment("Pixi Iframe Container: Passback Failed To Load (Error)"),o.iframe.parentNode.parentNode.insertBefore(t,o.iframe.parentNode)}catch(i){}});var r=setTimeout(function(){n("Passback timeout"),i.emit("passback-timeout"),a.loadEvent("JS:PASSBACK_TIMEOUT",void 0,void 0,{detail:e.positionId});try{var t=o.iframe.contentDocument.createComment("Passback Failed To Load (Timeout)");o.iframe.contentDocument.body.appendChild(t),t=o.iframe.ownerDocument.createComment("Pixi Iframe: Passback Failed To Load (Timeout)"),o.iframe.parentNode.insertBefore(t,o.iframe),t=o.iframe.ownerDocument.createComment("Pixi Iframe Container: Passback Failed To Load (Timeout)"),o.iframe.parentNode.parentNode.insertBefore(t,o.iframe.parentNode)}catch(r){}},1e4);o.on("resize",function(t){t&&t.width>1&&t.height>1&&(a.loadEvent("JS:PASSBACK_OK",void 0,void 0,{detail:e.positionId}),clearTimeout(r))})},k=0;k<e.positions.length;k++){var P=e.positions[k],A=P.positionId;if(a.scheduledRendezVous){var O=r-a.firstPositionRegisteredAt,S=3*(a.globalOptions.rendezvous_duration||N),T=Math.round(10*O/S);A+=0>T?":0":T>10?":MORE":":"+T}var E=_.piximedia.request_pos_sp[a.siteId][a.placementId],C=[];for(var D in E)E.hasOwnProperty(D)&&C.push(D);P.implicit||(A+=":explicit"),A+=":pos="+C.join(","),a.loadEvent("JS:PASSBACK",void 0,void 0,{detail:A}),I(P,y,e)}}}catch(x){o("Could not activate ad: "+x)}e.timetracker&&e.timetracker.global&&a.master&&a.loadLibrary("sweetlib.js",function(){e.timetrackerGlobal||(e.timetrackerGlobal=_.piximedia.SweetLib.setTimer("GLOBAL",function(t,i){e.loadEvent("TIMETRACKER::"+t,{duration:i})}),e.timetrackerGlobal.start())});var M;try{var j=_.localStorage?_.localStorage.getItem("pmCustomFieldsCSS"):"";if(j){var B=JSON.parse(j);B&&B.css&&(M=B.css)}}catch(x){}!M&&e&&e.args&&(M=e.args.css),M&&a.master&&a.loadLibrary("sweetlib.js",function(){var e=a.getTopmostDocument();if(s(M))for(var t=0;t<M.length;t++)_.piximedia.SweetLib.createCSSs(M[t],e);else _.piximedia.SweetLib.createCSSs(M,e)})})})},P.prototype.unloadPosition=function(e){n("Unloading position",e);for(var t=0;t<(e.iframes||[]).length;t++){var i=e.iframes[t];n("Unloading iframe"),i.unload()}var o=e.decoratedBy;o&&(o.positions=l(o.positions,"positionId",e.positionId)),delete this.positions[e.positionId]},P.prototype.unloadAd=function(e,t){if(n("Unloading ad",e),t=t||{},e.positions)for(var i=0;i<e.positions.length;i++){for(var o=e.positions[i],a=0;a<(o.iframes||[]).length;a++){var r=o.iframes[a];n("Unloading iframe"),r.unload({hide:t.hide})}o.iframes=[],o.decoratedAt=o.decoratedBy=void 0,o.used=!1,delete this.positions[o.positionId]}e.iframe&&(e.iframe.unload({hide:t.hide}),e.iframe=void 0),e.purgeEventEmitter(),e.active=!1},P.prototype.hostPosition=function(e,t){var a=this;t.hosted=!0,n("Prepare to host position",t),this.waitDomMutable(function(){i("DOM is mutable for hosted position",t);var r,s;s=function(e,t){var i=g.getID(e);if(i)try{r.fireEventToID(i,t,function(){},function(){})}catch(n){o("Caught exc, maybe destroyed rpc channel",n)}},a.globalEmitter.on("event",s),i("Injecting hosted position",t,e.positions),e.injectPosition(t,{iframeOptions:{doNotResize:!0}},function(o,c){i("Loading marker for hosted position",t),a.loadMarkerForPosition(t,function(o,l){if(!o){var p=a.getTopmostDocument();o=p.createElement("div");var d="pixiMarkerHosted"+Math.round(1e16*Math.random());o.id=d,p.body.appendChild(o)}if(i("Found marker for position "+t.positionId,o),r){i("Destroying dangling RPC channel");try{r.destroy()}catch(m){}}for(var u,h=o.childNodes,f=new x(a,t),g=0;g<h.length;g++)if(h[g].className.indexOf("pmContainer")>=0){u=h[g];for(var y=u.getElementsByTagName("iframe"),b=0;b<y.length;b++){var w=y[b];a.winlostIframeIds[w.id]=!0}u.parentNode.removeChild(u);break}u=o.ownerDocument.createElement("div"),u.className="pmHostedContainer pmContainer "+a.containerClassName,v(u),u.style.fontSize=0,o.appendChild(u);var I=u.getElementsByTagName("iframe");if(I.length)for(var k=0;k<I.length;k++){var P=I[k];a.winlostIframeIds[P.id]=!0,u.removeChild(P)}var A,O,_;O=u.ownerDocument,_=O.defaultView||O.parentWindow,_._piximedia=_._piximedia||{},function(e){return _._piximedia.easyXDM||(c.piximedia.injectEasyXDM(_,O,a.getTopmostWindow().location),_._piximedia.easyXDM=_.easyXDM.noConflict("_piximedia")),e()}(function(){A=_._piximedia.easyXDM,i("Creating RPC channel"),r=new A.Rpc({container:u,hash:!0,props:{style:{width:a.msie?1:0,height:a.msie?1:0},allowfullscreen:"allowfullscreen",scrolling:"no",width:a.msie?1:0,height:a.msie?1:0},remote:D,onReady:function(){n("master is ready")}},{local:{getConfig:function(){for(var o=[],n=[],r=0;r<a.allAvailableAds.length;r++)if(e.uniqid===a.allAvailableAds[r].uniqid){var s=a.allAvailableAds[r];s.injectedOnce=e.main_js_always_in_head||e.injectedOnce,o=[s];break}e.injectedOnce=!0;var c={},l={};for(var p in a.positions)if(a.positions.hasOwnProperty(p)){var d=a.positions[p];d.clickUrl&&(c[p]=d.clickUrl),d.advertiserClickUrl&&(l[p]=d.advertiserClickUrl)}var m={positionId:t.positionId,pixiPositionId:t.pixiPositionId||t.decoratedBy.getPixiPositionIdForPositionId(t.positionId),decoratedAt:t.decoratedAt,clickUrl:t.clickUrl,implicit:t.implicit,injectionIndex:t.injectionIndex,pageContainerWidth:t.pageContainerWidth,advertiserClickUrl:t.advertiserClickUrl,allAdvertiserClickUrls:l,allClickUrls:c};i("Config position: ",m),n.push(m);var u={siteId:a.siteId,placementId:a.placementId,globalOptions:a.globalOptions,allAvailableAds:o,positions:n,documentHasFocus:a.documentHasFocus};return u},fireEventToID:function(e,t,i,o){try{return a.globalEmitter.fireEventToID(e,t,{exceptTo:s}),i()}catch(n){return o()}}},remote:{fireEventToID:{}}});var o=function(){var e=u.getElementsByTagName("iframe");if(!e.length)return setTimeout(o,10);var t=e[0];i("Found RPC iframe",t),f.setIframe(t),l&&a.watchForRemoval(l,function(){n("Secondary marker has been removed"),f.emit("remove")})};i("Looking for RPC iframe"),o()})})})})},P.prototype.hostRoom=function(e,t,i){if(!this.master)return o("PAM.prototype.hostRoom() might only be called on the master PAM");t=t||{},n("Registering room "+e);var a="room."+e,r={siteId:this.siteId,placementId:this.placementId,positionId:a,ajax:!0,implicit:!0,virtual:{getContainer:i}};for(var s in t)t.hasOwnProperty(s)&&(r[s]=t[s]);this.hello(r)},P.prototype.getTopmostFiFForElement=function(e){var t=e.ownerDocument,i=t.defaultView||t.parentWindow,o=this.getTopmostWindow();if(!i.inFIF&&!i.inDapIF&&!i.inDapMgrIf)return void 0;var n,a="pmBeacon"+this.rand(),r=i.name,s=o.document.getElementsByTagName("iframe");i.name=a;for(var c=0;c<s.length;c++){var l=s[c];try{if(l.contentWindow&&l.contentWindow.name===a){n=l;break}}catch(p){}}if(!n)e:for(var d=0;d<s.length;d++){var m=s[d];try{if(m.contentWindow&&(m.contentWindow.inFIF||m.contentWindow.inDapIF||m.contentWindow.inDapMgrIf))for(var u=m.contentWindow.document,h=u.getElementsByTagName("iframe"),f=0;f<h.lenght;f++){var v=h[f];try{if(v.contentWindow&&v.contentWindow.name===a){n=m;break e}}catch(p){}}}catch(p){}}return i.name=r,n},P.prototype.checkTopDomain=function(){var e,t=this;try{e=top.pmOriginalDomain}catch(i){return}if(e){var o=function(){var i;try{i=top.document.domain}catch(a){return n("Top document changed from "+e+" to unknown value!"),void t.loadEvent("PANIC",void 0,void 0,{fail_reason:"top_domain_changed",c1:e,c2:"EXCEPTION"})}i!==e?(n("Top document changed from "+e+" to "+i+"!"),t.loadEvent("PANIC",void 0,void 0,{fail_reason:"top_domain_changed",c1:e,c2:i})):setTimeout(o,1e4)};setTimeout(o,1e4)}},P.prototype.debug=function(){B=!0,_.console&&_.console.log&&_.console.log(t.get().join("\n"))},P.prototype.clearCSS=function(e){v(e)},P.prototype.createOpaqueAnimation=function J(e,t,i){var o=this;return J.prefix||(J.prefix="animation-"+o.rand()+"-",J.seq=0),i||(i=J.prefix+J.seq++),o.master?o.loadLibrary("sweetlib.js",function(){var n=o.getTopmostDocument(),a=_.piximedia.SweetLib.querySelector(e,n);o.animations[i]=_.piximedia.SweetLib.animate(a,t)}):o.emit("create-opaque-animation",e,t,i),i},P.prototype.createAnimation=function(e,t){var i=this,o=i.createOpaqueAnimation(e,t);return{play:function(e){i.playOpaqueAnimation(o,e)},reverse:function(e){i.reverseOpaqueAnimation(o,e)},clear:function(){i.clearOpaqueAnimation(o)}}},P.prototype.playOpaqueAnimation=function(e,t,i){var n=this;i||(i="fire-"+n.rand());var a="play-opaque-animation:callback:"+i;if(n.master){var r=n.animations[e];if(!r)return o("Could not find animation "+e);r.play(function(){n.emit(a)})}else n.on(a,function s(){n.removeListener(a,s),t(e)}),n.emit("play-opaque-animation",e,void 0,i)},P.prototype.reverseOpaqueAnimation=function(e,t,i){var n=this;i||(i="fire-"+n.rand());var a="reverse-opaque-animation:callback:"+i;if(n.master){var r=n.animations[e];if(!r)return o("Could not find animation "+e);r.reverse(function(){n.emit(a)})}else n.on(a,function s(){n.removeListener(a,s),t(e)}),n.emit("reverse-opaque-animation",e,void 0,i)},P.prototype.clearOpaqueAnimation=function(e){var t=this;if(t.master){var i=t.animations[e];if(!i)return o("Could not find animation "+e);i.clear()}else t.emit("clear-opaque-animation",e)},P.prototype.listBroadcastPm=function(e,t){var i=_.XMLHttpRequest?new _.XMLHttpRequest:void 0;if(e.match(/\/$/)||(e+="/"),"withCredentials"in i)i.open("GET","//"+j+"/list-of-broadcast.pm/"+e+"json",!0),i.onreadystatechange=function(){return 4===i.readyState?t(200!==i.status?{error:"failed: "+i.responseText}:JSON.parse(i.responseText)):void 0},i.send(null);else{var o="listbroadcastpm"+this.rand(),n=_.document.getElementsByTagName("head")[0],a=_.document.createElement("script");a.async=!0,a.src="//"+j+"/list-of-broadcast.pm/"+e+"jsonp=piximedia._."+encodeURIComponent(o),n.appendChild(a),_.piximedia._[o]=t}},P.prototype.startNavigationTracking=function(e){var t=this;return t.master?void t.loadLibrary("sweetlib.js",function(){var t=_.piximedia.SweetLib;t.startNavigationTracking(e)}):t.emit("start-navigation-tracking",e)},P.prototype.bindVisibilityTracker=function(e,t,i,o){var n=this;return o||(o="fire-"+n.rand()),n.master?void n.loadLibrary("sweetlib.js",function(){var a=_.piximedia.SweetLib,r={object:a.querySelector(e)};for(var s in t)if(t.hasOwnProperty(s))switch(s){case"callback":break;default:r[s]=t[s]}a.bindVisibilityTracker(r,function(e){return i?i(e):void n.emit(o,e)})}):(n.on(o,i),n.emit("bind-visibility-tracker",e,t,void 0,o))},P.upscaleAssetQuery=function(e){if("object"==typeof e.match)return e;"string"==typeof e&&"{"===e.substr(0,1)&&(e=JSON.parse(e));var t=function(e){switch(e.length){case 5:break;case 4:e=[e[0],e[1],null,e[2],e[3]];break;case 3:e=[null,e[0],e[1],e[2],null];break;case 2:e=[null,e[0],null,e[1],null];break;case 1:e=[null,null,e[0],null,null]}for(var t=0;t<e.length;t++)e[t]=null===e[t]?null:parseFloat(e[t],10);return null===e[0]&&(null!==e[1]?e[0]=e[1]:e[0]=e[2]),null===e[4]&&(null!==e[3]?e[4]=e[3]:e[4]=e[2]),e},i=function(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseFloat(e,10);return t.toString()===e?t:e};if("string"==typeof e.require){var o=P.upscaleAssetQuery(e.require);if(e.use){var n=P.upscaleAssetQuery(e.require).match.grabAllAssets;o.match.grabSomeAssets=[];for(var a in n)n.hasOwnProperty(a)&&(o.match.grabSomeAssets=o.match.grabSomeAssets.concat(n[a].grabSomeAssets))}return o}if("string"==typeof e){for(var r=e.replace(/,\s+/g,",").split(/\s+/),c={grabAllAssets:[]},l=0;l<r.length;l++){var p=r[l],d=p.split(","),m={grabSomeAssets:[]};c.grabAllAssets.push(m);for(var u=0;u<d.length;u++){var f=d[u],v={and:[]};m.grabSomeAssets.push(v);var g=f.split("."),y=g.shift();y&&v.and.push([{property:"type"},"==",y]);for(var b in g)if(g.hasOwnProperty(b)){var w=g[b],x=w.match(/^[0-9]+x[0-9]+$/);if(x)v.and.push([{property:"surface"},"==",w]);else if(x=w.match(/^([a-z_]+)\*(.*)$/))v.and.push([{property:x[1]},"*",t(x[2].split("*"))]);else if(x=w.match(/^([a-z_]+)(=|<=|<|>=|>|<>|!=)(.*)$/)){var I=x[1],k=x[2],A=x[3];v.and.push([{property:I},k,i(A)])}else v.and.push({property:w})}}}e={match:c}}else if("object"==typeof e){var O=h(e)[0];if(void 0===O)throw new Error("Invalid query (1)");var _=e[O];if(void 0===_)throw new Error("Invalid query (2)");if(_.desc||_.requires){var S={grabAllAssets:[],grabMatchingAssets:[]};for(var T in e)if(e.hasOwnProperty(T)){var E=e[T];i(E.mandatory)?S.grabAllAssets.push({grabName:T,value:P.upscaleAssetQuery(E.requires)}):S.grabMatchingAssets.push({grabName:T,value:P.upscaleAssetQuery(E.requires)})}e={match:S}}else{var C={and:[]},N={grabAllAssets:[C]},D=function(e,o){var n=function(e){return e};switch(e){case"weight":n=function(e){return 1024*e},e="file_size";break;case"iframable":e="iframeable"}if(s(o)){for(var a=[],r=0;r<o.length;r++)a[r]=n(o[r]);return[{property:e},"*",t(a)]}if("string"!=typeof o)return[{property:e},"==",i(o)];var c=o.substr(o.length-1,1),l=o.substr(0,o.length-1);switch(c){case"+":case"-":case"!":switch(o=n(i(l)),c){case"+":return[{property:e},">=",o];case"-":return[{property:e},"<=",o];case"!":return[{property:e},"!==",o]}break;default:return[{property:e},"==",n(i(o))]}};for(var M in e)if(e.hasOwnProperty(M)){var j=e[M];""!==j&&C.and.push(D(M,j))}e={match:N}}}if(e.match&&e.match.grabAllAssets)for(var B=0;B<e.match.grabAllAssets.length;B++){var F=e.match.grabAllAssets[B];F.grabSomeAssets||F.grabMatchingAssets||F.grabAllAssets||(e.match.grabAllAssets[B]={grabAllAssets:[F]})}return e},P.assetsMatchQuery=function(e,t,i){i=i||{};var o,n,a,r,l=i.trailMissing||[],p={},d=i.assetsUsedOnce||{},m={},u=[],h={},f=[],v=function(e){o=e,o.name===o._splitname?(n=o._classes,a=o._type):(n=o.name.split("."),a=n.shift(),o._classes=n,o._type=a,o._splitname=o.name),o.metadataObject?r=o.metadataObject||{}:(r=o.metadata||{},"string"==typeof r&&(r=JSON.parse(r)||{},o.metadataObject=r))},g=function(e){switch(e){case"asset_id":return o.asset_id;case"type":return a;case"bytes":case"file_size":return o.file_size;default:var t=r.tags;return t&&c(t,e)>=0?!0:r[e]}},y=function(e){var t=e.id||e.asset_id;d[t]=!0;for(var i=0;i<f.length;i++){var o=f[i];h[o]=h[o]||[],m[o+":"+t]||(m[o+":"+t]=!0,h[o].push(e))}m[t]||(m[t]=!0,u.push(e))},b=function(e){e=e.grabName&&e.value?e.value:e,e.match&&(e=e.match);var t=JSON.stringify(e);p[t]||(p[t]=!0,l.push(JSON.parse(t)))},w=function(e){if(!e)return e;e.value&&(e=e.value),"object"==typeof e&&e.match&&(e=e.match);var n,a,r,c,l,p,d,m,u;if(e.grabSomeAssets||e.grabMatchingAssets||e.grabAllAssets){for(var h=e.grabSomeAssets||e.grabMatchingAssets||e.grabAllAssets,f=[],x=!1,I=h.length?!0:!1,k=0;k<h.length;k++){for(var P=h[k],A=!1,O=0;O<t.length;O++){v(t[O]);var _;if(P.and){_=!0;e:do for(d=0;d<P.and.length;d++)if(m=P.and[d],m&&void 0!==m.length&&s(m)){if(u=void 0,a=m[0],n=a&&a.property?g(a.property):w(a),1===m.length)u=n;else if(l=m[1],p=m[2],"*"===l)r=p[0],c=p[4],u=r&&r>n?!1:c&&n>c?!1:!0;else{switch(typeof m[2]){case"string":case"number":case"boolean":p=m[2];break;default:p=w(m[2])}switch(l){case"<":u=p>n;break;case">":u=n>p;break;case"<=":u=p>=n;break;case">=":u=n>=p;break;case"=":case"==":case"===":u=n===p;break;case"<>":case"!==":case"!=":u=n!==p}}if(!u){_=!1;break e}}else if(!w(P.and[d])){_=!1;break e}while(!1)}else _=w(P);_&&(A=!0,y(o))}A?x=!0:(f.push(P),I=!1)}var S;if(S=e.grabAllAssets&&!i.forceOr?I:x,!S)for(var T=0;T<f.length;T++){var E=f[T];b(E)}return x}if(void 0===e.length||!s(e)){if(e.property)return g(e.property);if(e.and){for(d=0;d<e.and.length;d++)if(m=e.and[d],m&&void 0!==m.length&&s(m)){if(u=void 0,a=m[0],n=a&&a.property?g(a.property):w(a),1===m.length)u=n;else if(l=m[1],p=m[2],"*"===l)r=p[0],c=p[4],u=r&&r>n?!1:c&&n>c?!1:!0;else{switch(typeof m[2]){case"string":case"number":case"boolean":p=m[2];break;default:p=w(m[2])}switch(l){case"<":u=p>n;break;case">":u=n>p;break;case"<=":u=p>=n;break;case">=":u=n>=p;break;case"=":case"==":case"===":u=n===p;break;case"<>":case"!==":case"!=":u=n!==p}}if(!u)return!1}else if(!w(e.and[d]))return!1;return!0}if(e.or){for(var C=0;C<e.and.length;C++)if(w(e.or[C]))return!0;return!1}return"object"==typeof e&&e.match?w(e.match):e}if(a=e[0],n=a&&a.property?g(a.property):w(e[0]),1===e.length)return n;if(l=e[1],p=e[2],"*"===l)return r=p[0],c=p[4],r&&r>n?!1:c&&n>c?!1:!0;switch(typeof e[2]){case"string":case"number":case"boolean":p=e[2];break;default:p=w(e[2])}switch(l){case"<":return p>n;case">":return n>p;case"<=":return p>=n;case">=":return n>=p;case"=":case"==":case"===":return n===p;case"<>":case"!==":case"!=":return n!==p}};if(e=P.upscaleAssetQuery(e),!e.match||!e.match.grabAllAssets)throw new Error("Don't know how to parse this expression");for(var x=!0,I=!1,k=0;k<e.match.grabAllAssets.length;k++){var A=e.match.grabAllAssets[k],O=A.grabName;f.push(O),w(A)?I=!0:x=!1,f.pop()}var _;return x?_=u:(I&&(i.partial=!0),_=[]),_},P.convertTrailMissing=function(e){var t=function(e){for(var t="*",i=[],o=function(e){if(e.property)-1===i.indexOf(e.property)&&i.push(e.property);else{if(!s(e))throw new Error("Unexepcted trail entry (4)");var o=e[0],n=e[1],a=e[2];if(o&&o.property){if("type"===o.property){if("=="!==n&&"==="!==n)throw new Error("Unexpected trail entry (3)");return void(t=a)}o=o.property}var r;switch(n){case"*":r=o+"*"+a.join("*");break;case"=":case"==":case"===":r=o+"="+a;break;case"!=":case"<>":case"!==":r=o+"!="+a;break;default:r=o+n+a}-1===i.indexOf(r)&&i.push(r)}};e.grabAllAssets&&e.grabAllAssets&&1===e.grabAllAssets.length;)e=e.grabAllAssets[0];if(e.and)for(var n=0;n<e.and.length;n++)o(e.and[n]);return t+(i.length?"."+i.join("."):"")};if(e.grabSomeAssets){for(var i=[],o=0;o<e.grabSomeAssets.length;o++)i.push(t(e.grabSomeAssets[o]));return i.join(",")}return t(e)},P.prototype.getPrerequisiteVirtualPosition=function(e){try{if(!this.globalOptions||!this.globalOptions.virtualPositions)return;for(var t in this.globalOptions.virtualPositions)if(this.globalOptions.virtualPositions.hasOwnProperty(t)){
var i=this.globalOptions.virtualPositions[t];if(i.prerequisite){var o={};if(o[t]={positionId:t},this.queryPosition(e,{positions:o}).length)return i.prerequisite}}}catch(n){return}},P.prototype.getPositionById=function(e){return this.positions[e]||null},P.VERSION=C,P.RENDEZVOUS_DURATION=N,P.SUPPORTS_TRACKING_AD=!0,P.SUPPORTS_TRACKING_CREATIVE=!0,P.browserDetect=q,P.EventEmitter=g,P.Ad=y,P.Position=I,P.Iframe=x,P.AdProxy=b,P.CGAdProxy=w,P.isArray=s,_.piximedia["PAM"+C]=P,(!_.piximedia.PAM||_.piximedia.PAM.VERSION<C)&&(_.piximedia.PAM=P,_.piximedia.browserDetect=q)}(),window.piximedia._.injectEasyXDM=function(e,t,i){!function(e,t,i,o,n,a){function r(e,t){var i=typeof e[t];return"function"==i||!("object"!=i||!e[t])||"unknown"==i}function s(e,t){return!("object"!=typeof e[t]||!e[t])}function c(e){return"[object Array]"===Object.prototype.toString.call(e)}function l(){var e="Shockwave Flash",t="application/x-shockwave-flash";if(!b(navigator.plugins)&&"object"==typeof navigator.plugins[e]){var i=navigator.plugins[e].description;i&&!b(navigator.mimeTypes)&&navigator.mimeTypes[t]&&navigator.mimeTypes[t].enabledPlugin&&(S=i.match(/\d+/g))}if(!S){var o;try{o=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),S=Array.prototype.slice.call(o.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),o=null}catch(n){}}if(!S)return!1;var a=parseInt(S[0],10),r=parseInt(S[1],10);return T=a>9&&r>0,!0}function p(){if(!V){V=!0;for(var e=0;e<J.length;e++)J[e]();J.length=0}}function d(t,i){return e.piximedia&&e.piximedia.pam&&e.piximedia.pam.waitDomMutable?e.piximedia.pam.waitDomMutable(function(){t.call(i)}):V?void t.call(i):void J.push(function(){t.call(i)})}function m(){var e=parent;if(""!==L)for(var t=0,i=L.split(".");t<i.length;t++)e=e[i[t]];return e.easyXDM}function u(t){return e.easyXDM=q,L=t,L&&(U="easyXDM_"+L.replace(".","_")+"_"),R}function h(e){return e.match(j)[3]}function f(e){return e.match(j)[4]||""}function v(e){var t=e.toLowerCase().match(j),i=t[2],o=t[3],n=t[4]||"";return("http:"==i&&":80"==n||"https:"==i&&":443"==n)&&(n=""),i+"//"+o+n}function g(e){if(e=e.replace(F,"$1/"),!e.match(/^(http||https):\/\//)){var t="/"===e.substring(0,1)?"":i.pathname;"/"!==t.substring(t.length-1)&&(t=t.substring(0,t.lastIndexOf("/")+1)),e=i.protocol+"//"+i.host+t+e}for(;B.test(e);)e=e.replace(B,"");return e}function y(e,t){var i="",o=e.indexOf("#");-1!==o&&(i=e.substring(o),e=e.substring(0,o));var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push(r+"="+a(t[r]));return e+(W?"#":-1==e.indexOf("?")?"?":"&")+n.join("&")+i}function b(e){return"undefined"==typeof e}function w(e,t,i){var o;for(var n in t)t.hasOwnProperty(n)&&(n in e?(o=t[n],"object"==typeof o?w(e[n],o,i):i||(e[n]=t[n])):e[n]=t[n]);return e}function x(){var e=t.body.appendChild(t.createElement("form")),i=e.appendChild(t.createElement("input"));i.name=U+"TEST"+D,_=i!==e.elements[i.name],t.body.removeChild(e)}function I(e){b(_)&&x();var i;_?i=t.createElement('<iframe name="'+e.props.name+'"/>'):(i=t.createElement("IFRAME"),i.name=e.props.name),i.id=i.name=e.props.name,delete e.props.name,"string"==typeof e.container&&(e.container=t.getElementById(e.container)),e.container||(w(i.style,{position:"absolute",top:"-2000px",left:"0px"}),e.container=t.body);var o=e.props.src;if(e.props.src="javascript:false",w(i,e.props),i.border=i.frameBorder=0,i.allowTransparency=!0,e.container.appendChild(i),e.onLoad&&E(i,"load",e.onLoad),e.usePost){var n,a=e.container.appendChild(t.createElement("form"));if(a.target=i.name,a.action=o,a.method="POST","object"==typeof e.usePost)for(var r in e.usePost)e.usePost.hasOwnProperty(r)&&(_?n=t.createElement('<input name="'+r+'"/>'):(n=t.createElement("INPUT"),n.name=r),n.value=e.usePost[r],a.appendChild(n));a.submit(),a.parentNode.removeChild(a)}else i.src=o;return e.props.src=o,i}function k(e,t){"string"==typeof e&&(e=[e]);for(var i,o=e.length;o--;)if(i=e[o],i=new RegExp("^"==i.substr(0,1)?i:"^"+i.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),i.test(t))return!0;return!1}function P(o){var n,a=o.protocol;if(o.isHost=o.isHost||b(G.xdm_p),W=o.hash||!1,o.props||(o.props={}),o.isHost)o.remote=g(o.remote),o.channel=o.channel||"default"+D++,o.secret=Math.random().toString(16).substring(2),b(a)&&(a=v(i.href)==v(o.remote)?"4":r(e,"postMessage")||r(t,"postMessage")?"1":o.swf&&r(e,"ActiveXObject")&&l()?"6":"Gecko"===navigator.product&&"frameElement"in e&&-1==navigator.userAgent.indexOf("WebKit")?"5":o.remoteHelper?"2":"0");else if(o.channel=G.xdm_c.replace(/["'<>\\]/g,""),o.secret=G.xdm_s,o.remote=G.xdm_e.replace(/["'<>\\]/g,""),a=G.xdm_p,o.acl&&!k(o.acl,o.remote))throw new Error("Access denied for "+o.remote);switch(o.protocol=a,a){case"0":if(w(o,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),o.isHost){if(!o.local){for(var s,c=i.protocol+"//"+i.host,p=t.body.getElementsByTagName("img"),d=p.length;d--;)if(s=p[d],s.src.substring(0,c.length)===c){o.local=s.src;break}o.local||(o.local=e)}var m={xdm_c:o.channel,xdm_p:0};o.local===e?(o.usePolling=!0,o.useParent=!0,o.local=i.protocol+"//"+i.host+i.pathname+i.search,m.xdm_e=o.local,m.xdm_pa=1):m.xdm_e=g(o.local),o.container&&(o.useResize=!1,m.xdm_po=1),o.remote=y(o.remote,m)}else w(o,{channel:G.xdm_c,remote:G.xdm_e,useParent:!b(G.xdm_pa),usePolling:!b(G.xdm_po),useResize:o.useParent?!1:o.useResize});n=[new R.stack.HashTransport(o),new R.stack.ReliableBehavior({}),new R.stack.QueueBehavior({encode:!0,maxLength:4e3-o.remote.length}),new R.stack.VerifyBehavior({initiate:o.isHost})];break;case"1":n=[new R.stack.PostMessageTransport(o)];break;case"2":o.isHost&&(o.remoteHelper=g(o.remoteHelper)),n=[new R.stack.NameTransport(o),new R.stack.QueueBehavior,new R.stack.VerifyBehavior({initiate:o.isHost})];break;case"3":n=[new R.stack.NixTransport(o)];break;case"4":n=[new R.stack.SameOriginTransport(o)];break;case"5":n=[new R.stack.FrameElementTransport(o)];break;case"6":S||l(),n=[new R.stack.FlashTransport(o)]}return n.push(new R.stack.QueueBehavior({lazy:o.lazy,remove:!0})),n}function A(e){for(var t,i={incoming:function(e,t){this.up.incoming(e,t)},outgoing:function(e,t){this.down.outgoing(e,t)},callback:function(e){this.up.callback(e)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},o=0,n=e.length;n>o;o++)t=e[o],w(t,i,!0),0!==o&&(t.down=e[o-1]),o!==n-1&&(t.up=e[o+1]);return t}function O(e){e.up.down=e.down,e.down.up=e.up,e.up=e.down=null}var _,S,T,E,C,N=e,D=Math.floor(1e4*Math.random()),M=Function.prototype,j=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,B=/[\-\w]+\/\.\.\//,F=/([^:])\/\//g,L="",R={},q=e.easyXDM,U="easyXDM_",W=!1;if(r(e,"addEventListener"))E=function(e,t,i){e.addEventListener(t,i,!1)},C=function(e,t,i){e.removeEventListener(t,i,!1)};else{if(!r(e,"attachEvent"))throw new Error("Browser not supported");E=function(e,t,i){e.attachEvent("on"+t,i)},C=function(e,t,i){e.detachEvent("on"+t,i)}}var H,V=!1,J=[];if("readyState"in t?(H=t.readyState,V="complete"==H||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==H||"interactive"==H)):V=!!t.body,!V){if(r(e,"addEventListener"))E(t,"DOMContentLoaded",p);else if(E(t,"readystatechange",function(){"complete"==t.readyState&&p()}),t.documentElement.doScroll&&e===top){var z=function(){if(!V){try{t.documentElement.doScroll("left")}catch(e){return void o(z,1)}p()}};z()}E(e,"load",p)}var G=function(e){e=e.substring(1).split("&");for(var t,i={},o=e.length;o--;)t=e[o].split("="),i[t[0]]=n(t[1]);return i}(/xdm_e=/.test(i.search)?i.search:i.hash),X=function(){var e={},t={a:[1,2,3]},i='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(t).replace(/\s/g,"")===i?JSON:(Object.toJSON&&Object.toJSON(t).replace(/\s/g,"")===i&&(e.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(t=i.evalJSON(),t.a&&3===t.a.length&&3===t.a[2]&&(e.parse=function(e){return e.evalJSON()})),e.stringify&&e.parse?(X=function(){return e},e):null)};w(R,{version:"2.4.19.3",query:G,stack:{},apply:w,getJSONObject:X,whenReady:d,noConflict:u}),R.DomHelper={on:E,un:C,requiresJSON:function(i){s(e,"JSON")||t.write('<script type="text/javascript" src="'+i+'"></script>')}},function(){var e={};R.Fn={set:function(t,i){e[t]=i},get:function(t,i){if(e.hasOwnProperty(t)){var o=e[t];return i&&delete e[t],o}}}}(),R.Socket=function(e){var t=A(P(e).concat([{incoming:function(t,i){e.onMessage(t,i)},callback:function(t){e.onReady&&e.onReady(t)}}])),i=v(e.remote);this.origin=v(e.remote),this.destroy=function(){t.destroy()},this.postMessage=function(e){t.outgoing(e,i)},t.init()},R.Rpc=function(e,t){if(t.local)for(var i in t.local)if(t.local.hasOwnProperty(i)){var o=t.local[i];"function"==typeof o&&(t.local[i]={method:o})}var n=A(P(e).concat([new R.stack.RpcBehavior(this,t),{callback:function(t){e.onReady&&e.onReady(t)}}]));this.origin=v(e.remote),this.destroy=function(){n.destroy()},n.init()},R.stack.SameOriginTransport=function(e){var t,n,a,r;return t={outgoing:function(e,t,i){a(e),i&&i()},destroy:function(){n&&(n.parentNode.removeChild(n),n=null)},onDOMReady:function(){r=v(e.remote),e.isHost?(w(e.props,{src:y(e.remote,{xdm_e:i.protocol+"//"+i.host+i.pathname,xdm_c:e.channel,xdm_p:4}),name:U+e.channel+"_provider"}),n=I(e),R.Fn.set(e.channel,function(e){return a=e,o(function(){t.up.callback(!0)},0),function(e){t.up.incoming(e,r)}})):(a=m().Fn.get(e.channel,!0)(function(e){t.up.incoming(e,r)}),o(function(){t.up.callback(!0)},0))},init:function(){d(t.onDOMReady,t)}}},R.stack.FlashTransport=function(e){function n(e,t){o(function(){s.up.incoming(e,l)},0)}function r(i){var o=e.swf+"?host="+e.isHost,n="easyXDM_swf_"+Math.floor(1e4*Math.random());R.Fn.set("flash_loaded"+i.replace(/[\-.]/g,"_"),function(){R.stack.FlashTransport[i].swf=p=m.firstChild;for(var e=R.stack.FlashTransport[i].queue,t=0;t<e.length;t++)e[t]();e.length=0}),e.swfContainer?m="string"==typeof e.swfContainer?t.getElementById(e.swfContainer):e.swfContainer:(m=t.createElement("div"),w(m.style,T&&e.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),t.body.appendChild(m));var r="callback=flash_loaded"+a(i.replace(/[\-.]/g,"_"))+"&proto="+N.location.protocol+"&domain="+a(h(N.location.href))+"&port="+a(f(N.location.href))+"&ns="+a(L);m.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+n+"' data='"+o+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+o+"'></param><param name='flashvars' value='"+r+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+r+"' allowScriptAccess='always' wmode='transparent' src='"+o+"' height='1' width='1'></embed></object>"}var s,c,l,p,m;return s={outgoing:function(t,i,o){p.postMessage(e.channel,t.toString()),o&&o()},destroy:function(){try{p.destroyChannel(e.channel)}catch(t){}p=null,c&&(c.parentNode.removeChild(c),c=null)},onDOMReady:function(){l=e.remote,R.Fn.set("flash_"+e.channel+"_init",function(){o(function(){s.up.callback(!0)})}),R.Fn.set("flash_"+e.channel+"_onMessage",n),e.swf=g(e.swf);var t=h(e.swf),a=function(){R.stack.FlashTransport[t].init=!0,p=R.stack.FlashTransport[t].swf,p.createChannel(e.channel,e.secret,v(e.remote),e.isHost),e.isHost&&(T&&e.swfNoThrottle&&w(e.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),w(e.props,{src:y(e.remote,{xdm_e:v(i.href),xdm_c:e.channel,xdm_p:6,xdm_s:e.secret}),name:U+e.channel+"_provider"}),c=I(e))};R.stack.FlashTransport[t]&&R.stack.FlashTransport[t].init?a():R.stack.FlashTransport[t]?R.stack.FlashTransport[t].queue.push(a):(R.stack.FlashTransport[t]={queue:[a]},r(t))},init:function(){d(s.onDOMReady,s)}}},R.stack.PostMessageTransport=function(t){function n(e){if(e.origin)return v(e.origin);if(e.uri)return v(e.uri);if(e.domain)return i.protocol+"//"+e.domain;throw"Unable to retrieve the origin of the event"}function a(e){var i=n(e);i==l&&e.data.substring(0,t.channel.length+1)==t.channel+" "&&r.up.incoming(e.data.substring(t.channel.length+1),i)}var r,s,c,l;return r={outgoing:function(e,i,o){c.postMessage(t.channel+" "+e,i||l),o&&o()},destroy:function(){C(e,"message",a),s&&(c=null,s.parentNode.removeChild(s),s=null)},onDOMReady:function(){if(l=v(t.remote),t.isHost){var n=function(i){i.data==t.channel+"-ready"&&(c="postMessage"in s.contentWindow?s.contentWindow:s.contentWindow.document,C(e,"message",n),E(e,"message",a),o(function(){r.up.callback(!0)},0))};E(e,"message",n),w(t.props,{src:y(t.remote,{xdm_e:v(i.href),xdm_c:t.channel,xdm_p:1}),name:U+t.channel+"_provider"}),s=I(t)}else E(e,"message",a),c="postMessage"in e.parent?e.parent:e.parent.document,c.postMessage(t.channel+"-ready",l),o(function(){r.up.callback(!0)},0)},init:function(){d(r.onDOMReady,r)}}},R.stack.FrameElementTransport=function(n){var a,r,s,c;return a={outgoing:function(e,t,i){s.call(this,e),i&&i()},destroy:function(){r&&(r.parentNode.removeChild(r),r=null)},onDOMReady:function(){c=v(n.remote),n.isHost?(w(n.props,{src:y(n.remote,{xdm_e:v(i.href),xdm_c:n.channel,xdm_p:5}),name:U+n.channel+"_provider"}),r=I(n),r.fn=function(e){return delete r.fn,s=e,o(function(){a.up.callback(!0)},0),function(e){a.up.incoming(e,c)}}):(t.referrer&&v(t.referrer)!=G.xdm_e&&(e.top.location=G.xdm_e),s=e.frameElement.fn(function(e){a.up.incoming(e,c)}),a.up.callback(!0))},init:function(){d(a.onDOMReady,a)}}},R.stack.NameTransport=function(e){function t(t){var i=e.remoteHelper+(s?"#_3":"#_2")+e.channel;c.contentWindow.sendMessage(t,i)}function i(){s?2!==++p&&s||r.up.callback(!0):(t("ready"),r.up.callback(!0))}function n(e){r.up.incoming(e,u)}function a(){m&&o(function(){m(!0)},0)}var r,s,c,l,p,m,u,h;return r={outgoing:function(e,i,o){m=o,t(e)},destroy:function(){c.parentNode.removeChild(c),c=null,s&&(l.parentNode.removeChild(l),l=null)},onDOMReady:function(){s=e.isHost,p=0,u=v(e.remote),e.local=g(e.local),s?(R.Fn.set(e.channel,function(t){s&&"ready"===t&&(R.Fn.set(e.channel,n),i())}),h=y(e.remote,{xdm_e:e.local,xdm_c:e.channel,xdm_p:2}),w(e.props,{src:h+"#"+e.channel,name:U+e.channel+"_provider"}),l=I(e)):(e.remoteHelper=e.remote,R.Fn.set(e.channel,n));var t=function(){var n=c||this;C(n,"load",t),R.Fn.set(e.channel+"_load",a),function r(){"function"==typeof n.contentWindow.sendMessage?i():o(r,50)}()};c=I({props:{src:e.local+"#_4"+e.channel},onLoad:t})},init:function(){d(r.onDOMReady,r)}}},R.stack.HashTransport=function(t){function i(e){if(f){var i=t.remote+"#"+u++ +"_"+e;(c||!g?f.contentWindow:f).location=i}}function n(e){m=e,s.up.incoming(m.substring(m.indexOf("_")+1),y)}function a(){if(h){var e=h.location.href,t="",i=e.indexOf("#");-1!=i&&(t=e.substring(i)),t&&t!=m&&n(t)}}function r(){l=setInterval(a,p)}var s,c,l,p,m,u,h,f,g,y;return s={outgoing:function(e,t){i(e)},destroy:function(){e.clearInterval(l),(c||!g)&&f.parentNode.removeChild(f),f=null},onDOMReady:function(){if(c=t.isHost,p=t.interval,m="#"+t.channel,u=0,g=t.useParent,y=v(t.remote),c){if(w(t.props,{src:t.remote,name:U+t.channel+"_provider"}),g)t.onLoad=function(){h=e,r(),s.up.callback(!0)};else{var i=0,n=t.delay/50;!function a(){if(++i>n)throw new Error("Unable to reference listenerwindow");try{h=f.contentWindow.frames[U+t.channel+"_consumer"]}catch(e){}h?(r(),s.up.callback(!0)):o(a,50)}()}f=I(t)}else h=e,r(),g?(f=parent,s.up.callback(!0)):(w(t,{props:{src:t.remote+"#"+t.channel+new Date,name:U+t.channel+"_consumer"},onLoad:function(){s.up.callback(!0)}}),f=I(t))},init:function(){d(s.onDOMReady,s)}}},R.stack.ReliableBehavior=function(e){var t,i,o=0,n=0,a="";return t={incoming:function(e,r){var s=e.indexOf("_"),c=e.substring(0,s).split(",");e=e.substring(s+1),c[0]==o&&(a="",i&&i(!0)),e.length>0&&(t.down.outgoing(c[1]+","+o+"_"+a,r),n!=c[1]&&(n=c[1],t.up.incoming(e,r)))},outgoing:function(e,r,s){a=e,i=s,t.down.outgoing(n+","+ ++o+"_"+e,r)}}},R.stack.QueueBehavior=function(e){function t(){if(e.remove&&0===s.length)return void O(i);if(!c&&0!==s.length&&!r){c=!0;var n=s.shift();i.down.outgoing(n.data,n.origin,function(e){c=!1,n.callback&&o(function(){n.callback(e)},0),t()})}}var i,r,s=[],c=!0,l="",p=0,d=!1,m=!1;return i={init:function(){b(e)&&(e={}),e.maxLength&&(p=e.maxLength,m=!0),e.lazy?d=!0:i.down.init()},callback:function(e){c=!1;var o=i.up;t(),o.callback(e)},incoming:function(t,o){if(m){var a=t.indexOf("_"),r=parseInt(t.substring(0,a),10);l+=t.substring(a+1),0===r&&(e.encode&&(l=n(l)),i.up.incoming(l,o),l="")}else i.up.incoming(t,o)},outgoing:function(o,n,r){e.encode&&(o=a(o));var c,l=[];if(m){for(;0!==o.length;)c=o.substring(0,p),o=o.substring(c.length),l.push(c);for(;c=l.shift();)s.push({data:l.length+"_"+c,origin:n,callback:0===l.length?r:null})}else s.push({data:o,origin:n,callback:r});d?i.down.init():t()},destroy:function(){r=!0,i.down.destroy()}}},R.stack.VerifyBehavior=function(e){function t(){o=Math.random().toString(16).substring(2),i.down.outgoing(o)}var i,o,n;return i={incoming:function(a,r){var s=a.indexOf("_");-1===s?a===o?i.up.callback(!0):n||(n=a,e.initiate||t(),i.down.outgoing(a)):a.substring(0,s)===n&&i.up.incoming(a.substring(s+1),r)},outgoing:function(e,t,n){i.down.outgoing(o+"_"+e,t,n)},callback:function(i){e.initiate&&t()}}},R.stack.RpcBehavior=function(e,t){function i(e){e.jsonrpc="2.0",a.down.outgoing(r.stringify(e))}function o(e,t){var o=Array.prototype.slice;return function(){var n,a=arguments.length,r={method:t};a>0&&"function"==typeof arguments[a-1]?(a>1&&"function"==typeof arguments[a-2]?(n={success:arguments[a-2],error:arguments[a-1]},r.params=o.call(arguments,0,a-2)):(n={success:arguments[a-1]},r.params=o.call(arguments,0,a-1)),l[""+ ++s]=n,r.id=s):r.params=o.call(arguments,0),e.namedParams&&1===r.params.length&&(r.params=r.params[0]),i(r)}}function n(e,t,o,n){if(!o)return void(t&&i({id:t,error:{code:-32601,message:"Procedure not found."}}));var a,r;t?(a=function(e){a=M,i({id:t,result:e})},r=function(e,o){r=M;var n={id:t,error:{code:-32099,message:e}};o&&(n.error.data=o),i(n)}):a=r=M,c(n)||(n=[n]);try{var s=o.method.apply(o.scope,n.concat([a,r]));b(s)||a(s)}catch(l){r(l.message)}}var a,r=t.serializer||X(),s=0,l={};return a={incoming:function(e,o){var a=r.parse(e);if(a.method)t.handle?t.handle(a,i):n(a.method,a.id,t.local[a.method],a.params);else{var s=l[a.id];a.error?s&&s.error&&s.error(a.error):s&&s.success&&s.success(a.result),delete l[a.id]}},init:function(){if(t.remote)for(var i in t.remote)t.remote.hasOwnProperty(i)&&(e[i]=o(t.remote[i],i));a.down.init()},destroy:function(){for(var i in t.remote)t.remote.hasOwnProperty(i)&&e.hasOwnProperty(i)&&delete e[i];a.down.destroy()}}},N.easyXDM=R}(e,t,i,e.setTimeout,decodeURIComponent,encodeURIComponent)},window.piximedia.injectEasyXDM=function(e,t,i){window.piximedia._.injectEasyXDM.call(e,e,t,i)},window.piximedia.injectEasyXDM(window,document,window.location),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(e){return 10>e?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var i,o,n,a,r,s=gap,c=t[e];switch(c&&"object"==typeof c&&"function"==typeof c.toJSON&&(c=c.toJSON(e)),"function"==typeof rep&&(c=rep.call(t,e,c)),typeof c){case"string":return quote(c);case"number":return isFinite(c)?String(c):"null";case"boolean":case"null":return String(c);case"object":if(!c)return"null";if(gap+=indent,r=[],"[object Array]"===Object.prototype.toString.apply(c)){for(a=c.length,i=0;a>i;i+=1)r[i]=str(i,c)||"null";return n=0===r.length?"[]":gap?"[\n"+gap+r.join(",\n"+gap)+"\n"+s+"]":"["+r.join(",")+"]",gap=s,n}if(rep&&"object"==typeof rep)for(a=rep.length,i=0;a>i;i+=1)"string"==typeof rep[i]&&(o=rep[i],n=str(o,c),n&&r.push(quote(o)+(gap?": ":":")+n));else for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(n=str(o,c),n&&r.push(quote(o)+(gap?": ":":")+n));return n=0===r.length?"{}":gap?"{\n"+gap+r.join(",\n"+gap)+"\n"+s+"}":"{"+r.join(",")+"}",gap=s,n}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof JSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(e,t,i){var o;if(gap="",indent="","number"==typeof i)for(o=0;i>o;o+=1)indent+=" ";else"string"==typeof i&&(indent=i);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return str("",{"":e})}),"function"!=typeof JSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,JSON.parse=function(text,reviver){function walk(e,t){var i,o,n=e[t];if(n&&"object"==typeof n)for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(o=walk(n,i),void 0!==o?n[i]=o:delete n[i]);return reviver.call(e,t,n)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),function(){"use strict";function e(e){t.console&&t.console.log&&(t.console.log.apply?t.console.log.apply(t.console,arguments):t.console.log(e))}var t=window;t.piximedia.easyXDM=t.easyXDM.noConflict("piximedia"),t.piximedia.Lib={};var i="callbackLib";if(t._piximedia&&t._piximedia[i]){var o=t._piximedia[i];t._piximedia[i]=void 0;for(var n=0;n<o.length;n++){var a=o[n];if(a.window)try{a.window.piximedia=a.window.piximedia||t.piximedia}catch(r){}if(a.windows)for(var s=0;s<a.windows.length;s++){var c=a.windows[s];try{c.piximedia=c.piximedia||t.piximedia}catch(r){}}try{a()}catch(r){e("Error in callback: "+r)}}}}();