/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
(function(c){var d={vertical:false,rtl:false,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},b=false;c(window).bind("load.jcarousel",function(){b=true});c.jcarousel=function(l,g){this.options=c.extend({},d,g||{});this.locked=false;this.autoStopped=false;this.container=null;this.clip=null;this.list=null;this.buttonNext=null;this.buttonPrev=null;this.buttonNextState=null;this.buttonPrevState=null;if(!g||g.rtl===undefined){this.options.rtl=(c(l).attr("dir")||c("html").attr("dir")||"").toLowerCase()=="rtl"}this.wh=!this.options.vertical?"width":"height";this.lt=!this.options.vertical?(this.options.rtl?"right":"left"):"top";var q="",n=l.className.split(" ");for(var k=0;k<n.length;k++){if(n[k].indexOf("jcarousel-skin")!=-1){c(l).removeClass(n[k]);q=n[k];break}}if(l.nodeName.toUpperCase()=="UL"||l.nodeName.toUpperCase()=="OL"){this.list=c(l);this.clip=this.list.parents(".jcarousel-clip");this.container=this.list.parents(".jcarousel-container")}else{this.container=c(l);this.list=this.container.find("ul,ol").eq(0);this.clip=this.container.find(".jcarousel-clip")}if(this.clip.size()===0){this.clip=this.list.wrap("<div></div>").parent()}if(this.container.size()===0){this.container=this.clip.wrap("<div></div>").parent()}if(q!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1){this.container.wrap('<div class=" '+q+'"></div>')}this.buttonPrev=c(".jcarousel-prev",this.container);if(this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null){this.buttonPrev=c(this.options.buttonPrevHTML).appendTo(this.container)}this.buttonPrev.addClass(this.className("jcarousel-prev"));this.buttonNext=c(".jcarousel-next",this.container);if(this.buttonNext.size()===0&&this.options.buttonNextHTML!==null){this.buttonNext=c(this.options.buttonNextHTML).appendTo(this.container)}this.buttonNext.addClass(this.className("jcarousel-next"));this.clip.addClass(this.className("jcarousel-clip")).css({overflow:"hidden",position:"relative"});this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css((this.options.rtl?"right":"left"),0);this.container.addClass(this.className("jcarousel-container")).css({position:"relative"});if(!this.options.vertical&&this.options.rtl){this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl")}var m=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null;var p=this.list.children("li");var r=this;if(p.size()>0){var f=0,h=this.options.offset;p.each(function(){r.format(this,h++);f+=r.dimension(this,m)});this.list.css(this.wh,f+"px");if(!g||g.size===undefined){this.options.size=p.size()}}this.container.css("display","block");this.funcNext=function(){r.next()};this.funcPrev=function(){r.prev()};this.funcResize=function(){if(r.resizeTimer){clearTimeout(r.resizeTimer)}r.resizeTimer=setTimeout(function(){r.reload()},100)};if(this.options.initCallback!==null){this.options.initCallback(this,"init")}this.setup()};var a=c.jcarousel;a.fn=a.prototype={jcarousel:"0.2.8"};a.fn.extend=a.extend=c.extend;a.fn.extend({setup:function(){this.first=null;this.last=null;this.prevFirst=null;this.prevLast=null;this.animating=false;this.timer=null;this.resizeTimer=null;this.tail=null;this.inTail=false;if(this.locked){return}this.list.css(this.lt,this.pos(this.options.offset)+"px");var e=this.pos(this.options.start,true);this.prevFirst=this.prevLast=null;this.animate(e,false);c(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize);if(this.options.setupCallback!==null){this.options.setupCallback(this)}},reset:function(){this.list.empty();this.list.css(this.lt,"0px");this.list.css(this.wh,"10px");if(this.options.initCallback!==null){this.options.initCallback(this,"reset")}this.setup()},reload:function(){if(this.tail!==null&&this.inTail){this.list.css(this.lt,a.intval(this.list.css(this.lt))+this.tail)}this.tail=null;this.inTail=false;if(this.options.reloadCallback!==null){this.options.reloadCallback(this)}if(this.options.visible!==null){var g=this;var h=Math.ceil(this.clipping()/this.options.visible),f=0,e=0;this.list.children("li").each(function(j){f+=g.dimension(this,h);if(j+1<g.first){e=f}});this.list.css(this.wh,f+"px");this.list.css(this.lt,-e+"px")}this.scroll(this.first,false)},lock:function(){this.locked=true;this.buttons()},unlock:function(){this.locked=false;this.buttons()},size:function(e){if(e!==undefined){this.options.size=e;if(!this.locked){this.buttons()}}return this.options.size},has:function(g,h){if(h===undefined||!h){h=g}if(this.options.size!==null&&h>this.options.size){h=this.options.size}for(var f=g;f<=h;f++){var k=this.get(f);if(!k.length||k.hasClass("jcarousel-item-placeholder")){return false}}return true},get:function(e){return c(">.jcarousel-item-"+e,this.list)},add:function(l,q){var m=this.get(l),h=0,g=c(q);if(m.length===0){var p,k=a.intval(l);m=this.create(l);while(true){p=this.get(--k);if(k<=0||p.length){if(k<=0){this.list.prepend(m)}else{p.after(m)}break}}}else{h=this.dimension(m)}if(g.get(0).nodeName.toUpperCase()=="LI"){m.replaceWith(g);m=g}else{m.empty().append(q)}this.format(m.removeClass(this.className("jcarousel-item-placeholder")),l);var o=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null;var f=this.dimension(m,o)-h;if(l>0&&l<this.first){this.list.css(this.lt,a.intval(this.list.css(this.lt))-f+"px")}this.list.css(this.wh,a.intval(this.list.css(this.wh))+f+"px");return m},remove:function(f){var g=this.get(f);if(!g.length||(f>=this.first&&f<=this.last)){return}var h=this.dimension(g);if(f<this.first){this.list.css(this.lt,a.intval(this.list.css(this.lt))+h+"px")}g.remove();this.list.css(this.wh,a.intval(this.list.css(this.wh))-h+"px")},next:function(){if(this.tail!==null&&!this.inTail){this.scrollTail(false)}else{this.scroll(((this.options.wrap=="both"||this.options.wrap=="last")&&this.options.size!==null&&this.last==this.options.size)?1:this.first+this.options.scroll)}},prev:function(){if(this.tail!==null&&this.inTail){this.scrollTail(true)}else{this.scroll(((this.options.wrap=="both"||this.options.wrap=="first")&&this.options.size!==null&&this.first==1)?this.options.size:this.first-this.options.scroll)}},scrollTail:function(e){if(this.locked||this.animating||!this.tail){return}this.pauseAuto();var f=a.intval(this.list.css(this.lt));f=!e?f-this.tail:f+this.tail;this.inTail=!e;this.prevFirst=this.first;this.prevLast=this.last;this.animate(f)},scroll:function(f,e){if(this.locked||this.animating){return}this.pauseAuto();this.animate(this.pos(f),e)},pos:function(C,k){var n=a.intval(this.list.css(this.lt));if(this.locked||this.animating){return n}if(this.options.wrap!="circular"){C=C<1?1:(this.options.size&&C>this.options.size?this.options.size:C)}var z=this.first>C;var E=this.options.wrap!="circular"&&this.first<=1?1:this.first;var H=z?this.get(E):this.get(this.last);var B=z?E:E-1;var F=null,A=0,w=false,G=0,D;while(z?--B>=C:++B<C){F=this.get(B);w=!F.length;if(F.length===0){F=this.create(B).addClass(this.className("jcarousel-item-placeholder"));H[z?"before":"after"](F);if(this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(B<=0||B>this.options.size)){D=this.get(this.index(B));if(D.length){F=this.add(B,D.clone(true))}}}H=F;G=this.dimension(F);if(w){A+=G}if(this.first!==null&&(this.options.wrap=="circular"||(B>=1&&(this.options.size===null||B<=this.options.size)))){n=z?n+G:n-G}}var s=this.clipping(),u=[],h=0,t=0;H=this.get(C-1);B=C;while(++h){F=this.get(B);w=!F.length;if(F.length===0){F=this.create(B).addClass(this.className("jcarousel-item-placeholder"));if(H.length===0){this.list.prepend(F)}else{H[z?"before":"after"](F)}if(this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(B<=0||B>this.options.size)){D=this.get(this.index(B));if(D.length){F=this.add(B,D.clone(true))}}}H=F;G=this.dimension(F);if(G===0){throw new Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...")}if(this.options.wrap!="circular"&&this.options.size!==null&&B>this.options.size){u.push(F)}else{if(w){A+=G}}t+=G;if(t>=s){break}B++}for(var r=0;r<u.length;r++){u[r].remove()}if(A>0){this.list.css(this.wh,this.dimension(this.list)+A+"px");if(z){n-=A;this.list.css(this.lt,a.intval(this.list.css(this.lt))-A+"px")}}var q=C+h-1;if(this.options.wrap!="circular"&&this.options.size&&q>this.options.size){q=this.options.size}if(B>q){h=0;B=q;t=0;while(++h){F=this.get(B--);if(!F.length){break}t+=this.dimension(F);if(t>=s){break}}}var o=q-h+1;if(this.options.wrap!="circular"&&o<1){o=1}if(this.inTail&&z){n+=this.tail;this.inTail=false}this.tail=null;if(this.options.wrap!="circular"&&q==this.options.size&&(q-h+1)>=1){var y=a.intval(this.get(q).css(!this.options.vertical?"marginRight":"marginBottom"));if((t-y)>s){this.tail=t-s-y}}if(k&&C===this.options.size&&this.tail){n-=this.tail;this.inTail=true}while(C-->o){n+=this.dimension(this.get(C))}this.prevFirst=this.first;this.prevLast=this.last;this.first=o;this.last=q;return n},animate:function(i,e){if(this.locked||this.animating){return}this.animating=true;var f=this;var g=function(){f.animating=false;if(i===0){f.list.css(f.lt,0)}if(!f.autoStopped&&(f.options.wrap=="circular"||f.options.wrap=="both"||f.options.wrap=="last"||f.options.size===null||f.last<f.options.size||(f.last==f.options.size&&f.tail!==null&&!f.inTail))){f.startAuto()}f.buttons();f.notify("onAfterAnimation");if(f.options.wrap=="circular"&&f.options.size!==null){for(var k=f.prevFirst;k<=f.prevLast;k++){if(k!==null&&!(k>=f.first&&k<=f.last)&&(k<1||k>f.options.size)){f.remove(k)}}}};this.notify("onBeforeAnimation");if(!this.options.animation||e===false){this.list.css(this.lt,i+"px");g()}else{var j=!this.options.vertical?(this.options.rtl?{right:i}:{left:i}):{top:i};var h={duration:this.options.animation,easing:this.options.easing,complete:g};if(c.isFunction(this.options.animationStepCallback)){h.step=this.options.animationStepCallback}this.list.animate(j,h)}},startAuto:function(f){if(f!==undefined){this.options.auto=f}if(this.options.auto===0){return this.stopAuto()}if(this.timer!==null){return}this.autoStopped=false;var e=this;this.timer=window.setTimeout(function(){e.next()},this.options.auto*1000)},stopAuto:function(){this.pauseAuto();this.autoStopped=true},pauseAuto:function(){if(this.timer===null){return}window.clearTimeout(this.timer);this.timer=null},buttons:function(g,f){if(g==null){g=!this.locked&&this.options.size!==0&&((this.options.wrap&&this.options.wrap!="first")||this.options.size===null||this.last<this.options.size);if(!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size){g=this.tail!==null&&!this.inTail}}if(f==null){f=!this.locked&&this.options.size!==0&&((this.options.wrap&&this.options.wrap!="last")||this.first>1);if(!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!==null&&this.first==1){f=this.tail!==null&&this.inTail}}var e=this;if(this.buttonNext.size()>0){this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext);if(g){this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext)}this.buttonNext[g?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",g?false:true);if(this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=g){this.buttonNext.each(function(){e.options.buttonNextCallback(e,this,g)}).data("jcarouselstate",g)}}else{if(this.options.buttonNextCallback!==null&&this.buttonNextState!=g){this.options.buttonNextCallback(e,null,g)}}if(this.buttonPrev.size()>0){this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev);if(f){this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev)}this.buttonPrev[f?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",f?false:true);if(this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=f){this.buttonPrev.each(function(){e.options.buttonPrevCallback(e,this,f)}).data("jcarouselstate",f)}}else{if(this.options.buttonPrevCallback!==null&&this.buttonPrevState!=f){this.options.buttonPrevCallback(e,null,f)}}this.buttonNextState=g;this.buttonPrevState=f},notify:function(e){var f=this.prevFirst===null?"init":(this.prevFirst<this.first?"next":"prev");this.callback("itemLoadCallback",e,f);if(this.prevFirst!==this.first){this.callback("itemFirstInCallback",e,f,this.first);this.callback("itemFirstOutCallback",e,f,this.prevFirst)}if(this.prevLast!==this.last){this.callback("itemLastInCallback",e,f,this.last);this.callback("itemLastOutCallback",e,f,this.prevLast)}this.callback("itemVisibleInCallback",e,f,this.first,this.last,this.prevFirst,this.prevLast);this.callback("itemVisibleOutCallback",e,f,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(j,m,e,k,h,g,f){if(this.options[j]==null||(typeof this.options[j]!="object"&&m!="onAfterAnimation")){return}var n=typeof this.options[j]=="object"?this.options[j][m]:this.options[j];if(!c.isFunction(n)){return}var o=this;if(k===undefined){n(o,e,m)}else{if(h===undefined){this.get(k).each(function(){n(o,this,k,e,m)})}else{var p=function(q){o.get(q).each(function(){n(o,this,q,e,m)})};for(var l=k;l<=h;l++){if(l!==null&&!(l>=g&&l<=f)){p(l)}}}}},create:function(e){return this.format('<li><div class="loader_anim"><img src="/images/ajax-loader.gif" alt="Loading..." title="Loading..."/><br/>Loading...</div></li>',e)},format:function(k,h){k=c(k);var g=k.get(0).className.split(" ");for(var f=0;f<g.length;f++){if(g[f].indexOf("jcarousel-")!=-1){k.removeClass(g[f])}}k.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+h)).css({"float":(this.options.rtl?"right":"left"),"list-style":"none"}).attr("jcarouselindex",h);return k},className:function(e){return e+" "+e+(!this.options.vertical?"-horizontal":"-vertical")},dimension:function(h,i){var g=c(h);if(i==null){return !this.options.vertical?(g.outerWidth(true)||a.intval(this.options.itemFallbackDimension)):(g.outerHeight(true)||a.intval(this.options.itemFallbackDimension))}else{var f=!this.options.vertical?i-a.intval(g.css("marginLeft"))-a.intval(g.css("marginRight")):i-a.intval(g.css("marginTop"))-a.intval(g.css("marginBottom"));c(g).css(this.wh,f+"px");return this.dimension(g)}},clipping:function(){return !this.options.vertical?this.clip[0].offsetWidth-a.intval(this.clip.css("borderLeftWidth"))-a.intval(this.clip.css("borderRightWidth")):this.clip[0].offsetHeight-a.intval(this.clip.css("borderTopWidth"))-a.intval(this.clip.css("borderBottomWidth"))},index:function(e,f){if(f==null){f=this.options.size}return Math.round((((e-1)/f)-Math.floor((e-1)/f))*f)+1}});a.extend({defaults:function(e){return c.extend(d,e||{})},intval:function(e){e=parseInt(e,10);return isNaN(e)?0:e},windowLoaded:function(){b=true}});c.fn.jcarousel=function(g){if(typeof g=="string"){var e=c(this).data("jcarousel"),f=Array.prototype.slice.call(arguments,1);return e[g].apply(e,f)}else{return this.each(function(){var h=c(this).data("jcarousel");if(h){if(g){c.extend(h.options,g)}h.reload()}else{c(this).data("jcarousel",new a(this,g))}})}}})(jQuery);FKART.ui.Carousel=function(p){var y={columns:5,rows:1,columnsperslide:5,buttonsonside:false,allowdeletion:false,removeonerror:true,buttonOverlap:false,cssClass:"",bottomgap:0,vertical:false,alwaysshowbuttons:false};var K=$.extend({},y,p);var e=this;var h=$(p.content);var z,A,n,r,f,C,j,B,u;var L=false,i=true,k=true;var m=$(".ccarousel-item:visible",h);var E=false;var I=0;var F=K.columns;var o=function(){z=$($dc("fk-ui-ccarousel-container "+K.cssClass,"div"));A=$($dc("ccarousel-clip","div"));n=$($dc("ccarousel-wrapper","div"));f=$($dc("ccarousel-prev","a"));C=$($dc("ccarousel-next","a"));u=$($dc("arrow","div"));if(m.length==0){if(K.removeonerror==true){$(e).trigger("error")}else{return}}var M=h.parent();h.appendTo(n);n.appendTo(A);z.prependTo(M);$(".ccarousel.nojs").removeClass("nojs");if(m.length<=K.columns&&!K.alwaysshowbuttons){k=false}if(K.vertical){z.addClass("overlapped");f.addClass("onTop").appendTo(z);A.appendTo(z);C.addClass("onBottom").appendTo(z);A.css({height:z.height()})}else{if(!K.buttonsonside){r=$($dc("ccarousel-buttons","div"));f.appendTo(r);C.appendTo(r);A.appendTo(z);if(k){r.appendTo(z)}}else{f.addClass("onside").appendTo(z);A.appendTo(z);C.addClass("onside").appendTo(z);A.css({width:z.width(),"float":"left"});if(k){if(K.buttonOverlap){A.css({width:z.width()});C.addClass("overlapped");f.addClass("overlapped");z.addClass("overlapped")}else{A.css({width:z.width()-f.width()-C.width()})}}}}g();E=true};var t=function(){if(K.vertical){B=Math.floor((A.height()-(K.bottomgap*(K.columns-1)))/K.columns);m.css({height:B,"margin-bottom":K.bottomgap});n.css({height:m.length*B+(K.bottomgap*(K.columns-1))})}else{j=Math.floor(A.width()/K.columns);m.css({width:j});if(K.pagination){m.find(".carousel-item").css({width:j/K.rows})}n.css({width:m.length*j})}};var l=function(){t();C.bind("click",D);f.bind("click",s)};var D=function(){I+=K.columnsperslide;if(I>=m.length-K.columns){I=m.length-K.columns}if(I<=0){I=0}c(I);$(e).trigger("nextSlide",[m.slice(F,F+K.columnsperslide)]);F+=K.columnsperslide};var s=function(){$(e).trigger("prevSlide");I-=K.columnsperslide;if(I<=0){I=0}c(I);$(e).trigger("afterPrevSlide");F-=K.columnsperslide;$(e).trigger("lazyPrevSlide",[m.slice(F-K.columnsperslide,F)])};var c=function(M){if(K.vertical){n.css({top:-(M*(B+K.bottomgap))})}else{n.css({left:-M*j})}g()};var H=function(M){if(typeof M==="number"&&M>=0&&M<=m.length-K.columns){I=M;c(M);F=I+K.columns}};var g=function(){k=true;if(m.length<=K.columns&&!K.alwaysshowbuttons){k=false}L=(I>0);i=(I+K.columns<m.length);if(k){f.show();C.show();if(L){f.removeClass("disabled")}else{f.addClass("disabled")}if(i){C.removeClass("disabled")}else{C.addClass("disabled")}}else{f.hide();C.hide()}};var q=function(){m=$(".ccarousel-item:visible",h);I=0;c(I)};var b=function(){if(E){return}m=$(".ccarousel-item:visible",h);G();I=0;c(I)};var J=function(){$.unbind();z.remove()};var v=function(){return z.height()};var G=function(){o();l()};var x=function(){var M=[];for(var N=0;N<K.columns;N++){M.push(I+N)}return M};var w=function(){return m};var a=function(){return parseInt(I/K.columnsperslide)};var d=function(){return j};return({init:G,destroy:J,bindEvent:function(M,N){$(e).bind(M,N)},unbindEvent:function(M,N){$(e).unbind(M,N)},getContainer:function(){return z},settings:K,getHeight:v,reset:q,reinit:b,next:D,prev:s,jumpTo:H,getCurrentItems:x,getAllItems:w,getCurrentColumn:a,getItemWidth:d})};FKART.ui.LazyCarousel=function(c){var g=new FKART.ui.Carousel(c),b;var f=g.init;var h=function(){f();b=g.getContainer();e($(".ccarousel",b).children("li.ccarousel-item").slice(0,g.settings.columns));g.bindEvent("nextSlide",function(j,i){e(i)});g.bindEvent("lazyPrevSlide",function(i,j){e(j)})};var a=function(l){if(typeof l==="number"&&l>=0&&l<g.getAllItems().length){g.jumpTo(l);var k=$(g.getAllItems()[l]);k=k.find("img");for(var j=0;j<k.length;j++){if(k[j].hasAttribute("data-carousel-src")){k[j].setAttribute("src",k[j].getAttribute("data-carousel-src"));k[j].removeAttribute("data-carousel-src")}}}};var e=function(i){$("img",i).each(function(){var j=$(this);j.attr("src",j.attr("data-carousel-src"));j.removeAttr("data-carousel-src")})};var d=function(){g.reset();var i=$(".ccarousel",b).children("li.ccarousel-item");e(i)};return({carousel:g,init:h,reset:d,jumpTo:a})};FKART.ui.PaginatedCarousel=function(n){var m=new FKART.ui.Carousel(n),b,f;var d=m.init;var a=[];var j=[];var g=false;var l=this;var k=function(){if(!n.formPaginationUrl){n.errorCallback()}else{d();b=m.getContainer();i($(".ccarousel",b).children("li.ccarousel-item").slice(0,m.settings.columns));m.bindEvent("nextSlide",function(p,o){if(n.pagination){c(o)}i(o)});m.bindEvent("lazyPrevSlide",function(p,q){i(q);var o=m.getCurrentColumn();if(j.indexOf(o)!==-1&&g){f.hide();g=false}})}};var c=function(o){var p=m.getCurrentColumn();if(j.indexOf(p)===-1&&a.indexOf(p)===-1){a.push(p);if(!f){f=new FKART.ui.Loader({size:"medium",renderInside:b,cssCls:"reco-loader",msg:"Loading..."})}if(!g){f.show();g=true}call_url=n.formPaginationUrl(o);$.get(call_url,function(q){j.push(p);a.pop();o.html(q);o.find(".carousel-item").css({width:m.getItemWidth()/n.rows});n.afterLoadCallback();if(a.length===0){f.hide();g=false}}).fail(function(){j.push(p);a.filter(function(q){return q!=p});if(a.length===0){f.hide();g=false}})}else{if(g){f.hide();g=false}}};var e=function(q){if(typeof q==="number"&&q>=0&&q<m.getAllItems().length){m.jumpTo(q);var p=$(m.getAllItems()[q]);p=p.find("img");for(var o=0;o<p.length;o++){if(p[o].hasAttribute("data-carousel-src")){p[o].setAttribute("src",p[o].getAttribute("data-carousel-src"));p[o].removeAttribute("data-carousel-src")}}}};var i=function(o){$("img",o).each(function(){var p=$(this);p.attr("src",p.attr("data-carousel-src"));p.removeAttr("data-carousel-src")})};var h=function(){m.reset();var o=$(".ccarousel",b).children("li.ccarousel-item");i(o)};return({carousel:m,init:k,reset:h,jumpTo:e})};function FKJCarousel(inputObj){var my=this;var size=(inputObj.size?inputObj.size:0);my.id=inputObj.id;var ajaxUrl=inputObj.ajaxUrl;var limit=(inputObj.limit?inputObj.limit:4);my.scroll=(inputObj.scroll?inputObj.scroll:4);my.visible=(inputObj.visible?inputObj.visible:4);my.datastart=(inputObj.datastart?inputObj.datastart:0);var fetchlimit=(inputObj.fetchlimit?inputObj.fetchlimit:10);this.jcarousel_itemLoadCallback=function(carousel,state){if(carousel.size()<size){return}if(my.datastart>size){return}if(carousel.has(carousel.first,carousel.last)){return}jQuery.get(ajaxUrl,{start:carousel.first,limit:limit,datastart:(my.datastart==0)?carousel.first:my.datastart,fetchlimit:fetchlimit},function(data){jcarousel_itemAddCallback(carousel,carousel.first,data,size)})};this.fkloadInitialItems=function(carousel,resdata,start){var data=resdata.data;if(data&&typeof(data)!=undefined){var numResults=data.length;for(var i=0;i<numResults;i++){result=data[i];carousel.add(start+i,getItemHTML(result))}}};this.initCallback=function(carousel,state){var data=initialData.data;if(data&&typeof(data)!=undefined){var numResults=data.length;for(var i=0;i<numResults;i++){result=data[i];carousel.add(1+i,getItemHTML(result))}}};this.init=function(){jQuery("#"+my.id).jcarousel({scroll:my.scroll,visible:my.visible,size:size,itemLoadCallback:this.jcarousel_itemLoadCallback,buttonNextHTML:"<input type='button' />",buttonPrevHTML:"<input type='button' />"})};function jcarousel_itemAddCallback(carousel,first,resdata,size){var res=eval("("+resdata+")");if(res.status=="success"){var data=res.content.data;var numResults=data.length;my.datastart=res.content.datastart;if((numResults<limit)||(my.datastart>=size)){carousel.size(first+numResults-1)}for(var i=0;i<numResults;i++){if(data[i]&&typeof(data[i])!==undefined){var result=data[i];carousel.add(first+i,getItemHTML(result))}else{carousel.add(first+i,"")}}$("#"+my.id).children().find("div.loader_anim").css("display","none")}}function jcarousel_getItemHTML(item){return'<img src="'+jQuery("src",item).text()+'" width="75" height="75" alt="'+jQuery("title",item).text()+'" />'}function getItemHTML(data){var html="";var discount="&nbsp;";if(data&&typeof(data)!=undefined){if(data.discount>5){discount="<div class='discount-"+data.discount+"'></div>"}html+="<div class='fkc-item'>";html+="<div class='fkc-prodimage'><span></span><a href='"+data.href+"'><img src='"+data.image+'\' onerror=\'if(this.getAttribute("onerror_cnt")==0) { this.setAttribute("onerror_cnt",1);this.src="'+data.default_image+"\";}return false;' onerror_cnt='0' alt='"+data.title+"' title='"+data.title+"'/></a></div>";html+="<div class='fkc-prodname'><a href='"+data.href+"'>"+data.title_short+"</a></div>";if(data.our_price>0&&data.list_price>0){html+="<div class='fkc-prices'><table width='100%'><tr><td align='right' width='50%'>";if(data.our_price<data.list_price){html+="<span class='history_list_price'>Rs. "+data.list_price+"</span>"}html+="<span class='history_our_price'>Rs. "+data.our_price+"</span></td>";html+="<td align='left'>"+discount+"</td>";html+="</tr></table></div>"}html+="</div>"}return html}this.init()};