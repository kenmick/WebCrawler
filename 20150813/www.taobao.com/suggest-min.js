KISSY.add("tbc/search-suggest/1.4.8/suggest",function(e,t){function r(e){r.superclass.constructor.call(this,e||{})}return r=t.extend({initializer:function(){var e=this;e.on("afterRenderData",function(){e.fire("beforeShow")})},sendRequest:function(e){var t=this,r=t.constructor.superclass.sendRequest;if(t.fire("beforeQueryChange",{query:e})===!1)return!1;t.queryTimer&&clearTimeout(t.queryTimer),t.laterTimer&&clearTimeout(t.laterTimer);var n=arguments;t.queryTimer=setTimeout(function(){t.queryTimer=null,t.laterTimer=setTimeout(function(){t.later=!1},500),r.apply(t,n)},t.later?200:50),t.later=!0},handleKeyDownInternal:function(e){var t=this,r=t.constructor.superclass.handleKeyDownInternal;return t.fire("beforeKeyDown",{event:e})===!1?!1:void r.apply(this,arguments)},handleKeyEventInternal:function(e){var t=this,r=t.constructor.superclass.handleKeyEventInternal;return t.fire("beforeKeyDown",{event:e})===!1?!1:void r.apply(this,arguments)},setValueInternal:function(e){var t=this,r=t.constructor.superclass.setValueInternal;return t.fire("beforeSetInputValue",{event:e})===!1?!1:void r.apply(this,arguments)},setValueFromAutocomplete:function(e){var t=this,r=t.constructor.superclass.setValueFromAutocomplete;return t.fire("beforeSetInputValue",{event:e})===!1?!1:void r.apply(this,arguments)},renderItems:function(e,t,r){var n,a,u=this,o=u.get("sugConfig").resultFormat,s=u.resultArr||(u.resultArr=[]),i="",l=e;KISSY.each(t,function(e,u){if(!e||!e[0])return void t.splice(u,1);for(n=e[0];n.indexOf(l)<0;)l=l.substr(0,l.length-1);""===l?(i=n,n=""):0===n.indexOf(l)&&(i=l,n=n.replace(l,""));for(var c in s)if(a=s[c],a.textContent===e[0]&&a.unique)return;r=r.replace("{format}",o),s.push({textContent:e[0],content:KISSY.substitute(r,{query:i,text:n,index:u+1,count:e[1]}),list:!0})}),u.resultArr=s},alignInternal:function(e){var t=this,r=t.constructor.superclass.alignInternal;return t.fire("beforeShow",{event:e})===!1?!1:void r.apply(this,arguments)}},{ATTRS:{dataSourceCfg:{value:{xhrCfg:{url:"",dataType:"jsonp",scriptCharset:"utf-8",data:{code:"utf-8"}},allowEmpty:!0,paramName:"q",cache:!0}},mods:{value:{},setter:function(e){return e}}}}),r.RemoteDataSource=t.RemoteDataSource,r.LocalDataSource=t.LocalDataSource,r},{requires:["combobox"]});