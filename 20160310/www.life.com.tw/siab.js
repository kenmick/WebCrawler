//v119 (c) 2008-2015 33Across Inc. All Rights Reserved

Tynt=window.Tynt||[];
(function(){function n(){}function p(a,b,c,d){(this.size=a||"")?(a=a.split("x"),this.width=a[0],this.height=a[1]):this.height=this.width="0";this.elementId=b||"";this.product=c||"inpage";d?this.distro=d:"inpage"==this.product?this.distro="SIAB":"inview"==this.product&&(this.distro="RCIV");this.sicWindow=this.iframeId=null}var e=window,g=document,h={distro:"SIAB-"+(new Date).getTime()};Tynt.SIABL=!0;Date.now||(Date.now=function(){return(new Date).getTime()});var d={_maxRef:800,_icUrl:"http://"+(Tynt.e||
"")+"ic.tynt.com",_debUrl:"http://"+(Tynt.e||"")+"de.tynt.com/deb/v2",_sicUrl:"http://"+(Tynt.e||"")+"cdn-sic.33across.com/1/javascripts/sic.js",_apUrl:"http://"+(Tynt.e||"")+"cdn-ap.33across.com/javascripts/ap.js",_idMacro:"aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",newEle:function(a,b,c,d){d=d||window;a=d.document.createElement(a);b&&this.extend(a,b);c&&this.extend(a.style,c);return a},injectScript:function(a,b){var c,d;b=b||window;d=this.newEle("script",{async:"async",type:"text/javascript",
src:a},null,b);c=b.document.getElementsByTagName("script")[0];c.parentNode.insertBefore(d,c)},injectSicScript:function(){this.injectScript(this._sicUrl)},injectApolloScript:function(){this.injectScript(this._apUrl)},injectSicIframe:function(a,b){var c;c=this.newEle("iframe",{src:"about:blank",frameBorder:"0",frameSpacing:"0",scrolling:"no"},{width:b.width+"px",height:b.height+"px",border:"0 none",margin:"0"});a?"script"==a.tagName.toLowerCase()?a.parentNode.insertBefore(c,a):a.appendChild(c):document.body.appendChild(c);
b.iframeId=this.eleId(c);b.sicWindow=c.contentWindow;c=c.contentWindow.document;c.open();c.write('<!DOCTYPE html><html><head><style type="text/css">*{margin:0;padding:0;}</style></head><body><script type="text/javascript">window.Tynt = window.parent.Tynt;\x3c/script><script type="text/javascript" src="'+this._sicUrl+'">\x3c/script></body></html>');c.close()},eleId:function(a){var b=a.id;b||(b="x33x"+Date.now(),a.id=b);return b},injectPixel:function(a,b,c){var d;try{d=g.createElement("img")}catch(e){d=
document.createElement("img")}d&&(b&&(d.onload=b),c&&(d.onerror=c),d.src=a)},docUrl:function(){var a,b=null,c;c=g.getElementsByTagName("link");for(a=0;a<c.length;++a)c[a].getAttribute("href")&&c[a].getAttribute("rel")&&0<=c[a].getAttribute("rel").indexOf("canonical")&&(b=c[a].href);b||(b=this.getMeta("property","og:url","name","original-source"));return b?(0!=b.indexOf("http")&&(a=e.location.protocol+"//"+e.location.host+e.location.pathname,(c=g.getElementsByTagName("base")[0])&&(c=c.getAttribute("href"))&&
(a=c),"/"==b.charAt(0)?(c=a.indexOf("/",9),-1<c&&(a=a.slice(0,c))):(c=a.lastIndexOf("/"),a=9<c?a.slice(0,c+1):a+"/"),b=a+b),b):""},getMeta:function(a,b,c,d){var e,f=null,k=null,h=g.getElementsByTagName("meta");for(e=0;e<h.length;++e)f||h[e].getAttribute(a)!==b?c&&!k&&h[e].getAttribute(c)===d&&(k=h[e].getAttribute("content")||null):f=h[e].getAttribute("content")||null;return f||k},extend:function(a,b){var c,d;for(c=1;c<arguments.length;++c)for(d in arguments[c])arguments[c].hasOwnProperty(d)&&(a[d]=
arguments[c][d]);return a},isArray:function(a){return"undefined"!=typeof a&&"[object Array]"===Object.prototype.toString.call(a)},inArray:function(a,b){return 0<=this.indexOf(a,b)},toArray:function(a,b){return Array.prototype.slice.call(a,b||0)},indexOf:function(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0;c<a.length;++c)if(a[c]===b)return c;return-1},unique:function(a){var b,c={},d=[];for(b=0;b<a.length;++b)c[a[b]]||(c[a[b]]=!0,d.push(a[b]));return d},iframeType:function(){var a=this.iframeEle(),
b=0;if(a)a.id&&0<=a.id.search(/google_ads?_i?frame/)?(b=6,d.log(1,"In same-origin iframe from DFP")):(b=5,d.log(1,"In same-origin iframe"));else try{window!=window.top?"undefined"!=typeof window.$sf?(b=4,d.log(1,"In SafeFrame")):(b=3,d.log(1,"In cross-origin iframe")):d.log(1,"In top window")}catch(c){b=3,d.log(1,"DEBUG: exception 2")}return b},iframeEle:function(a){var b=null;a=a||window;try{b=a.frameElement}catch(c){}return b},iframeTop:function(){var a=window,b=null;try{for(;a!=window.top;)b=a,
a=a.parent}catch(c){return null}return b?this.iframeEle(b):null},getTopWin:function(){var a=window;try{for(;a.parent!==a&&a.parent.document;)a=a.parent}catch(b){}return a},jsonDecode:function(a){if("function"!==typeof Array.prototype.toJSON)return JSON.stringify(a);var b=Array.prototype.toJSON;delete Array.prototype.toJSON;a=JSON.stringify(a);Array.prototype.toJSON=b;return a},getCookie:function(a,b){for(var c=b+"=",d=a.split(";"),e=0;e<d.length;e++){for(var f=d[e];" "==f.charAt(0);)f=f.substring(1,
f.length);if(0===f.indexOf(c))return f.substring(c.length,f.length)}return null},rmScheme:function(a){return a.replace(/^https?:\/\//,"")},trim:function(a){return a.replace(/^\s+|\s+$/g,"")},trunc:function(a,b){var c,d;if(!a||a.length<=b)return a;c=a.substring(0,b);for(d=1;3>=d;++d)if("%"==c.charAt(c.length-d))return c.substring(0,c.length-d);return c},tyntIds:function(){return this.unique(Tynt).join("~")},log:function(){var a;"undefined"==typeof Tynt.debug&&0<e.location.search.indexOf("__tcdebugmode=1")&&
e.console&&e.console.log&&(Tynt.debug=1);1===Tynt.debug&&(a=this.toArray(arguments),1===a[0]&&(a[0]=h.distro),a.unshift("[TC]"),e.console.log.apply(e.console,a))},callIc:function(){var a,b,c,l,m,f,k;if(!e._33Across.state.icDone){e._33Across.state.icDone=1;b=this.getCookie(g.cookie,"tracertraffic");a=e.location.hash;a=/tynt=/.test(a)?a.match(/tynt=?([^?&$#]*)/)[1]:!1;l=c=this._icUrl+"/b/p?id="+this.tyntIds()+(b?"&et="+b:"")+(a?"&a="+a:"")+("string"==typeof Tynt.b?"&b="+Tynt.b:"")+"&lm="+h.type+"&ts="+
Date.now();(a=this.getMeta("property","og:image:url","property","og:image"))&&(l+="&img="+encodeURIComponent(this.trunc(a,255)));m=l;(a=this.getMeta("property","og:title"))&&a!=g.title&&(m+="&ct="+encodeURIComponent(this.trunc(a,127)));f=m;g.referrer&&(a=this.trunc(this.rmScheme(g.referrer),this._maxRef),f+="&r="+encodeURIComponent(a));k=f;if(a=g.title||e.location.hostname)a=this.trim(this.trunc(a,200)),k+="&t="+encodeURIComponent(a);b=k;if(a=this.docUrl())a=this.trunc(this.rmScheme(a),500),b+="&cu="+
encodeURIComponent(a);d.callIc.rsp=function(){e._33Across.state.icDone=2};d.log(1,"Calling IC");this.injectPixel(b,d.callIc.rsp,function(){d.injectPixel(k,d.callIc.rsp,function(){d.injectPixel(f,d.callIc.rsp,function(){d.injectPixel(m,d.callIc.rsp,function(){d.injectPixel(l,d.callIc.rsp,function(){d.injectPixel(c,d.callIc.rsp)})})})})})}},callDeb:function(a){if("undefined"==typeof a){if(e._33Across.state.deDone)return;a=4}e._33Across.state.deDone=!0;0==a||2==e._33Across.state.icDone?(d.log(1,"Calling DEB"+
(0==a?" on IC timeout":"")),this.injectScript(this._debUrl+"?id="+this.tyntIds()+"&r="+encodeURIComponent(this.trunc(this.rmScheme(g.referrer),this._maxRef)),e)):setTimeout(function(){d.callDeb(a-1)},50)}};h.type=d.iframeType();5<=h.type&&(e=d.getTopWin(),g=e.document);e._33Across||(e._33Across={});e._33Across.state||(e._33Across.state={icDone:0,deDone:!1,ivDone:!1});Tynt.settings||(Tynt.settings={_error:0,_pending:!1,_pubId:null,_scUrl:"http://"+(Tynt.e||"")+"sc.tynt.com/script/sc/",_settings:{},
_copy:null,isReady:function(){return 0===this._error&&null!=this._copy},get:function(){return this._settings},pubId:function(){if(null==this._pubId)for(var a=0;a<Tynt.length;++a)if("string"==typeof Tynt[a]&&22==Tynt[a].length&&0>Tynt[a].indexOf("!")){this._pubId=Tynt[a];break}return this._pubId},download:function(){var a,b;this._pending||this.isReady()||(a=this,Tynt.getConfig=function(){return a.isReady()?a._copy:null},Tynt.sc=function(c){clearTimeout(b);a._error=c.fl||0;0===a._error?(a._init(c),
d.log("Settings downloaded",a._copy),Tynt.cmdFlush()):d.log("ERROR: Settings download failed: ",a._error);a._pending=!1},this.pubId()&&(d.log("Downloading settings"),this._pending=!0,d.injectScript(this._scUrl+this.pubId()+".js"),b=setTimeout(function(){Tynt.sc({fl:1})},1E4)))},_init:function(a){a=a||{};!0===a.d?(Tynt.o&&d.extend(a,Tynt.o),this._ovr(a)):a=Tynt.i||e.tyntVariables||{};this._def();d.extend(this._settings,a);this._val();this._copy="undefined"!==typeof JSON&&"function"===typeof JSON.parse&&
"function"===typeof JSON.stringify?JSON.parse(d.jsonDecode(this._settings)):this._settings},_ovr:function(a){if(d.isArray(Tynt.overrides))for(var b=0;b<Tynt.overrides.length;b++)"object"===typeof Tynt.overrides[b]&&d.extend(a,Tynt.overrides[b])},_def:function(){this._settings.a=!0;this._settings.ad=!0;this._settings.aw=0;this._settings.cc=0;this._settings.b=!1;this._settings.ap="Read more:";this._settings.as="";this._settings.st=!1;this._settings.su=!0;this._settings.w=!1;this._settings.f=!1;this._settings.ss=
""},_val:function(){this._settings.a||(this._settings.a=!1);6<this._settings.cc&&(this._settings.cc=0);8>this._settings.aw&&(this._settings.aw=8);this._settings.su||(this._settings.su=!1);this._settings.w&&!this._twUser(this._settings.w)&&(this._settings.w=!1);this._settings.f&&!this._fbUser(this._settings.f)&&(this._settings.f=!1);0<this._error&&(this._settings.a=!1,this._settings.b=!1)},_twUser:function(a){return/^\w{1,15}$/.test(a||"")},_fbUser:function(a){return/^[\w.]{2,}$/.test(a||"")}});"undefined"==
typeof Tynt.cmd&&(Tynt.cmd=[]);n.prototype.push=function(){d.log("Executing commands",arguments);try{for(var a=0;a<arguments.length;++a)if("function"===typeof arguments[a])arguments[a]()}catch(b){d.log("Tynt.cmd ERROR",b)}};"undefined"==typeof Tynt.cmdFlush&&(Tynt.cmdFlush=function(){var a=Tynt.cmd;if(!a||d.isArray(a)){var b=Tynt.cmd=new n;a&&0<a.length&&b.push.apply(b,a)}});Tynt.ads||(Tynt.ads={_slots:[],display:function(a,b,c,d){"string"==typeof a&&(a=new p(a,b,c,d),this.addSlot(a))},getSlot:function(a){return(a=
this.getSlots(a))&&0<a.length?a[0]:null},getSlots:function(a){for(var b=[],c=0;c<this._slots.length;++c)this._slots[c].sicWindow===a&&b.push(this._slots[c]);return 0<b.length?b:null},addSlot:function(a){var b;(b=Tynt.settings.get())&&b.sic?(a.sicWindow=window,"inview"==a.product&&this.ivReady(b,a)?(this.ivDone(!0),this._slots.push(a),d.log("Injecting SIC/InView",a),d.injectSicScript()):"inpage"==a.product&&this.ipReady(b)&&(0<h.type?(this._setIframeId(a),this._slots.push(a),d.log("Injecting SIC/InPage",
a),d.injectSicScript()):a.elementId?(b=document.getElementById(a.elementId))?(this._slots.push(a),d.log("Injecting SIC/InPage into iframe",a),d.injectSicIframe(b,a)):d.log("ERROR: Could not find target element:",a.elementId):d.log("ERROR: Could not install InPage"))):d.log("ERROR: settings or .sic undefined",b)},_setIframeId:function(a){var b=d.iframeTop();b&&(a.iframeId=d.eleId(b))},ivDone:function(a){!0===a&&(e._33Across.state.ivDone=!0);return e._33Across.state.ivDone},ivReady:function(a,b){var c=
!1,e;!this.ivDone()&&d.isArray(a.p)&&d.inArray(a.p,"sic_v1")&&a.sic.products&&a.sic.products.inview&&(e=a.sic.products.inview.install_method||a.sic.install_method,"TI"==b.distro?"On Page"==e&&(c=!0):"On Page"!=e&&(c=!0));return c},ipReady:function(a){return a.sic.products&&a.sic.products.siab}});Tynt.settings.download()})();
