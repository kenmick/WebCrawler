var Demandbase=window.Demandbase||{},Demandbase=window.Demandbase||{};
Demandbase.Config={clientId:"phXI6yS7",nonCompanyDefault:null,nonWatchDefault:null,getDomain:null,conditions:null,segments:null,key:"cd79a9f82c976038cd27dd4fc100b577",ads:{key:"cd79a9f82c976038cd27dd4fc100b577",pixels:{ad:"1420577520",rt:"1420577553",cn:null}},analytics:{key:"cd79a9f82c976038cd27dd4fc100b577",fieldMap:{1:"demandbase_sid",2:"audience",3:"audience_segment",4:"company_name",5:"industry",6:"sub_industry",7:"revenue_range",8:"employee_range",9:"ip",10:"watch_list_account_type",11:"watch_list_account_status",
12:"watch_list_campaign_code",13:"state",14:"country_name",15:"fortune_1000",16:"forbes_2000",17:"b2b",18:"b2c",19:"city",20:"zip",21:"country",22:"web_site",23:"stock_ticker",24:"traffic",25:"marketing_alias",26:"employee_count",27:"street_address",28:"phone",29:"annual_sales"}},isFormPage:function(){europe_iso="AL AD AM AT BY BE BA BG CH CY CZ DE DK EE ES FO FI FR GB GE GI GR HU HR IE IS IT LT LU LV MC MK MT NO NL PL PT RO RU SE SI SK SM TR UA VA".split(" ");try{for(var a=Demandbase.Config.forms.emailFields||
[],b=Demandbase.Config.forms.companyID,c=0;c<europe_iso.length;c++)if(Demandbase.IP.CompanyProfile.country===europe_iso[c])return!1;Demandbase.Config.forms.emailID&&a.push(Demandbase.Config.forms.emailID);for(c=0;c<a.length;c++){var d=Demandbase.utils.getElementByIdOrName(a[c]),e=Demandbase.utils.getElementByIdOrName(b);if(d&&e)return!0}}catch(g){window.console?window.console.log(g.message):""}return!1},forms:{companyID:"Company",emailID:"Email",enableMktoAutoAdd:!0,fieldMap:{demandbase_sid:"dbdemandbasesid",
watch_list_account_type:"dbwatchlistaccounttype",watch_list_account_status:"dbwatchlistaccountstatus",watch_list_campaign_code:"dbwatchlistcampaigncode",company_name:"dbcompanyname",marketing_alias:"dbmarketingalias",industry:"dbindustry",sub_industry:"dbsubindustry",revenue_range:"dbrevenuerange",employee_range:"dbemployeerange",street_address:"dbstreetaddress",city:"dbcity",state:"dbstate",zip:"dbzip",country:"dbcountry",ip:"dbip",data_source:"dbdatasource",phone:"dbphone",country_name:"dbcountryname",
primary_sic:"dbprimarysic",employee_count:"dbemployeecount",annual_sales:"dbannualsales",fortune_1000:"dbfortune1000",forbes_2000:"dbforbes2000",b2b:"dbb2b",b2c:"dbb2c",web_site:"dbwebsite",stock_ticker:"dbstockticker",traffic:"dbtraffic",primary_naics:"dbprimarynaics"}},callback:function(a){a&&(window.DB_Company=a)},content:{key:null,mods:null}};"use strict";"undefined"===typeof window.console&&(window.console={log:function(){},debug:function(){}});
"undefined"===typeof window.localStorage&&(window.localStorage={getItem:function(){},setItem:function(){}});"undefined"===typeof JSON&&(JSON={stringify:function(){},parse:function(){}});Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c=this.length>>>0,d=Number(b)||0,d=0>d?Math.ceil(d):Math.floor(d);for(0>d&&(d+=c);d<c;d++)if(d in this&&this[d]===a)return d;return-1});
Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var g,f=[];for(g in e)a.call(e,g)&&f.push(g);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&f.push(c[g]);return f}}());
Array.prototype.some||(Array.prototype.some=function(a){if(null==this)throw new TypeError("Array.prototype.some called on null or undefined");if("function"!==typeof a)throw new TypeError;for(var b=Object(this),c=b.length>>>0,d=2<=arguments.length?arguments[1]:void 0,e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1});Demandbase.Config.hooks=window.Demandbase.Config.hooks||{};"function"!==typeof Demandbase.Config.hooks.onEctReady&&(Demandbase.Config.hooks.onEctReady=function(){});
Demandbase.Connectors=window.Demandbase.Connectors||{};
Demandbase.utils={name:"Demandbase API Utilities",version:"1.12",logging:Demandbase.Config.logging||!1,debug:Demandbase.Config.debug||!1,callbackStack:[],callback:function(a){try{var b=Demandbase.utils.callbackStack;Demandbase.utils.log("Running Demandbase.utils.callback");for(var c in b){var d=b[c];"function"===typeof d&&(d.call(Demandbase,a),this.log("Running callback..."))}}catch(e){Demandbase.utils.alert("Error: "+e+"\n"+e.stack)}},registerCallback:function(a){try{var b=Demandbase.utils.callbackStack,
c=Demandbase.IP.CompanyProfile;-1==b.indexOf(a)&&b.push(a);c&&a.call(Demandbase,c)}catch(d){Demandbase.utils.alert("Error: "+d+"\n"+d.stack)}},flattenData:function(a){for(var b in a)if("object"==typeof a[b]&&null!==a[b]&&a.hasOwnProperty(b)){for(var c in a[b])a[b+"_"+c]=a[b][c];delete a[b]}return a},getAttrValue:function(a,b){var c=Demandbase.Config.nonCompanyDefault||Demandbase.utils.tokens.DFLT_NON_COMPANY,d=Demandbase.Config.emptyWatchDefault||Demandbase.utils.tokens.DFLT_AW_EMPTY,e={city:"registry_city",
state:"registry_state",zip:"registry_zip_code",country:"registry_country_code",country_name:"registry_country",latitude:"registry_latitude",longitude:"registry_longitude"}[b]||"",e=a[b]||a[e]||c,c=(a.company_name||c)!==c,g=Object.keys(a).some(function(a){return~a.indexOf("watch_list_")});if(!1===a[b])return"false";-1!==b.indexOf("watch_list_")&&c&&(g||(d=Demandbase.Config.nonWatchDefault||Demandbase.utils.tokens.DFLT_NON_AW),e=a[b]||d);return e},getElementByIdOrName:function(a){var b=null;a&&((b=
document.getElementById(a)||null)||(b=document.getElementsByName(a)[0]||null));return b},getQueryParam:function(a){var b={},c=window.location.search.substring(1),d=c.split("&");if(!c)return"";for(c=0;c<d.length;c++){var e=d[c].split("=");b[e[0]]=e[1]}return b[a]||""},isCurrentPage:function(a,b){function c(a){return 0===a.indexOf("//")?a.substring(2,a.length):a.replace(/^.*?:\/\//g,"")}function d(a){-1!==a.indexOf("#",a.length-1)&&(a=a.substring(0,a.length-1));-1!==a.indexOf("/",a.length-1)&&(a=a.substring(0,
a.length-1));return a}if(!a)return!1;var e=document.location.hash,g=document.location.search,f=document.location.href;window.top!==window.self&&(f=document.referrer);b&&(g=b.indexOf("#"),-1===g&&(g=b.length),e=b.substring(b.indexOf("#"),b.length),g=b.substring(b.indexOf("?"),g),f=b);a=c(a);a=a.replace(/^(www\.)/g,"");a=d(a);f=c(f);f=f.replace(/^(www\.)/g,"");f=d(f);-1===a.indexOf("#")&&-1!==f.indexOf("#")&&(f=f.substring(0,f.length-e.length));-1===a.indexOf("?")&&-1!==f.indexOf("?")&&(f=f.substring(0,
f.length-g.length));f=d(f);return f===a},isFormPage:function(){var a=Demandbase.Config.forms.emailFields||[];Demandbase.Config.forms.emailID&&a.push(Demandbase.Config.forms.emailID);for(var b=0;b<a.length;b++)if(this.getElementByIdOrName(a[b]))return!0;return!1},jqid:function(a){return a?"#"+a.replace(/(:|\.|\[|\]|,)/g,"\\$1"):null},alert:function(a){this.log(a);(this.debug||"true"===this.getQueryParam(Demandbase.utils.tokens.QS_ENABLE_DEBUG)||Demandbase.Config.debug)&&alert(a)},log:function(a){("undefined"!==
typeof window.console&&(this.logging||"true"===this.getQueryParam(Demandbase.utils.tokens.QS_ENABLE_LOG))||Demandbase.Config.logging)&&window.console.log("DB: "+a)},readCookie:function(a,b){return(b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)"))?b.pop():""},writeCookie:function(a,b,c,d,e,g){if(!a||/^(?:expires|max\-age|path|domain|secure)$/i.test(a))return!1;var f="";if(c)switch(c.constructor){case Number:f=Infinity===c?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+c;break;case String:f=
"; expires="+c;break;case Date:f="; expires="+c.toUTCString()}document.cookie=encodeURIComponent(a)+"="+encodeURIComponent(b)+f+(e?"; domain="+e:"")+(d?"; path="+d:"")+(g?"; secure":"");return!0},loadDebugFile:function(){var a=document.createElement("script"),b=document.getElementsByTagName("script")[0],c=Demandbase.Config.clientId+".js";a.async=!0;a.id="db_debug_lib";a.src=this.tokens.PROTOCOL+"scripts.demandbase.com/"+c;b.parentNode.insertBefore(a,b);this.log("Loaded Debug library...")},loadScript:function(a,
b,c){if(a){c=document.createElement("script");var d=document.getElementsByTagName("script")[0],e="https:"==document.location.protocol?"https:":"http:";c.async=!0;"undefined"!==typeof b&&b&&(c.id=b);0==a.indexOf("//")?a=e+a:0!==a.indexOf("http:")&&0!==a.indexOf("https:")&&(a=e+"//"+a);c.src=a;d.parentNode.insertBefore(c,d);this.log("Loaded: "+a)}else this.log("URL not provided.")},loadFormModule:function(a){var b=!1;if(b="function"===typeof Demandbase.Config.isFormPage?Demandbase.Config.isFormPage():
Demandbase.utils.isFormPage()){var c=this.tokens.URL_FORM_MODULE;"undefined"!==typeof a&&"undefined"!==typeof a.debug&&a.debug&&(c=this.tokens.URL_FORM_MODULE_DEBUG);"undefined"!==typeof window.MktoForms2&&"undefined"!==typeof window.MktoForms2.whenReady?MktoForms2.whenReady(function(a){Demandbase.utils.loadScript(c,"db_form_module")}):this.loadScript(c,"db_form_module");Demandbase.Connectors.initWebForm=function(a){Demandbase.Connectors.WebForm.connect(a||Demandbase.Config.forms||{})}}},ect:{delim:"-",
values:{pid:"",cid:"",sid:"",ip:"",impid:""},unpack:function(a){if(a){var b={pid:0,cid:1,sid:2,ip:3};a=a.split(this.delim);this.values.pid=a[b.pid]||"";this.values.cid=a[b.cid]||"";this.values.sid=a[b.sid]||"";this.values.ip=a[b.ip]||""}},loadModule:function(a){if("undefined"!==typeof Demandbase.Config.disableEctModule&&!0===Demandbase.Config.disableEctModule)Demandbase.utils.log("ECT: Nothing loaded.  Module is disabled in Config.");else{a=document.createElement("iframe");var b=document.getElementsByTagName("body")[0];
b||(b=document.getElementsByTagName("head")[0]);a.src=Demandbase.utils.tokens.URL_ECT_PAGE+"?parent="+document.location.href;a.id="db_ect";a.height="0";a.width="0";a.style.display="none";b.appendChild(a);Demandbase.utils.log("ECT: added.")}},buildParamString:function(){var a="",b=Demandbase.utils.ect.values||null;b&&(b.pid&&(a="&pid="+b.pid+"&cid="+b.cid+"&tip="+b.ip+"&tsid="+b.sid),b.impid&&(a=a+"&impid="+b.impid));return a}},events:{add:function(a){try{var b=!0;if(this.isValid(a)){var c=a.type||
Demandbase.utils.tokens.DFLT_EVENT_TYPE,d=a.elements,e=d.constructor;if(e===HTMLCollection||e===NodeList)for(var g in d)e=!1,d.hasOwnProperty(g)&&(e=this._attachListener(d[g],c,a.listener),e||(b=!1,Demandbase.utils.log("Event not added to"+d[g])));else return this._attachListener(a.elements,c,a.listener)}else return Demandbase.utils.log("Event not added."),!1;return b}catch(f){Demandbase.utils.alert("Error: "+f+"\n"+f.stack)}},_attachListener:function(a,b,c){try{var d=!1;if(a)if(a instanceof jQuery){if("undefined"!==
typeof a.on)a.on(b,c);else a.bind(b,c);d=!0;Demandbase.utils.log("Event Listener bind to: "+a+" on event "+b);a.attr("demandbase_event",!0)}else a.addEventListener?(a.addEventListener(b,function(){c.call()},!1),Demandbase.utils.log("Event Listener added to: "+a+" on event "+b),d=!0):a.attachEvent?(a.attachEvent(b,function(){c.call()}),Demandbase.utils.log("Event Attached to: "+a+" on event "+b),d=!0):Demandbase.utils.log("ERROR: no event attached to element: "+a),d&&"function"===typeof a.setAttribute&&
a.setAttribute("demandbase_event",!0);else return Demandbase.utils.log("Event not registered - invalid element/s."),null;return d}catch(e){Demandbase.utils.alert("ECT Error: "+e+"\n"+e.stack)}},isValid:function(a){for(var b=!1,c=["elements","listener"],d=a.elements||null,e=a.listener||null,g=Demandbase.utils,f=0;f<c.length;f++)if("undefined"===typeof a[c[f]]||!a[c[f]])return g.log("Invalid Event object. Missing: "+c[f]),!1;if("function"!==typeof e)return g.log('Invalid Event: "listener" must be a function. Got ('+
e+")"),!1;d instanceof Node||d instanceof NodeList||d instanceof HTMLElement||d instanceof HTMLCollection||d instanceof Window||d instanceof Document||"function"===typeof d||"undefined"!==typeof jQuery&&d instanceof jQuery?b=!0:g.log("Invalid Event:  element: "+d+' has type: "'+d.constructor+'" which is not proper instance type.');return b}},tokens:{ERR_NO_AUTH_KEY:"ERR_NO_AUTH_KEY",ERR_NO_PIXEL_ID:"ERR_NO_PIXEL_ID",QS_USE_TEST_IP:"db_useTestIp",QS_USE_TEST_DOMAIN:"db_useTestDomain",QS_QUERY_IP:"db_ip",
QS_QUERY_DOMAIN:"db_domain",QS_ENABLE_LOG:"db_logging",QS_ENABLE_DEBUG:"db_debug",QS_ENABLE_TEST_MODE:"db_testMode",TEST_MODE_NAME:"dbtme",DFLT_NON_COMPANY:"(Non-Company Visitor)",DFLT_AW_EMPTY:"(AccountWatch Empty)",DFLT_NON_AW:"(Non-AccountWatch Visitor)",DFLT_EVENT_TYPE:"click",URL_FORM_MODULE:"scripts.demandbase.com/forms.min.js",URL_FORM_MODULE_DEBUG:"scripts.demandbase.com/forms.js",URL_IP_API:"api.demandbase.com/api/v2/ip.json",URL_DOMAIN_API:"api.demandbase.com/api/v1/domain.json",URL_AD_PIXEL:"a.company-target.com/pixel?type=js&id=",
URL_ECT_PAGE:function(){return document.location.protocol+"//b.company-target.com/ect.html.gz"}(),URL_DEBUG_FILE:function(){return document.location.protocol+"//scripts.demandbase.com/"+Demandbase.Config.clientId+".js"}(),URL_TEST_FILE:function(){return document.location.protocol+"//tag.demandbase.com/clients/"+Demandbase.Config.clientId+"/"+Demandbase.Config.clientId+".js"}(),ECT_NAME:"ssid",URL_CURRENT:function(){var a=document.URL;window.top!==window.self&&(a=document.referrer);return a=encodeURIComponent(a)}(),
PROTOCOL:function(){return"https:"==document.location.protocol?"https://":"http://"}()}};
Demandbase.IP={name:"Demandbase IP API Wrapper",key:Demandbase.Config.key||Demandbase.Config.analytics.key||Demandbase.Config.ads.key||Demandbase.Config.forms.key||Demandbase.utils.tokens.ERR_NO_AUTH_KEY,CompanyProfile:null,isCalled:!1,useTestValue:Demandbase.utils.getQueryParam(Demandbase.utils.tokens.QS_USE_TEST_IP)||Demandbase.Config.useTestIp||!1,testValue:Demandbase.utils.getQueryParam(Demandbase.utils.tokens.QS_QUERY_IP)||Demandbase.Config.testIp||"No Test IP Set",_callback:function(a){if(a)try{var b=
Demandbase.utils;this.CompanyProfile=a=b.flattenData(a);b.callback(a);"undefined"==typeof Demandbase.Connectors.WebForm&&b.loadFormModule({debug:Demandbase.Config.debug||Demandbase.Config.forms.debug||!1})}catch(c){Demandbase.utils.alert("IP API Error: "+c+" : "+c.stack)}},load:function(a,b){try{if(this.key==Demandbase.utils.tokens.ERR_NO_AUTH_KEY&&"undefined"==typeof a)Demandbase.utils.log("IP API query cancelled - check auth key.");else{var c,d=document.URL,e="",g="undefined"!==typeof a?a:this.key,
f="undefined"!==typeof b&&!1===b?"Demandbase.Ads.track":"Demandbase.IP._callback";window.top!==window.self&&(d=document.referrer);d=encodeURIComponent(d);c=Demandbase.utils.tokens.URL_IP_API+"?key="+g+"&referrer="+encodeURIComponent(document.referrer)+"&page="+d+"&page_title="+encodeURIComponent(document.title)+"&callback="+f;c+=Demandbase.utils.ect.buildParamString();this.useTestValue?e=this.testValue:"undefined"!==typeof Demandbase.utils.ect.values.ip&&Demandbase.utils.ect.values.ip&&(e=Demandbase.utils.ect.values.ip);
e&&(c=c+"&query="+e);Demandbase.utils.log("Calling IP API...");Demandbase.utils.loadScript(c,"db_ip_api")}}catch(h){Demandbase.utils.alert("IP API Error: "+h+" : "+h.stack)}},_loadOnce:function(){this.isCalled?Demandbase.utils.log("IP API call blocked (already called, wait for callback)"):(this.load(),this.isCalled=!0)}};
Demandbase.Domain={name:"Demandbase Domain API Wrapper",key:Demandbase.Config.key||Demandbase.Config.analytics.key||Demandbase.Config.ads.key||Demandbase.Config.forms.key||Demandbase.utils.tokens.ERR_NO_AUTH_KEY,CompanyProfile:null,useTestValue:Demandbase.utils.getQueryParam(Demandbase.utils.tokens.QS_USE_TEST_DOMAIN)||Demandbase.Config.useTestDomain||!1,testValue:Demandbase.utils.getQueryParam(Demandbase.utils.tokens.QS_QUERY_DOMAIN)||Demandbase.Config.testDomain||"No Test Domain Set",_callback:function(a){try{var b=
Demandbase.utils;a.domain||a.person?(a=a.domain||a.person,this.CompanyProfile=a=b.flattenData(a)):Demandbase.utils.log("Demandbase.Domain: No company profile available for domain: "+this.getDomain())}catch(c){Demandbase.utils.alert("Domain API Error: "+c+" : "+c.stack)}},load:function(){if("function"===typeof Demandbase.Config.getDomain&&this.key!==Demandbase.utils.tokens.ERR_NO_AUTH_KEY){var a;a=document.URL;window.top!==window.self&&(a=document.referrer);a=encodeURIComponent(a);a=Demandbase.utils.tokens.URL_DOMAIN_API+
"?key="+this.key+"&referrer="+encodeURIComponent(document.referrer)+"&page="+a+"&page_title="+encodeURIComponent(document.title)+"&callback=Demandbase.Domain._callback";a=this.useTestValue?a+"&query="+this.testValue:a+"&query="+this.getDomain();Demandbase.utils.log("Calling Domain API...");Demandbase.utils.loadScript(a,"db_domain_api")}else Demandbase.utils.log("Domain API query cancelled - check auth key or Config.getDomain")},getDomain:function(a){try{if(this.useTestValue)return this.testValue;
if("function"===typeof Demandbase.Config.getDomain)return Demandbase.Config.getDomain.call(Demandbase.Config);Demandbase.utils.log("Warning: Config.getDomain fcn not defined.");return"getVisitorDomain function is not defined"}catch(b){Demandbase.utils.alert("getDomain Error: "+b+" : "+b.stack)}}};
(function(){Demandbase.init=function(){var a=Demandbase.utils;if("undefined"!==typeof Demandbase.Config.enableTestMode&&!0===Demandbase.Config.enableTestMode&&"true"===a.readCookie(a.tokens.TEST_MODE_NAME)){var b="";"true"===a.getQueryParam(a.tokens.QS_ENABLE_TEST_MODE)?(b=a.tokens.URL_TEST_FILE,a.log("Re-loading with TEST file...")):"true"===a.getQueryParam(a.tokens.QS_ENABLE_DEBUG)&&(b=a.tokens.URL_DEBUG_FILE,a.log("Re-loading DEBUG file..."));if(b)throw a.writeCookie(a.tokens.TEST_MODE_NAME,"false",
86400,"/"),a.loadScript(b),Demandbase={},Error("Tag load halted. Entering TEST MODE (no error).");a.log("Set qs param to enable TEST or DEBUG mode. Loading as normal...")}"undefined"!==typeof Demandbase.Config.disableEctModule&&!0===Demandbase.Config.disableEctModule?Demandbase.IP.load():(a.ect.loadModule(),a=200,"undefined"!==typeof Demandbase.Config.ectTimeout&&(a=Demandbase.Config.ectTimeout),setTimeout(function(){Demandbase.IP.isCalled||Demandbase.IP._loadOnce()},a));"function"===typeof Demandbase.Config.getDomain&&
Demandbase.Config.getDomain()&&Demandbase.Domain.load();Demandbase._isInitialized=!0};Demandbase.version="1.11"})();
(function(){var a=Demandbase.utils.callback;Demandbase.utils.callback=function(b){Demandbase.utils.log("Setup callback extender...");"function"===typeof Demandbase.Config.callback&&Demandbase.Config.callback.call(Demandbase,b);a.apply(Demandbase.utils,[b])};"undefined"!==typeof window.MktoForms2&&"undefined"!==typeof window.MktoForms2.whenReady&&MktoForms2.whenReady(function(a){Demandbase.utils.loadFormModule({debug:Demandbase.Config.debug||Demandbase.Config.forms.debug||!1})});window.addEventListener("message",
function(a){if(0===Demandbase.utils.tokens.URL_ECT_PAGE.indexOf(a.origin)){for(var c=["ssid","tuuid"],d=0;d<c.length;d++)if(!a.data.hasOwnProperty(c[d]))return;Demandbase.utils.ect.unpack(a.data.ssid);Demandbase.utils.ect.values.impid=a.data.tuuid;Demandbase.Config.hooks.onEctReady();Demandbase.utils.log("ECT: msg received...IP API called");Demandbase.IP._loadOnce()}},!1)})();Demandbase.init();
Demandbase.Connectors.Google_Analytics={name:"Demandbase Universal Analytics Connector",version:"7.1.1",fields:Demandbase.Config.analytics.fieldMap||{},CompanyProfile:null,gType:"ua",trackerName:"",track:function(a){try{if(!a)throw"Error - no data passed to callback";var b=Demandbase.Connectors.Google_Analytics,c=Demandbase.utils;a=c.flattenData(a);b._toGtmDl(a);b.CompanyProfile=a;b._detectG();b._setTrackerName();for(var d in b.fields)if(b.fields.hasOwnProperty(d)){var e=d,g=b.fields[d],f=c.getAttrValue(a,
g);b._var(e,g,f.toString())}b._cEvent("Demandbase","API Resolution","IP API")}catch(h){Demandbase.utils.alert("GA Error: "+h+"\n"+h.stack),Demandbase.Connectors.Google_Analytics._cEvent("Demandbase","API Resolution","Callback Error")}},load:function(){try{Demandbase.utils.registerCallback(this.track),this._setEvents()}catch(a){Demandbase.utils.alert("GA Error: "+a+"\n"+a.stack)}},_log:function(a){Demandbase.utils.log("GA: "+a)},_var:function(a,b,c){"ga"===this.gType?window._gaq.push([this.trackerName?
this.trackerName+"._setCustomVar":"_setCustomVar",a>>0,b,c,1]):ga(this.trackerName?this.trackerName+".set":"set","dimension"+a,c);this._log(a+" "+b+" : "+c)},_cEvent:function(a,b,c){"ga"===this.gType?window._gaq.push([this.trackerName?this.trackerName+"._trackEvent":"_trackEvent",a,b,c,0,1]):ga(this.trackerName?this.trackerName+".send":"send","event",{eventCategory:a,eventAction:b,eventLabel:c,nonInteraction:!0});this._log("Sent Custom Event:"+a+"/"+b+"/"+c)},_toGtmDl:function(a,b){window.google_tag_manager&&
window.dataLayer&&(dataLayer.push(a),dataLayer.push({event:"Demandbase_Loaded"+("undefined"===typeof b?"":"_"+b)}),this._log("Pushed to GTM dataLayer"))},_detectG:function(){"function"===typeof window.ga?this.gType="ua":window._gaq?(this.gType="ga",_gaq.push(["_addDevId","NE7T9"])):(window.ga||(window.ga=function(){(ga.q=ga.q||[]).push(arguments)}),this.gType="ua");this._log("Detected Google version: "+this.gType)},_setEvents:function(){var a=Demandbase.Config.analytics.events||[],b=Demandbase.utils,
c;for(c in a)if(a.hasOwnProperty(c)){var d=a[c];if(d.data){var e=d.data.category||"",g=d.data.action||"",f=d.data.label||"";"undefined"===typeof d.listener&&e&&g&&f?d.listener=function(){Demandbase.Connectors.Google_Analytics._cEvent(e,g,f);Demandbase.utils.log("Event listener ran....")}:e&&g&&f||this._log("Need to define a custom listener function or set data with category/action/label")}b.events.add(d)}},_setTrackerName:function(){var a="";"undefined"!==typeof Demandbase.Config.analytics.trackerName&&
Demandbase.Config.analytics.trackerName?this.trackerName=Demandbase.Config.analytics.trackerName:"function"===typeof window.ga&&"function"===typeof window.ga.getAll?(a=ga.getAll()||[],0<a.length&&(a=a[0],this.trackerName=a=a.get("name")||"")):"undefined"!==typeof window._gat&&"function"===typeof window._gat._getTrackers&&(a=_gat._getTrackers(),0<a.length&&(a=a[0],this.trackerName=a=a._getName()||""))}};Demandbase.Connectors.Google_Analytics.load();
Demandbase.Ads={name:"Demandbase Ad Connector",version:"4.2.2",pixels:Demandbase.Config.ads.pixels||{},conversionTriggers:Demandbase.Config.ads.conversionTriggers||{},track:function(a){try{Demandbase.Ads._log("tracked.")}catch(b){Demandbase.utils.alert("Ads Error: "+b+"\n"+b.stack)}},trackConversion:function(){this._loadPixel("cn")},load:function(){try{this._setCampaign(),this.loadPixels(),this._setEvents(),Demandbase.utils.registerCallback(this.track),"undefined"!==typeof Demandbase.Config.ads.reportingOnly&&
!0===Demandbase.Config.ads.reportingOnly&&Demandbase.Config.ads.key!==Demandbase.IP.key&&Demandbase.IP.load(Demandbase.Config.ads.key,!1)}catch(a){Demandbase.utils.alert("Ads Error: "+a+"\n"+a.stack)}},loadPixels:function(){try{this._loadPixel("ad"),this.isConversionPage()?this.trackConversion():this._loadPixel("rt")}catch(a){Demandbase.utils.alert("Ads Error: "+a+"\n"+a.stack)}},isConversionPage:function(a){if("undefined"!==typeof this.conversionTriggers.pages){var b=Demandbase.utils;pagesList=a?
[a]:this.conversionTriggers.pages;for(var c in pagesList)if(pagesList.hasOwnProperty(c)&&b.isCurrentPage(pagesList[c]))return!0}return!1},_loadPixel:function(a){var b=this.pixels[a]||Demandbase.utils.tokens.ERR_NO_PIXEL_ID;if(b&&b!==Demandbase.utils.tokens.ERR_NO_PIXEL_ID){var c=document.createElement("img"),d=document.getElementsByTagName("body")[0],e=Demandbase.utils;c.setAttribute("style","display:none");c.setAttribute("alt","Demandbase pixel");c.id="db_pixel_"+a;c.src=e.tokens.PROTOCOL+e.tokens.URL_AD_PIXEL+
b+"&page="+e.tokens.URL_CURRENT;"undefined"!==typeof d&&d||(d=document.getElementsByTagName("head")[0]);d.appendChild(c);this._log("Loaded Pixel "+c.src)}},_setCampaign:function(){if("undefined"!==typeof Demandbase.Config.ads.campaigns)for(var a=Demandbase.Config.ads.campaigns||[],b=Demandbase.utils,c=0;c<a.length;c++)for(var d=a[c],e=d.pages||[],g=0;g<e.length;g++)if(b.isCurrentPage(e[g])){this.pixels=d.pixels;this.conversionTriggers=d.conversionTriggers;this._log("Campaign set to: "+d.name);return}},
_setEvents:function(){if("undefined"!==typeof this.conversionTriggers.events){var a=this.conversionTriggers.events||[],b;for(b in a)if(a.hasOwnProperty(b)){var c=a[b];c.listener||(c.trackConversion?c.listener=function(){Demandbase.Ads.trackConversion()}:c.virtualPageview?c.listener=function(){Demandbase.Ads.loadPixels();Demandbase.IP.load(void 0,!1)}:this._log("Define a listener function or set trackConversion or virtualPageview"));Demandbase.utils.events.add(c)}}else this._log("No events in conversionTriggers")},
_log:function(a){Demandbase.utils.log("Ads: "+a)}};Demandbase.Ads.load();"function"===typeof Demandbase.Config.onLoad&&Demandbase.Config.onLoad.call(Demandbase);
