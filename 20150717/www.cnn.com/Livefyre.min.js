!function(e,t){if("object"!=typeof Livefyre||"function"!=typeof Livefyre.define||!Livefyre.define.amd)if("object"!=typeof Livefyre&&"function"==typeof e.define&&e.define.amd)e.define([],t);else{var r=t();e.Livefyre=e.Livefyre||{};for(var n in r)r.hasOwnProperty(n)&&(e.Livefyre[n]=r[n])}}(this,function(){require={skipDataMain:!0};var requirejs,require,define;!function(global){function isFunction(e){return"[object Function]"===ostring.call(e)}function isArray(e){return"[object Array]"===ostring.call(e)}function each(e,t){if(e){var r;for(r=0;r<e.length&&(!e[r]||!t(e[r],r,e));r+=1);}}function eachReverse(e,t){if(e){var r;for(r=e.length-1;r>-1&&(!e[r]||!t(e[r],r,e));r-=1);}}function hasProp(e,t){return hasOwn.call(e,t)}function getOwn(e,t){return hasProp(e,t)&&e[t]}function eachProp(e,t){var r;for(r in e)if(hasProp(e,r)&&t(e[r],r))break}function mixin(e,t,r,n){return t&&eachProp(t,function(t,i){(r||!hasProp(e,i))&&(n&&"string"!=typeof t?(e[i]||(e[i]={}),mixin(e[i],t,r,n)):e[i]=t)}),e}function bind(e,t){return function(){return t.apply(e,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(e){throw e}function getGlobal(e){if(!e)return e;var t=global;return each(e.split("."),function(e){t=t[e]}),t}function makeError(e,t,r,n){var i=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return i.requireType=e,i.requireModules=n,r&&(i.originalError=r),i}function newContext(e){function t(e){var t,r;for(t=0;e[t];t+=1)if(r=e[t],"."===r)e.splice(t,1),t-=1;else if(".."===r){if(1===t&&(".."===e[2]||".."===e[0]))break;t>0&&(e.splice(t-1,2),t-=2)}}function r(e,r,n){var i,o,a,u,s,c,l,f,p,d,h,m=r&&r.split("/"),v=m,g=q.map,y=g&&g["*"];if(e&&"."===e.charAt(0)&&(r?(v=getOwn(q.pkgs,r)?m=[r]:m.slice(0,m.length-1),e=v.concat(e.split("/")),t(e),o=getOwn(q.pkgs,i=e[0]),e=e.join("/"),o&&e===i+"/"+o.main&&(e=i)):0===e.indexOf("./")&&(e=e.substring(2))),n&&g&&(m||y)){for(u=e.split("/"),s=u.length;s>0;s-=1){if(l=u.slice(0,s).join("/"),m)for(c=m.length;c>0;c-=1)if(a=getOwn(g,m.slice(0,c).join("/")),a&&(a=getOwn(a,l))){f=a,p=s;break}if(f)break;!d&&y&&getOwn(y,l)&&(d=getOwn(y,l),h=s)}!f&&d&&(f=d,p=h),f&&(u.splice(0,p,f),e=u.join("/"))}return e}function n(e){isBrowser&&each(scripts(),function(t){return t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===w.contextName?(t.parentNode.removeChild(t),!0):void 0})}function i(e){var t=getOwn(q.paths,e);return t&&isArray(t)&&t.length>1?(t.shift(),w.require.undef(e),w.require([e]),!0):void 0}function o(e){var t,r=e?e.indexOf("!"):-1;return r>-1&&(t=e.substring(0,r),e=e.substring(r+1,e.length)),[t,e]}function a(e,t,n,i){var a,u,s,c,l=null,f=t?t.name:null,p=e,d=!0,h="";return e||(d=!1,e="_@r"+(M+=1)),c=o(e),l=c[0],e=c[1],l&&(l=r(l,f,i),u=getOwn(A,l)),e&&(l?h=u&&u.normalize?u.normalize(e,function(e){return r(e,f,i)}):r(e,f,i):(h=r(e,f,i),c=o(h),l=c[0],h=c[1],n=!0,a=w.nameToUrl(h))),s=!l||u||n?"":"_unnormalized"+(_+=1),{prefix:l,name:h,parentMap:t,unnormalized:!!s,url:a,originalName:p,isDefine:d,id:(l?l+"!"+h:h)+s}}function u(e){var t=e.id,r=getOwn(E,t);return r||(r=E[t]=new w.Module(e)),r}function s(e,t,r){var n=e.id,i=getOwn(E,n);!hasProp(A,n)||i&&!i.defineEmitComplete?(i=u(e),i.error&&"error"===t?r(i.error):i.on(t,r)):"defined"===t&&r(A[n])}function c(e,t){var r=e.requireModules,n=!1;t?t(e):(each(r,function(t){var r=getOwn(E,t);r&&(r.error=e,r.events.error&&(n=!0,r.emit("error",e)))}),n||req.onError(e))}function l(){globalDefQueue.length&&(apsp.apply(j,[j.length-1,0].concat(globalDefQueue)),globalDefQueue=[])}function f(e){delete E[e],delete O[e]}function p(e,t,r){var n=e.map.id;e.error?e.emit("error",e.error):(t[n]=!0,each(e.depMaps,function(n,i){var o=n.id,a=getOwn(E,o);!a||e.depMatched[i]||r[o]||(getOwn(t,o)?(e.defineDep(i,A[o]),e.check()):p(a,t,r))}),r[n]=!0)}function d(){var e,t,r,o,a=1e3*q.waitSeconds,u=a&&w.startTime+a<(new Date).getTime(),s=[],l=[],f=!1,h=!0;if(!y){if(y=!0,eachProp(O,function(r){if(e=r.map,t=e.id,r.enabled&&(e.isDefine||l.push(r),!r.error))if(!r.inited&&u)i(t)?(o=!0,f=!0):(s.push(t),n(t));else if(!r.inited&&r.fetched&&e.isDefine&&(f=!0,!e.prefix))return h=!1}),u&&s.length)return r=makeError("timeout","Load timeout for modules: "+s,null,s),r.contextName=w.contextName,c(r);h&&each(l,function(e){p(e,{},{})}),u&&!o||!f||!isBrowser&&!isWebWorker||k||(k=setTimeout(function(){k=0,d()},50)),y=!1}}function h(e){hasProp(A,e[0])||u(a(e[0],null,!0)).init(e[1],e[2])}function m(e,t,r,n){e.detachEvent&&!isOpera?n&&e.detachEvent(n,t):e.removeEventListener(r,t,!1)}function v(e){var t=e.currentTarget||e.srcElement;return m(t,w.onScriptLoad,"load","onreadystatechange"),m(t,w.onScriptError,"error"),{node:t,id:t&&t.getAttribute("data-requiremodule")}}function g(){var e;for(l();j.length;){if(e=j.shift(),null===e[0])return c(makeError("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));h(e)}}var y,b,w,x,k,q={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},E={},O={},S={},j=[],A={},P={},M=1,_=1;return x={require:function(e){return e.require?e.require:e.require=w.makeRequire(e.map)},exports:function(e){return e.usingExports=!0,e.map.isDefine?e.exports?e.exports:e.exports=A[e.map.id]={}:void 0},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t,r=getOwn(q.pkgs,e.map.id);return t=r?getOwn(q.config,e.map.id+"/"+r.main):getOwn(q.config,e.map.id),t||{}},exports:A[e.map.id]}}},b=function(e){this.events=getOwn(S,e.id)||{},this.map=e,this.shim=getOwn(q.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},b.prototype={init:function(e,t,r,n){n=n||{},this.inited||(this.factory=t,r?this.on("error",r):this.events.error&&(r=bind(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=r,this.inited=!0,this.ignore=n.ignore,n.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,w.startTime=(new Date).getTime();var e=this.map;return this.shim?(w.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return e.prefix?this.callPlugin():this.load()})),void 0):e.prefix?this.callPlugin():this.load()}},load:function(){var e=this.map.url;P[e]||(P[e]=!0,w.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,r=this.map.id,n=this.depExports,i=this.exports,o=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(o)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{i=w.execCb(r,o,n,i)}catch(a){e=a}else i=w.execCb(r,o,n,i);if(this.map.isDefine&&(t=this.module,t&&void 0!==t.exports&&t.exports!==this.exports?i=t.exports:void 0===i&&this.usingExports&&(i=this.exports)),e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else i=o;this.exports=i,this.map.isDefine&&!this.ignore&&(A[r]=i,req.onResourceLoad&&req.onResourceLoad(w,this.map,this.depMaps)),f(r),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,t=e.id,n=a(e.prefix);this.depMaps.push(n),s(n,"defined",bind(this,function(n){var i,o,l,p=this.map.name,d=this.map.parentMap?this.map.parentMap.name:null,h=w.makeRequire(e.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(n.normalize&&(p=n.normalize(p,function(e){return r(e,d,!0)})||""),o=a(e.prefix+"!"+p,this.map.parentMap),s(o,"defined",bind(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),l=getOwn(E,o.id),l&&(this.depMaps.push(o),this.events.error&&l.on("error",bind(this,function(e){this.emit("error",e)})),l.enable()),void 0):(i=bind(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),i.error=bind(this,function(e){this.inited=!0,this.error=e,e.requireModules=[t],eachProp(E,function(e){0===e.map.id.indexOf(t+"_unnormalized")&&f(e.map.id)}),c(e)}),i.fromText=bind(this,function(r,n){var o=e.name,s=a(o),l=useInteractive;n&&(r=n),l&&(useInteractive=!1),u(s),hasProp(q.config,t)&&(q.config[o]=q.config[t]);try{req.exec(r)}catch(f){return c(makeError("fromtexteval","fromText eval for "+t+" failed: "+f,f,[t]))}l&&(useInteractive=!0),this.depMaps.push(s),w.completeLoad(o),h([o],i)}),n.load(e.name,h,i,q),void 0)})),w.enable(n,this),this.pluginMaps[n.id]=n},enable:function(){O[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(e,t){var r,n,i;if("string"==typeof e){if(e=a(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[t]=e,i=getOwn(x,e.id))return this.depExports[t]=i(this),void 0;this.depCount+=1,s(e,"defined",bind(this,function(e){this.defineDep(t,e),this.check()})),this.errback&&s(e,"error",bind(this,this.errback))}r=e.id,n=E[r],hasProp(x,r)||!n||n.enabled||w.enable(e,this)})),eachProp(this.pluginMaps,bind(this,function(e){var t=getOwn(E,e.id);t&&!t.enabled&&w.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var r=this.events[e];r||(r=this.events[e]=[]),r.push(t)},emit:function(e,t){each(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},w={config:q,contextName:e,registry:E,defined:A,urlFetched:P,defQueue:j,Module:b,makeModuleMap:a,nextTick:req.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=q.pkgs,r=q.shim,n={paths:!0,config:!0,map:!0};eachProp(e,function(e,t){n[t]?"map"===t?(q.map||(q.map={}),mixin(q[t],e,!0,!0)):mixin(q[t],e,!0):q[t]=e}),e.shim&&(eachProp(e.shim,function(e,t){isArray(e)&&(e={deps:e}),!e.exports&&!e.init||e.exportsFn||(e.exportsFn=w.makeShimExports(e)),r[t]=e}),q.shim=r),e.packages&&(each(e.packages,function(e){var r;e="string"==typeof e?{name:e}:e,r=e.location,t[e.name]={name:e.name,location:r||e.name,main:(e.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}),q.pkgs=t),eachProp(E,function(e,t){e.inited||e.map.unnormalized||(e.map=a(t))}),(e.deps||e.callback)&&w.require(e.deps||[],e.callback)},makeShimExports:function(e){function t(){var t;return e.init&&(t=e.init.apply(global,arguments)),t||e.exports&&getGlobal(e.exports)}return t},makeRequire:function(t,i){function o(r,n,s){var l,f,p;return i.enableBuildCallback&&n&&isFunction(n)&&(n.__requireJsBuild=!0),"string"==typeof r?isFunction(n)?c(makeError("requireargs","Invalid require call"),s):t&&hasProp(x,r)?x[r](E[t.id]):req.get?req.get(w,r,t,o):(f=a(r,t,!1,!0),l=f.id,hasProp(A,l)?A[l]:c(makeError("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(t?"":". Use require([])")))):(g(),w.nextTick(function(){g(),p=u(a(null,t)),p.skipMap=i.skipMap,p.init(r,n,s,{enabled:!0}),d()}),o)}return i=i||{},mixin(o,{isBrowser:isBrowser,toUrl:function(e){var n,i=e.lastIndexOf("."),o=e.split("/")[0],a="."===o||".."===o;return-1!==i&&(!a||i>1)&&(n=e.substring(i,e.length),e=e.substring(0,i)),w.nameToUrl(r(e,t&&t.id,!0),n,!0)},defined:function(e){return hasProp(A,a(e,t,!1,!0).id)},specified:function(e){return e=a(e,t,!1,!0).id,hasProp(A,e)||hasProp(E,e)}}),t||(o.undef=function(e){l();var r=a(e,t,!0),i=getOwn(E,e);n(e),delete A[e],delete P[r.url],delete S[e],i&&(i.events.defined&&(S[e]=i.events),f(e))}),o},enable:function(e){var t=getOwn(E,e.id);t&&u(e).enable()},completeLoad:function(e){var t,r,n,o=getOwn(q.shim,e)||{},a=o.exports;for(l();j.length;){if(r=j.shift(),null===r[0]){if(r[0]=e,t)break;t=!0}else r[0]===e&&(t=!0);h(r)}if(n=getOwn(E,e),!t&&!hasProp(A,e)&&n&&!n.inited){if(!(!q.enforceDefine||a&&getGlobal(a)))return i(e)?void 0:c(makeError("nodefine","No define call for "+e,null,[e]));h([e,o.deps||[],o.exportsFn])}d()},nameToUrl:function(e,t,r){var n,i,o,a,u,s,c,l,f;if(req.jsExtRegExp.test(e))l=e+(t||"");else{for(n=q.paths,i=q.pkgs,u=e.split("/"),s=u.length;s>0;s-=1){if(c=u.slice(0,s).join("/"),o=getOwn(i,c),f=getOwn(n,c)){isArray(f)&&(f=f[0]),u.splice(0,s,f);break}if(o){a=e===o.name?o.location+"/"+o.main:o.location,u.splice(0,s,a);break}}l=u.join("/"),l+=t||(/^data\:|\?/.test(l)||r?"":".js"),l=("/"===l.charAt(0)||l.match(/^[\w\+\.\-]+:/)?"":q.baseUrl)+l}return q.urlArgs?l+((-1===l.indexOf("?")?"?":"&")+q.urlArgs):l},load:function(e,t){req.load(w,e,t)},execCb:function(e,t,r,n){return t.apply(n,r)},onScriptLoad:function(e){if("load"===e.type||readyRegExp.test((e.currentTarget||e.srcElement).readyState)){interactiveScript=null;var t=v(e);w.completeLoad(t.id)}},onScriptError:function(e){var t=v(e);return i(t.id)?void 0:c(makeError("scripterror","Script error for: "+t.id,e,[t.id]))}},w.require=w.makeRequire(),w}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(e){return"interactive"===e.readyState?interactiveScript=e:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.9",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"==""+opera,contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if(void 0===define){if(void 0!==requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}void 0===require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(e,t,r,n){var i,o,a=defContextName;return isArray(e)||"string"==typeof e||(o=e,isArray(t)?(e=t,t=r,r=n):e=[]),o&&o.context&&(a=o.context),i=getOwn(contexts,a),i||(i=contexts[a]=req.s.newContext(a)),o&&i.configure(o),i.require(e,t,r)},req.config=function(e){return req(e)},req.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(e){req[e]=function(){var t=contexts[defContextName];return t.require[e].apply(t,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},req.load=function(e,t,r){var n,i=e&&e.config||{};if(isBrowser)return n=req.createNode(i,t,r),n.setAttribute("data-requirecontext",e.contextName),n.setAttribute("data-requiremodule",t),!n.attachEvent||n.attachEvent.toString&&(""+n.attachEvent).indexOf("[native code")<0||isOpera?(n.addEventListener("load",e.onScriptLoad,!1),n.addEventListener("error",e.onScriptError,!1)):(useInteractive=!0,n.attachEvent("onreadystatechange",e.onScriptLoad)),n.src=r,currentlyAddingScript=n,baseElement?head.insertBefore(n,baseElement):head.appendChild(n),currentlyAddingScript=null,n;if(isWebWorker)try{importScripts(r),e.completeLoad(t)}catch(o){e.onError(makeError("importscripts","importScripts failed for "+t+" at "+r,o,[t]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(e){return head||(head=e.parentNode),dataMain=e.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(e,t,r){var n,i;"string"!=typeof e&&(r=t,t=e,e=null),isArray(t)||(r=t,t=null),!t&&isFunction(r)&&(t=[],r.length&&((""+r).replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,r){t.push(r)}),t=(1===r.length?["require"]:["require","exports","module"]).concat(t))),useInteractive&&(n=currentlyAddingScript||getInteractiveScript(),n&&(e||(e=n.getAttribute("data-requiremodule")),i=contexts[n.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,r])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),define("requireLib",function(){}),define("inherits",[],function(){function e(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}return e.parasitically=function(t,r){for(var n,i=e.keys(r.prototype),o=i.length,a=0;o>a;a++)n=i[a],t.prototype[n]||(t.prototype[n]=r.prototype[n])},e.keys=Object.keys||function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],n=r.length;return function(i){if("object"!=typeof i&&"function"!=typeof i||null===i)throw new TypeError("Object.keys called on a non-object");var o=[];for(var a in i)e.call(i,a)&&o.push(a);if(t)for(var u=0;n>u;u++)e.call(i,r[u])&&o.push(r[u]);return o}}(),e}),define("event-emitter",["require","exports","module"],function(e,t,r){function n(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var r=0,n=e.length;n>r;r++)if(e[r]===t)return r;return-1}var i=Array.prototype.slice,o=r.exports=function(){this._listeners={}};o.listenerCount=function(e,t){var r=e._listeners[t];return r?r.length:0},o.prototype.on=function(e,t){return this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t),this},o.prototype.addListener=o.prototype.on,o.prototype.once=function(e,t){function r(){this.removeListener(e,r),t.apply(this,arguments)}return r.listener=t,this.on(e,r)},o.prototype.removeListener=function(e,t){if(t&&this._listeners[e]){var r=n(this._listeners[e],t);if(-1===r)return;this._listeners[e].splice(r,1)}},o.prototype.emit=function(e){var t,r=this._listeners[e]||[],n=i.call(arguments,1);if(r.length&&(r=r.slice()),"error"===e&&!r.length)throw t=n[0],t instanceof Error?t:TypeError('Uncaught, unspecified "error" event');for(var o=0,a=r.length;a>o;o++)try{r[o].apply(this,n)}catch(t){switch(e){case"error":try{this.emit("errorOnError",t)}catch(u){throw Error("event-emitter: There was an exceptionin the errorInOnError listener",t,this)}break;default:this.emit("error",t)}}}}),define("debug",["require","exports","module"],function(e,t,r){function n(e){return n.enabled(e)?function(t){t=i(t);var r=new Date,o=r-(n[e]||r);n[e]=r,t=e+" "+t+" +"+n.humanize(o),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function i(e){return e instanceof Error?e.stack||e.message:e}r.exports=n,n.names=[],n.skips=[],n.enable=function(e){try{localStorage.debug=e}catch(t){}for(var r=(e||"").split(/[\s,]+/),i=r.length,o=0;i>o;o++)e=r[o].replace("*",".*?"),"-"===e[0]?n.skips.push(RegExp("^"+e.substr(1)+"$")):n.names.push(RegExp("^"+e+"$"))},n.disable=function(){n.enable("")},n.humanize=function(e){var t=1e3,r=6e4,n=60*r;return e>=n?(e/n).toFixed(1)+"h":e>=r?(e/r).toFixed(1)+"m":e>=t?(0|e/t)+"s":e+"ms"},n.enabled=function(e){for(var t=0,r=n.skips.length;r>t;t++)if(n.skips[t].test(e))return!1;for(var t=0,r=n.names.length;r>t;t++)if(n.names[t].test(e))return!0;return!1};try{window.localStorage&&n.enable(localStorage.debug)}catch(o){}}),define("auth/util/bind",["require","exports","module"],function(e,t,r){r.exports=function(e,t){if(!e)throw Error();if(arguments.length>2){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}}),define("auth/auth",["require","exports","module","inherits","event-emitter","debug","./util/bind"],function(e,t,r){function n(e,t){var r=0;return t=t||{},function(){return r++,r>1?(a(["This function is only meant to be called once, but it was called ",r," times"].join("")),void 0):(e.apply(t,arguments),void 0)}}var i=e("inherits"),o=e("event-emitter"),a=e("debug")("auth"),u=e("./util/bind"),s=r.exports=function(){var e,t=!1,r=!1;o.apply(this),this._delegate=!1;var n=function(t){return t?e&&e[t]:e};this.on("login",function(n){e=n,t=!0,r=!0}),this.on("authenticate",function(){r=!0}),this.on("logout",function(){e=null,t=!1,r=!1}),this.on("error",function(e){a(e)}),this.get=n,this.isAuthenticated=function(){return r}};i(s,o),s.prototype.delegate=function(e){return a("Auth#delegate",e),this._delegate={},e.login&&(this._delegate.login=u(e.login,e)),e.logout&&(this._delegate.logout=u(e.logout,e)),e.viewProfile&&(this._delegate.viewProfile=u(e.viewProfile,e)),e.editProfile&&(this._delegate.editProfile=u(e.editProfile,e)),e.forEachAuthentication&&e.forEachAuthentication(u(function(e){this._authenticate(e)},this)),this.emit("delegate",e),this},s.prototype.hasDelegate=function(e){return"string"==typeof e?this._delegate&&this._delegate.hasOwnProperty(e):!!this._delegate},s.prototype.login=function(e){if(e&&"function"!=typeof e)return this._loginUser(e);var t=e;a("Auth#login");var r=this._delegate.login,i=u(n(function(){this._finishLogin.apply(this,arguments),"function"==typeof t&&t.apply(this,arguments)},this));r(i)},s.prototype._loginUser=function(e){this.emit("login",e);for(var t in e)e.hasOwnProperty(t)&&this.emit("login."+t,e[t])},s.prototype._finishLogin=function(e,t){return a("Auth#_finishLogin",e,t),e?(this.emit("error",e),void 0):(t||a(["_finishLogin called without a truthy second parameter. The user","cannot be authenticated."].join(" ")),this._authenticate(t),void 0)},s.prototype.logout=function(e){a("Auth#logout");var t=this._delegate.logout,r=Error("No logout auth delegate");if(!t){if("function"!=typeof e)throw r;return e(r),void 0}var i=u(n(function(){this._finishLogout.apply(this,arguments),"function"==typeof e&&e.apply(this,arguments)},this));t(i)},s.prototype._finishLogout=function(e,t){return a("Auth#_finishLogout",t),e?(this.emit("error",e),void 0):(this.emit("logout"),void 0)},s.prototype.authenticate=function(e){this._authenticate(e)},s.prototype._authenticate=function(e){if(e){for(var t in e)e.hasOwnProperty(t)&&this.emit("authenticate."+t,e[t]);this.emit("authenticate",e)}},s.prototype.viewProfile=function(e){this._delegate.viewProfile(e)},s.prototype.editProfile=function(e){this._delegate.editProfile(e)},s.prototype.plugin=function(e){return e(this),this}}),define("auth/main",["require","exports","module","./auth"],function(e,t,r){var n=e("./auth"),i=function(e){return new n(e)};t=r.exports=i(),t.create=i}),define("auth",["auth/main"],function(e){return e}),define("base64",["require","exports","module"],function(e,t,r){function n(e){this.message=e}var i={},o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=Error(),n.prototype.name="InvalidCharacterError",i.btoa=window.btoa?function(e){return window.btoa(e)}:function(e){for(var t,r,i=0,a=o,u="";e.charAt(0|i)||(a="=",i%1);u+=a.charAt(63&t>>8-8*(i%1))){if(r=e.charCodeAt(i+=.75),r>255)throw new n("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");t=t<<8|r}return u},i.atob=window.atob?function(e){return window.atob(e)}:function(e){if(e=e.replace(/=+$/,""),1==e.length%4)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var t,r,i=0,a=0,u="";r=e.charAt(a++);~r&&(t=i%4?64*t+r:r,i++%4)?u+=String.fromCharCode(255&t>>(6&-2*i)):0)r=o.indexOf(r);return u},i.url={btoa:function(e){var t=i.btoa(e);return t=t.replace(/\+/g,"-"),t=t.replace(/\//g,"_")},atob:function(e){var t=e;return t=t.replace(/-/g,"+"),t=t.replace(/_/g,"/"),i.atob(t)}},r.exports=i}),define("livefyre-auth/collection-authorization",["require","exports","module"],function(e,t,r){r.exports=function(e){this.collection=e,this.authors=[],this.moderatorKey=null}}),define("mout/function/identity",[],function(){function e(e){return e}return e}),define("mout/function/prop",[],function(){function e(e){return function(t){return t[e]}}return e}),define("mout/object/hasOwn",[],function(){function e(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return e}),define("mout/object/forIn",["./hasOwn"],function(e){function t(){o=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=!0;for(var e in{toString:null})i=!1}function r(r,a,u){var s,c=0;null==i&&t();for(s in r)if(n(a,r,s,u)===!1)break;if(i)for(var l=r.constructor,f=!!l&&r===l.prototype;(s=o[c++])&&("constructor"===s&&(f||!e(r,s))||r[s]===Object.prototype[s]||n(a,r,s,u)!==!1););}function n(e,t,r,n){return e.call(n,t[r],r,t)}var i,o;return r}),define("mout/object/forOwn",["./hasOwn","./forIn"],function(e,t){function r(r,n,i){t(r,function(t,o){return e(r,o)?n.call(i,r[o],o,r):void 0})}return r}),define("mout/lang/kindOf",[],function(){function e(e){return null===e?"Null":e===t?"Undefined":r.exec(n.call(e))[1]}var t,r=/^\[object (.*)\]$/,n=Object.prototype.toString;return e}),define("mout/lang/isKind",["./kindOf"],function(e){function t(t,r){return e(t)===r}return t}),define("mout/lang/isArray",["./isKind"],function(e){var t=Array.isArray||function(t){return e(t,"Array")};return t}),define("mout/object/deepMatches",["./forOwn","../lang/isArray"],function(e,t){function r(e,t){for(var r=-1,n=e.length;++r<n;)if(o(e[r],t))return!0;return!1}function n(e,t){for(var n=-1,i=t.length;++n<i;)if(!r(e,t[n]))return!1;return!0}function i(t,r){var n=!0;return e(r,function(e,r){return o(t[r],e)?void 0:n=!1}),n}function o(e,r){return e&&"object"==typeof e?t(e)&&t(r)?n(e,r):i(e,r):e===r}return o}),define("mout/function/makeIterator_",["./identity","./prop","../object/deepMatches"],function(e,t,r){function n(n,i){if(null==n)return e;switch(typeof n){case"function":return void 0!==i?function(e,t,r){return n.call(i,e,t,r)}:n;case"object":return function(e){return r(e,n)};case"string":case"number":return t(n)}}return n}),define("mout/array/filter",["../function/makeIterator_"],function(e){function t(t,r,n){r=e(r,n);var i=[];if(null==t)return i;for(var o,a=-1,u=t.length;++a<u;)o=t[a],r(o,a,t)&&i.push(o);return i}return t}),define("livefyre-auth/util/jsonp",["require","exports","module"],function(e,t,r){function n(e,t){function r(){i.parentNode&&i.parentNode.removeChild(i),window[n]=void 0}var n="_lfcallback_"+ +new Date,i=document.createElement("script"),o=e.indexOf("?")>0?"&":"?";window[n]=function(e){r(),t(null,e)},i.type="text/javascript",i.async=!0,i.onerror=function(){r(),t("error")},i.src=e+o+"callback="+n,document.getElementsByTagName("head")[0].appendChild(i)}r.exports={req:n}}),define("mout/array/map",["../function/makeIterator_"],function(e){function t(t,r,n){r=e(r,n);var i=[];if(null==t)return i;for(var o=-1,a=t.length;++o<a;)i[o]=r(t[o],o,t);return i}return t}),define("livefyre-auth/auth-api",["require","exports","module","base64","./collection-authorization","mout/array/filter","./util/jsonp","mout/array/map"],function(e,t,r){function n(e){var t=e&&e.code;if(200!==t){var r=Error("Error requesting with JSONP");return r.response=e,r.code=t,r}}function i(e){for(var t,r=[].slice.call(arguments,1),n=0,i=r.length;i>n;n++){t=r[n];for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])}return e}function o(e,t){var r="{key}={value}".replace("{key}",e).replace("{value}",encodeURIComponent(t));return r}function a(e){var t=e.split(".");if(3!==t.length)throw Error("The provided lftoken is not a JWT: "+e);var r=l.atob(t[1]),n=JSON.parse(r),i=n.domain;return i}function u(e){return e.split(".")[0]}function s(e){var t=u(e),r="http:"!==document.location.protocol?"https:":document.location.protocol;return"livefyre"===t?r+"//"+"admin."+e:r+"//"+t+".admin.fyre.co"}function c(e){var t=a(e);return s(t)}var l=e("base64"),f=e("./collection-authorization"),p=e("mout/array/filter"),d=e("./util/jsonp"),h=e("mout/array/map"),m=r.exports={};m.authenticate=function(e,t){var r,i,a=[],u=e&&e.token,f=e&&e.serverUrl;u&&a.push(o("lftoken",e.token)),e.network&&(f=s(e.network)),f||(f=u?c(u):"http://livefyre.com"),e.bpChannel&&a.push(o("bp_channel",e.bpChannel)),e.articleId&&e.siteId&&a.push(o("articleId",l.btoa(e.articleId)),o("siteId",e.siteId)),r=a.join("&"),i=[f,"/api/v3.0/auth/?",r].join(""),this._request(i,function(e,r){e||(e=n(r));var i=r&&r.data;t(e,i)})},m._request=function(e,t){d.req(e,t)},m.updateUser=function(e,t,r){var n,o=t.profile,a=t.token,u=a&&a.value,s=a&&new Date(+new Date+1e3*a.ttl),c=t.collection_id,l=i({},o,{serverUrl:t.serverUrl,token:u,tokenExpiresAt:s});e.set(l);var f=[];c&&(n=this.createCollectionAuthorization(r||{},t),n&&f.push(n));var d=this.createNetworkAuthorizations(t);d.length>0&&f.push.apply(f,d);var h=this.createSiteAuthorizations(t);h.length>0&&f.push.apply(f,h);var m=p(f,function(t){return t.network?!e.isMod({network:t.network}):t.siteId?!e.isMod({siteId:t.siteId}):t.collection&&t.collection.id?!e.isMod({collectionId:t.collection.id}):!1});return m.length>0&&e.authorizations.push.apply(e.authorizations,m),e},m.createCollectionAuthorization=function(e,t){var r={network:e.network,id:t.collection_id,siteId:e.siteId,articleId:e.articleId},n=new f(r),i=t.permissions,o=i&&i.authors;o&&o.length>0&&n.authors.push.apply(n.authors,o);var a=i&&i.moderator_key;return a&&(n.moderatorKey=a),n},m.createNetworkAuthorizations=function(e){var t=e.modScopes,r=t&&t.networks;if(!(r&&r.length>0))return[];var n=h(r,function(e){var t={network:e,moderator:!0};return t});return n},m.createSiteAuthorizations=function(e){var t=e.modScopes,r=t&&t.sites;if(!(r&&r.length>0))return[];var n=h(r,function(e){var t={siteId:e,moderator:!0};return t});return n}}),define("mout/array/slice",[],function(){function e(e,t,r){var n=e.length;t=null==t?0:0>t?Math.max(n+t,0):Math.min(t,n),r=null==r?n:0>r?Math.max(n+r,0):Math.min(r,n);for(var i=[];r>t;)i.push(e[t++]);return i}return e}),define("mout/function/bind",["../array/slice"],function(e){function t(t,r){var n=e(arguments,2);return function(){return t.apply(r,n.concat(e(arguments)))}}return t}),define("mout/array/some",["../function/makeIterator_"],function(e){function t(t,r,n){r=e(r,n);var i=!1;if(null==t)return i;for(var o=-1,a=t.length;++o<a;)if(r(t[o],o,t)){i=!0;break}return i}return t}),define("livefyre-auth/user",["require","exports","module","event-emitter","inherits","mout/array/some"],function(e,t,r){function n(){this._attributes={},this.authorizations=[],s.call(this)}function i(e){var t=l(this.authorizations,function(t){var r=t.collection;return Boolean(r&&t.moderatorKey&&r.network===e.network&&r.siteId===e.siteId&&r.articleId===e.articleId)});return t}function o(e){var t=this.getAuthorizationByCollectionId(e);return Boolean(t&&t.moderatorKey)}function a(e){var t=l(this.authorizations,function(t){var r=t.network;return r&&r===e&&t.moderator});return t}function u(e){var t=l(this.authorizations,function(t){var r=t.siteId;return r&&r===e&&t.moderator});return t}var s=e("event-emitter"),c=e("inherits"),l=e("mout/array/some");c(n,s),n.EVENTS={CHANGE:"change"},n.prototype.set=function(e,t){var r,i,o;"string"==typeof e&&(r=e,e={},e[r]=t);for(i in e)e.hasOwnProperty(i)&&(o=e[i],this._attributes[i]=o,this.emit(n.EVENTS.CHANGE+":"+i,o));this.emit(n.EVENTS.CHANGE,e)},n.prototype.get=function(e){return e?this._attributes[e]:this._attributes},n.prototype.unset=function(e){if(e in this._attributes){delete this._attributes[e];var t={};t[e]=void 0,this.emit(n.EVENTS.CHANGE+":"+e,t[e])
}},n.prototype.isAuthenticated=function(){return!!this.get("id")},n.prototype.getAuthorizationByCollectionId=function(e){for(var t,r,n=0;n<this.authorizations.length;n++)if(t=this.authorizations[n],r=t.collection,r&&r.id===e)return t;return null},n.prototype.isMod=function(e){return e.collectionId?o.call(this,e.collectionId):e.articleId?i.call(this,e):e.network?a.call(this,e.network):e.siteId?u.call(this,e.siteId):void 0},r.exports=n}),define("mout/lang/isPlainObject",[],function(){function e(e){return!!e&&"object"==typeof e&&e.constructor===Object}return e}),define("mout/object/mixIn",["./forOwn"],function(e){function t(t){for(var n,i=0,o=arguments.length;++i<o;)n=arguments[i],null!=n&&e(n,r,t);return t}function r(e,t){this[t]=e}return t}),define("mout/lang/clone",["./kindOf","./isPlainObject","../object/mixIn"],function(e,t,r){function n(t){switch(e(t)){case"Object":return i(t);case"Array":return u(t);case"RegExp":return o(t);case"Date":return a(t);default:return t}}function i(e){return t(e)?r({},e):e}function o(e){var t="";return t+=e.multiline?"m":"",t+=e.global?"g":"",t+=e.ignorecase?"i":"",RegExp(e.source,t)}function a(e){return new Date(+e)}function u(e){return e.slice()}return n}),define("mout/lang/deepClone",["./clone","../object/forOwn","./kindOf","./isPlainObject"],function(e,t,r,n){function i(t,n){switch(r(t)){case"Object":return o(t,n);case"Array":return a(t,n);default:return e(t)}}function o(e,r){if(n(e)){var o={};return t(e,function(e,t){this[t]=i(e,r)},o),o}return r?r(e):e}function a(e,t){for(var r=[],n=-1,o=e.length;++n<o;)r[n]=i(e[n],t);return r}return i}),define("livefyre-auth/util/storage",["require","exports","module"],function(e,t,r){var n="__lfstorage__",i=function(){try{var e=localStorage||null;return e.setItem(n,"1"),e.removeItem(n),!0}catch(t){return!1}}(),o={set:function(e,t,r){var n={value:t,expiration:r||null};try{localStorage.setItem(e,JSON.stringify(n))}catch(i){}},get:function(e){try{var t=localStorage.getItem(e),r=t?JSON.parse(t):{};return r.expiration&&r.expiration<+new Date?(o.remove(e),void 0):r.value}catch(n){return void 0}},remove:function(e){try{localStorage.removeItem(e)}catch(t){}}},a={set:function(e,t,r){function n(e){return new Date(e).toUTCString()}var i,o,a=6048e5;i=r>0?n(r):0===r?";expires="+new Date(1970,1,1).toUTCString():+new Date+a,document.cookie=e+"="+JSON.stringify(t)+o},get:function(e){function t(){return document.cookie.split(/\s*;\s*/)}for(var r,n=e+"=",i=t(),o=0;r=i[o];++o){if(0===r.lastIndexOf(n,0))return r.substr(n.length);if(r===e)return""}return void 0},remove:function(e){a.set(e,"",0)}};r.exports=i?o:a}),define("livefyre-auth/session",["require","exports","module","./auth-api","mout/lang/deepClone","./user","./util/storage"],function(e,t,r){var n=e("./auth-api"),i=e("mout/lang/deepClone"),o=e("./user"),a=e("./util/storage"),u="fyre-auth",s="fyre-authentication-creds";r.exports={get:function(){var e=a.get(u)||{};if(!e.token)return null;var t=new o;return n.updateUser(t,e),t},save:function(e,t){var r=i(e),n=e.token,o=+new Date+1e3*n.ttl;t&&(r.mod_map=t.get("modMap")),a.set(u,r,o);var c=e.token;c&&a.set(s,c.value,+new Date+1e3*c.ttl)},clear:function(){a.remove(u),a.remove(s)}}}),define("livefyre-auth/auth-adapters",["require","exports","module","auth","./auth-api","mout/function/bind","./user","./session"],function(e,t,r){function n(e){var t="function"==typeof e.loginByCookie,r=window.fyre&&"object"==typeof window.fyre.conv;return!!t&&!!r}function i(e){var t="function"==typeof e.restoreSession,r=window.Livefyre&&"object"==typeof window.Livefyre.user;return t&&r}function o(e){return n(e)||i(e)}function a(e){function t(e,t){"function"==typeof e&&e.apply(this,null,t)}function r(t){var r=new p;t.serverUrl=e.serverUrl,r=l.updateUser(r,t),c.login({livefyre:r})}function n(){c.emit("logout")}var i={},o=window.Livefyre;return o.user.on("login",r),o.user.on("logout",n),i.login=function(){var r=e.login;return function(n){r.call(e),o.user.once("login",function(e){t(n,[e])})}}(),i.logout=function(){var r=e.logout;return function(n){r.call(e),o.user.once("logout",function(){t(n)})}}(),i.viewProfile=f(e.viewProfile,e),i.editProfile=f(e.editProfile,e),i.destroy=function(){o.user.removeListener("login",r),o.user.removeListener("logout",n),e.destroy()},i}function u(e){function t(e,t){return t?(c.login({livefyre:d.get()}),void 0):c.emit("logout")}function r(e){return{success:function(){"function"==typeof e&&e.apply(this,null,arguments)},failure:function(){"function"==typeof e&&e.apply(this,arguments)}}}var n=window.fyre;n.conv.user.on("change:token",t),n.conv.user.id&&(c.get("livefyre")||t(n.conv.user.get("token")));var i={success:function(){},failure:function(){}},o=Array.prototype.slice,a={};return a.login=function(){var t=e.login;return function(n){t.call(e,r(n))}}(),a.logout=function(){var t=e.logout;return function(r){t.call(e,i),r()}}(),a.viewProfile=function(){var t=e.viewProfile;return function(){var r=o.call(arguments);r.unshift(i),t.apply(e,r)}}(),a.editProfile=function(){var t=e.editProfile;return function(){var r=o.call(arguments);r.unshift(i),t.apply(e,r)}}(),a.destroy=function(){n.conv.user.off("change:token",t)},e.loginByCookie(i),a}function s(e){return i(e)?a(e):n(e)?u(e):e}var c=e("auth"),l=e("./auth-api"),f=e("mout/function/bind"),p=e("./user"),d=e("./session");r.exports={oldToNew:s,isOld:o}}),define("livefyre-auth/user-service",["require","exports","module","./auth-api","./user"],function(e,t){var r=e("./auth-api"),n=e("./user");t.fetch=function(e,t){var i=this._authApi||r;i.authenticate(e,function(r,o){if(r)return t(r);if(!o.profile)return r=Error("fetch-user got empty auth response"),t(r);var a=new n;o.serverUrl=e.serverUrl,i.updateUser(a,o,e),t(null,a,o)})}}),define("livefyre-auth/auth-plugin",["require","exports","module","./auth-adapters","./user","debug","./session","./user-service"],function(e,t,r){var n=e("./auth-adapters"),i=e("./user"),o=e("debug")("livefyre-auth/auth-plugin"),a=e("./session"),u=e("./user-service");r.exports=function(e,t,r){function s(t){e.login({livefyre:t})}function c(){if("function"==typeof fyre.conv.getDelegate){var t=fyre.conv.getDelegate();t&&!t.appkitMetaDelegate&&e.delegate(t)}}function l(){return window.fyre&&window.fyre.conv&&"function"==typeof fyre.conv.ready?(fyre.conv.ready(function(){c()}),!0):void 0}r=r||{};var f=r.userService||u,p=a.get();p&&s(p),e.on("authenticate.livefyre",function(e){if(e){if(e instanceof i)return s(e);"string"==typeof e?e={token:e,serverUrl:t}:"object"==typeof e&&(e={token:e.lftoken,serverUrl:e.serverUrl?e.serverUrl:t,network:e.network}),f.fetch(e,function(t,r,n){return t?(o("Error authenticating with credentials",e,t),void 0):(a.save(n,r),s(r),void 0)})}}),e.on("logout",function(){a.clear()}),e.delegate=function(t){return function(r){r=n.oldToNew(r),t.call(e,r)}}(e.delegate);var d=0;!function h(){d++,d>15||e.hasDelegate()||l()||setTimeout(h,100*d)}()}}),define("livefyre-auth/livefyre-auth-delegate",["require","exports","module","./auth-adapters","./util/jsonp","./util/storage","./user-service","./session"],function(e,t,r){function n(e,t){return this instanceof n?(t=t||{},this.serverUrl=e,this.siteId=t.siteId,void 0):new n(e,t)}e("./auth-adapters");var i=e("./util/jsonp"),o=e("./util/storage"),a=navigator.userAgent,u="fyre-auth",s=e("./user-service"),c=a.indexOf("Opera")>-1,l=e("./session");n.prototype.login=function(e){var t=this;this._popup(function(){t.restoreSession(function(t,r){e(t,{livefyre:r})})})},n.prototype._popup=function(e){function t(e){if(!e)return!1;try{return e.closed===!1}catch(t){if(c)return!0;throw t}}function r(e,r){return t(r)?void 0:(clearInterval(s),e(),void 0)}var n=this.serverUrl,i=n+"/auth/popup/login/",o="width=530;height=365;location=true;menubar=false;resizable=false;scrollbars=false",a="?start=true";this.siteId&&(a+="&site_id="+this.siteId);var u=window.open(i+a,"authWindow",o),s=setInterval(function(){r(e,u)},100)},n.prototype.logout=function(e){var t=this.serverUrl+"/auth/logout/ajax/?nocache="+(new Date).getTime();i.req(t,function(t,r){e(t,r)})},n.prototype.viewProfile=function(e){window.open(e.profileUrl,"_blank")},n.prototype.editProfile=function(){window.open(this.serverUrl+"/profile/edit/info/","_blank")},n.prototype.restoreSession=function(e){var t=o.get(u)||{};t.token?e(null,t.token.value):(o.remove(u),s.fetch({serverUrl:this.serverUrl},function(t,r,n){return t?e(t):(l.save(n,r),e(null,r),void 0)}))},r.exports=n}),define("livefyre-auth/main",["require","exports","module","auth","./auth-plugin","./livefyre-auth-delegate","./user","./user-service","./auth-api"],function(e,t,r){var n=e("auth"),i=e("./auth-plugin");i(n),r.exports=t=n,t.createDelegate=e("./livefyre-auth-delegate"),t.User=e("./user"),t.userService=e("./user-service"),t.api=e("./auth-api"),t.authPlugin=i}),define("livefyre-auth",["livefyre-auth/main"],function(e){return e}),define("text",["module"],function(e){var t,r,n=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,o=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,a="undefined"!=typeof location&&location.href,u=a&&location.protocol&&location.protocol.replace(/\:/,""),s=a&&location.hostname,c=a&&(location.port||void 0),l=[],f=e.config&&e.config()||{};return t={version:"2.0.5",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(o);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,r;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){r=n[t];try{e=new ActiveXObject(r)}catch(i){}if(e){n=[r];break}}return e},parseName:function(e){var t,r,n,i=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),r=e.substring(o+1,e.length)):t=e,n=r||t,o=n.indexOf("!"),-1!==o&&(i="strip"===n.substring(o+1),n=n.substring(0,o),r?r=n:t=n),{moduleName:t,ext:r,strip:i}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,r,n,i){var o,a,u,s=t.xdRegExp.exec(e);return s?(o=s[2],a=s[3],a=a.split(":"),u=a[1],a=a[0],!(o&&o!==r||a&&a.toLowerCase()!==n.toLowerCase()||(u||a)&&u!==i)):!0},finishLoad:function(e,r,n,i){n=r?t.strip(n):n,f.isBuild&&(l[e]=n),i(n)},load:function(e,r,n,i){if(i.isBuild&&!i.inlineText)return n(),void 0;f.isBuild=i.isBuild;var o=t.parseName(e),l=o.moduleName+(o.ext?"."+o.ext:""),p=r.toUrl(l),d=f.useXhr||t.useXhr;!a||d(p,u,s,c)?t.get(p,function(r){t.finishLoad(e,o.strip,r,n)},function(e){n.error&&n.error(e)}):r([l],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)})},write:function(e,r,n){if(l.hasOwnProperty(r)){var i=t.jsEscape(l[r]);n.asModule(e+"!"+r,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,r,n,i,o){var a=t.parseName(r),u=a.ext?"."+a.ext:"",s=a.moduleName+u,c=n.toUrl(a.moduleName+u)+".js";t.load(s,n,function(){var r=function(e){return i(c,e)};r.asModule=function(e,t){return i.asModule(e,c,t)},t.write(e,s,r,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node?(r=require.nodeRequire("fs"),t.get=function(e,t){var n=r.readFileSync(e,"utf8");0===n.indexOf("ï»¿")&&(n=n.substring(1)),t(n)}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,r,n,i){var o,a=t.createXhr();if(a.open("GET",e,!0),i)for(o in i)i.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),i[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(){var t,i;4===a.readyState&&(t=a.status,t>399&&600>t?(i=Error(e+" HTTP status: "+t),i.xhr=a,n(i)):r(a.responseText))},a.send(null)}:("rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java)&&(t.get=function(e,t){var r,n,i="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),u=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),i)),s="";try{for(r=new java.lang.StringBuffer,n=u.readLine(),n&&n.length()&&65279===n.charAt(0)&&(n=n.substring(1)),r.append(n);null!==(n=u.readLine());)r.append(a),r.append(n);s=""+r+""}finally{u.close()}t(s)}),t}),define("json",["text"],function(text){function cacheBust(e){return e=e.replace(CACHE_BUST_FLAG,""),e+=e.indexOf("?")<0?"?":"&",e+CACHE_BUST_QUERY_PARAM+"="+Math.round(2147483647*Math.random())}var CACHE_BUST_QUERY_PARAM="bust",CACHE_BUST_FLAG="!bust",jsonParse="undefined"!=typeof JSON&&"function"==typeof JSON.parse?JSON.parse:function(val){return eval("("+val+")")},buildMap={};return{load:function(e,t,r,n){!n.isBuild||n.inlineJSON!==!1&&-1===e.indexOf(CACHE_BUST_QUERY_PARAM+"=")?text.get(t.toUrl(e),function(t){n.isBuild?(buildMap[e]=t,r(t)):r(jsonParse(t))},r.error,{accept:"application/json"}):r(null)},normalize:function(e){return-1===e.indexOf(CACHE_BUST_FLAG)?e:cacheBust(e)},write:function(e,t,r){if(t in buildMap){var n=buildMap[t];r('define("'+e+"!"+t+'", function(){ return '+n+";});\n")}}}}),define("json!lfpackages/packages.json",function(){return{"livefyre-geo-collection":{main:"livefyre-geo-collection.lf",versions:["0.0.0"]},stream:{main:"stream",versions:["0.2.2"]},"fyre.conv":{main:"livefyre",versions:["3.0.0"],qa:"3.0.0-rc",uat:"3.0.0-staging"},"personalized-stream-counter":{main:"personalized-stream-counter",versions:["0.0.1","0.1.6"]},"poll-manager":{main:"poll-manager",versions:["0.1.0","0.2.28"],qa:"0.2.30-rc",uat:"0.2.28-staging"},"collection-feed":{main:"collection-feed",versions:["0.0.16"],dev:"0.0.0-dev.0"},"backplane-auth-plugin":{main:"index",versions:["0.1.0"],qa:"0.1.0-rc.0"},"lfep-auth-delegate":{main:"index",versions:["0.0.2","0.1.1"]},poll:{main:"poll",versions:["0.1.31"],qa:"0.1.31-rc",uat:"0.1.31-staging"},"streamhub-hot-collections":{main:"streamhub-hot-collections",versions:["0.1.1"]},tracker:{main:"tracker",versions:["0.3.4"],qa:"0.3.4-rc",uat:"0.3.4-staging"},"personalized-feed-stub":{main:"personalized-feed-stub",versions:["0.0.5"],dev:"0.0.0-dev.0"},"streamhub-sdk":{main:"streamhub-sdk",versions:["2.8.0","2.11.5","2.12.11","2.13.10","2.14.2","2.15.4","2.16.0"],qa:"2.14.0-rc"},"streamhub-permalink":{main:"streamhub-permalink",versions:["0.1.0","0.2.0","0.3.2"],qa:"0.3.1-rc"},sidenotes:{main:"sidenotes",versions:["1.0.8","1.1.18","1.2.7"],qa:"1.2.7-rc",uat:"1.2.7-staging"},"streamhub-gallery":{main:"streamhub-gallery",versions:["0.6.1","0.7.0"]},"streamhub-wall":{main:"streamhub-wall",versions:["2.4.1","2.5.0","2.6.1","3.0.7","3.1.5","3.2.1","3.3.2","3.4.0","3.5.0"],qa:"3.5.1-rc",uat:"3.5.0-staging"},"livefyre-map":{main:"livefyre-map",versions:["2.0.4"],qa:"2.0.3-rc",uat:"2.0.4-staging"},"streamhub-map":{main:"streamhub-map",versions:["1.3.2","1.4.0"],qa:"1.4.0-rc",uat:"1.4.0-staging"},"streamhub-feed":{main:"streamhub-feed",versions:["2.1.1","3.0.1"],dev:"2.1.1-dev.0"},"streamhub-input":{main:"streamhub-input",versions:["0.2.2","0.3.10","0.4.3"]},"app-embed-contrib":{main:"app-embed-contrib",versions:["0.0.5","0.1.0","0.2.0","0.3.1","0.4.0","0.5.0","0.6.4"],qa:"0.0.0-rc.13"},"app-embed":{main:"app-embed",versions:["0.0.5","0.1.0","0.2.0","0.3.1","0.4.0","0.5.0","0.6.4"],qa:"0.0.1-rc.1"},"appkit-mock-content":{main:"appkit-mock-content",versions:["0.0.6"]}}}),define("semver",["require","exports","module"],function(e,t){function r(e,t,r){for(var n=-1,i=e.length,o=r;++n<i;)o=t(o,e[n]);return o}function n(e){var t;((t=e.indexOf("-"))>-1||(t=e.indexOf("+"))>-1)&&(e=e.slice(0,t));for(var r,n=e.split("."),i=-1,o=n.length,a=[];++i<o&&(r=n[i].replace(/\D/,""));)a.push(r);return a}function i(e){return/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)([\+|-].*)?$/.test(e)}function o(e){return/^.?\d+/.test(e)}function a(e,t){for(var r=0,n=e.length;n>r;r++){if(isNaN(t[r]))return!0;if(parseInt(e[r],10)>parseInt(t[r],10))return!1}return!0}function u(e,t){if(!o(t))return null;var i=n(t);return r(e,function(e,t){var r=n(t);if(a(r,i)){if(!e)return t;if(!a(r,n(e)))return t}return e},null)}t.valid=i,t.validRange=o,t.maxSatisfying=u}),define("livefyre-require/options",[],function(){var e=!0,t=window.location.search.match(/lfmin=([^&#]*)/);t&&t.length&&(e=!!parseInt(t[1],10));var r=!0,n=window.location.search.match(/lfcdn=([^&#]*)/);n&&n.length&&(r=!!parseInt(n[1],10));var i="livefyre-cdn",o=i,a=window.location.search.match(/lfbucket=([^&#]*)/);a&&a.length&&(o+="-"+a[1]);for(var u,s={},c=/[?|&]lfVersion\[([^&#]+)\]=([^&#$]+)/g;u=c.exec(window.location.search);)s[u[1]]=u[2];return o!==i&&(r=!1),{env:function(){return lfenv},cdn:function(){return r},minified:function(){return e},bucketUrl:function(){return o+".s3.amazonaws.com"},cdnUrl:function(){return"cdn.livefyre.com"},overrides:function(){return s}}}),define("livefyre-require/resolvers",["json!lfpackages/packages.json","semver","livefyre-require/options"],function(e,t,r){function n(r){var n,i,o=r.split(d),s=o[1],c=o[0],p=c,h=s;if(!s)return null;if(e[c]&&"object"==typeof e[c]&&(n=e[c].versions||[],i=t.valid(s),h=i&&s||t.maxSatisfying(n,s),p=e[c].main||u),!h||!t.valid(h))return null;var m=a+g+"/"+l+c+"/"+f+h;return m+="/"+p+v}function i(e){var t=e.split(d)[0];return p.hasOwnProperty(t)?(e=t+d+p[t],o(e)||n(e)):null}function o(t){var r=t.split(d),i=r[1],o=r[0];return y.hasOwnProperty(i)?(t=o+d+e[o][i],n(t)):null}var a=window.location.protocol.match(/^http/)?"//":"http://",u="index",s=".js",c=".min.js",l="libs/",f="v",p=r.overrides(),d="#",h=r.cdnUrl(),m=r.bucketUrl(),v=r.minified()?c:s,g=r.cdn()?h:m,y={dev:!0,qa:!0,uat:!0},b=[i,o,n];return{overrides:i,version:n,resolve:function(e){for(var t,r=0,n=b.length;n>r&&!(t=b[r](e));r++);return t}}}),define("livefyre-require/main",["requireLib","livefyre-require/resolvers"],function(e,t){var r=e&&e.define||define,n=e&&e.requirejs||requirejs;return{require:function(e,r,i){for(var o,a,u=0;u<e.length;u++)o=e[u],a=t.resolve(o),a&&(e[u]=a);return n(e,r,i)},define:r,requirejs:n}}),define("livefyre-require",["livefyre-require/main"],function(e){return e}),define("streamhub-sdk/debug",["require","exports","module","debug"],function(e,t,r){r.exports=e("debug")}),define("streamhub-permalink/uri-interpreter",["require","exports","module","streamhub-sdk/debug"],function(e,t,r){e("streamhub-sdk/debug")("streahub-permalink");var n={};n.patterns={content:/lf-content=(([^:]+):)?([^:]+):([^$#]+)/},n.getContentPermalink=function(){return this.parse(window.location.hash)},n.parse=function(e){if(e){var t=e.match(this.patterns.content);if(t){var r=t[2],n=t[3],i=t[4],o={collectionId:n,contentId:i};return r&&(o.environment=r),o}}},r.exports=n}),define("Livefyre/check-permalink",["require","exports","module","streamhub-permalink/uri-interpreter","livefyre-require"],function(e,t){var r=e("streamhub-permalink/uri-interpreter"),n=e("livefyre-require");t.get=function(){return r.getContentPermalink()};var i="streamhub-permalink#0";t.load=function(){n.require([i],function(e){console.log("loaded permalink package",e)})}}),define("permalink-hub/permalink-hub",[],function(){function e(){var e,t=window.location.hash?window.location.hash.split("="):[];return t=t.length>0?t[t.length-1]:null,t&&(e={},t=t.split(":"),3===t.length&&(e.environment=t.shift()),e.collectionId=t[0],e.contentId=t[1]),e}function t(t){this.collectionHandlers={},this.hasPermalinkModal=!1,this.bus=t.bus||window,this.modalDisabled=t.modalDisabled,this.permalinkData=e();var r=this.bus.addEventListener?"message":"onmessage",n=this.bus.addEventListener||this.bus.attachEvent,i=this;n(r,function(e){i.onPostMessage.call(i,e)},!1)}return t.prototype.onPostMessage=function(e){var t=null;if("object"==typeof e.data)t=e.data;else try{t=JSON.parse(e.data)}catch(r){return}"permalink"===t.to&&t.data&&t.action&&("post"===t.action&&("permalink-modal"===t.from?this.receiveModalRegistration(t.data):this.receiveAppRegistration(t.data)),"put"===t.action&&"permalink-modal"===t.from&&this.receiveModalHaveAppPermalink(t.data))},t.prototype.receiveModalHaveAppPermalink=function(e){for(var t=this.collectionHandlers[e.collectionId]||[],r=0;r<t.length;r++)this.messageAppToPermalink(t[r].name,e)},t.prototype.receiveModalRegistration=function(){if(!this.hasPermalinkModal){this.hasPermalinkModal=!0;for(key in this.collectionHandlers)for(var e=0;e<this.collectionHandlers[key].length;e++)this.messageModalAppInfo(this.collectionHandlers[key][e])}},t.prototype.receiveAppRegistration=function(e){this.collectionHandlers[e.collectionId]=this.collectionHandlers[e.collectionId]||[],this.collectionHandlers[e.collectionId].push(e),this.hasPermalinkModal&&!this.modalDisabled?this.messageModalAppInfo(e):this.modalDisabled&&(e.contentId=this.permalinkData.contentId,this.messageAppToPermalink(e.name,e))},t.prototype.messageAppToPermalink=function(e,t){var r={from:"permalink",to:e,action:"put",data:t};this.bus.postMessage(JSON.stringify(r),"*")},t.prototype.messageModalAppInfo=function(e){var t={from:"permalink",to:"permalink-modal",action:"post",data:e};this.bus.postMessage(JSON.stringify(t),"*")},t}),define("permalink-hub/main",["require","exports","module","./permalink-hub"],function(e,t,r){t=r.exports=e("./permalink-hub")}),define("permalink-hub",["permalink-hub/main"],function(e){return e}),define("Livefyre/main",["require","exports","module","livefyre-auth","event-emitter","livefyre-require","./check-permalink","permalink-hub"],function(e,t,r){var n=e("livefyre-auth"),i=e("event-emitter"),o=e("livefyre-require"),a=e("./check-permalink"),u=e("permalink-hub"),s=t=r.exports=new i;t["livefyre-auth"]=n,t.auth=n,t._lfjs=!0,function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}(s,o);var c=!1;s.on("_configurationComplete",function(){var e=a.get();e&&(new u({bus:window,modalDisabled:c}),c||a.load(e))}),s.on("initialized",function(){s.emit("beforeLoadPermalinks",{disableModal:function(){c=!0}}),s.emit("_configurationComplete")}),s.require=function(e){return function(t,r,i){function o(){a>-1&&Array.prototype.splice.call(arguments,a,0,n),r.apply(this,arguments)}for(var a=-1,u=0;u<t.length;u++)if(/auth$|auth#/.test(t[u])){a=u;break}return a>-1&&t.splice(a,1),0===t.length?o([]):e(t,o,i)}}(s.require)}),define("Livefyre",["Livefyre/main"],function(e){return e});var Livefyre=window.Livefyre||{};return require(["Livefyre"],function(e){for(var t in e)Livefyre[t]=e[t];setTimeout(function(){e.emit("initialized")},4)}),Livefyre.require=function(){var e=arguments;require(["Livefyre"],function(t){t.require.apply(t,e)})},Livefyre.on=function(){var e=arguments;require(["Livefyre"],function(t){t.on.apply(t,e)})},Livefyre.define=define,Livefyre});
//# sourceMappingURL=Livefyre.min.js.map