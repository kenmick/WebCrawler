function DailymotionPlayer(t,e,n){var i;DM.playerLabels.init();var r=DM.playerOptions.init();this.fields=n,this.info=t,this.statsInfo={},this.messageQueue=[],this.adBlockpinged=!1,this.ui=new DailymotionPlayerUI(e),r.statsEnabled()||(window.DMP_Stats={mockStats:{enable:function(){},disable:function(){},trigger:function(){},filter:function(){}},getInstance:function(){return this.mockStats}}),this.stats=DMP_Stats.getInstance(),i=t?t.url?t.url:t.url=location.href:location.href;var o=r.flashRequired();return o?(this.ui.error({title:o.title,message:o.message}),void this.stats.trigger(DMP_Stats.ERROR,{type:"player",label:(o.partner_player?"Partner Player - ":"")+"Flash Player Needed",src:i})):(this.setImplem(r.flashPlayer()?new DailymotionPlayerFlash(this.ui):new DM.InstreamPlayer(this.ui)),this.statsInfo.muted=this.muted=!1,this.statsInfo.volume=this.volume=1,this.paused=!0,this.ended=!1,this.statsInfo.width=this.ui.width,$.extend(this.statsInfo,this.info),r.get("api")&&this.initAPI(),t?(this.initWithVideoInfo(!0),DM.models.videoModel.setVideo(this.info)):"flash"==r.get("startscreen")&&this.load(),void(t.annotations&&this.loadHapYak()))}function DailymotionPlayerUI(t){var e=this,n=DM.playerOptions;this.root=t,this.assets=DM.config("assets"),this.widthBreakpoints=[160,250,350],this.detectWidthBreakpoint(),this.width,$(this.root).attr("id","player").addClass("paused").resize(function(){e.detectWidthBreakpoint()}),this.events={},$(window).on("resize",function(){e.detectWidthBreakpoint()}),$(this.events).bind("play",function(){$("#player").removeClass("paused"),$("#player").addClass("started")}),$(this.events).bind("pause ended",function(){$("#player").addClass("paused"),$("#player").removeClass("started")}),$(this.events).bind("error",function(t,n){e.error(n)}),$("#player").toggleClass("hideinfo",!n.get("info")),this.webkitForceInline=n.get("playsinline"),this.whitemark=n.get("whitemark"),this.chromeless=n.get("chromeless"),this.enableLogo=n.get("logo",!0),this.startuploaderonly=n.get("startuploaderonly"),this.loaderFallback=n.get("gifloader"),this.enableControls=!n.noControls(),this.enableSocial=n.get("social"),this.m=Modernizr,this.$videoFrame=$("#video-frame")}function DailymotionPlayerFlash(t){this.ui=t,this.out=this,this.params=DM.playerOptions.exportFlashPlayerOptions(),this.wmode=this.params.wmode,this.playerReady=!1,this.actionQueue=[]}function DailymotionPlayerHTML(t){var e=DM.playerOptions,n=DM.tracking;this.ui=t,this.out=this,this.html5=!0,this.resolveCDN=!1,this.nativeControls=e.nativeControls(),this.start=e.get("start"),this.webkitForceInline=e.get("playsinline"),this.autoplay=e.get("autoplay"),this.forceFullscreen=e.get("fullscreen"),this.showRelatedEndScreen=e.get("related"),this.startuploaderonly=e.get("startuploaderonly"),this.quality=e.get("quality"),this.m=Modernizr;var i=e.get("hls");this.hls={live:i===!0||"auto"===i&&this.m.hls,vod:i===!0||"auto"===i&&this.m.hls&&!this.m.android&&!this.m.psvita,hasFailed:!1};var r=e.get("hls_default_quality");r&&(this.hls.default_quality=r),this.stats=DMP_Stats.getInstance(),this.ui.videoFrame().innerHTML='<video height="100%" width="100%" class="ff force-transform" style="background: #000" x-webkit-airplay="allow" '+(this.webkitForceInline?"webkit-playsinline":"")+"></video>";var o=this.player=document.querySelector("video");return o?(this.m["video-inline"]||this.webkitForceInline||$(o).css({opacity:0,width:"1px",height:"1px",top:"50%",left:"50%"}),this.m.ios&&"ipad"===this.m.ios.device&&$(o).css({top:"-10000px"}),void(this.tracking=new n($(o)))):this.fallback()}window.Modernizr=function(t,e,n){function i(t){_.cssText=t}function r(t,e){return i(T.join(t+";")+(e||""))}function o(t,e){return typeof t===e}function s(t,e){return!!~(""+t).indexOf(e)}function a(t,e){for(var i in t){var r=t[i];if(!s(r,"-")&&_[r]!==n)return"pfx"==e?r:!0}return!1}function l(t,e,i){for(var r in t){var s=e[t[r]];if(s!==n)return i===!1?t[r]:o(s,"function")?s.bind(i||e):s}return!1}function u(t,e,n){var i=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+w.join(i+" ")+i).split(" ");return o(e,"string")||o(e,"undefined")?a(r,e):(r=(t+" "+D.join(i+" ")+i).split(" "),l(r,e,n))}var c,d,h,p="2.6.2",f={},g=!0,m=e.documentElement,v="modernizr",y=e.createElement(v),_=y.style,T=({}.toString," -webkit- -moz- -o- -ms- ".split(" ")),A="Webkit Moz O ms",w=A.split(" "),D=A.toLowerCase().split(" "),b={svg:"http://www.w3.org/2000/svg"},E={},S=[],k=S.slice,I=function(t,n,i,r){var o,s,a,l,u=e.createElement("div"),c=e.body,d=c||e.createElement("body");if(parseInt(i,10))for(;i--;)a=e.createElement("div"),a.id=r?r[i]:v+(i+1),u.appendChild(a);return o=["&#173;",'<style id="s',v,'">',t,"</style>"].join(""),u.id=v,(c?u:d).innerHTML+=o,d.appendChild(u),c||(d.style.background="",d.style.overflow="hidden",l=m.style.overflow,m.style.overflow="hidden",m.appendChild(d)),s=n(u,t),c?u.parentNode.removeChild(u):(d.parentNode.removeChild(d),m.style.overflow=l),!!s},M=function(){function t(t,r){r=r||e.createElement(i[t]||"div"),t="on"+t;var s=t in r;return s||(r.setAttribute||(r=e.createElement("div")),r.setAttribute&&r.removeAttribute&&(r.setAttribute(t,""),s=o(r[t],"function"),o(r[t],"undefined")||(r[t]=n),r.removeAttribute(t))),r=null,s}var i={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return t}(),R={}.hasOwnProperty;h=o(R,"undefined")||o(R.call,"undefined")?function(t,e){return e in t&&o(t.constructor.prototype[e],"undefined")}:function(t,e){return R.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var n=k.call(arguments,1),i=function(){if(this instanceof i){var r=function(){};r.prototype=e.prototype;var o=new r,s=e.apply(o,n.concat(k.call(arguments)));return Object(s)===s?s:o}return e.apply(t,n.concat(k.call(arguments)))};return i}),E.flexbox=function(){return u("flexWrap")},E.flexboxlegacy=function(){return u("boxDirection")},E.touch=function(){var n;return"ontouchstart"in t||t.DocumentTouch&&e instanceof DocumentTouch?n=!0:I(["@media (",T.join("touch-enabled),("),v,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(t){n=9===t.offsetTop}),n},E.postmessage=function(){return!!t.postMessage},E.hashchange=function(){return M("hashchange",t)&&(e.documentMode===n||e.documentMode>7)},E.rgba=function(){return i("background-color:rgba(150,255,150,.5)"),s(_.backgroundColor,"rgba")},E.borderradius=function(){return u("borderRadius")},E.opacity=function(){return r("opacity:.55"),/^0.55$/.test(_.opacity)},E.video=function(){var t=e.createElement("video"),n=!1;try{(n=!!t.canPlayType)&&(n=new Boolean(n),n.ogg=t.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),n.h264=t.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),n.webm=t.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,""))}catch(i){}return n},E.svg=function(){return!!e.createElementNS&&!!e.createElementNS(b.svg,"svg").createSVGRect};for(var P in E)h(E,P)&&(d=P.toLowerCase(),f[d]=E[P](),S.push((f[d]?"":"no-")+d));return f.addTest=function(t,e){if("object"==typeof t)for(var i in t)h(t,i)&&f.addTest(i,t[i]);else{if(t=t.toLowerCase(),f[t]!==n)return f;e="function"==typeof e?e():e,"undefined"!=typeof g&&g&&(m.className+=" "+(e?"":"no-")+t),f[t]=e}return f},i(""),y=c=null,f._version=p,f._prefixes=T,f._domPrefixes=D,f._cssomPrefixes=w,f.hasEvent=M,f.testProp=function(t){return a([t])},f.testAllProps=u,f.testStyles=I,f.prefixed=function(t,e,n){return e?u(t,e,n):u(t,"pfx")},m.className=m.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(g?" js "+S.join(" "):""),f}(this,this.document),function(){"use strict";var t=navigator.userAgent;Modernizr.addTest("chrome",function(){return t.match(/Chrome/)}),Modernizr.addTest("firefox",function(){return t.match(/Firefox/)}),Modernizr.addTest("ua_mobile",function(){return t.match(/iPhone|iPod|CFNetwork|Android.*Mobile Safari|Windows Phone|IEMobile\/(?:9|1\d)|tizen|(Blackberry|BB10|BBOS; Touch).*Version\/10|Android; Mobile;.*Firefox|Mozilla\/\S+ \(Mobile;/i)}),Modernizr.addTest("ua_tablet",function(){return t.match(/iPad|Tablet|B?G[TP]-P\d+|Droidx|Xoom|playbook|kindle|(SCH|SPH|SCS|SHW|SGH)-\w+|a\d{3}|dell streak|hp-tablet|Touchpad|Slider|Transformer( Prime)?|silk|Android; Tablet;.*Firefox/i)}),Modernizr.addTest("ua_desktop",function(){return t.match(/Mac OS|Macintosh|Safari|Windows|Microsoft/i)}),Modernizr.addTest("ua_tv",function(){return t.match(/AppleTV|GoogleTV|Opera.*Presto|Opera.*TV|NetBox|SMART.TV|AmazonWebAppPlatform|TV Store/i)}),Modernizr.addTest("ua_bot",function(){return t.match(/spider|crawl|slurp|bot/)}),Modernizr.addTest("ua_windowsphone",function(){return t.match(/Windows Phone(?: OS)? [1-7]/i)}),Modernizr.addTest("ua_windows8",function(){return t.match(/Windows Phone(?: OS)? 8/i)}),Modernizr.addTest("ua_blackberry",function(){return t.match(/Blackberry/)}),Modernizr.addTest("ua_google_preview_bot",function(){return/Google Web Preview/.test(t)}),Modernizr.addTest("psvita",function(){return/Playstation Vita/i.test(t)}),Modernizr.addTest("sessionstorage",function(){try{if(sessionStorage.getItem)return sessionStorage.getItem("test"),!0}catch(t){return!1}}),Modernizr.addTest("flash",function(){if(t.match(/iPhone(?: Simulator)?;|iPod|iPad|WebOS|Blackberry|Symbian|Android|Bada/i))return!1;if(navigator.mimeTypes&&navigator.mimeTypes.length&&navigator.mimeTypes["application/x-shockwave-flash"])return!!navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin;try{return!!new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){return!1}}),Modernizr.addTest("hls",function(){if(t.match(/iPhone|iPod|iPad|Android 4/i))return!0;var e=document.createElement("video");try{return e&&e.canPlayType&&!!e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E, mp4a.40.2"')}catch(n){return!1}}),Modernizr.addTest("video-inline",function(){return!t.match(/iPhone(?: Simulator)?;|iPod|Android 2/)}),Modernizr.addTest("utf8-play",function(){return t.match(/Android/)?!1:t.match(/Safari|MSIE|Firefox|Chrome/)}),Modernizr.addTest("mobile",function(){return window.innerWidth<500*(window.devicePixelRatio||1)&&(Modernizr.touch||t.match(/Blackberry|Symbian/))}),Modernizr.addTest("tablet",function(){return Modernizr.touch&&!Modernizr.ua_tv&&window.innerWidth>500*(window.devicePixelRatio||1)}),Modernizr.addTest("tv",function(){return Modernizr.ua_tv}),Modernizr.addTest("ios",function(){var e=!1,n=t.match(/(iPod|iPhone(?: Simulator)?|iPad);.*OS ([0-9\_]+)/);return null!=n&&n.length&&(e=new Boolean(!0),e.version=n[2].replace(/_/g,"."),e.device="iPad"===n[1]?"ipad":"iphone",e.isWebview=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(t),e.sdk_version="0"),e}),Modernizr.addTest("android",function(){var e=!1,n=t.match(/Android ([0-9\.]+)/);return null!=n&&n.length&&(e=new Boolean(!0),e.version=n[1]),e}),Modernizr.addTest("androidbrowser",function(){var e=t.indexOf("Android")>-1&&t.indexOf("Mozilla/5.0")>-1&&t.indexOf("AppleWebKit")>-1,n=new RegExp(/AppleWebKit\/([\d.]+)/),i=n.exec(t),r=null===i?null:parseFloat(n.exec(t)[1]);return e&&null!==r&&537>r}),Function.prototype.bind||(Function.prototype.bind=function(t){function e(){}if("function"!=typeof this)throw new TypeError("Bind must be called on a function");var n=[].slice,i=n.call(arguments,1),r=this,o=function(){return r.apply(this instanceof e?this:t||{},i.concat(n.call(arguments)))};return e.prototype=r.prototype,o.prototype=new e,o})}(),function(){var t=[].slice;!function(e){"use strict";var n,i;return n=e.DM||{},n.events={},n.Events=function(){function e(){}return e.prototype.on=function(t,e,n){return null==n&&(n=null),"function"==typeof e?(this.listeners||(this.listeners={}),this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push({func:e,scope:n}),this):void 0},e.prototype.off=function(t,e){var n,i,r,o,s,a;if(null!=(s=this.listeners)?s[t]:void 0)if("function"!=typeof e)this.listeners[t]=[];else for(a=this.listeners[t],i=r=0,o=a.length;o>r;i=++r)n=a[i],n.func===e&&this.listeners[t].splice(i,1)},e.prototype.trigger=function(){var e,n,i,r,o,s,a;if(i=arguments[0],e=2<=arguments.length?t.call(arguments,1):[],null!=(s=this.listeners)?s[i]:void 0)for(a=this.listeners[i],r=0,o=a.length;o>r;r++)if(n=a[r],n.func.apply(n.scope,e)===!1)return},e}(),n.observer=new n.Events,i={},n.config=function(t,e){return null==e?i[t]||null:i[t]=e},n.View=function(){function t(){}return t.prototype._compile=function(t,e){var n,i,r,o,s,a;if(o=t,!(r=t.match(/{{([^}]*)}}/g)))return o;for(s=0,a=r.length;a>s;s++)i=r[s],o=o.replace(i,(n=e[i.slice(2,-2)])?n:"");return o},t.prototype._createElement=function(t,e){var n;return null==e&&(e={}),n=document.createElement("div"),n.innerHTML=this._compile(t,e),n.firstChild},t.prototype._empty=function(t){var e,n;for(n=[];e=t.firstChild;)n.push(t.removeChild(e));return n},t}(),n.plugin=function(t,e,i){var r,o,s,a,l,u,c,d,h,p;if(!e)return i&&i();if(u=n.config("plugins"),null==u)return void console.error("plugins are not defined");if(l=null!=u?u[t]:void 0,null==l)return console.warn("Unknown plugin: "+t),i&&i();if(l===!0)return i&&i();for("string"==typeof l&&(l=[l]),c=[],a=/^.*\.js(:?\.v[0-9a-f]+)?$/,o=/^.*\.css(:?\.v[0-9a-f]+)?$/,h=0,p=l.length;p>h;h++)d=l[h],a.test(d)?(s=$.ajax({url:d,cache:!0,context:this,dataType:"script"}),c.push(s)):o.test(d)&&(r=document.createElement("link"),r.rel="stylesheet",r.href=d,document.head.appendChild(r));return $.when(c).then(function(){u[t]=!0,n.config("plugins",u),i&&i()})},n.pluginUrl=function(t){var e;return e=n.config("plugins"),null!=e?e[t]:void 0},n.extend=function(){var t,e,n,i,r,o;for(t=r=1,o=arguments.length;o>=1?o>=r:r>=o;t=o>=1?++r:--r){n=arguments[t];for(e in n)i=n[e],n.hasOwnProperty(e)&&(arguments[0][e]=i)}return arguments[0]},n.external=!/^https?:\/\/([^\/]+)?\.dailymotion\.[a-z]{2,}/.test(document.referrer),e.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},n=[].slice;!function(t){"use strict";var i,r,o,s,a;return r=t.DM||{},r.utils=r.utils||{},s=document.createElement("a"),r.utils.versionCompare=function(t,e,n){var i,r,o,s,a,l,u,c,d,h;if(r=function(t){return(o?/^\d+[A-Za-z]*$/:/^\d+$/).test(t)},o=n&&n.lexicographical,c=n&&n.zeroExtend,a=t.split("."),u=e.split("."),!a.every(r)||!u.every(r))return 0/0;if(c){for(;a.length<u.length;)a.push("0");for(;u.length<a.length;)u.push("0")}for(o||(a=a.map(Number),u=u.map(Number)),i=d=0,h=a.length;h>d;i=++d){if(s=a[i],l=u[i],u.length===i)return 1;if(s!==l)return s>l?1:-1}return a.length!==u.length?-1:0},r.utils.trim=a=function(t){return t?t.replace(/^\s+/g,"").replace(/\s+$/g,""):null},r.utils.cookie={create:function(t,e,n){var i,r,o,s,a;r=n.expires,s=n.path,i=n.domain,a=n.secure,null!=r&&parseInt(r,10)>0&&(o=new Date,o.setDate(o.getDate()+r),r=o.toUTCString()),null==i||~location.hostname.indexOf(i)||(i=void 0),document.cookie=[t+"="+e,null!=r?"; expires="+r:"",null!=s?"; path="+s:"",null!=i?"; domain="+i:"",null!=a?"; secure":""].join("")},read:function(t){var e,n,i,r,o;for(n=""+t+"=",e=document.cookie.split(";"),r=0,o=e.length;o>r;r++){for(i=e[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(n))return i.substring(n.length,i.length)}},"delete":function(t,e){null==e&&(e={}),e.expires="Thu, 01 Jan 1970 00:00:01 GMT",this.create(t,"",e)}},r.utils.session={getVisitorGroup:function(t){var e,n,i;if(null==t&&(t=100),n=1,e=1e6,t>e)throw new Error("Out of bounds exception: too much groups ("+t+")");return this.clearDoubleTSCookies(),null==this.trafficSegment&&(i=parseInt(r.utils.cookie.read("ts")),!i||n>i||i>e?(this.trafficSegment=Math.floor(Math.random()*(e-n)+n),r.utils.cookie.create("ts",this.trafficSegment,{domain:".dailymotion.com",expires:3650,path:"/"})):this.trafficSegment=i),Math.ceil(this.trafficSegment*t/e)},getSubVisitorGroup:function(t,e){var n,i,r,o,s;return null==t&&(t=null),null==e&&(e=1),null===t&&(t=this.getVisitorGroup()),o=1e4*(t-1),s=o+1e4*e,n=this.trafficSegment-o||1,i=100,r=s-o,Math.ceil(n*i/r)},clearDoubleTSCookies:function(){var t,e,n,i,o;for(o=["/video","/video/","/embed/video","/embed/video/"],n=0,i=o.length;i>n;n++)e=o[n],r.utils.cookie["delete"]("ts",{path:e}),r.utils.cookie["delete"]("ts",{domain:".dailymotion.com",path:e});return t=document.cookie.match(/(^|;)\s*(ts=[^;]+)/g),null!=t&&t.length>1?(console.log("detected multiple 'ts' cookie for path '"+document.location.pathname+"' => deleting!"),r.utils.cookie["delete"]("ts",{domain:".dailymotion.com"})):void 0}},r.logger=function(){var t,e,n,i,r;r=function(){},"console"in window||(window.console={}),"log"in console||(window.console.log=r),"warn"in console||(window.console.warn=r),"error"in console||(window.console.error=r),"timeStamp"in console||(window.console.timeStamp=r),"group"in console||(window.console.group=r),"groupCollapsed"in console||(window.console.groupCollapsed=r),"groupEnd"in console||(window.console.groupEnd=r),t={log:r,warn:r,error:r,timeStamp:r,group:r,groupCollapsed:r,groupEnd:r},("dev"===ENV&&""===document.referrer||-1!==window.location.search.indexOf("logger=1"))&&(t=window.console),n=function(e,n){var i,r;return null==n&&(n=""),i="%c["+e+"]",r=n,Function.prototype.bind?{log:e?t.log.bind(t,i,r):t.log.bind(t),warn:e?t.warn.bind(t,i,r):t.warn.bind(t),error:e?t.error.bind(t,i,r):t.error.bind(t),timeStamp:t.timeStamp.bind(t),group:e?t.group.bind(t,i,r):t.group.bind(t),groupCollapsed:e?t.groupCollapsed.bind(t,i,r):t.groupCollapsed.bind(t),groupEnd:e?t.groupEnd.bind(t,i,r):t.groupEnd.bind(t)}:t};try{n().log()}catch(o){e=o,n=function(){return t}}return i=n(),i.getLogger=n,i}(),o=function(){function t(t,e,n,i,r,o,s){this.protocol=t,this.host=e,this.hostname=n,this.port=i,this.pathname=null!=r?r:"",this.search=null!=o?o:"",this.hash=null!=s?s:"",this.href=t?this.protocol+"//"+this.host+this.pathname+this.search+this.hash:e?"//"+this.host+this.pathname+this.search+this.hash:this.pathname+this.search+this.hash}return t.prototype.params=function(e){return null==this._params&&(this._params=t.parseQueryString(this.search)),e?this._params[e]?this._params[e][0]:null:this._params},t.regexp=/^(?:(https?:)\/\/(([^:\/]+)(:[^\/]+)?))?([^#?]*)(\\?[^#]*)?(#.*)?$/,t.parse=function(e){var n;return(n=e.match(this.regexp))?function(t,e,n){n.prototype=t.prototype;var i=new n,r=t.apply(i,e);return Object(r)===r?r:i}(t,n.slice(1),function(){}):null},t.parseQueryString=function(t,e){var n,i,r,o,s,a,l;if(null==e&&(e=!1),o={},""===t)return o;for(r=t.substring(1).split(/[;&]/),a=0,l=r.length;l>a;a++)i=r[a],i=i.split("="),n=decodeURIComponent(i[0]),s=decodeURIComponent(i[1]),e===!0?o[n]=s:(o[n]||(o[n]=[]),o[n].push(s));return o},t.appendQueryStringParameter=function(t,e){return s.href=t,t+=""+(s.search.length?"&":"?")+e,s.href="",t},t}(),r.utils.Location=o,i=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.params=function(t){var e;return e=function(t,n){var i,r,o,s,a,l,u;for(null==n&&(n=/[&]/),s={},o=t.split(n),l=0,u=o.length;u>l;l++)r=o[l],r=r.split("="),i=decodeURIComponent(r[0]),a=r.length<=2?decodeURIComponent(r[1]):e(r.slice(1).join("="),/[;]/),s[i]||(s[i]=[]),s[i].push(a);return s},this._params?n.__super__.params.call(this,t):this._params=e(this.search.substring(1))},n.parse=function(t){var e;return(e=t.match(this.regexp))?function(t,e,n){n.prototype=t.prototype;var i=new n,r=t.apply(i,e);return Object(r)===r?r:i}(n,e.slice(1),function(){}):null},n}(o),r.utils.AuditudeLocation=i,r.utils.CDNResolver=function(){var t,e;return e={},t=r.logger.getLogger("CDNResolver","color: green; font-weight: bold; font-size: 1.1em;"),{clear:function(){return e={}},resolve:function(i,r){var o;return i!==e.id&&(e={deferred:o=$.Deferred(),promise:o.promise(),id:i},e.promise.resolved=function(t){return o.onResolved=t,this},e.deferred.customResolve=function(){var i;return i=1<=arguments.length?n.call(arguments,0):[],t.log("Resolved URL to",i[0]),o.onResolved&&o.onResolved.apply(e.promise,i),o.resolve.apply(o,i)},t.log("Resolving URL",r),$.get(r).done(e.deferred.customResolve).fail(function(){var i,r;return i=1<=arguments.length?n.call(arguments,0):[],t.error("failed to resolve URL :",i),(r=e.deferred).reject.apply(r,i)})),e.promise}}}(),r.utils.fullscreen=function(){var t;return t=function(t){var e,n,i,o;return e=function(){function t(t){this.player=t,this.$player=$(t)}return t}(),i=navigator.userAgent,o=window,n=document,"webkitEnterFullscreen"in t?(e.prototype={enabled:"webkitEnterFullscreen"in t,request:function(){return this.player.webkitSupportsFullscreen?this.player.webkitEnterFullscreen():void 0},exit:function(){return this.player.webkitExitFullscreen()},isFullscreen:function(){return this.player.webkitDisplayingFullscreen},onChange:function(t){return $(n).on("webkitfullscreenchange",function(e){return function(){return t(e.isFullscreen())}}(this))}},Modernizr.ios?e.prototype.onChange=function(t){return this.$player.on("webkitbeginfullscreen",function(){return function(){return t(!0)}}(this)),this.$player.on("webkitendfullscreen",function(){return function(){return t(!1)}}(this))}:Modernizr.android&&!Modernizr.chrome&&(e.prototype.onChange=function(t){var e,i,s,a,l,u,c,d;return l=null,c=!1,e=function(t){return function(){var e;return e=!1,t.$player.one("click.fschange loadedmetadata.fschange playing.fschange",function(){return e?void 0:(null==l&&(l=setInterval(u,250)),e=!0)})}}(this),i=function(){return function(){return r.utils.versionCompare(Modernizr.android.version,"4.2",{zeroExtend:!0})>=0?$(n).one("webkitfullscreenchange",a):$(o).one("focus",a)}}(this),d=function(t){return function(){return t.$player.off(".fschange"),clearInterval(l),l=null}}(this),s=function(){return function(){return t(!0),d(),i()}}(this),a=function(){return function(){return t(!1),d(),e()}}(this),u=function(t){return function(){var e;return e=t.isFullscreen(),e!==c?(e===!0?s():a(),c=e):void 0}}(this),e()}),e):"webkitFullscreenEnabled"in n?(e.prototype={enabled:n.webkitFullscreenEnabled,request:function(){return this.player.webkitRequestFullscreen()},exit:function(){return n.webkitExitFullscreen()},isFullscreen:function(){return n.webkitFullscreenElement===this.player},onChange:function(t){return $(n).on("webkitfullscreenchange",function(e){return function(){return t(e.isFullscreen())}}(this))}},e):"mozRequestFullScreen"in t?(e.prototype={enabled:!0,request:function(){return this.$player.attr("controls",!0),this.player.mozRequestFullScreen()},exit:function(){return this.$player.attr("controls",!0),this.player.mozCancelFullScreen()},isFullscreen:function(){return n.mozFullScreenElement===this.player},onChange:function(t){return $(n).on("mozfullscreenchange",function(e){return function(){return t(e.isFullscreen())}}(this))}},e):"msRequestFullscreen"in t?(e.prototype={enabled:n.msFullscreenEnabled,request:function(){return this.player.msRequestFullscreen()},exit:function(){return this.player.msExitFullscreen()},isFullscreen:function(){return n.msFullscreenElement===this.player},onChange:function(t){return $(n).on("msfullscreenchange",function(e){return function(){return t(e.isFullscreen())}}(this))}},e):(e.prototype={enabled:n.fullscreenEnabled,request:function(){return this.player.requestFullscreen()},exit:function(){return this.player.exitFullscreen()},isFullscreen:function(){return n.fullscreenElement===this.player},onChange:function(t){return $(n).on("fullscreenchange",function(e){return function(){return t(e.isFullscreen())}}(this))}},e)}(document.createElement("video")),function(e){return new t(e)}}(),r.utils.visibility=function(){var t,e;t="hidden",null!=document[t]?document.addEventListener("visibilitychange",function(t){return e(t)}):(t="webkitHidden")&&null!=document[t]?document.addEventListener("webkitvisibilitychange",function(t){return e(t)}):(t="mozHidden")&&null!=document[t]?document.addEventListener("mozvisibilitychange",function(t){return e(t)}):(t="msHidden")&&null!=document[t]?document.addEventListener("msvisibilitychange",function(t){return e(t)}):window.onpageshow=window.onpagehide=window.onfocus=window.onblur=function(t){return e(t)},e=function(e){var n,i,o,s;return s="Visible",i="Hidden",n={focus:s,focusin:s,pageshow:s,blur:i,focusout:i,pagehide:i},e=e||window.event,o=null!=n[e.type]?n[e.type]:document[t]?i:s,r.observer.trigger("page"+o)}}(),r.utils.extend=r.extend,t.DM=r}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r;return n=t.DM||{},n.models=n.models||{},r=null,i=function(t){function i(){this.video={id:null}}return e(i,t),i.prototype.setVideo=function(t){return null===r&&(r=n.logger.getLogger("VideoModel","color: blue; font-weight: bold;")),null!=t.id&&t.id!==this.video.id?(this.video=t,r.groupCollapsed("defined video object"),r.log("video:",this.video),this.trigger("change",this.video),r.groupEnd(),!0):!1},i}(n.Events),n.models.videoModel=new i,t.DM=n}(window)}.call(this),function(){!function(t){"use strict";var e,n,i;return e=t.DM||{},n=null,i={init:function(){return n=e.config("labels"),null==n?console.warn("Player labels definition is missing!!"):void 0},get:function(t){return n.hasOwnProperty(t)?n[t]:void 0}},e.playerLabels=i,t.DM=e}(window)}.call(this),function(){!function(t){"use strict";var e,n,i,r,o,s,a,l,u,c,d,h;return e=t.DM||{},u=Modernizr,c=null,l=!1,r={start:null,api:!1,id:null,network:"dsl",startscreen:"html",controls:"html",fullscreen:"auto",hls:"auto",info:!0,is_webapp:!1,related:!0,reporting:!0,logo:!0,social:!0,syndication:null,analytics_services:{pinba:{enable:!0}}},s={wmode:"transparent",isInIframe:1},n=["info","html","playsinline","fullscreen","startuploaderonly","quality","hls","hls_default_quality","whitemark","is_secure","can_play_ad","http_x_requested_with","disableiframes"],h=function(){var t;return t=e.utils.versionCompare,function(e,n){return t(e,n,{zeroExtend:!0})}}(),a=function(){return!c.html&&u.flash},i=function(t,e){return null==e&&(e=!1),null==t?e:t&&"0"!==t?"string"==typeof t&&t.match(/^(?:false|no|off|nil)$/i)?!1:!0:!1},o=function(){var t,e,n,i;return t=u.android&&h(u.android.version,"4.0")>=0&&!u.androidbrowser,i=u.ios&&h(u.ios.version,"6")>=0,n=u.ua_windowsphone||u.ua_windows8,e=!(u.mobile||u.tablet||u.tv),!u.tv&&(i||t||n||e)},d={init:function(){var t,n,s,d,p,f,g,m,v,y,_;return s=e.utils.Location.parseQueryString(window.location.search,!0),n=e.config("options"),c=e.extend({},r,n,s),l=null!=n.quality||null!=s.quality,-1===["postMessage","xdcom","fragment","location"].indexOf(c.api)&&(c.api=r.api),c.autoplay=i(c.autoplay,i(c.autoPlay,r.autoplay)),c.info=i(c.info,!i(c.hideInfos,r.info)),c.is_webapp=i(c.is_webapp,r.is_webapp),c.html=i(c.html,r.html),c.reporting=i(c.reporting,r.reporting),c.startscreen=function(){switch(c.startscreen){case"flash":return"flash";case"html":case"auto":return"html";default:return console.warn("Unsupported startscreen mode: "+c.startscreen+". Fallback to '"+r.startscreen+"'"),r.startscreen}}(),c.controls=function(){switch(c.controls){case"none":case"0":case 0:return"none";case"flash":return"flash";case"native":return"native";case"html":case"auto":return"html";default:return console.warn("Unsupported controls mode: "+c.controls+". Fallback to '"+r.controls+"'"),r.controls}}(),c.playsinline=i(c.playsinline,i(c["webkit-playsinline"],r.playsinline)),"auto"!==c.fullscreen&&(c.fullscreen=i(c.fullscreen,r.fullscreen)),c.related=i(c.related,r.related),"auto"!==c.hls&&(c.hls=i(c.hls,r.hls)),c.gifloader=i(c.gifloader,r.gifloader),r.quality="cellular"===c.networks?240:380,d=parseInt(c.quality,10),c.quality=d&&-1!==[240,380,480,720,1080].indexOf(d)?d:r.quality,c.hls_default_quality=parseInt(c.hls_default_quality,10),c.whitemark=i(c.whitemark,r.whitemark),c.chromeless=i(c.chromeless,r.chromeless),c.logo=i(c.logo,r.logo),c.social=i(c.social,r.social),c.syndication=c.syndication,c.referer=c.webapp_referer||c.referer||null,c.is_secure=i(c.is_secure,r.is_secure),c.cookie_root_domain||(c.cookie_root_domain=window.location.host),c.disableiframes=i(c.disableiframes,r.disableiframes),c.autoplay&&(u.mobile||u.tablet)&&(c.autoplay=!1,c.chromeless=c.api!==!1&&c.chromeless),c.startuploaderonly=i(u.android&&!u.chrome),"auto"===c.fullscreen&&(!u.mobile&&!u.tablet||u.ios?c.fullscreen=!1:(t=$(window),_=t.width(),y=t.height(),p=_>y?y:_,c.fullscreen=400>p)),u.android&&(u.chrome?c.fullscreen=!1:(h(u.android.version,"4.3")<=0&&""!==c.http_x_requested_with||h(u.android.version,"4.1")<=0&&e.external||h(u.android.version,"4")<0)&&(c.fullscreen=!1)),a()?(u.opacity&&u.rgba&&u.borderradius||(c.startscreen="flash"),("animatedTitle"in c||"skin"in c)&&(c.startscreen="flash"),c.controls="flash"):("flash"===c.startscreen&&(c.startscreen="html"),"flash"===c.controls&&(c.controls="html")),f=e.models.videoModel,f.video.audience_url&&!c.api&&(c.api=!0),c.can_play_ad=o(),(null!=(g=u.ios)?g.isWebview:void 0)&&(null!=(m=c.objc_sdk_version)?m.match(/([0-9]+\.?)+/):void 0)&&(u.ios.sdk_version=c.objc_sdk_version),f.on("change",function(t){t.audience_url&&!c.api&&(c.api=!0)}),(null!=(v=u.ios)?v.isWebview:void 0)&&e.utils.versionCompare(u.ios.sdk_version,"2.0.1")<=0&&(c.disableiframes=!0),this},get:function(t){return c.hasOwnProperty(t)?c[t]:void 0},statsEnabled:function(){return"DMP_Stats"in window&&"function"==typeof DMP_Stats.getInstance&&c.reporting&&!a()},flashRequired:function(){var t,n,i;return n=e.playerLabels,t=n.get("flash_warning"),u.flash||u.video&&u.video.h264||!(screen.width>=800)||!t||u.ua_google_preview_bot?c.is_partner_player&&!u.flash?(i=n.get("partner_player_warning"),{partner_player:!0,title:i[0],message:i[1]}):!1:{partner_player:!1,title:t[0],message:t[1]}},flashPlayer:function(){return a()},htmlPlayer:function(){return!a()},flashControls:function(){return"flash"===c.controls},htmlControls:function(){return"html"===c.controls},nativeControls:function(){return"native"===c.controls},noControls:function(){return"none"===c.controls},flashStartscreen:function(){return"flash"===c.startscreen},htmlStartscreen:function(){return"html"===c.startscreen},exportFlashPlayerOptions:function(){var t,i,r,o;for(i=e.extend({},s,c),-1===["opaque","transparent","direct","window"].indexOf(i.wmode)&&(i.wmode=s.wmode),l&&(i.forcedQuality=function(){switch(i.quality){case 240:return"ld";case 480:return"hq";case 720:return"hd720";case 1080:return"hd1080";default:return"sd"}}()),i.autoplay=i.autoplay?1:0,i.hideInfos=i.info?0:1,i.related=i.related?1:0,i.chromeless=i.chromeless?1:0,i.reporting=i.reporting?1:0,i.enableApi=i.api?1:0,i.logo=i.logo?1:0,i.hideFacebookButton=i.social?0:1,i.hideTwitterButton=i.social?0:1,i.isInIframe=s.isInIframe,i.metaAutoplay=i.autoplay,"flash"!==i.startscreen&&(i.autoplay=1),document.referrer&&(i.referer=i.parentURL=document.referrer),i.enableApi=1,r=0,o=n.length;o>r;r++)t=n[r],"undefined"!=typeof i[t]&&delete i[t];return i}},e.playerOptions=d,t.DM=e}(window)}.call(this),!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.DMVAST=t()}}(function(){return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t,e){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function r(t){return"number"==typeof t}function o(t){return"object"==typeof t&&null!==t}function s(t){return void 0===t
}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!r(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,n,r,a,l,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||o(this._events.error)&&!this._events.error.length))throw e=arguments[1],e instanceof Error?e:TypeError('Uncaught, unspecified "error" event.');if(n=this._events[t],s(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,a=new Array(r-1),l=1;r>l;l++)a[l-1]=arguments[l];n.apply(this,a)}else if(o(n)){for(r=arguments.length,a=new Array(r-1),l=1;r>l;l++)a[l-1]=arguments[l];for(u=n.slice(),r=u.length,l=0;r>l;l++)u[l].apply(this,a)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?o(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,o(this._events[t])&&!this._events[t].warned){var r;r=s(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},n.prototype.removeListener=function(t,e){var n,r,s,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],s=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(o(n)){for(a=s;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],2:[function(t,e){var n;n=function(){function t(){this.errorURLTemplates=[],this.impressionURLTemplates=[],this.creatives=[]}return t}(),e.exports=n},{}],3:[function(t,e){var n,i,r;i=t("./parser.coffee"),r=t("./util.coffee"),n=function(){function t(){}return t.cappingFreeLunch=0,t.cappingMinimumTimeInterval=0,t.timeout=0,t.get=function(t,e){var n;return n=+new Date,this.totalCallsTimeout<n?(this.totalCalls=1,this.totalCallsTimeout=n+36e5):this.totalCalls++,this.cappingFreeLunch>=this.totalCalls?void e(null):n-this.lastSuccessfullAd<this.cappingMinimumTimeInterval?void e(null):i.parse(t,function(){return function(t){return e(t)}}(this))},function(){var e,n;n=r.storage,e=Object.defineProperty,["lastSuccessfullAd","totalCalls","totalCallsTimeout"].forEach(function(i){e(t,i,{get:function(){return n.getItem(i)},set:function(t){return n.setItem(i,t)},configurable:!1,enumerable:!0})}),null==t.totalCalls&&(t.totalCalls=0),null==t.totalCallsTimeout&&(t.totalCallsTimeout=0)}(),t}(),e.exports=n},{"./parser.coffee":8,"./util.coffee":14}],4:[function(t,e){var n;n=function(){function t(){this.id=null,this.width=0,this.height=0,this.type=null,this.staticResource=null,this.companionClickThroughURLTemplate=null,this.trackingEvents={}}return t}(),e.exports=n},{}],5:[function(t,e){var n,i,r,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var i in e)s.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=function(){function t(){this.trackingEvents={}}return t}(),r=function(t){function e(){e.__super__.constructor.apply(this,arguments),this.type="linear",this.duration=0,this.skipDelay=null,this.mediaFiles=[],this.videoClickThroughURLTemplate=null,this.videoClickTrackingURLTemplate=null}return a(e,t),e}(n),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e}(n),i=function(){function t(){this.type="companion",this.variations=[]}return t}(),e.exports={VASTCreativeLinear:r,VASTCreativeNonLinear:o,VASTCreativeCompanion:i}},{}],6:[function(t,e){e.exports={client:t("./client.coffee"),tracker:t("./tracker.coffee"),parser:t("./parser.coffee"),util:t("./util.coffee")}},{"./client.coffee":3,"./parser.coffee":8,"./tracker.coffee":10,"./util.coffee":14}],7:[function(t,e){var n;n=function(){function t(){this.fileURL=null,this.deliveryType="progressive",this.mimeType=null,this.codec=null,this.bitrate=0,this.minBitrate=0,this.maxBitrate=0,this.width=0,this.height=0}return t}(),e.exports=n},{}],8:[function(t,e){var n,i,r,o,s,a,l,u,c,d=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};n=t("./urlhandler.coffee"),u=t("./response.coffee"),i=t("./ad.coffee"),c=t("./util.coffee"),s=t("./creative.coffee").VASTCreativeLinear,o=t("./creative.coffee").VASTCreativeCompanion,a=t("./mediafile.coffee"),r=t("./companionad.coffee"),l=function(){function t(){}var e;return e=[],t.addURLTemplateFilter=function(t){"function"==typeof t&&e.push(t)},t.removeURLTemplateFilter=function(){return e.pop()},t.countURLTemplateFilters=function(){return e.length},t.clearUrlTemplateFilters=function(){return e=[]},t.parse=function(t,e){return this._parse(t,null,function(t,n){return e(n)})},t._parse=function(t,i,r){var o,s,a;for(s=0,a=e.length;a>s;s++)o=e[s],t=o(t);return null==i&&(i=[]),i.push(t),n.get(t,function(e){return function(n,o){var s,a,l,h,p,f,g,m,v,y,_;if(null!=n)return r(n);if(p=new u,null==(null!=o?o.documentElement:void 0)||"VAST"!==o.documentElement.nodeName)return r();for(y=o.documentElement.childNodes,f=0,m=y.length;m>f;f++)h=y[f],"Error"===h.nodeName&&p.errorURLTemplates.push(e.parseNodeText(h));for(_=o.documentElement.childNodes,g=0,v=_.length;v>g;g++)h=_[g],"Ad"===h.nodeName&&(s=e.parseAdElement(h),null!=s?p.ads.push(s):c.track(p.errorURLTemplates,{ERRORCODE:101}));for(a=function(){var t,e,n;if(p){for(n=p.ads,t=0,e=n.length;e>t;t++)if(s=n[t],null!=s.nextWrapperURL)return;return 0===p.ads.length&&(c.track(p.errorURLTemplates,{ERRORCODE:303}),p=null),r(null,p)}},l=p.ads.length;l--;)s=p.ads[l],null!=s.nextWrapperURL&&!function(n){var r,o;return i.length>=10||(o=n.nextWrapperURL,d.call(i,o)>=0)?(c.track(n.errorURLTemplates,{ERRORCODE:302}),p.ads.splice(p.ads.indexOf(n),1),void a()):(-1===n.nextWrapperURL.indexOf("://")&&(r=t.slice(0,t.lastIndexOf("/")),n.nextWrapperURL=""+r+"/"+n.nextWrapperURL),e._parse(n.nextWrapperURL,i,function(t,e){var i,r,o,s,l,u,d,h,f,g,m,v,y,_;if(null!=t)c.track(n.errorURLTemplates,{ERRORCODE:301}),p.ads.splice(p.ads.indexOf(n),1);else if(null==e)c.track(n.errorURLTemplates,{ERRORCODE:303}),p.ads.splice(p.ads.indexOf(n),1);else for(p.errorURLTemplates=p.errorURLTemplates.concat(e.errorURLTemplates),o=p.ads.indexOf(n),p.ads.splice(o,1),v=e.ads,u=0,d=v.length;d>u;u++){if(s=v[u],s.errorURLTemplates=n.errorURLTemplates.concat(s.errorURLTemplates),s.impressionURLTemplates=n.impressionURLTemplates.concat(s.impressionURLTemplates),null!=n.trackingEvents)for(y=s.creatives,g=0,h=y.length;h>g;g++)if(i=y[g],"linear"===i.type)for(_=Object.keys(n.trackingEvents),m=0,f=_.length;f>m;m++)r=_[m],(l=i.trackingEvents)[r]||(l[r]=[]),i.trackingEvents[r]=i.trackingEvents[r].concat(n.trackingEvents[r]);p.ads.splice(o,0,s)}return delete n.nextWrapperURL,a()}))}(s);return a()}}(this))},t.childByName=function(t,e){var n,i,r,o;for(o=t.childNodes,i=0,r=o.length;r>i;i++)if(n=o[i],n.nodeName===e)return n},t.childsByName=function(t,e){var n,i,r,o,s;for(i=[],s=t.childNodes,r=0,o=s.length;o>r;r++)n=s[r],n.nodeName===e&&i.push(n);return i},t.parseAdElement=function(t){var e,n,i,r;for(r=t.childNodes,n=0,i=r.length;i>n;n++){if(e=r[n],"Wrapper"===e.nodeName)return this.parseWrapperElement(e);if("InLine"===e.nodeName)return this.parseInLineElement(e)}},t.parseWrapperElement=function(t){var e,n,i,r,o,s,a;for(e=this.parseInLineElement(t),r=this.childByName(t,"VASTAdTagURI"),null!=r&&(e.nextWrapperURL=this.parseNodeText(r)),i=null,a=e.creatives,o=0,s=a.length;s>o;o++)if(n=a[o],"linear"===n.type){i=n;break}return null!=i&&null!=i.trackingEvents&&(e.trackingEvents=i.trackingEvents),null!=e.nextWrapperURL?e:void 0},t.parseInLineElement=function(t){var e,n,r,o,s,a,l,u,c,d,h,p,f,g;for(e=new i,p=t.childNodes,a=0,c=p.length;c>a;a++)switch(s=p[a],s.nodeName){case"Error":e.errorURLTemplates.push(this.parseNodeText(s));break;case"Impression":e.impressionURLTemplates.push(this.parseNodeText(s));break;case"Creatives":for(f=this.childsByName(s,"Creative"),l=0,d=f.length;d>l;l++)for(r=f[l],g=r.childNodes,u=0,h=g.length;h>u;u++)switch(o=g[u],o.nodeName){case"Linear":n=this.parseCreativeLinearElement(o),n&&e.creatives.push(n);break;case"CompanionAds":n=this.parseCompanionAd(o),n&&e.creatives.push(n)}}return e},t.parseCreativeLinearElement=function(t){var e,n,i,r,o,l,u,c,d,h,p,f,g,m,v,y,_,T,A,w,D,b,E,S;if(e=new s,e.duration=this.parseDuration(this.parseNodeText(this.childByName(t,"Duration"))),-1===e.duration&&"Wrapper"!==t.parentNode.parentNode.parentNode.nodeName)return null;for(u=t.getAttribute("skipoffset"),null==u?e.skipDelay=null:"%"===u.charAt(u.length-1)?(l=parseInt(u,10),e.skipDelay=e.duration*(l/100)):e.skipDelay=this.parseDuration(u),p=this.childByName(t,"VideoClicks"),null!=p&&(e.videoClickThroughURLTemplate=this.parseNodeText(this.childByName(p,"ClickThrough")),e.videoClickTrackingURLTemplate=this.parseNodeText(this.childByName(p,"ClickTracking"))),D=this.childsByName(t,"TrackingEvents"),g=0,_=D.length;_>g;g++)for(d=D[g],b=this.childsByName(d,"Tracking"),m=0,T=b.length;T>m;m++)c=b[m],n=c.getAttribute("event"),h=this.parseNodeText(c),null!=n&&null!=h&&(null==(f=e.trackingEvents)[n]&&(f[n]=[]),e.trackingEvents[n].push(h));for(E=this.childsByName(t,"MediaFiles"),v=0,A=E.length;A>v;v++)for(o=E[v],S=this.childsByName(o,"MediaFile"),y=0,w=S.length;w>y;y++)r=S[y],i=new a,i.fileURL=this.parseNodeText(r),i.deliveryType=r.getAttribute("delivery"),i.codec=r.getAttribute("codec"),i.mimeType=r.getAttribute("type"),i.bitrate=parseInt(r.getAttribute("bitrate")||0),i.minBitrate=parseInt(r.getAttribute("minBitrate")||0),i.maxBitrate=parseInt(r.getAttribute("maxBitrate")||0),i.width=parseInt(r.getAttribute("width")||0),i.height=parseInt(r.getAttribute("height")||0),e.mediaFiles.push(i);return e},t.parseCompanionAd=function(t){var e,n,i,s,a,l,u,c,d,h,p,f,g,m,v,y,_,T,A,w,D;for(i=new o,T=this.childsByName(t,"Companion"),h=0,m=T.length;m>h;h++){for(n=T[h],e=new r,e.id=n.getAttribute("id")||null,e.width=n.getAttribute("width"),e.height=n.getAttribute("height"),A=this.childsByName(n,"StaticResource"),p=0,v=A.length;v>p;p++)a=A[p],e.type=a.getAttribute("creativeType")||0,e.staticResource=this.parseNodeText(a);for(w=this.childsByName(n,"TrackingEvents"),f=0,y=w.length;y>f;f++)for(u=w[f],D=this.childsByName(u,"Tracking"),g=0,_=D.length;_>g;g++)l=D[g],s=l.getAttribute("event"),c=this.parseNodeText(l),null!=s&&null!=c&&(null==(d=e.trackingEvents)[s]&&(d[s]=[]),e.trackingEvents[s].push(c));e.companionClickThroughURLTemplate=this.parseNodeText(this.childByName(n,"CompanionClickThrough")),i.variations.push(e)}return i},t.parseDuration=function(t){var e,n,i,r,o;return null==t?-1:(e=t.split(":"),3!==e.length?-1:(o=e[2].split("."),r=parseInt(o[0]),2===o.length&&(r+=parseFloat("0."+o[1])),i=parseInt(60*e[1]),n=parseInt(60*e[0]*60),isNaN(n||isNaN(i||isNaN(r||i>3600||r>60)))?-1:n+i+r))},t.parseNodeText=function(t){return t&&(t.textContent||t.text)},t}(),e.exports=l},{"./ad.coffee":2,"./companionad.coffee":4,"./creative.coffee":5,"./mediafile.coffee":7,"./response.coffee":9,"./urlhandler.coffee":11,"./util.coffee":14}],9:[function(t,e){var n;n=function(){function t(){this.ads=[],this.errorURLTemplates=[]}return t}(),e.exports=n},{}],10:[function(t,e){var n,i,r,o,s,a={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var i in e)a.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("./client.coffee"),s=t("./util.coffee"),r=t("./creative.coffee").VASTCreativeLinear,n=t("events").EventEmitter,o=function(t){function e(t,e){var n,o,s;this.ad=t,this.creative=e,this.muted=!1,this.impressed=!1,this.skipable=!1,this.skipDelayDefault=-1,this.trackingEvents={},this.emitAlwaysEvents=["creativeView","start","firstQuartile","midpoint","thirdQuartile","complete","resume","pause","rewind","skip","closeLinear","close"],s=e.trackingEvents;for(n in s)o=s[n],this.trackingEvents[n]=o.slice(0);e instanceof r?(this.assetDuration=e.duration,this.quartiles={firstQuartile:Math.round(25*this.assetDuration)/100,midpoint:Math.round(50*this.assetDuration)/100,thirdQuartile:Math.round(75*this.assetDuration)/100},this.skipDelay=e.skipDelay,this.linear=!0,this.clickThroughURLTemplate=e.videoClickThroughURLTemplate,this.clickTrackingURLTemplate=e.videoClickTrackingURLTemplate):(this.skipDelay=-1,this.linear=!1),this.on("start",function(){i.lastSuccessfullAd=+new Date})}return l(e,t),e.prototype.setProgress=function(t){var e,n,i,r,o,s,a,l,u;if(o=null===this.skipDelay?this.skipDelayDefault:this.skipDelay,-1===o||this.skipable||(o>t?this.emit("skip-countdown",o-t):(this.skipable=!0,this.emit("skip-countdown",0))),this.linear&&this.assetDuration>0){if(n=[],t>0){n.push("start"),i=Math.round(t/this.assetDuration*100),n.push("progress-"+i+"%"),u=this.quartiles;for(r in u)s=u[r],t>=s&&s+1>=t&&n.push(r)}for(a=0,l=n.length;l>a;a++)e=n[a],this.track(e,!0);t<this.progress&&this.track("rewind")}return this.progress=t},e.prototype.setMuted=function(t){return this.muted!==t&&this.track(t?"muted":"unmuted"),this.muted=t},e.prototype.setPaused=function(t){return this.paused!==t&&this.track(t?"pause":"resume"),this.paused=t},e.prototype.setFullscreen=function(t){return this.fullscreen!==t&&this.track(t?"fullscreen":"exitFullscreen"),this.fullscreen=t},e.prototype.setSkipDelay=function(t){return"number"==typeof t?this.skipDelay=t:void 0},e.prototype.load=function(){return this.impressed?void 0:(this.impressed=!0,this.trackURLs(this.ad.impressionURLTemplates),this.track("creativeView"))},e.prototype.errorWithCode=function(t){return this.trackURLs(this.ad.errorURLTemplates,{ERRORCODE:t})},e.prototype.complete=function(){return this.track("complete")},e.prototype.stop=function(){return this.track(this.linear?"closeLinear":"close")},e.prototype.skip=function(){return this.track("skip"),this.trackingEvents=[]},e.prototype.click=function(){var t,e;return null!=this.clickTrackingURLTemplate&&this.trackURLs([this.clickTrackingURLTemplate]),null!=this.clickThroughURLTemplate?(this.linear&&(e={CONTENTPLAYHEAD:this.progressFormated()}),t=s.resolveURLTemplates([this.clickThroughURLTemplate],e)[0],this.emit("clickthrough",t)):void 0},e.prototype.track=function(t,e){var n,i;null==e&&(e=!1),"closeLinear"===t&&null==this.trackingEvents[t]&&null!=this.trackingEvents.close&&(t="close"),i=this.trackingEvents[t],n=this.emitAlwaysEvents.indexOf(t),null!=i?(this.emit(t,""),this.trackURLs(i)):-1!==n&&this.emit(t,""),e===!0&&(delete this.trackingEvents[t],n>-1&&this.emitAlwaysEvents.splice(n,1))},e.prototype.trackURLs=function(t,e){return null==e&&(e={}),this.linear&&(e.CONTENTPLAYHEAD=this.progressFormated()),s.track(t,e)},e.prototype.progressFormated=function(){var t,e,n,i,r;return r=parseInt(this.progress),t=r/3600,t.length<2&&(t="0"+t),e=r/60%60,e.length<2&&(e="0"+e),i=r%60,i.length<2&&(i="0"+e),n=parseInt(100*(this.progress-r)),""+t+":"+e+":"+i+"."+n},e}(n),e.exports=o},{"./client.coffee":3,"./creative.coffee":5,"./util.coffee":14,events:1}],11:[function(t,e){var n,i,r;r=t("./urlhandlers/xmlhttprequest.coffee"),i=t("./urlhandlers/flash.coffee"),n=function(){function e(){}return e.get=function(e,n){return"undefined"==typeof window||null===window?t("./urlhandlers/node.coffee").get(e,n):r.supported()?r.get(e,n):i.supported()?i.get(e,n):n()},e}(),e.exports=n},{"./urlhandlers/flash.coffee":12,"./urlhandlers/xmlhttprequest.coffee":13}],12:[function(t,e){var n;n=function(){function t(){}return t.xdr=function(){var t;return window.XDomainRequest&&(t=new XDomainRequest),t},t.supported=function(){return!!this.xdr()},t.get=function(t,e){var n,i;return(i="function"==typeof window.ActiveXObject?new window.ActiveXObject("Microsoft.XMLDOM"):void 0)?(i.async=!1,n=this.xdr(),n.open("GET",t),n.send(),n.onload=function(){return i.loadXML(n.responseText),e(null,i)}):e()},t}(),e.exports=n},{}],13:[function(t,e){var n;n=function(){function t(){}return t.xhr=function(){var t;return t=new window.XMLHttpRequest,"withCredentials"in t?t:void 0},t.supported=function(){return!!this.xhr()},t.get=function(t,e){var n;return n=this.xhr(),n.open("GET",t),n.send(),n.onreadystatechange=function(){return 4===n.readyState?e(null,n.responseXML):void 0}},t}(),e.exports=n},{}],14:[function(t,e){var n;n=function(){function t(){}return t.track=function(t,e){var n,i,r,o,s,a;for(i=this.resolveURLTemplates(t,e),a=[],o=0,s=i.length;s>o;o++)n=i[o],"undefined"!=typeof window&&null!==window&&(r=new Image,a.push(r.src=n));return a},t.resolveURLTemplates=function(t,e){var n,i,r,o,s,a,l,u,c;i=[],null==e&&(e={}),"CACHEBUSTING"in e||(e.CACHEBUSTING=Math.round(1e10*Math.random())),e.random=e.CACHEBUSTING;for(u=0,c=t.length;c>u;u++){n=t[u],a=n;for(r in e)l=e[r],o="["+r+"]",s="%%"+r+"%%",a=a.replace(o,l),a=a.replace(s,l);i.push(a)}return i},t.storage=function(){var t,e,n,i;try{n="undefined"!=typeof window&&null!==window?window.localStorage||window.sessionStorage:null}catch(r){i=r,n=null}return e=function(t){var e,n;try{if(n="__VASTUtil__",t.setItem(n,n),t.getItem(n)!==n)return!0}catch(i){return e=i,!0}return!1},(null==n||e(n))&&(t={},n={length:0,getItem:function(e){return t[e]},setItem:function(e,n){t[e]=n,this.length=Object.keys(t).length},removeItem:function(e){delete t[e],this.length=Object.keys(t).length},clear:function(){t={},this.length=0}}),n}(),t}(),e.exports=n},{}]},{},[6])(6)}),function(){!function(t){var e,n,i,r,o,s,a,l,u,c,d,h,p,f,g;return n=t.DM||{},n.VAST=n.VAST||{},g=navigator.userAgent,p=document.referrer,d=Modernizr,c=n.logger,a=n.utils.extend,i=n.utils.Location,e=n.utils.AuditudeLocation,o=/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i,l={"[DMPLATFORM]":"DMPLATFORM","[DMDEVICETYPE]":"DMDEVICETYPE","[DMPLAYERTYPE]":"DMPLAYERTYPE","[DMEXT]":"DMEXT","[DMREFERER]":"DMREFERER","[DMHOST]":"DMHOST","[DMTYPE]":"DMTYPE","[DMCATEGORY]":"DMCATEGORY","[DMOWNER]":"DMOWNER","[DMVIDEOTYPE]":"DMVIDEOTYPE","[DMVIDEO]":"DMVIDEO","[DMLANG]":"DMLANG"},u=a({},l,{"[ext]":l["[DMEXT]"],"[external]":l["[DMEXT]"],"[playertype]":l["[DMPLAYERTYPE]"],"[embedder]":l["[DMREFERER]"],"[referrer]":l["[DMREFERER]"],"[referer]":l["[DMREFERER]"],"[embedder.host]":l["[DMHOST]"],"[referrer.host]":l["[DMHOST]"],"[referer.host]":l["[DMHOST]"],"[TIMESTAMP]":"TIMESTAMP","[ts]":"TIMESTAMP","[timestamp]":"TIMESTAMP","[DATE]":"DATE","[USER_AGENT]":"USER_AGENT","[ua]":"USER_AGENT","[user-agent]":"USER_AGENT","[OUECHMAGUEULE]":"OUECHMAGUEULE"}),s={matcher:/\[([a-zA-Z._-]+)\]/gi,extractables:l,injectables:u},h={},f=function(t,e){return t instanceof RegExp&&e instanceof RegExp&&t.source===e.source&&t.global===e.global&&t.ignoreCase===e.ignoreCase&&t.multiline===e.multiline},r=function(){function t(t){this.videoInfo=t}var r;return r=function(t){var e;return e=function(t){return 10>t?"0"+t:t},""+t.getFullYear()+e(t.getMonth()+1)+e(t.getDate())+e(t.getHours())+e(t.getMinutes())+e(t.getSeconds())},t.prototype.updateInfo=function(t){return this.videoInfo=t,delete this.extractedValues},t.prototype.getValueForKey=function(t){return t in this.extractedValues||(this.extractedValues[t]=this.computeValueForKey(t)),this.extractedValues[t]},t.prototype.computeValueForKey=function(t){var e,i,s;switch(t){case u["[DMPLATFORM]"]:return d.ua_mobile?"phone":d.ua_tablet?"tablet":d.ua_tv?"tv":"desktop";case u["[DMDEVICETYPE]"]:if(d.ios)return"ios";if(d.android)return"android";if(d.ua_windowsphone)return"windowsphone";if(d.ua_windows8)return"windows8";if(d.ua_blackberry)return"blackberry";break;case u["[DMEXT]"]:return n.external?1:0;case u["[DMHOST]"]:return e=null!=p?p.match(o):void 0,s=e&&e.length>1?e[1]:0;case u["[DMTYPE]"]:return(i=location.host.match(/([^.]+)\.dailymotion\.com/))?"www"===i[1]?"prod":i[1]:0;case u["[DMREFERER]"]:return p||0;case u["[DMPLAYERTYPE]"]:return"html";case u["[DMCATEGORY]"]:return this.videoInfo.channel||"";case u["[DMOWNER]"]:return this.videoInfo["owner.username"]||"";case u["[DMVIDEOTYPE]"]:return this.videoInfo.type||"";case u["[DMVIDEO]"]:return this.videoInfo.id||"";case u["[DMLANG]"]:return this.videoInfo.language||"";case u["[TIMESTAMP]"]:return function(){return+new Date};case u["[DATE]"]:return function(){return r(new Date)};case u["[USER_AGENT]"]:return g;default:return 0}},t.prototype.getProcessor=function(t){var e,n,i;n={};for(e in h)if(i=h[e],-1!==t.indexOf(e)){n=i;break}return{extractables:a({},s.extractables,n.extractables),injectables:a({},s.injectables,n.injectables),matchers:n.matcher&&!f(n.matcher,s.matcher)?[s.matcher,n.matcher]:[s.matcher]}},t.prototype.extractValuesFromTemplate=function(t,e){var n,i;return n=t.params(),this.extractedValues={},c.groupCollapsed("Searching for extractables..."),c.log("extractValuesFromTemplate: input",n),i=function(t){return function(n){var r,o,s,a,l,u,c,d;for(s in n)for(a=n[s],u=0,c=a.length;c>u;u++)if(l=a[u],"object"==typeof l)i(l);else if(null===t.getInjectableKey(l,e)){d=e.extractables;for(r in d)o=d[r],s===o&&(t.extractedValues[s]=l)}}}(this),i(n),c.log("Found extracted values:",this.extractedValues),c.groupEnd(),this.extractedValues},t.prototype.getInjectableKey=function(t,e){var n,i,r;r=e.injectables;for(i in r)if(n=r[i],-1!==t.indexOf(i))return n;return null},t.prototype.filter=function(t){var n,r,o,s,a,l,u,d,h,p,f,g,m,v;for(h=t.match(/auditude\.com/)?e.parse(t):i.parse(t),c.groupCollapsed("[DMURLTemplateFilter] filtering url [",h.host,"]"),c.log("%cInput:","font-weight:bold;",t),c.groupCollapsed("filtering..."),c.log("Converted input to Location",h),d=this.getProcessor(t),c.log("Got processor for url",d),this.extractedValues||this.extractValuesFromTemplate(h,d),u=[],v=d.matchers,p=0,g=v.length;g>p;p++)s=v[p],(a=t.match(s))&&(u=u.concat(a));if(!u)return t;for(n=function(t){return function(e){var n;return n=t.getValueForKey(e),"function"==typeof n?n():n}}(this),c.groupCollapsed("Injecting values in url..."),f=0,m=u.length;m>f;f++)l=u[f],(r=this.getInjectableKey(l,d))&&(o=encodeURIComponent(n(r)),t=t.replace(l,o),c.log("Replaced placeholder",l,"with value :",o));return c.groupEnd(),c.groupEnd(),c.log("%cOutput:","font-weight:bold;",t),c.groupEnd(),t},t}(),n.VAST.URLTemplateFilter=r,t.DM=n}(window)}.call(this),function(){var t=[].slice;!function(e){"use strict";var n,i,r,o,s;return n=e.DM||{},n.ads=n.ads||{},s=n.logger.getLogger("MediaFile","color: purple; font-weight: bold;"),o=function(){s.warn("Implement me")},i=function(){function e(){this._events=new n.Events}return e.prototype.adLinear=!0,e.prototype.adWidth=0,e.prototype.adHeight=0,e.prototype.adExpanded=!1,e.prototype.adSkippableState=!1,e.prototype.adRemainingTime=0,e.prototype.adDuration=0,e.prototype.adVolume=0,e.prototype.adCompanions=[],e.prototype.adIcons=!1,e.prototype.adSkippableRemainingTime=0,e.prototype._events=null,e.prototype._videoSlot=null,e.prototype._trigger=function(){var e,n;e=1<=arguments.length?t.call(arguments,0):[],null!=(n=this._events)&&n.trigger.apply(n,e)},e.prototype.handshakeVersion=function(){return o()},e.prototype.subscribe=function(t,e,n){var i;null!=(i=this._events)&&i.on(e,t,n)},e.prototype.unsubscribe=function(t,e){var n;null!=(n=this._events)&&n.off(e,t)},e.prototype.initAd=function(){return o()},e.prototype.resizeAd=function(){return o()},e.prototype.startAd=function(){return o()},e.prototype.stopAd=function(){return o()},e.prototype.expandAd=function(){return o()},e.prototype.collapseAd=function(){return o()},e.prototype.skipAd=function(){return o()},e.prototype.getAdDuration=function(){return o()},e.prototype.getAdRemainingTime=function(){return o()},e.prototype.getAdSkippableState=function(){return o()},e.prototype.getAdSkippableRemainingTime=function(){return o()},e}(),i.events={LOADED:"AdLoaded",STARTED:"AdStarted",STOPPED:"AdStopped",SKIPPED:"AdSkipped",SKIPPABLE_STATE_CHANGE:"AdSkippableStateChange",SIZE_CHANGE:"AdSizeChange",LINEAR_CHANGE:"AdLinearChange",DURATION_CHANGE:"AdDurationChange",EXPANDED_CHANGE:"AdExpandedChange",REMAINING_TIME_CHANGE:"AdRemainingTimeChange",VOLUME_CHANGE:"AdVolumeChange",IMPRESSION:"AdImpression",VIDEO_START:"AdVideoStart",VIDEO_1ST_QUARTILE:"AdVideoFirstQuartile",VIDEO_MIDPOINT:"AdVideoMidpoint",VIDEO_3RD_QUARTILE:"AdVideoThirdQuartile",VIDEO_COMPLETE:"AdVideoComplete",CLICK_THRU:"AdClickThru",INTERACTION:"AdInteraction",USER_ACCEPT:"AdUserAccept",INVITATION:"AdInvitation",USER_MINIMIZE:"AdUserMinimize",USER_CLOSE:"AdUserClose",PAUSED:"AdPaused",PLAYING:"AdPlaying",LOG:"AdLog",ERROR:"AdError",SKIPPABLE_REMAINING_TIME_CHANGE:"AdSkippableRemainingTimeChange"},r={MEDIAFILE_NOT_FOUND:401,MEDIAFILE_TIMEOUT:402,MEDIAFILE_NOT_SUPPORTED:403,MEDIAFILE_PLAYBACK_ERROR:405},n.ads.timeouts={types:{LOAD_AD_UNIT:"LOAD_AD_UNIT",INIT_AD:"INIT_AD",START_AD:"START_AD",AD_GLOBAL:"AD_GLOBAL",STOP_AD:"STOP_AD"},defaults:{LOAD_AD_UNIT:3e3,INIT_AD:3e3,START_AD:8e3,AD_GLOBAL:1e4,STOP_AD:250}},n.ads.MediaFile=i,n.ads.VASTErrorCodes=r,e.DM=n}(window)}.call(this),function(){!function(t){"use strict";var e,n,i,r,o,s,a,l;return e=t.DM||{},e.ads=e.ads||{},o=e.logger.getLogger("VASTWrapper","color: purple; font-weight: bold;"),s=e.playerOptions,i=e.VAST.URLTemplateFilter,l=e.ads.timeouts.types,a=/\b(?:bing\.com|google|yahoo|ask\.com|yandex\.ru|naver\.com|voila\.fr|stumbleupon\.com|reddit\.com)\b/i,n={global:{closeButtonDisplayDelay:0,loadAdUnitTimeoutDuration:3e3,initAdTimeoutDuration:2e3,adMediaTimeoutDuration:8e3,adGlobalTimeoutDuration:1e4,stopAdTimeoutDuration:250},country:{FR:{closeButtonDisplayDelay:5},US:{closeButtonDisplayDelay:-1},NO:{closeButtonDisplayDelay:-1},SE:{closeButtonDisplayDelay:-1},DK:{closeButtonDisplayDelay:-1},FI:{closeButtonDisplayDelay:-1}},freelunch:["US","TR"]},r=function(){function t(){var t,i,r,o;this._stats=DMP_Stats.getInstance(),r=s.get("userEnv").cc,o=s.get("referer"),this.rules=e.extend({},n.global,n.country[r]),t=o&&o.match(a)||~n.freelunch.indexOf(r)?1:0,i=e.external?0:18e4,DMVAST.client.cappingMinimumTimeInterval=i,DMVAST.client.cappingFreeLunch=t}return t.prototype.urlTemplateFilter=null,t.prototype.rules=null,t.prototype._stats=null,t.prototype.watchFetchAd=function(t){return this._stats.trigger(DMP_Stats.AD_CALL_START,{}),t.fail(function(t){return function(){return t._stats.trigger(DMP_Stats.AD_CALL_FAIL,{})}}(this)).always(function(t){return function(){return t._stats.trigger(DMP_Stats.AD_CALL_END,{})}}(this))},t.prototype.getMediaFileInstance=function(){return new e.ads.VASTMediaFile},t.prototype.getCreativeData=function(){},t.prototype.getEnvironmentVars=function(t,e,n){return{slot:t,videoSlot:e,vastUrl:n,vastRules:{closeButtonDisplayDelay:this.rules.closeButtonDisplayDelay}}},t.prototype.prepareAdUnit=function(t){var e,n;return e=$.Deferred(),(null!=t&&null!=(n=t.advertising)?n.url:void 0)?(this.urlTemplateFilter?this.urlTemplateFilter.updateInfo(t):(this.urlTemplateFilter=new i(t),DMVAST.parser.addURLTemplateFilter(function(t){return function(e){return t.urlTemplateFilter.filter(e)}}(this))),e.resolve(t.advertising.url),e.promise()):(e.reject("field info.advertising.url is not defined for type VAST"),e.promise())},t.prototype.getTimeoutDurationForStep=function(t){switch(t){case l.LOAD_AD_UNIT:return this.rules.loadAdUnitTimeoutDuration;case l.INIT_AD:return this.rules.initAdTimeoutDuration;case l.START_AD:return this.rules.adMediaTimeoutDuration;case l.AD_GLOBAL:return this.rules.adGlobalTimeoutDuration;case l.STOP_AD:return this.rules.stopAdTimeoutDuration;default:return o.warn("Unkonwn Timeout Type :",t),null}},t}(),e.ads.VASTWrapper=r,t.DM=e}(window)}.call(this),function(){!function(t){"use strict";var e,n,i,r,o,s,a,l,u,c,d;return e=t.DM||{},e.ads=e.ads||{},a=e.logger.getLogger("VPAIDWrapper","color: purple; font-weight: bold;"),l=e.playerOptions,u=e.ads.timeouts,n=null,c=null,d=null,r=function(t){switch(t.type){case"sdk/liverail":return l.get("sdk_liverail").js;default:return a.warn("Can't find a VPAID URL for advetising type:",t.type)}},s=function(t,e,i){var r;return null==i&&(i=!1),null===d&&(d=$.Deferred()),r=e.document.getElementById("vpaid-loader"),null===r&&(r=e.document.createElement("script"),r.id="vpaid-loader",r.src=""+t+(i?"?disableIframes=1":""),r.onload=function(){return n=e.getVPAIDAd(),n.handshakeVersion("2.0"),d.resolve(n)},e.document.body.appendChild(r)),d.promise()},o=function(t){var e;return null===c&&(c=$.Deferred()),l.get("disableiframes")?s(t,window,!0).fail(c.reject).done(c.resolve):(e=document.getElementById("vpaid-frame"),null===e&&(e=document.createElement("iframe"),e.id="vpaid-frame",e.style.display="none",e.onload=function(){return s(t,e.contentWindow,!1).fail(c.reject).done(c.resolve)},document.body.appendChild(e))),c.promise()},i=function(){function t(t){var e,n;this.adsConfig=t,this._stats=DMP_Stats.getInstance(),(n=this.adsConfig.params.LR_TAGS)&&(this.adsConfig.params.LR_TAGS=n.replace(/PTYPE_web/,"PTYPE_html")),(e=this.adsConfig.params.LR_DM_PTYPE)&&(this.adsConfig.params.LR_DM_PTYPE=e.replace(/web/,"html")),this.adsConfig.params.LR_LAYOUT_SKIN_ID=0,null==this.adsConfig.params.LR_AUTOPLAY&&(this.adsConfig.params.LR_AUTOPLAY=l.get("autoplay")?1:0)}return t.prototype._stats=null,t.prototype.getMediaFileInstance=function(){return new e.ads.VPAIDMediaFile(n,this.adsConfig.ac_token)},t.prototype.getCreativeData=function(){return this.adsConfig.params},t.prototype.getEnvironmentVars=function(t,e){return{slot:t,videoSlot:e,videoSlotCanAutoPlay:!0}},t.prototype.prepareAdUnit=function(){var t,e,n;return t=$.Deferred(),e=r(this.adsConfig),this._stats.trigger(DMP_Stats.AD_LOAD_START,{}),t.done(function(t){return function(){return t._stats.trigger(DMP_Stats.AD_LOAD_END,{})}}(this)),"sdk/liverail"!==this.adsConfig.type?t.reject("Unsupported advertising type: "+this.adsConfig.type):(null!=(n=this.adsConfig.params)?n.LR_PUBLISHER_ID:void 0)||t.reject("LR_PUBLISHER_ID parameter is required"),e||t.reject("field VPAID URL is not defined"),"rejected"===t.state()?t.promise():(o(e).fail(t.reject).done(t.resolve),t.promise())},t.prototype.getTimeoutDurationForStep=function(t){var e,n;return e=this.adsConfig.timeouts,n=function(){if(!e)return null;switch(t){case u.types.LOAD_AD_UNIT:return e.load;case u.types.INIT_AD:return e.init;case u.types.START_AD:return e.start;case u.types.AD_GLOBAL:return e.global;case u.types.STOP_AD:return e.stop;default:return a.warn("Unkonwn Timeout Type :",t),null}}(),n||u.defaults[t]},t.prototype.onTimeoutReached=function(t){switch(t){case u.types.LOAD_AD_UNIT:d.reject("timeout"),this._stats.trigger(DMP_Stats.AD_LOAD_TIMEOUT,{});
break;case u.types.INIT_AD:this._stats.trigger(DMP_Stats.AD_INIT_TIMEOUT,{});break;case u.types.START_AD:this._stats.trigger(DMP_Stats.AD_START_TIMEOUT,{});break;case u.types.AD_GLOBAL:this._stats.trigger(DMP_Stats.AD_GLOBAL_TIMEOUT,{})}},t}(),e.ads.VPAIDWrapper=i,t.DM=e}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r,o,s;return n=t.DM||{},n.ads=n.ads||{},s=n.logger.getLogger("VASTMediaFile","color: purple; font-weight: bold;"),r=n.ads.MediaFile,String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),i=n.ads.VASTErrorCodes,o=function(t){function n(){return n.__super__.constructor.apply(this,arguments)}var o,a,l,u,c;return e(n,t),l="VASTMediaFile",a=r.events,c=function(t){return"video/mp4"===t.mimeType?!0:!1},o=function(t,e){return new DMVAST.tracker(t,e)},u=function(t){var e,n,r,a,l,u,d,h,p,f,g,m,v,y,_;if(a=$.Deferred(),u=null,null==t)return a.reject("Empty VAST response"),a.promise();for(v=t.ads,d=0,f=v.length;f>d;d++){for(e=v[d],y=e.creatives,h=0,g=y.length;g>h;h++)if(r=y[h],"linear"===r.type){for(_=r.mediaFiles,p=0,m=_.length;m>p;p++)if(l=_[p],c(l)){u=o(e,r),a.resolve(l,u);break}if(u)break}if(u)break;a.reject("No suitable mediaFile for this ad"),e&&(n=e.errorURLTemplates)&&DMVAST.util.track(n,{ERRORCODE:i.MEDIAFILE_NOT_SUPPORTED})}return u||(s.warn("[PlayerInstream] VAST response> end of response: no preroll found"),a.reject("Empty response or unable to find a valid ad"),n&&DMVAST.util.track(n,{ERRORCODE:i.MEDIAFILE_NOT_FOUND})),a.promise()},n.prototype._tracker=null,n.prototype._rules=null,n.prototype._stats=null,n.prototype.onMediaTimeout=function(){this._stats.trigger(DMP_Stats.AD_INSTREAM_TIMEOUT,{}),DMVAST.util.track(this._tracker.ad.errorURLTemplates,{ERRORCODE:i.MEDIAFILE_TIMEOUT})},n.prototype.handshakeVersion=function(){},n.prototype.initAd=function(t,e,n,r,o,c){var d,h,p,f,g;this._videoSlot=c.videoSlot,this._$videoSlot=$(this._videoSlot),this._rules=c.vastRules,this._stats=DMP_Stats.getInstance(),g=c.vastUrl,d={creativeView:function(t){return function(){return t._trigger(a.IMPRESSION)}}(this),start:function(t){return function(){return t._trigger(a.VIDEO_START)}}(this),firstQuartile:function(t){return function(){return t._trigger(a.VIDEO_1ST_QUARTILE)}}(this),midpoint:function(t){return function(){return t._trigger(a.VIDEO_MIDPOINT)}}(this),thirdQuartile:function(t){return function(){return t._trigger(a.VIDEO_3RD_QUARTILE)}}(this),pause:function(t){return function(){return t._trigger(a.PAUSED)}}(this),resume:function(t){return function(){return t._stats.trigger(DMP_Stats.AD_INSTREAM_PLAY,{},!0),t._trigger(a.PLAYING)}}(this),complete:function(t){return function(){return f(),t._trigger(a.VIDEO_COMPLETE)}}(this),skip:function(t){return function(){return f(),t._trigger(a.SKIPPED)}}(this),close:function(t){return function(){return t._trigger(a.STOPPED),f()}}(this),closeLinear:function(t){return function(){return t._trigger(a.STOPPED),f()}}(this),clickthrough:function(t){return function(e){return t._videoSlot.paused?t.resumeAd():t._trigger(a.CLICK_THRU,e,null,!0)}}(this),"skip-countdown":function(t){return function(e){t.adSkippableRemainingTime=e,t._trigger(a.SKIPPABLE_REMAINING_TIME_CHANGE,e),1>=e&&(t._tracker.removeListener("skip-countdown",d["skip-countdown"]),t._skipCountdownTimeout=setTimeout(function(){return s.log("skip-countdown timeout..."),p()},e))}}(this)},f=function(t){return function(){var e,n,i;s.log("unbinding callbacks..."),t._skipCountdownTimeout&&clearTimeout(t._skipCountdownTimeout),i=[];for(n in d)e=d[n],i.push(t._tracker.removeListener(n,e));return i}}(this),p=function(t){return function(){var e;return t.adSkippableState=!0,t._trigger(a.SKIPPABLE_STATE_CHANGE,t.adSkippableState),null!=(e=t._tracker)?e.removeListener("skip-countdown",d["skip-countdown"]):void 0}}(this),DMVAST.client.get(g,function(t){return function(e){return u(e).fail(function(e){return t._trigger(a.ERROR,e)}).done(function(e,n){var i,r;if(t._videoSlot){t._tracker=n,t._videoSlot.src=e.fileURL.trim(),t._trigger(a.LOADED);for(r in d)i=d[r],t._tracker.on(r,i);if(null===t._tracker.skipDelay){if(0===t._rules.closeButtonDisplayDelay)return p();if(-1!==t._rules.closeButtonDisplayDelay)return t._tracker.setSkipDelay(t._rules.closeButtonDisplayDelay)}}})}}(this)),h=document.documentElement.hasOwnProperty("ontouchend")?"touchend":"click",this._$videoSlot&&this._$videoSlot.on("canplay."+l,function(t){return function(){return t._tracker.load()}}(this)).on("play."+l,function(t){return function(){return t._tracker.setPaused(!1)}}(this)).on("pause."+l,function(t){return function(){return t._tracker.setPaused(!0)}}(this)).on("playing."+l,function(t){return function(){return t._stats.trigger(DMP_Stats.AD_INSTREAM_PLAYING,{},!0)}}(this)).on("volumechange."+l,function(t){return function(e){return t.adVolume=e.target.volume,t._tracker.setMuted(e.target.muted),t._trigger(a.VOLUME_CHANGE,t.adVolume)}}(this)).on("durationchange."+l,function(t){return function(e){return t.adDuration=e.target.duration,t._trigger(a.DURATION_CHANGE,t.adDuration)}}(this)).on("ended."+l,function(t){return function(){return t._tracker.complete()}}(this)).on("timeupdate."+l,function(t){return function(e){var n;return n=e.target.currentTime,t._tracker.setProgress(n),t.adRemainingTime=t.adDuration-n,t._trigger(a.REMAINING_TIME_CHANGE,t.adRemainingTime)}}(this)).on("error."+l,function(t){return function(e,n){return DMVAST.util.track(t._tracker.ad.errorURLTemplates,{ERRORCODE:i.MEDIAFILE_PLAYBACK_ERROR}),t._trigger(a.ERROR,n)}}(this)).on(""+h+"."+l,function(t){return function(){return t._tracker.click(),!1}}(this))},n.prototype.resizeAd=function(){},n.prototype.startAd=function(){this._stats.trigger(DMP_Stats.AD_INSTREAM_PLAY,{}),this._videoSlot.play()},n.prototype.stopAd=function(){var t,e,n;null!=(t=this._$videoSlot)&&t.off("."+l),null!=(e=this._videoSlot)&&e.pause(),null!=(n=this._tracker)&&n.stop(),this._tracker=null,this._videoSlot=null,this._$videoSlot=null,this._rules=null,this._events=null},n.prototype.pauseAd=function(){this._videoSlot.pause()},n.prototype.resumeAd=function(){this._videoSlot.play()},n.prototype.expandAd=function(){},n.prototype.collapseAd=function(){},n.prototype.skipAd=function(){this._$videoSlot.off("."+l),this._videoSlot.pause(),this._tracker.skip(),this._events=null},n.prototype.getAdDuration=function(){return this.adDuration},n.prototype.getAdRemainingTime=function(){return this.adRemainingTime},n.prototype.getAdSkippableRemainingTime=function(){return this.adSkippableRemainingTime},n}(r),n.ads.VASTMediaFile=o,t.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e},n=[].slice;!function(t){"use strict";var i,r,o,s,a,l,u;return i=t.DM||{},i.ads=i.ads||{},a=i.logger.getLogger("VPAIDMediaFile","color: purple; font-weight: bold;"),l=i.playerOptions,r=i.ads.MediaFile,u=i.ads.timeouts.types,s=function(t){var e,n,i;return e=l.get("cookie_root_domain"),i=864e5,n=new Date,n.setTime(n.getTime()+i),"ac_token="+t+";domain="+e+";expires="+n.toUTCString()},o=function(t){function i(t,e){var n,r,s;this.vpaidAdUnit=t,this.ac_token=e,i.__super__.constructor.call(this),this._stats=DMP_Stats.getInstance();for(r in o)n=o[r],s=this.onVPAIDEvent(n),this._listeners[n]=s,this.vpaidAdUnit.subscribe(s,n,this)}var o,l;return e(i,t),l="VPAIDMediaFile",o=r.events,i.prototype._listeners={},i.prototype._stats=null,i.prototype.onVPAIDEvent=function(t){return function(e){return function(){var i;switch(i=1<=arguments.length?n.call(arguments,0):[],t){case o.REMAINING_TIME_CHANGE:e.adRemainingTime=e.vpaidAdUnit.getAdRemainingTime(),e._$videoSlot.off("timeupdate.remaining."+l);break;case o.DURATION_CHANGE:e.adDuration=e.vpaidAdUnit.getAdDuration(),e._$videoSlot.off("durationchange."+l);break;case o.SKIPPABLE_STATE_CHANGE:e.adSkippableState=e.vpaidAdUnit.getAdSkippableState();break;case o.SKIPPABLE_REMAINING_TIME_CHANGE:e.adSkippableRemainingTime=e.vpaidAdUnit.getAdSkippableRemainingTime(),e._$videoSlot.off("timeupdate.skippable."+l);break;case o.VIDEO_START:e._stats.trigger(DMP_Stats.AD_START_END,{}),e._stats.trigger(DMP_Stats.AD_GLOBAL_END,{}),e.ac_token&&(document.cookie=s(e.ac_token));break;case o.LOADED:e._stats.trigger(DMP_Stats.AD_INIT_END,{})}return e._trigger.apply(e,[t].concat(n.call(i)))}}(this)},i.prototype.handshakeVersion=function(t){return this.vpaidAdUnit.handshakeVersion(t)},i.prototype.initAd=function(t,e,n,i,r,s){return this._stats.trigger(DMP_Stats.AD_GLOBAL_START,{}),this._stats.trigger(DMP_Stats.AD_INIT_START,{}),this._videoSlot=s.videoSlot,this._$videoSlot=$(this._videoSlot),this._$videoSlot.on("timeupdate.remaining."+l,function(t){return function(e){var n;return n=e.target.currentTime,t.adRemainingTime=t.adDuration-n,t._trigger(o.REMAINING_TIME_CHANGE,t.adRemainingTime)}}(this)).on("timeupdate.skippable."+l,function(t){return function(){return t.adSkippableRemainingTime=t.vpaidAdUnit.getAdSkippableRemainingTime(),0===t.adSkippableRemainingTime&&t._$videoSlot.off("timeupdate.skippable."+l),t._trigger(o.SKIPPABLE_REMAINING_TIME_CHANGE,t.adSkippableRemainingTime)}}(this)).on("durationchange."+l,function(t){return function(e){return t.adDuration=e.target.duration,t._trigger(o.DURATION_CHANGE,t.adDuration)}}(this)),a.log("initAd",r,s),this.vpaidAdUnit.initAd(t,e,n,i,r,s)},i.prototype.resizeAd=function(t,e,n){return this.vpaidAdUnit.resizeAd(t,e,n)},i.prototype.startAd=function(){return this._stats.trigger(DMP_Stats.AD_START_START,{}),this.vpaidAdUnit.startAd()},i.prototype.stopAd=function(){var t,e,n;this._$videoSlot.off("."+l),n=this._listeners;for(e in n)t=n[e],this.vpaidAdUnit.unsubscribe(t,e);return this.vpaidAdUnit.stopAd()},i.prototype.pauseAd=function(){return this.vpaidAdUnit.pauseAd()},i.prototype.resumeAd=function(){return this.vpaidAdUnit.resumeAd()},i.prototype.expandAd=function(){return this.vpaidAdUnit.expandAd()},i.prototype.collapseAd=function(){return this.vpaidAdUnit.collapseAd()},i.prototype.skipAd=function(){return this.vpaidAdUnit.skipAd()},i.prototype.getAdDuration=function(){return this.adDuration},i.prototype.getAdRemainingTime=function(){return this.adRemainingTime},i.prototype.getAdSkippableState=function(){return this.adSkippableState},i.prototype.getAdSkippableRemainingTime=function(){return this.adSkippableRemainingTime},i}(r),i.ads.VPAIDMediaFile=o,t.DM=i}(window)}.call(this),function(){!function(t){"use strict";var e;return e=t.DM||{},e.templates=e.templates||{},e.templates.ads={countdownText:'<div class="ad-countdown">\n    <span class="ad-countdown-text"></span>\n</div>',playBtn:'<div class="ad-play-layer">\n    <button class="ad-play-button">\n        <div class="inner">\n            <div class="icon"></div>\n        </div>\n    </button>\n</div>',closeBtn:'<div class="ad-close-button">\n    <span class="countdown">{{time}}</span>\n    <span class="cross">&times;</span>\n</div>'},t.DM=e}(window)}.call(this),function(){!function(t){"use strict";var e;return e=t.DM||{},e.templates=e.templates||{},e.templates.social={button:"<a target=\"_blank\" href=\"{{link}}\" class='btn smooth-hover btn-icon btn-squared {{btnType}}' rel='external'> <i class='icon icon-{{className}}'></i> <span>{{label}}</span> </a>"},t.DM=e}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.DM||{},n.social=n.social||{},n.models=n.models||{},i=n.models.videoModel,n.models.SocialLinksModel=function(t){function r(){var t;t||(t=n.social.logger),this.sharingURLs=a(i.video.sharing_urls),i.on("change",function(e){return function(n){return e.sharingURLs=a(n.sharing_urls,e.params),t.log("[SocialLinksModel] videoModel changed:",e.sharingURLs),e.trigger("change",e.sharingURLs)}}(this)),t.log("[SocialLinksModel] constructor:",this.sharingURLs)}var o,s,a;return e(r,t),s={facebookURL:{label:"Facebook",className:"facebook"},twitterURL:{label:"Twitter",className:"twitter"},vkURL:{label:"Vkontakte",className:"vk"},naszaklasaURL:{label:"Nk",className:"nk"},zingmeURL:{label:"Zing",className:"zing"}},o="facebookURL",a=function(t){var e,i,r,a;a=function(e){return n.utils.extend({link:t[e]},s[e])},e=!1,i={};for(r in t)t.hasOwnProperty(r)&&s[r]&&(r!==o?i[r]=a(r):e=!0);return e&&(i[o]=a(o)),i},r}(n.Events),t.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r;return n=t.DM||{},n.models=n.models||{},r=null,i=n.events.ads,n.models.AdsUIModel=function(t){function i(){r||(r=n.ads.logger),r.log("[AdsUIModel] constructor")}return e(i,t),i.prototype.adDuration=15,i.prototype.countdown=-1,i.prototype.skipCountdown=-2,i.prototype.adPlaybackState="PLAYING",i.prototype.set=function(t){var e,n,i,r,o;for(e=!1,o=["adDuration","adCurrentTime","adCountdown","skipCountdown","adPlaybackState"],i=0,r=o.length;r>i;i++)n=o[i],null==t[n]||"adCountdown"!==n&&"skipCountdown"!==n||(t[n]=0|t[n]),null!=t[n]&&t[n]!==this[n]&&(this[n]=t[n],e=!0);return e?this.trigger("change"):void 0},i}(n.Events),n.models.AdsUIModel.PlaybackState={PLAYING:"PLAYING",PAUSED:"PAUSED"},t.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i;return n=t.DM||{},n.social=n.social||{},n.views=n.views||{},i=null,n.views.SocialButtonsView=function(t){function r(t,e,r){this.model=t,this.rootNode=e,this.params=null!=r?r:{},i||(i=n.social.logger),i.log("[SocialButtonsView] constructor:",this),this.btns=[],this.render(),this.model.on("change",function(t){return function(){return t.render()}}(this))}var o;return e(r,t),o=n.templates.social.button,r.prototype.render=function(){var t,e,r,s,a,l,u,c;for(i.log("[SocialButtonsView] render",this.rootNode),u=this.btns,a=0,l=u.length;l>a;a++)t=u[a],this.rootNode.removeChild(t);this.btns=[],c=this.model.sharingURLs;for(s in c)r=c[s],e=n.utils.extend({btnType:this.params.smallIcons?"btn-small":""},r),t=this._createElement(o,e),$(t).on("click",function(){return function(t){t.stopPropagation(),n.observer.trigger(n.events.social.BTN_CLICK,r)}}(this)),this.btns.push(t),this.rootNode.appendChild(t);return this},r}(n.View),t.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r,o,s,a,l,u;return o=t.DM||{},o.views=o.views||{},u=null,a=null,l=null,o.views.AdsUIView=function(t){function r(t,e,n){this.model=t,this.rootNode=e,u||(u=o.ads.logger),a=o.events.ads,l=o.playerLabels.get("ads")["video-countdown"],u.log("[AdsUIView] constructor:",this),this.render(n)}return e(r,t),r.prototype.closeBtn=null,r.prototype.countdownLabel=null,r.prototype.playBtn=null,r.prototype.render=function(t){return t&&(this.closeBtn||(this.closeBtn=new n(this.model,this.rootNode))),this.countdownLabel||(this.countdownLabel=new i(this.model,this.rootNode)),this.playBtn||(this.playBtn=new s(this.model,this.rootNode)),this},r.prototype.destroy=function(){this.closeBtn&&this.closeBtn.destroy(),this.countdownLabel.destroy(),this.playBtn.destroy(),this.closeBtn=null,this.countdownLabel=null,this.playBtn=null},r}(o.View),r=function(){function t(){}return t.prototype.countdown=15,t.prototype.countdownDone=!1,t.prototype.resolveCountDown=function(t){this.countdownDone!==!0&&-1!==this.countdown&&(0===this.countdown&&(this.countdownDone=!0),0===this.countdown||this.countdown>1?t():setTimeout(t,this.countdown))},t}(),i=function(t){function n(t,e){this.model=t,this.rootNode=e,u.log("[CountdownLabelView] constructor:",this),this.cdResolver=new r,this.render(),this.model.on("change",function(t){return function(){return t.update()}}(this))}var i;return e(n,t),i=o.templates.ads.countdownText,n.prototype.el=null,n.prototype.update=function(){return this.countdownLabel.style.display="none",this.cdResolver.countdown=this.model.adCountdown,this.cdResolver.resolveCountDown(function(t){return function(){return 0===(0|t.model.adCountdown)?t.countdownLabel.style.display="none":(t.countdownLabel.style.display="inline-block",t.countdownLabel.textContent=l.replace("%d",0|t.model.adCountdown))}}(this))},n.prototype.render=function(){return null===this.el?(u.log("[CountdownLabelView] render"),this.el=this._createElement(i),this.countdownLabel=this.el.querySelector(".ad-countdown-text"),this.countdownLabel.style.display="none",this.rootNode.appendChild(this.el),this.update(),this):void 0},n.prototype.destroy=function(){null!==this.el&&(this.rootNode.removeChild(this.el),this.el=null)},n}(o.View),n=function(t){function n(t,e){this.model=t,this.rootNode=e,u.log("[CloseBtnView] constructor:",this),this.cdResolver=new r,this.render(),this.model.on("change",function(t){return function(){return t.update()}}(this))}var i;return e(n,t),i=o.templates.ads.closeBtn,n.prototype.el=null,n.prototype.update=function(){null!==this.el&&(this.cdResolver.countdown=this.model.skipCountdown,this.cdResolver.resolveCountDown(function(t){return function(){return 0===t.model.skipCountdown?(t.el.style.display="block",t.countdownNode.style.display="none",t.crossNode.style.display="block"):t.model.skipCountdown>0?(t.el.style.display="block",t.countdownNode.style.display="block",t.crossNode.style.display="none",t.countdownNode.textContent=t.model.skipCountdown):(t.el&&(t.el.style.display="none"),t.countdownNode.style.display="none",t.crossNode.style.display="none")}}(this)))},n.prototype.render=function(){return null===this.el?(u.log("[CloseBtnView] render"),this.el=this._createElement(i,{time:this.model.skipCountdown}),this.countdownNode=this.el.querySelector(".countdown"),this.crossNode=this.el.querySelector(".cross"),this.countdownNode.style.display="none",this.crossNode.style.display="none",$(this.el).on("click.ad-ui touchend.ad-ui",function(t){return function(){return 0===t.model.skipCountdown?(u.log("Sending "+a.AD_UI_SKIP+" event"),o.observer.trigger(a.AD_UI_SKIP),!1):void 0}}(this)),this.rootNode.appendChild(this.el),this.update(),this):void 0},n.prototype.destroy=function(){null!==this.el&&($(this.el).off("click.ad-ui touchend.ad-ui"),this.rootNode.removeChild(this.el),this.el=null)},n}(o.View),s=function(t){function n(t,e){this.model=t,this.rootNode=e,u.log("[PlayBtnView] constructor:",this),this.render(),this.model.on("change",function(t){return function(){return t.update()}}(this))}var i;return e(n,t),i=o.templates.ads.playBtn,n.prototype.el=null,n.prototype.update=function(){return this.el.style.display=this.model.adPlaybackState===this.model.constructor.PlaybackState.PAUSED?"block":"none"},n.prototype.render=function(){var t;if(null===this.el)return u.log("[PlayBtnView] render"),this.el=this._createElement(i),this.el.style.display="none",t=document.documentElement.hasOwnProperty("ontouchend")?"touchend":"click",$(this.el).on(""+t+".ad-ui",function(t){return function(){return t.model.adPlaybackState===t.model.constructor.PlaybackState.PAUSED?(u.log("Sending "+a.AD_UI_PLAY+" event"),o.observer.trigger(a.AD_UI_PLAY),!1):void 0}}(this)),this.rootNode.appendChild(this.el),this.update(),this},n.prototype.destroy=function(){null!==this.el&&($(this.el).off("click.ad-ui touchend.ad-ui"),this.rootNode.removeChild(this.el),this.el=null)},n}(o.View),t.DM=o}(window)}.call(this),function(){!function(t){"use strict";var e,n,i,r;return n=t.DM||{},n.social=n.social||{},n.controllers=n.controllers||{},n.social.logger=n.logger.getLogger("social","color: orange; font-weight: bold;"),n.events.social={BTN_CLICK:"DM.social.BTN_CLICK"},r=n.social.logger,i=n.models.SocialLinksModel,e=n.views.SocialButtonsView,n.controllers.SocialButtons=function(){function t(t,n){var o;r.groupCollapsed("SocialButtons constructor:",this),this.socialLinksModel=new i,o=new e(this.socialLinksModel,t,n),r.groupEnd()}return t}(),t.DM=n}(window)}.call(this),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r,o,s,a;return r=t.DM||{},r.ads=r.ads||{},r.controllers=r.controllers||{},r.ads.logger=r.logger.getLogger("Ads UI","color: brown; font-weight: bold;"),r.events.ads={AD_UI_SKIP:"AD_UI_SKIP",AD_UI_PLAY:"AD_UI_PLAY"},a=r.ads.logger,i=r.views.AdsUIView,n=r.models.AdsUIModel,o=r.ads.MediaFile,s=r.ads.MediaFile.events,r.controllers.AdsUI=function(t){function r(t,e){this.rootNode=t,this.player=e}return e(r,t),r.prototype.adsUIView=null,r.prototype.create=function(t,e){return a.groupCollapsed("creating Ads UI"),this.adsUIModel=new n,this.adsUIModel.set({adDuration:t,adCountdown:-1,adPlaybackState:n.PLAYING}),this.adsUIView=new i(this.adsUIModel,this.rootNode,e),a.groupEnd()},r.prototype.setSkipCountDown=function(t){var e;return null!=(e=this.adsUIModel)?e.set({skipCountdown:t}):void 0},r.prototype.setAdDuration=function(t){var e;return null!=(e=this.adsUIModel)?e.set({adDuration:t}):void 0},r.prototype.setAdCountDown=function(t){var e;return null!=(e=this.adsUIModel)?e.set({adCountdown:t}):void 0},r.prototype.onAdPaused=function(){var t;return null!=(t=this.adsUIModel)?t.set({adPlaybackState:n.PlaybackState.PAUSED}):void 0},r.prototype.onAdPlaying=function(){var t;return null!=(t=this.adsUIModel)?t.set({adPlaybackState:n.PlaybackState.PLAYING}):void 0},r.prototype.destroy=function(){var t,e;null!=(e=this.adsUIView)&&e.destroy(),this.adsUIView=null,t=this.backend&&$(t).off(".ad-ui")},r}(r.Events),t.DM=r}(window)}.call(this),window.DMInstream={type:{preroll:0,postroll:1},status:{fail:417,processing:102,timeout:408,success:201,plugin_timeout:4081,media_timeout:4082,ads_disabled:5050}},DailymotionPlayer.prototype={setImplem:function(t){function n(t){var n,i,r=[];for(n=0,i=t.length;i>n;n++)e=t[n],r.push(""+e+".implem");return r.join(" ")}function i(t,e){$(l.ui.events).triggerHandler(t.type,e)}function r(t,e){l.api(t.type,e)}function o(t,e){switch(t.type){case"volumechange":l.volume=e.volume,l.muted=e.muted;break;case"play":case"playing":l.paused=!1,l.ended=!1,l.adBlocker();break;case"canplay":case"pause":l.paused=!0;case"ended":l.ended=!0}}function s(t,e){var n="event="+t.type;u.get("id")&&(n+="&id="+u.get("id")),e&&(n+="&"+$.param(e));var i=u.get("api");"postMessage"==i?window.parent.postMessage(n,"*"):"xdcom"==i&&l.xdcom?l.xdcom.postMessage(u.get("xdcomId"),n):("fragment"==i||"location"==i)&&l.sendMessage(n)}function a(){function t(){r||(r=$.audience(u).progress(function(t){l.implem.setAudience(t)}))}function e(){r&&(r.close(),r=null)}function i(){$(l.implem).unbind(".audience"),e()}var r,o=DM.playerOptions,s=n(["play","playing"],"audience"),a=n(["pause","ended","unload"],"audience");if(i(),!o.flashControls()&&l.info.audience_url){var u=l.info.audience_url;DM.plugin("audience",!0,function(){$(l.implem).bind(s,t),$(l.implem).bind(a,e),$(l.implem).one("unload",i)})}}var l=this,u=DM.playerOptions,c=Modernizr;null!=this.implem&&$(this.implem).unbind(".implem"),this.implem=t;var d=n(["playing","play","pause","seeking","seeked","waiting","durationchange","timeupdate","progress","rebuffer"],"implem"),h=n(["check","play","pause","toggle-play","seek","fullscreen","watch-on-site"],"implem"),p=n(["volumechange","play","playing","canplay","ended","pause","rebuffer"],"implem"),f=n(["apiready","play","playing","canplay","canplaythrough","loadedmetadata","timeupdate","progress","seeking","seeked","volumechange","durationchange","pause","ended","error","fullscreenchange","ad_start","ad_timeupdate","ad_play","ad_pause","ad_end","rebuffer"],"implem");$(this.implem).bind(d,i),$(this.ui).bind(h,r),$(this.implem).bind(p,o),u.get("api")&&$(this.implem).bind(f,s),$(this.implem).bind("error.implem",function(t,e){(l.info.empty!==!0||"src_not_supported"!=e.code)&&(l.ui.error(e),l.ended=!0,"html"!=u.get("controls")||l.retried||"src_not_supported"!=e.code?$(l.ui.events).triggerHandler(t.type,e):(console.log("src error: retry once..."),l.retried=!0,(c.hls||u.get("hls"))&&l.implem.setHlsHasFailed(!0),l.loadId(l.info.id,null,!0)))}),this.info&&a(),DM.models.videoModel.on("change",a)},api:function(t,e){var n=DM.playerOptions;switch(t){case"check":return void $(this.implem).triggerHandler("apiready");case"load":return!n.flashControls()&&this.paused&&(this.started=!1),this.retried=!1,void this.loadId(e);case"toggle-play":return void(this.started?this.paused?this.implem.play():this.implem.pause():this.api("play"));case"toggle-muted":case"toggle-mute":return void this.implem.muted(!this.muted);case"mute":return void this.implem.muted(!0);case"unmute":return void this.implem.muted(!1);case"watch-on-site":var i=this.implem.currentTime();return void(top.location.href=this.info.url+(i?"?start="+Math.round(i):"")+"#from=embediframe")}return-1==$.inArray(t,["play","pause","volume","muted","seek","fullscreen"])?void console.error("Trying to call invalid API method: "+t):(("volume"==t||"seek"==t)&&(e=parseFloat(e)),("fullscreen"==t||"muted"==t)&&(e="0"!==e&&"false"!=e),this.implem[t]?void(this.started?this.implem[t].call(this.implem,e):"play"==t?this.load():console.error("Player not ready for "+t)):void console.error("Trying to call unimplemented API method: "+t))},initAPI:function(){var t=this,e=DM.playerOptions,n=Modernizr;if(e.get("api"))switch($(window).bind("message hashchange",function(e,n){if(n||(n="message"==e.type?e.originalEvent.data:location.hash.substring(1)),n&&!n.match(/^event=/)){var i=n.split("=");t.api(i[0],i[1])}}),e.get("api")){case"xdcom":window.onDMXDComMessage=function(t){$(window).triggerHandler("message",t)},window.onDMXDComReady=function(){t.xdcom=$("#xdcom").get(0),t.xdcom.addListener("onDMXDComMessage"),$(t.implem).triggerHandler("apiready")};var i=this.ui.getSWFHtml("//api.dmcdn.net/xdcom.swf",{allowscriptaccess:"always",flashvars:$.param({id:e.get("id")})},"xdcom"),r=document.createElement("div"),o=r.style;o.position="absolute",o.top="-10000px",o.width=o.height=0,document.body.appendChild(r),r.innerHTML=i;break;case"hashchange":DM.plugin("hashchange",!n.hashchange,function(){$(t.implem).triggerHandler("apiready")});break;default:$(this.implem).triggerHandler("apiready")}},initWithVideoInfo:function(t){var e=Modernizr,n=DM.playerOptions;!this.initializedWithVideoInfo&&t&&(this.initializedWithVideoInfo=!1),this.info&&!this.initializedWithVideoInfo&&(this.initializedWithVideoInfo=!0,n.htmlPlayer()&&this.stats.trigger(DMP_Stats.VIDEO_INFOS,this.statsInfo),this.info.error?($(this.implem).triggerHandler("error",this.info.error),this.stats.enabled=!1):e.sessionstorage&&sessionStorage.dmPlayedVideoId&&sessionStorage.dmPlayedVideoId==this.info.id?(this.ui.startscreen(this.info),$(this.implem).triggerHandler("ended"),$(this.implem).triggerHandler("fullscreenchange",{fullscreen:!1}),sessionStorage.removeItem("dmPlayedVideoId")):n.get("autoplay")?this.api("play"):(n.htmlStartscreen()?(this.ui.startscreen(this.info),DM.plugin("gestures",e.touch&&screen.width>500)):this.load(),this.implem.preload&&this.implem.preload(this.info)))},loadId:function(t,e,n){if(t){var i=DM.playerOptions,r=DM.utils.Location.parseQueryString;if(i.flashStartscreen()||i.flashControls()&&this.started)return void(this.started?this.implem.load({id:t}):this.load());if(n===!0||!this.info||this.info.id!=t){var o=this;this.started&&this.api("pause"),this.info={empty:!0},this.load(),this.ui.loading(!0),this.ui.empty(),fields=function(t){var e=t.split(",");return e.splice(e.indexOf("sharing_urls"),1),e.splice(e.indexOf("advertising"),1),e.join(",")}(this.fields);var s={fields:fields,ssl_assets:i.get("is_secure")};if(-1!==fields.search("advertising")){var a=i.get("ads_params"),l=a?r(a,!0):{},u=i.get("app"),c=i.get("referer");!l.LR_URL&&u&&(l.LR_URL=u),l.syndication_key=i.get("syndication"),l.ac_token=DM.utils.cookie.read("ac_token"),l.embedder_url=c?c:location.origin,l.player_type="html",l.device_type=i.get("device_type"),s.ads_params=encodeURIComponent($.param(l))}var d=i.get("apiKey");if(d){var h=DM.utils.cookie.read("dms_"+d);if(h)for(var p,f=h.substring(1,h.length-1).split(/&/),g=0,m=f.length;m>g;g++)if(p=f[g].split("/=/"),p&&"access_token"==p[0]){s.access_token=p[1];break}}$.ajax({url:"/json/video/"+t,data:s}).done(function(t){o.ui.relatedEndScreen(!1),o.info=t,DM.models.videoModel.setVideo(o.info),o.initializedWithVideoInfo&&i.htmlPlayer()&&(o.stats.enable(),o.stats.trigger(DMP_Stats.VIDEO_INFOS,o.info)),o.started?o.load():o.initializedWithVideoInfo?o.ui.startscreen(o.info):o.initWithVideoInfo(),o.ended&&o.api("play")}).fail(function(e,n,i){o.info={id:t,error:{code:n,title:i,message:null}},$(o.implem).triggerHandler("error",o.info.error)})}}},load:function(){if(this.info){var t=DM.playerOptions;if(this.info&&"error"in this.info&&t.htmlStartscreen())this.stats.trigger(DMP_Stats.ERROR,{type:"api",label:this.info.error.title,src:this.info.url}),this.ui.error(this.info.error);else{var e=this;this.ui.loading(!0),t.htmlControls()?DM.plugin("gestures",Modernizr.touch,function(){e.ui.controls(e.info)}):t.noControls()&&e.ui.controls("none"),this.implem.load(this.info,function(){e.ui.loading(!1)},e.retried),this.started=!0}}},sendMessage:function(t){if(this.messageQueue.push(t),!this.messageQueueTimer){var e=this;this.messageQueueTimer=setInterval(function(){e.unqueueMessage()},0)}},unqueueMessage:function(){var t=DM.playerOptions,e=this.messageQueue.shift();switch(0===this.messageQueue.length&&(this.messageQueueTimer=clearInterval(this.messageQueueTimer)),t.get("api")){case"location":location.href="dmevent://none?"+e;break;case"fragment":location.hash=e}},loadHapYak:function(){var t,e=this,n=0;DM.plugin("hapyak",!0,function(){t=setInterval(function(){n++,(window.hapyak||n>60)&&(clearInterval(t),window.hapyak&&e.initHapYak())},50)})},initHapYak:function(){var t=DM.playerOptions,e=t.flashPlayer()?"flash":"api",n=this.info.annotations,i=n.cdnEnabled?!0:!1,r={apiKey:"75debfb0ce714cd5ae1f",environment:n.env,playerMode:e,embed:!0,player:window.player,videoId:n.videoId,userId:n.readerId,authorId:n.ownerId,plugins:{cdn:{assets:{prefix:n.baseUrl},api:{prefix:n.baseUrl,enabled:i}}}};n.templates&&n.templates["channel-promotion"]&&(r.project={template:{tags:[n.templates["channel-promotion"].type]}},r.variables={channel:n.templates["channel-promotion"].channel}),hapyak.partner("dailymotion",{onLoad:function(t){t.viewer(r)}})},adBlocker:function(){var t=this;0==this.adBlockpinged&&(setTimeout(function(){t.hasAdBlocker()&&t.pingForAdBlocker()},100),this.adBlockpinged=!0)},hasAdBlocker:function(){var t=document.querySelectorAll&&[].slice.call(document.querySelectorAll("div.ad_box")).pop();return!t||0===t.innerHTML.length||0===t.clientHeight},pingForAdBlocker:function(){if("ok"===this.info.advertising.status){var t=$(this.ui.root).width(),e=$(this.ui.root).height()||$("embed",this.ui.root).height()||$(".ff",this.ui.root).height(),n=this.info.advertising.error_logger_url;n=n.replace("_WIDTH_",t),n=n.replace("_HEIGHT_",e),n=n.replace("_ERRORCODE_","1104"),n=DM.playerOptions.flashPlayer()?n.replace(/PTYPE_web/,"PTYPE_flash"):n.replace(/PTYPE_web/,"PTYPE_html"),(new Image).src=n}}},"console"in window||(console={}),"log"in console||(console.log=function(){}),"warn"in console||(console.warn=function(){}),"error"in console||(console.error=function(){}),"group"in console||(console.group=function(){}),"groupCollapsed"in console||(console.groupCollapsed=function(){}),"groupEnd"in console||(console.groupEnd=function(){}),DailymotionPlayerUI.prototype={set:function(t){$(this.root).empty().html(t)
},startscreen:function(t){if(t){if(t.hasOwnProperty("error"))return this.error(t.error);this.error(!1),this.$videoFrame.hide();var e=this,n=$("#startscreen");if(0===n.length&&this.enableControls&&!this.chromeless){$("#controls").remove(),n=$('<div id="startscreen" class="ff"/>').click(function(){return $(e).triggerHandler("play"),!1}).appendTo(this.root);var i=$('<div class="background"/>').appendTo($('<div class="bar">').appendTo(n));$('<div class="play button"><div class="inner"><div class="play-icon"></div><div class="icon"/></div></div>').click(function(){$(e).triggerHandler("play")}).appendTo(i),$('<div class="info"><div class="title"/><div class="owner"/><div class="duration"/></div>').click(!1).appendTo(i),this.whitemark||$(".info",i).delegate("a","click",function(){return top.location.href=$(this).attr("href"),!1}),this.logo(n)}this.customLogo(),this.thumb(t);var r=this.whitemark?"javascript:void(0);return false;":t.url+"#from=embediframe",o=t["owner.url"]+"#from=embediframe";if($(".info .title",n).html('<a href="'+r+'" target="_top">'+t.title+"</a>"),!this.whitemark){var s="<span>&nbsp;</span>";t["owner.url"]&&t["owner.screenname"]?s='<a href="'+o+'" target="_top">'+t["owner.screenname"]+"</a>":t["owner.screenname"]&&(s="<span>"+t["owner.screenname"]+"</span>"),$(".info .owner",n).html(s)}$(".info .duration",n).html(this.timeFormated(t.duration)),this.loading(!1)}},thumbSrc:function(t){if(this.thumbSrcs){if(t&&t.error)return this.thumbSrcs[380];var e=0,n=this.thumbSrcs[0],i=-1,r=$("#thumb").attr("src");currentWidth=$(this.root).width();for(var o in this.thumbSrcs){var s=this.thumbSrcs[o];s&&(s==r&&(i=o),currentWidth>=o&&o>e&&(e=o,n=s))}return e>i?n:r}},thumb:function(t){var e=$("#thumb");if(!t||t.empty===!0)return void e.attr("src","");this.thumbSrcs={380:t.thumbnail_url,160:t.thumbnail_240_url,0:t.thumbnail_120_url};var n=this,i=this.thumbSrc(t);i&&(0===e.length?(e=$('<img id=thumb style="position: absolute; display: block; width: 100%; opacity: .1">'),e.attr("src",i).load(function(){var e={opacity:1,top:0,left:0,width:"auto",height:"auto"},n=$(this),i=n.width(),r=n.height(),o=n.parent(),s=o.width(),a=o.height();i*r*s*a!==0&&(s/a>i/r?(e.width="100%",e.top=(a-r)/2):(e.height="100%",e.left=(s-i)/2),t.error&&(e.webkitFilter=e.mozFilter=e.filter="blur(5px)",e.opacity=.6,e.msFilter="progid:DXImageTransform.Microsoft.MotionBlur(strength=40)"),n.css(e))}).appendTo($("<div class=ff/>").prependTo(this.root)).triggerHandler("load"),this.thumbinited||($(window).bind("resize load",function(){e.triggerHandler("load")}),$(document.body).bind("load",function(){e.triggerHandler("load")}),$(window).resize(function(){e.attr("src",n.thumbSrc())}),this.thumbinited=!0)):e.attr("src",i))},logo:function(t){if(!this.chromeless&&!this.whitemark&&this.enableLogo){var e=this;0===$(".logo",t).length&&(this.assets.logo_svg||this.assets.logo_png)&&$('<img class="logo" class="button" width=97 height=16>').attr("src",Modernizr.svg?this.assets.logo_svg:this.assets.logo_png).click(function(){$(e).triggerHandler("watch-on-site")}).hover(function(){$("#player .bar").toggleClass("hover")}).appendTo(t),$("#player").hasClass("live")&&0===$(".live-logo",t).length&&$('<img class="live-logo" width=79 height=16>').attr("src",this.assets.liveshow_logo_svg).appendTo(t)}},customLogo:function(){var t=this;if(0===$(".custom-logo",this.root).length&&this.assets.custom_logo_url){var e=this.assets.custom_logo_origin.toLowerCase(),n={};n[-1!==e.indexOf("top")?"top":"bottom"]=Math.abs(this.assets.custom_logo_offset_y)+"px",n[-1!==e.indexOf("left")?"left":"right"]=Math.abs(this.assets.custom_logo_offset_x)+"px",$('<img class="custom-logo">').attr("src",this.assets.custom_logo_url).css(n).click(function(){$(t).triggerHandler("toggle-play")}).appendTo(this.root)}},videoFrame:function(){return 0===this.$videoFrame.length&&($controls=$("#controls"),this.$videoFrame=0===$controls.length?$('<div id="video-frame" class=ff></div>').appendTo(this.root):$('<div id="video-frame" class=ff></div>').insertBefore($controls)),this.$videoFrame.get(0)},controls:function(t){if("boolean"==typeof t){var e=document.getElementById("controls");return void(e&&(e.style.display=t?"":"none"))}if(t.hasOwnProperty("error"))return this.error(t.error);if(this.error(!1),this.$videoFrame.show(),!this.chromeless&&"none"!==t){this.duration=null,this.seeking=!1;var n=$("#controls");if(0===n.length){var i=this;$("#loader").css("margin-top","-22px"),$("#startscreen").remove(),n=$('<div id=controls class="ff" style="z-index: 1000"/>').appendTo(this.root),Modernizr.touch&&(screen.width>500||this.webkitForceInline)?(n.click(function(){i.autohide(!0)}),n.bind("touchmove",function(){i.autohide()}),n.bind("pinchopen",function(){$(i).triggerHandler("fullscreen")}),n.bind("touchmove",function(t){return 2!=t.originalEvent.targetTouches.length})):(n.click(function(){$(i).triggerHandler("toggle-play")}),n.bind("touchstart touchmove touchend click",function(){i.autohide()}));var r=$("<div class=background/>").appendTo($("<div class=bar>").appendTo(n)).click(!1);$('<div class="play button"><div class=inner><div class="play-icon smooth-hover"></div><div class=icon/><div class=icon2/></div></div>').click(function(){$(i).triggerHandler("toggle-play")}).appendTo(r),$('<div class="progress-bar"><div class="buffer smooth-width force-transform"/><div class=border/><div class="progress smooth-width force-transform"><div class=indicator><div class=inner><span>00:00</span><div class=arrow-border/><div class=arrow/></div></div><div class="handle force-transform"><div class="inner "><div class=handle-hole/></div></div></div></div>').appendTo(r),$('<div class="progress-bar-interaction"/>').bind("mousedown touchstart mousemove touchmove mouseup touchend",function(t){if(("mousedown"==t.type||"touchstart"==t.type)&&(i.seeking=!0),i.seeking&&i.duration){var e,n=$(t.target).width();e=t.type.match(/touch/)?t.originalEvent.changedTouches[0].clientX-$(t.target).offset().left-8:"offsetX"in t&&"number"==typeof t.offsetX?t.offsetX:t.originalEvent.layerX,e>n&&(e=n);var r=Math.floor(i.duration*(e/n));return 0>r&&(r=0),r>i.duration&&(r=duration),$("#controls .progress-bar .indicator .inner span").html(i.timeFormated(r)),$("#controls .progress-bar .progress").removeClass("smooth-width").css("width",e+"px"),("mouseup"==t.type||"touchend"==t.type)&&(i.seeking=!1,i.seekTo={to:r,timeupdatesCount:0},$(i).triggerHandler("seek",r)),i.autohide(),!1}}).appendTo(r),$("<div class=duration>--:--</div>").appendTo(r),$('<div class="fullscreen button smooth-hover"/>').click(function(){$(i).triggerHandler("fullscreen")}).appendTo(r),this.logo(n),this.controlsinitted||($(this.events).bind("durationchange",function(t,e){i.duration=e.duration,$("#controls .duration").html(i.timeFormated(e.duration))}),$(this.events).bind("timeupdate",function(t,e){if(i.duration&&!i.seeking){if(i.seekTo&&i.m.hls){if(i.seekTo.timeupdatesCount++,i.seekTo.timeupdatesCount<=3){var n=Math.abs(Math.floor(i.seekTo.to-e.time));return void(n>5*i.seekTo.timeupdatesCount&&(i.seekTo.timeupdatesCount=0))}i.seekTo=void 0}$("#controls .progress-bar .indicator .inner span").html(i.timeFormated(e.time));var r=e.time/i.duration*100+"%";$("#controls .progress-bar .progress").css("width",r).addClass("smooth-width")}i.loading(!1)}),$(this.events).bind("progress",function(t,e){if(i.duration){var n=e.time/i.duration*100+"%";$("#controls .progress-bar .buffer").css("width",n)}}),this.controlsinitted=!0)}if((this.whitemark||!this.enableLogo||!this.assets.logo_svg&&!this.assets.logo_png)&&$("#controls").addClass("whitemark"),this.customLogo(),this.thumb(t),this.topbar(n),this.duration=t.duration,$("#controls .duration").html(this.timeFormated(t.duration)),$("#player").toggleClass("live","live"==t.mode),this.autohide(),Modernizr.touch){var o={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};$(".bar, #topbar",n).on(o[Modernizr.prefixed("transition")],function(t){var e=$(this);"opacity"===t.originalEvent.propertyName&&"0"===e.css("opacity")&&e.hide()})}}},topbar:function(t){var e,n=this;if("boolean"==typeof t)return e=document.getElementById("topbar"),void(e&&(e.style.display=t?"":"none"));var i=$("#topbar",t);0===i.length&&(i=$("<div id=topbar/>").appendTo(t)),e=i[0],this.enableSocial&&!this.socialBtns&&(this.socialBtns=new DM.controllers.SocialButtons(e),DM.observer.on(DM.events.social.BTN_CLICK,function(){$(n).triggerHandler("pause")}))},relatedEndScreen:function(t){if(DM.controllers.RelatedEndScreen){var e=this;if("boolean"==typeof t){if(!this.related)return;return void(t?this.related.show():this.related.hide())}var n=this.$videoFrame;if(Modernizr.android?setTimeout(function(){n.hide()},1500):n.hide(),$("#controls").hide(),this.loading(!1),this.related)this.related.show();else{$relatedScreen=$('<div id=related-sreen class="ff"/>').appendTo(this.root);var i=this.enableSocial?new DM.models.SocialLinksModel:null;this.related=new DM.controllers.RelatedEndScreen($relatedScreen[0],i),DM.observer.on(DM.events.related.REPLAY,function(){e.related.hide(),n.show(),$("#controls").show(),setTimeout(function(){$(e).triggerHandler("play")},100)}),DM.observer.on(DM.events.related.FETCH_ERROR,function(){e.related.hide(),n.show(),$("#controls").show()})}}},initLoader:function(){var t=this;this.startuploaderonly||($(this.events).bind("seeking",function(){t.loading(!0)}),$(this.events).bind("pause ended",function(){t.loading(!1)}),this.loaderFallback?$(this.events).bind("canplaythrough",function(){t.started=!0}):$(this.events).bind("waiting",function(){t.loading(!0)})),this.controlsinitted||$(this.events).bind("timeupdate",function(){t.loading(!1)})},autohide:function(t){return $controls=$("#controls"),$(".bar, #topbar",$controls).show(),t===!0&&$controls.hasClass("visible")?($controls.removeClass("visible"),clearTimeout(this.autohideTimeout),void(this.autohideTimeout=null)):($controls.addClass("visible"),this.autohideTimeout&&(clearTimeout(this.autohideTimeout),this.autohideTimeout=null),void(this.autohideTimeout=setTimeout(function(){$controls.removeClass("visible")},3e3)))},error:function(t){if(t){if(this.loading(!1),this.thumb(info),!t.title&&!t.message)return;0===$("#error",this.root).length&&($('<div id="error" class="ff"><div class="'+(t.dmCode?"error-"+t.dmCode:"")+'"><h2 class="error-title">'+(t.title?t.title:"")+'</h2><span class="error-message">'+(t.message?t.message:"")+"</span></div></div>").appendTo(this.root),$("#startscreen .play").hide())}else $("#error",this.root).remove()},loading:function(t){t!=this._loading&&($("#player").toggleClass("loading",t),t?(this.error(!1),startLoader(),this.loaderFallback&&this.$videoFrame.hide()):(stopLoader(),this.loaderFallback&&this.started&&this.$videoFrame.show()),this._loading=t)},empty:function(){this.started=!1,this.thumb(!1)},detectWidthBreakpoint:function(){var t,e=$(this.root).width(),n="min-width-",i="max-width-",r=[],o=[],s="px";$(this.root).removeClass(this.widthBreakpoints.join(s+" "+n)+s+" "+i+this.widthBreakpoints.join(s+" "+i)+s),$.each(this.widthBreakpoints,function(t,a){e>=a&&r.push(n+a+s),a>=e&&o.push(i+a+s)}),r.length&&(t=r.join(" ")),o.length&&(t+=" "+o.join(" ")),$(this.root).addClass(t),this.width=e},timeFormated:function(t){if(isNaN(t)||!isFinite(t))return"--:--";t=Math.round(t);var e=(e=Math.floor(t/3600))<10?"0"+e:e,n=(n=Math.floor(t/60)%60)<10?"0"+n:n,i=(i=t%60)<10?"0"+i:i;return 3600>t?n+":"+i:e+"h"+n},getSWFHtml:function(t,e,n){var i;if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length)e.type="application/x-shockwave-flash",e.src=t,e.id=n,i=$("<embed>").attr(e).get(0);else{var r=['<param name="movie" value="'+t+'"></param>'];$.each(e,function(t,e){r.push('<param name="'+t+'" value="'+e+'"></param>')}),i='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="'+n+'">'+r.join("")+"</object>"}return i}},DailymotionPlayerFlash.prototype={event:function(t,e){$(this.out).triggerHandler(t,e)},init:function(t){if(this.params.enableApi){var e=this,n={0:"ended",1:["play","playing"],2:"pause",3:"canplay",5:"canplaythrough"},i=null,r=null,o=null;window.onDailymotionPlayerReady=function(){var t=e.player=$("#iframe-embed").get(0);t.addEventListener("onStateChange","dmStateChange"),t.addEventListener("onVideoMetadata","dmMetadata"),t.addEventListener("onVideoProgress","dmProgress"),t.addEventListener("onVideoRebuffer","dmRebuffer"),t.addEventListener("onError","dmError"),t.addEventListener("onSeek","dmSeek"),t.addEventListener("onVolumeChange","dmVolumeChange"),t.addEventListener("onAdStart","dmAdStart"),t.addEventListener("onAdEnd","dmAdEnd"),e.playerReady=!0,e.timeoutID&&clearTimeout(e.timeoutID),e.apiNotReady&&e.event("error",!1);for(var n=0;n<e.actionQueue.length;n++)e[e.actionQueue[n].fn].apply(e,e.actionQueue[n].arg)},window.dmStateChange=function(t){t in n&&$("array"==$.type(n[t])?n[t]:[n[t]]).each(function(){e.event(""+this)}),i=e.player.getDuration()},window.dmMetadata=function(t){e.event("loadedmetadata"),e.event("durationchange",{duration:t.videoDuration})},window.dmProgress=function(t){t.mediaTime!==r&&(e.event("timeupdate",{time:t.mediaTime}),r=t.mediaTime),t.mediaBytesReceived!==o&&(e.event("progress",{time:t.mediaBytesReceived/t.mediaBytesTotal*i}),o=t.mediaBytesReceived)},window.dmError=function(t){var n,i;switch(t){case"stream_not_found":n="Not Found",i="The video may have been deleted by its author.";break;case"stream_rejected":n="Authorization Error",i="The authorization token is invalid or has expired, please try again.";break;case"stream_error":n="Stream Error",i="An error occurred while decoding the video stream."}e.event("error",{code:t,title:n,message:i})},window.dmSeek=function(t){e.event("seeked",{time:t})},window.dmVolumeChange=function(t){var n=+(t.volume/100).toFixed(1);e.event("volumechange",{volume:n,muted:t.muted})},window.dmRebuffer=function(t){e.event("rebuffer",{rebuffering:t.processing})},window.dmAdStart=function(){e.event("ad_start")},window.dmAdEnd=function(){e.event("ad_end")}}var s=$(this.ui.getSWFHtml(t,{allowFullScreen:"true",allowScriptAccess:"always",wmode:this.wmode},"iframe-embed"));this.ui.set(s),s.addClass("ff").css({width:"100%",height:"100%"})},load:function(t,e){this.video_id&&$(this).triggerHandler("unload",this.video_id),t?t.swf_url||(t.swf_url="../swf"):t={id:null,swf_url:"../swf"},$(this).triggerHandler("load",t.id),this.video_id=t.id,this.inited?this.loadVideoById(t.id):(this.init(t.swf_url+(-1===t.swf_url.indexOf("?")?"?":"&")+$.param(this.params)+"&_="),this.inited=!0),e&&e()},setAudience:function(t){this.player.setAudience(t)},setHlsHasFailed:function(){},loadVideoById:function(t){var e=this;this.playerReady?this.player.loadVideoById(t):(this.timeoutID||(this.timeoutID=window.setTimeout(function(){e.apiNotReady=!0,e.event("error",{code:"not_ready",title:"Not Ready",message:"Cannot talk to player"})},3e3)),this.actionQueue.push({fn:"loadVideoById",arg:[t]}))},paused:function(){return this.player&&2==this.player.getPlayerState()},play:function(){this.playerReady?this.player.playVideo():this.actionQueue.push({fn:"play",arg:[]})},pause:function(){this.player.pauseVideo()},seek:function(t){this.player.seekTo(t),this.event("seeking",{time:t})},currentTime:function(){return this.player&&"function"==typeof this.player.getCurrentTime?this.player.getCurrentTime():0},muted:function(t){t?this.player.mute():this.player.unMute(),this.event("volumechange",{volume:this.player.getVolume()/100,muted:t})},volume:function(t){this.player.setVolume(100*t),this.event("volumechange",{volume:t,muted:this.player.isMuted()})}},DailymotionPlayerHTML.prototype={event:function(t,e){$(this.out).triggerHandler(t,e)},init:function(){function t(){clearInterval(o),o=null}function e(e){e.target.currentTime!==n.lastTime&&(e.target.paused||n.stats.trigger(DMP_Stats.VIDEO_TIME_UPDATE,{currentTime:i.currentTime}),o||i.paused||(n.lastTime=e.target.currentTime,o=setInterval(function(){i.currentTime===n.lastTime?(n.event("waiting"),n.stats.trigger(DMP_Stats.VIDEO_WAITING,{currentTime:i.currentTime}),t()):n.lastTime=i.currentTime},600)))}var n=this,i=this.player;$(i).bind("canplay",function(t){n.m.ios&&"ipad"===n.m.ios.device&&$(i).css({top:0}),n.start&&(t.target.currentTime=n.start,n.start=null)}),$(i).bind("click",function(){n.play()}),$(i).bind("error",function(t){var e,r,o,s=t.target.error;switch(s.code){case s.MEDIA_ERR_ABORTED:o="aborted",r="Aborted",e="You aborted the video playback.";break;case s.MEDIA_ERR_NETWORK:o="network",r="Network Error",e="A network error caused the video download to fail part-way.";break;case s.MEDIA_ERR_DECODE:o="decode",r="Media Error",e="The video playback was aborted due to a corruption problem or because the video used features your browser did not support.";break;case s.MEDIA_ERR_SRC_NOT_SUPPORTED:o="src_not_supported",r="Media Not Supported",e="The video could not be loaded, either because the server or network failed or because the format is not supported.";break;default:e="An unknown error occurred."}n.stats.trigger(DMP_Stats.ERROR,{type:"player",label:r?r:"Unknow",src:i.src}),n.event("error",{code:o,title:r,message:e})}),$(i).bind("volumechange",function(t){n.event(t.type,{volume:t.target.volume,muted:t.target.muted})}),$(i).bind("durationchange",function(t){n.event(t.type,{duration:t.target.duration})}),$(i).bind("ended play pause canplay canplaythrough loadedmetadata playing",function(t){n.event(t.type)}),$(i).bind("timeupdate seeking seeked",function(t){n.event(t.type,{time:t.target.currentTime})}),$(i).bind("progress",function(t){0!==t.target.buffered.length&&(n.event(t.type,{time:t.target.buffered.end(t.target.buffered.length-1)}),n.stats.trigger(DMP_Stats.VIDEO_PROGRESS,{time:t.target.buffered.end(t.target.buffered.length-1)}))});var r=DM.utils.fullscreen(i);r.onChange(function(t){n.event("fullscreenchange",{fullscreen:t}),t||n.ui.autohide(!0)}),this.lastTime=0;var o;this.startuploaderonly||($(i).bind("timeupdate",e),$(i).bind("pause ended",t)),$(window).on("beforeunload",function(){n.stats.trigger(DMP_Stats.EXIT)}),this.m.android&&$(i).bind("timeupdate",function(t){0===t.target.currentTime&&n.lastTimeUpdate>0&&n.event("pause"),n.lastTimeUpdate=t.target.currentTime});try{i.load(),this.nativeControls&&(i.controls=1)}catch(s){}try{this.play()}catch(a){}},load:function(t,e){function n(t,e){t.target.currentTime>.3&&(s.trigger(DMP_Stats.VIDEO_PLAYING,{resolvedCDN:e.resolveCDN}),$(e.player).off("timeupdate.stats playing.stats"))}if(t.empty===!0)this.loadEmpty(t);else{var i=DM.utils.Location,r=this,o=$(this.player),s=r.stats,a=1;if(this.info=t,this.setSilentMode(),this.enableStats(t.ad),t.paywall)return this.event("error",{code:"device_not_supported",title:"Device Not Supported",message:"This device is not supported for premium videos. Please try on a flash enabled device."}),void s.trigger(DMP_Stats.ERROR,{type:"api",title:"Device Not Supported",src:t.url});if(t.id&&(this.video_id&&this.event("unload",t.id),this.event("load",t.id)),t.protocol="progressive",this.video_id=t.id,this.log_urls=this.silent?null:t.log_view_urls?t.log_view_urls:t.log_external_view_urls,this.video_url=null,this.resolveCDN=!1,this.tracking.init(this.log_urls,t.duration,t.mode),t.stream_audio_url)this.video_url=t.stream_audio_url,this.player.setAttribute("poster",t.thumbnail_url);else{t.stream_h264_url&&240!=this.quality?this.video_url=t.stream_h264_url:t.stream_h264_ld_url&&(this.video_url=t.stream_h264_ld_url);var l={240:"stream_h264_ld_url",380:"stream_h264_url",480:"stream_h264_hq_url",720:"stream_h264_hd_url",1080:"stream_h264_hd1080_url"};if(this.quality){var u,c,d,h,p;for(c=Object.keys(l),h=c.indexOf(""+this.quality),p=h;p>=0;p--)if(d=c[p],u=l[d],t[u]){this.video_url=t[u];break}}if(this.video_url&&this.video_url.match(/dailymotion\.com\/cdn\//)&&(this.video_url=i.appendQueryStringParameter(this.video_url,"helper=0")),"live"==t.mode&&t.onair){if(o.one("progress.live",function(){r.ui.loading(!1)}),!this.hls.live||!t.stream_live_hls_url)return this.event("error",{code:"device_not_supported",title:"Device Not Supported",message:"This device is not supported for this live event."}),void s.trigger(DMP_Stats.ERROR,{type:"api",title:"Device Not Supported",src:t.url});t.protocol="hls",this.video_url=t.stream_live_hls_url,this.forceFullscreen=!1}else if(this.hls.vod&&t.stream_hls_url&&!this.hls.hasFailed){t.protocol="hls",this.video_url=t.stream_hls_url;var f=this.quality||this.hls.default_quality;f&&(this.video_url=i.appendQueryStringParameter(this.video_url,"default="+f))}this.player.getAttribute("poster")&&this.player.removeAttribute("poster")}if(!this.video_url)return this.event("error",{code:"stream_not_found",title:"Not Found",message:"The video may have been deleted by its author."}),void s.trigger(DMP_Stats.ERROR,{type:"api",title:"Stream Not Found",src:t.url});this.resolveCDN=function(e){if(!e)return!1;var n=e.match(/dailymotion\.com\/cdn\/(live\/)?/);return null!==n&&n.length>1?"hls"!=t.protocol||!!n[1]&&"live"==t.mode&&t.onair:void 0}(this.video_url),this.silent&&(this.resolveCDN=!1);var g=DM.utils.fullscreen(this.player);this.forceFullscreen===!0&&g.enabled&&(this.resolveCDN=!1),this.stats.trigger(DMP_Stats.VIDEO_LOAD,[{category:"Video Infos",action:"Protocol",label:t.protocol}]),navigator.userAgent.match(/iPhone OS 3_/)&&(this.html5=!1),this.html5?(this.m.ios&&"ipad"===this.m.ios.device&&o.css({top:"-10000px"}),o.attr("type","hls"===t.protocol?"application/vnd.apple.mpegurl":"video/mp4"),this.resolveCDN||""===this.video_url||this.setPlayerSrc(this.video_url)):this.play(),this.player&&o.one("playing.removeloading canplaythrough.removeloading",function(t){$(t.target).unbind(".removeloading"),r.ui.initLoader(),e&&e()}),s.trigger(DMP_Stats.DIMENSIONS,{width:window.innerWidth,height:window.innerHeight}),s.trigger(DMP_Stats.EMBEDDER,document.referrer),o.off(".stats").one("play.stats",function(){s.trigger(DMP_Stats.VIDEO_START,{resolvedCDN:r.resolveCDN})}).on("play.stats",function(t){s.trigger(DMP_Stats.CONTROLS_PLAY,{currentTime:t.target.currentTime})}).on("pause.stats",function(t){s.trigger(DMP_Stats.CONTROLS_PAUSE,{currentTime:t.target.currentTime})}).on("playing.stats",function(t){n(t,r)}).on("timeupdate.stats",function(t){n(t,r)}).on("ended.stats",function(){var t=r.currentTime();s.trigger(DMP_Stats.VIDEO_END,{currentTime:t}),s.trigger(DMP_Stats.VIDEO_COMPLETED,{currentTime:t})}).on("seeking.stats",function(t){var e={currentTime:t.target.currentTime};r.lastTime&&(e.lastTime=r.lastTime),s.trigger(DMP_Stats.CONTROLS_SEEK,e)}),o.off(".postroll"),o.on("ended.postroll",function(){r.out.postroll&&(a>0?(r.out.postroll(),a--):r.showRelated())}),this.showRelatedEndScreen&&(this.ui.relatedEndScreen(!1),o.off(".related"),this.silent||o.on("playing.related",function(){o.off("playing.related"),r.ui.relatedEndScreen(!1),setTimeout(function(){DM.plugin("related",!0)},3e3)}))}return this.inited||(this.init(),this.inited=!0),this},loadEmpty:function(t){this.silent=!0,this.enableStats(t.ad),this.tracking.disable(),this.video_url="",this.player.src="",$(this.player).removeAttr("type")},reload:function(t,e){{var n=this;$(this.player)}this.video_url=t.url,this.player.src=t.src,$(this.player).attr("type","hls"===this.info.protocol?"application/vnd.apple.mpegurl":"video/mp4"),this.player.load(),n.setSilentMode(),n.enableStats(n.info.ad),n.tracking.enable(),e&&e()},setSilentMode:function(){this.silent=!DM.playerOptions.statsEnabled()||this.info.ad===!0||this.info.stats===!1},enableStats:function(t){t===!0?this.stats.filter("adsonly"):this.silent?this.stats.disable():this.stats.enable()},showRelated:function(){var t=this;this.player.webkitExitFullScreen&&this.player.webkitExitFullScreen(),this.showRelatedEndScreen&&!this.silent&&DM.plugin("related",!0,function(){t.ui.relatedEndScreen(this.info)})},setAudience:function(){},setPlayerSrc:function(t){if(Location=DM.utils.Location,this.player){this.player.src=function(t){return t=t.split("#")[0],""!==t&&Modernizr.android&&(loc=Location.parse(t),filename=loc&&loc.pathname&&loc.pathname.match(/^.*\/([^\/]*)$/),filename=filename&&2===filename.length&&-1!==filename[1].lastIndexOf(".")?filename[1]:"hls"===info.protocol?"v.m3u8":"v.mp4",t=Location.appendQueryStringParameter(t,"f="+filename)),t}(t)}},fallback:function(){this.html5=!1,this.play()},setHlsHasFailed:function(t){this.hls.hasFailed=t},paused:function(){return this.player&&this.player.paused},play:function(){function t(){if(""!==this.video_url||""!==this.player.src){var t=DM.utils.fullscreen(this.player);if(this.forceFullscreen===!0&&t.enabled&&(t.request(),this.forceFullscreen=!1),this.player.play(),n.ios&&DM.utils.versionCompare(n.ios.version,"4.2",{zeroExtend:!0})<0){var i=$('<a href="#"></a>').click(function(t){""!==e.player.src&&e.player.play(),t.preventDefault()}).appendTo(this.ui.videoFrame()),r=document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),i.get(0).dispatchEvent(r),i.remove()}}}var e=this,n=Modernizr;return this.html5?this.resolveCDN&&""!==this.video_url?DM.utils.CDNResolver.resolve(this.video_id,DM.utils.Location.appendQueryStringParameter(this.video_url,"redirect=0")).fail(function(){code="network",title="Network Error",msg="A network error caused the video download to fail part-way.",e.stats.trigger(DMP_Stats.ERROR,{type:"player",label:title?title:"Unknow",src:e.player.src}),e.event("error",{code:code,title:title,message:msg})}).resolved(function(t){e.stats.trigger(DMP_Stats.VIDEO_RESOLVED_CDN,t),e.setPlayerSrc(t)}).always(function(){t.bind(e)()}):t.bind(this)():(this.event("play"),n.sessionstorage&&(sessionStorage.dmPlayedVideoId=this.video_id),this.resolveCDN?$.ajax(this.video_url+"&redirect=0",{success:function(t){window.top.location.href=t}}):window.top.location.href=this.video_url),this},pause:function(){return this.html5&&this.player?(this.player.pause(),this):void 0},seek:function(t){return this.player.currentTime=t,this},currentTime:function(){return this.player?this.player.currentTime:0},fullscreen:function(){var t=DM.utils.fullscreen(this.player);return t.enabled&&(this.stats.trigger(DMP_Stats.CONTROLS_FULLSCREEN),t.request()),this},muted:function(t){this.player.muted=t,this.stats.trigger(DMP_Stats.CONTROLS_MUTED,t)},volume:function(t){return this.player.volume=t,this.stats.trigger(DMP_Stats.CONTROLS_VOLUME,t),this}},!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.DMStats=t()}}(function(){return function t(e,n,i){function r(s,a){if(!n[s]){if(!e[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return r(n?n:t)},u,u.exports,t,e,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(t){window.DMP_Stats=t("./stats.coffee"),window.DMP_Stats_GoogleAnalytics=t("./plugins/google_analytics.coffee"),window.DMP_Stats_SiteCatalyst=t("./plugins/site_catalyst.coffee"),window.DMP_Stats_VisualScience=t("./plugins/visual_science.coffee"),window.DMP_Stats_ComScore=t("./plugins/com_score.coffee"),window.DMP_Stats_Pinba=t("./plugins/pinba.coffee"),window.DMP_Stats_eStats=t("./plugins/estats.coffee"),window.DMP_Stats_Xiti=t("./plugins/xiti.coffee")},{"./plugins/com_score.coffee":2,"./plugins/estats.coffee":3,"./plugins/google_analytics.coffee":4,"./plugins/pinba.coffee":5,"./plugins/site_catalyst.coffee":6,"./plugins/visual_science.coffee":7,"./plugins/xiti.coffee":8,"./stats.coffee":9}],2:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(t){var n,i;this.options=t,e.__super__.constructor.call(this,this.options),this.params=this.options.params,n=this.options.pluginUrl,i=window.COMSCORE,this.queue=i?!1:[],i||this.loadPlugin(n,function(t){return function(){window.COMSCORE&&t.flushQueue()}}(this))}var n;return o(e,t),e.prototype.track=function(t){var e;return e=t||"default",this.queue===!1?n.call(this,e):this.queue.push(e),this},e.prototype.flushQueue=function(){var t,e,i,r,o,s;for(s=this.queue,r=0,o=s.length;o>r;r++){e=s[r];for(t in e)i=e[t],n.call(this,i)}return this.queue=!1,this},n=function(t){var e;e=window.COMSCORE.beacon,"default"===t?e(this.params):$.get("/comscore_video",{video:t.id},function(){return function(t){t&&e(t)}}(this))},e}(n),e.exports=i},{"../stats_base.coffee":10}],3:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(t){var n;this.options=t,e.__super__.constructor.call(this,this.options),this.queue=[],this.liveMode=!1,this.player=null,this.info=null,this.dom=(null!=(n=this.options)?n.dom:void 0)?this.options.dom:null}var n;return o(e,t),window._PJS=0,window._cmsJS=0,window._eStatDS=1,e.prototype.setVideoInfo=function(t,e){var n,i,r,o,s,a;return this.info=t,this.player=e,(null!=(o=this.info)?o.serial:void 0)?((null!=(s=this.info)?s.tags:void 0)||null!=(a=this.info)&&(a.tags=[]),"undefined"==typeof eStat_id?void(window.eStat_PJS=function(t){return function(){return t.logger.log("eStat_PJS"),null!=t.info&&null!=t.player?t.setVideoInfo(t.info,t.player):void 0}}(this)):(window.eStat_PJS=function(){return this.logger.log("eStat_PJS (empty)")},eStat_id.serial(this.info.serial),this.liveMode="live"===this.info.mode&&this.info.onair,this.firstPlay=!0,this.ended=!1,this.logger.log("Got video info (serial:",this.info.serial," ,live:",this.liveMode,")"),r=function(t){return function(){return t.logger.log("initializaton"),t.dom&&"undefined"!=typeof eStat_ev&&null!==eStat_ev&&"function"==typeof eStat_ev.domaine&&eStat_ev.domaine(t.dom),eStat_ms.referenceUI(t.player,"DS",t.info.title,3<t.info.tags.length?t.info.tags[3]:"",2<t.info.tags.length?t.info.tags[2]:"",1<t.info.tags.length?t.info.tags[1]:"",4<t.info.tags.length?t.info.tags[4]:"",5<t.info.tags.length?t.info.tags[5]:"",0<t.info.tags.length?t.info.tags[0]:"","",function(){return t.player.currentTime}),eStat_ms.TagDS(t.player).setUrl(t.info.url),eStat_ms.TagDS(t.player).setPlayerNameVersion("DailymotionPlayer"),eStat_ms.TagDS(t.player).setDuration(t.info.duration),t.flushQueue()}}(this),window._cmsJS&&window.DS?r():(i=0,n=setInterval(function(t){return function(){return window._cmsJS&&window.DS?(r(),clearInterval(n)):i>50?(t.logger.log("Cancel eStat load."),clearInterval(n)):(t.logger.log("Can't init eStat yet..."),i+=1)}}(this),50)))):(this.info=null,void(this.player=null))},e.prototype.track=function(t){var e;if(null!=(e=this.info)?e.serial:void 0)return this.queue===!1?n.call(this,t):this.queue.push(t),this},e.prototype.flushQueue=function(){var t,e,i,r;if(this.queue===!1)return this;for(this.logger.log("Flushing queue, queue status :",this.queue),r=this.queue,e=0,i=r.length;i>e;e++)t=r[e],n.call(this,t);return this.queue=!1,this},e.prototype.stopTracking=function(){var t;if(null!=(t=this.info)?t.serial:void 0)return"undefined"!=typeof eStat_ms&&null!==eStat_ms?eStat_ms.StopMeasurement(this.player):void 0},n=function(t){var e;switch(e=null,t.state){case"play":this.firstPlay?this.firstPlay=!1:(this.liveMode||this.ended)&&(this.logger.log(""+(this.liveMode?"Live Mode":"Video ended")+" : creating new eStat session"),eStat_ms.newStreamUI(this.player,this.info.title,0<this.info.tags.length?this.info.tags[0]:"",1<this.info.tags.length?this.info.tags[1]:"",2<this.info.tags.length?this.info.tags[2]:"",3<this.info.tags.length?this.info.tags[3]:"",4<this.info.tags.length?this.info.tags[4]:"",this.liveMode?"Live":this.info.channel),this.ended=!1),e=eStatPlayState.Play;
break;case"pause":e=this.liveMode?eStatPlayState.Stop:eStatPlayState.Pause;break;case"stop":this.ended=!0,e=eStatPlayState.Stop}return t.pos||(t.pos=this.player.currentTime),this.logger.log("Track :",function(){switch(e){case eStatPlayState.Stop:return"stop";case eStatPlayState.Pause:return"pause";case eStatPlayState.Play:return"play"}}(),t.pos),eStat_ms.TagDS(this.player).sendEvent(e,t.pos)},e}(n),e.exports=i},{"../stats_base.coffee":10}],4:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(){function t(t){var n;return this.options=t,n=this.options.params,"account"in n?n.universal?new i(n):new e(n):void 0}var e,i;return e=function(t){function e(t){var n,i,r;e.__super__.constructor.call(this);for(n in t)r=t[n],this[n]=r;this._gaq=window._gaq||[],"_gaq"in window||(i=(this._is_https?"https://ssl":"http://www")+".google-analytics.com/ga.js",this.loadPlugin(i)),this.track(["_setAccount",this.account]),this.domain&&this.track(["_setDomainName",this.domain])}return o(e,t),e.prototype.track=function(t){return this._gaq.push(t),this},e.prototype.setCustomVar=function(t,e,n,i){var r;return r=["_setCustomVar",t,e,n],i&&r.push(i),this.track(r),this},e.prototype.trackEvent=function(t,e,n,i,r){var o;return o=["_trackEvent",t,e],n&&o.push(n),i&&o.push(i),r&&o.push({nonInteraction:1}),this.track(o),this},e.prototype.trackTiming=function(t,e,n,i,r){var o;return n>0&&36e5>n&&(o=["_trackTiming",t,e,n],i&&o.push(i),r&&o.push(r),this.track(o)),this},e.prototype.trackPageview=function(){return this.track(["_trackPageview"]),this},e}(n),i=function(t){function e(t){var n,i,r;e.__super__.constructor.call(this);for(i in t)r=t[i],this[i]=r;"ga"in window||!function(t,e,n,i,r,o,s){t.GoogleAnalyticsObject=r,t[r]=t[r]||function(){(t[r].q=t[r].q||[]).push(arguments)},t[r].l=1*new Date,o=e.createElement(n),s=e.getElementsByTagName(n)[0],o.async=1,o.src=i,s.parentNode.insertBefore(o,s)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),n=["create",this.account],"sampleRate"in this&&n.push({sampleRate:parseFloat(this.sampleRate,10)}),this.track(n),this.trackPageview()}return o(e,t),e.prototype.track=function(t){return window.ga.apply(window,t),this},e.prototype.setCustomVar=function(){return this},e.prototype.trackEvent=function(t,e,n,i,r){var o;return o=["send","event",t,e],n&&o.push(n),i&&o.push(i),r&&o.push({nonInteraction:1}),this.track(o),this},e.prototype.trackTiming=function(t,e,n,i,r){var o;return n>0&&36e5>n&&(o=["send","timing",t,e,n],i&&o.push(i),r&&o.push(r),this.track(o)),this},e.prototype.trackPageview=function(){return this.track(["send","pageview",{hitCallback:function(){}}]),this},e}(n),t}(),e.exports=i},{"../stats_base.coffee":10}],5:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(t){var n,i;this.options=t,e.__super__.constructor.call(this,this.options),this.baseURL=this.options.baseURL,i=this.options.cc,n=this.options.as,this.queue=[],this.params={xid:"undefined",country:i,as:n,cell:"undefined",proxy:"undefined",comment:"undefined"}}var n;return o(e,t),e.prototype.setVideoInfo=function(t){this.logger.log("Got video info (xid:",t.xid,")"),t.mode&&(this.mode=t.mode),t.xid&&(this.params.xid=t.xid),t.cell&&(this.params.cell=t.cell),t.proxy&&(this.params.proxy=t.proxy),t.comment&&(this.params.comment=t.comment),this.params.xid&&this.mode&&this.flushQueue()},e.prototype.track=function(t){return this.logger.log("Track :",t,"(queue is "+(this.queue?"on":"off")+")"),$.isArray(t)||(t=[t]),this.queue===!1?n.call(this,t):this.queue.push(t),this},e.prototype.flushQueue=function(){var t,e,i,r;if(this.queue&&this.queue.length)return this;for(this.logger.log("Flushing queue, queue status :",this.queue),r=this.queue,e=0,i=r.length;i>e;e++)t=r[e],n.call(this,t);return this.queue=!1,this},e.prototype.trackTiming=function(t,e){return e>0&&36e5>e&&this.track([t,e/1e3]),this},n=function(t){var e,n,i,r,o;e=t[0],r=t.length>1?t[1]:void 0,i="live"===this.mode?"live.html":"vod.html",o=""+this.baseURL+i+"."+e,n=r?$.extend({},this.params,{t:r}):this.params,$.extend(n,{_n:Math.round(1e8*Math.random())}),$.get(o,n).fail(function(t){return function(){return t.logger.warn("Error",arguments)}}(this))},e}(n),e.exports=i},{"../stats_base.coffee":10}],6:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(t){var n;this.options=t,e.__super__.constructor.call(this,this.options),n="SiteCatalyst"in window,n?this.s=window.SiteCatalyst.getInstance():(this.logger.log("window.SiteCatalyst not present, loading plugin at ",this.options.pluginUrl),this.loadPlugin(this.options.pluginUrl,function(t){return function(){window.SiteCatalyst?t.s=window.SiteCatalyst.getInstance():(t.logger.warn("Error on loading SC plugin: no window.SiteCatalyst found"),t.enabled=!1)}}(this))),this.queue=n?!1:[],this.tempS=n?!1:{},this.media=function(t){var e;return e=[],{open:function(n,i,r){t.queue===!1?t.s.Media.open(n,i,r):e.push({action:"open",args:[n,i,r]})},play:function(n,i){t.queue===!1?t.s.Media.play(n,i):e.push({action:"play",args:[n,i]})},stop:function(n,i){t.queue===!1?t.s.Media.stop(n,i):e.push({action:"stop",args:[n,i]})},close:function(n){t.queue===!1?t.s.Media.close(n):e.push({action:"close",args:[n]})},flushQueue:function(){var i,r,o,s,a;for(n=t.s,a=n.Media,o=0,s=e.length;s>o;o++){r=e[o];try{a[r.action].apply(a,r.args)}catch(l){i=l,t.logger.log(i)}}}}}(this)}var n,i;return o(e,t),e.prototype.init=function(){e.__super__.init.call(this),this.flushQueue(),this.media.flushQueue()},e.prototype.setRSID=function(t){!1 in window||(this.s.un=t)},e.prototype.set=function(t){return $.extend(this.tempS!==!1?this.tempS:this.s,t),this},e.prototype.track=function(t){null!=t&&(this.queue===!1?n.call(this,t):this.queue.push({type:null,data:t}))},e.prototype.trackEvent=function(t,e){null!=t&&(this.queue===!1?i.call(this,t):this.queue.push({type:"event",data:t,title:e}))},e.prototype.flushQueue=function(){var t,e,r,o,s;for(this.tempS!==!1&&($.extend(this.s,this.tempS),this.tempS=!1),s=this.queue,r=0,o=s.length;o>r;r++)e=s[r],t="event"!==e.type?n:i,t.call(this,e.data,e.title);return this.queue=!1,this},e.prototype.reset=function(){var t,e,n;for(n={},t=e=1;75>=e;t=++e)n["prop"+t]="",n["eVar"+t]="";return this.set(n),this},n=function(t){null!=t&&this.set(t),this.s.t(),this.reset()},i=function(t,e){null!=t&&this.set(t),this.s.tl(this.s,"o",e),this.reset()},e}(n),e.exports=i},{"../stats_base.coffee":10}],7:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(){e.__super__.constructor.call(this),this.queue=[],this.global={log:1}}var n;return o(e,t),e.prototype.extend=function(t){return $.extend(this.global,t),this},e.prototype.track=function(t){return this.queue===!1?n.call(this,t):this.queue.push(t),this},e.prototype.flushQueue=function(){var t,e,i,r;for(r=this.queue,e=0,i=r.length;i>e;e++)t=r[e],n.call(this,t);return this.queue=!1,this},n=function(t){var e;$.extend(t,this.global),t.cb=(new Date).getTime(),e=new Image,e.src="http://www.dailymotion.com/sense/images/vs/tag.gif?"+$.param(t)},e}(n),e.exports=i},{"../stats_base.coffee":10}],8:[function(t,e){var n,i,r={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var i in e)r.call(e,i)&&(t[i]=e[i]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../stats_base.coffee"),i=function(t){function e(t){this.options=t,e.__super__.constructor.call(this,this.options),this.queue=[],this.config=null,this.mediaControl=null,this.videoElement=null}return o(e,t),e.prototype.fire=function(){var t;return t=this,function(e){return t.enabled!==!1?(t.logger.log("Fire event ",e.type),t.mediaControl.fire.call(this,e)):void 0}},e.prototype.seek=function(){var t;return t=this,function(e){return t.enabled!==!1?(t.logger.log("Seek event ",e.type),t.mediaControl.seek.call(this,e)):void 0}},e.prototype.filter=function(t){"adsonly"===t?(this.logger.log("Filter 'adsonly' => disabling Xiti"),this.enabled=!1):null===t?this.logger.log("Filter disabled"):this.logger.warn("Unknow filterName: "+t+" => Not sure if we log everything correctly...")},e.prototype.setVideoInfo=function(t,e,n){var i,r;return"undefined"!=typeof ATMedia&&null!==ATMedia&&ATMedia.init?(e&&this.logger.log("Got video info (richName:",e.xtrichname,")"),window.ATMediaReady=void 0,this._fire||(this._fire=this.fire()),this._seek||(this._seek=this.seek()),i=function(t){return function(){var e,n,i,r;for(e=["playing","pause","ended"],i=0,r=e.length;r>i;i++)n=e[i],t.videoElement.addEventListener(n,t._fire,!1);return t.videoElement.addEventListener("seeked",t._seek,!1)}}(this),r=function(t){return function(){var e,n,i,r;for(e=["playing","pause","ended"],i=0,r=e.length;r>i;i++)n=e[i],t.videoElement.removeEventListener(n,t._fire,!1);return t.videoElement.removeEventListener("seeked",t._seek,!1)}}(this),this.config=t,this.config&&ATMedia.init(this.config),null!==this.mediaControl&&null!==this.videoElement&&(r(),ATMedia.removeMediaControl(this.mediaControl)),void(null!=e&&null!=n&&(this.videoElement=n,this.mediaControl=ATMedia.addMediaControl(this.videoElement,e),i()))):void(window.ATMediaReady=function(i){return function(){i.logger.log("ATMediaReady! Calling setVideoInfo again"),i.setVideoInfo(t,e,n)}}(this))},e}(n),e.exports=i},{"../stats_base.coffee":10}],9:[function(t,e){var n;n=function(){function t(e){t.setEvents(["SESSION_START","SESSION_END","EXIT"]),t.setEvents(e),this.managers=[],this.filters={},this.inited=!1}return t.setEvents=function(t){var e,n,i;for(n=0,i=t.length;i>n;n++)e=t[n],this[e]=e},t.getInstance=function(){return{trigger:function(){}}},t.prototype.register=function(t){this.managers.push(t)},t.prototype.reset=function(){this.map(function(t){t.reset()})},t.prototype.defineInclusiveFilter=function(t,e){return this.filters[t]={inclusive:!0,events:e}},t.prototype.defineExclusiveFilter=function(t,e){return this.filters[t]={inclusive:!1,events:e}},t.prototype.trigger=function(t,e){this.activeFilter&&this.activeFilter.inclusive!==(-1!==this.activeFilter.events.indexOf(t))||this.map(function(n){n.trigger(t,e)})},t.prototype.enable=function(){this.filter(null),this.map(function(t){t.enabled=!0})},t.prototype.disable=function(){this.filter(null),this.map(function(t){t.enabled=!1})},t.prototype.filter=function(t){this.activeFilter=this.filters[t]||null,this.map(function(e){"function"==typeof e.filter&&e.filter(t)})},t.prototype.map=function(t){var e,n,i,r;for(r=this.managers,n=0,i=r.length;i>n;n++)e=r[n],t(e)},t}(),e.exports=n},{}],10:[function(t,e){var n,i,r;n=t("./stats.coffee"),r=t("./stats_session.coffee"),i=function(){function t(t){var e,n,i,o;this.options=t,this._eventReceiver=document.createElement("a"),this._measureTimeCounter=0,this._waitCounter=0,this._history=[],this._lock=[],this.session=new r,this.enabled=!0,null!=(null!=(e=this.options)?e.sampling:void 0)&&this.setSampling(this.options.sampling),this.logger=(null!=(n=this.options)&&null!=(i=n.logger)?i.log:void 0)?this.options.logger:(null!=(o=this.options)?o.logger:void 0)&&console?console:{error:function(){},log:function(){},warn:function(){}}}return t.prototype.init=function(){return this.trigger(n.SESSION_START),this.on(n.EXIT,function(){this.trigger(n.SESSION_END)}),this},t.prototype.reset=function(){var t,e,i,r;for(this.session&&this.trigger(n.SESSION_END),this._eventReceiver=document.createElement("a"),e=this._history,i=0,r=e.length;r>i;i++)t=e[i],t.once?this.one(t.events,t.callback):this.on(t.events,t.callback);return this._history=[],this.init(),this},t.prototype.setSampling=function(t){return t()!==!0?this.enabled=!1:void 0},t.prototype.on=function(t,e,n){var i,r,o,s;return"function"==typeof e&&(n=e,e=null),n?(r=$.isArray(t)?t:[t],i=function(t){return function(){$(t._eventReceiver).on(r.join(" "),$.proxy(n,t))}}(this),null===e?i():(o=!0,"sampling"in e&&!e.sampling()&&(o=!1),s="waitFor"in e,s&&o&&$(this._eventReceiver).one(e.waitFor,function(){return function(){i()}}(this)),o&&i()),this._history.push({events:r,callback:n}),this):void 0},t.prototype.one=function(t,e,n){var i;return i=$.isArray(t)?t:[t],$(this._eventReceiver).one(i.join(" "),$.proxy(n,this)),this._history.push({events:i,callback:n,once:!0}),this},t.prototype.off=function(t,e){var n,i,r,o,s;for($(this._eventReceiver).off(t,e),s=this._history,n=r=0,o=s.length;o>r;n=++r)if(i=s[n],i.events===t&&i.callback===e){this._history.splice(n,1);break}return this},t.prototype.lock=function(t){this._lock.push(t)},t.prototype.unlock=function(t){var e;e=this._lock.indexOf(t),~e&&this._lock.splice(e,1)},t.prototype.trigger=function(t,e){var n;if(n=~this._lock.indexOf(t),this.enabled&&!n)try{$(this._eventReceiver).triggerHandler(t,e)}catch(i){t=i,this.logger.error(""+t.name+": "+t.message)}return this.session&&this.session.log(t,e),this},t.prototype.onLoad=function(t){return this.on(n.SESSION_START,t),this},t.prototype.onUnload=function(t){return this.on(n.SESSION_END,t),this},t.prototype.measureTime=function(t,e,n,i){var r,o,s,a,l,u,c,d,h;return null==i&&(i=!1),c=d=null,o=s=null,l=null,a="mt_"+this._measureTimeCounter++,h=function(){return function(t){return($.isArray(t)?t:[t]).map(function(t){return""+t+"."+a})}}(this),u=h(t),r=h(e),this.on(u,function(){return function(t,e){d||(c=+new Date,d=!0,l=e)}}(this)),this.on(r,function(t){return function(e,r){var u;s||(o=+new Date,u=o-c,n.call(t,u,[l,r]),i||t.off("."+a),s=!0)}}(this)),this},t.prototype.wait=function(t,e){var n,i;i="wait_"+this._waitCounter++,t=t.map(function(t){return""+t+"."+i}),n=t.length,this.on(t,function(t){return function(){0===--n&&(e.call(t),t.off("."+i))}}(this))},t.prototype.loadPlugin=function(t,e){var n,i,r,o;i=!1,o=this,n=document.createElement("script"),n.type="text/javascript",n.async=!0,n.src=t,n.onload=n.onreadystatechange=function(){i||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(i=!0,setTimeout(function(){return function(){return"function"==typeof e&&e(),o.init()}}(this),50),n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n))},n.onerror=function(){o.enabled=!1},r=document.getElementsByTagName("script")[0],r.parentNode.insertBefore(n,r)},t._is_https="https:"===document.location.protocol,t}(),e.exports=i},{"./stats.coffee":9,"./stats_session.coffee":11}],11:[function(t,e){var n;n=function(){function t(){this.history=[],this.data={}}return t.prototype.log=function(){this.history.push(JSON.stringify(arguments))},t.prototype.hasLog=function(t){var e,n,i,r;for(r=this.history,n=0,i=r.length;i>n;n++)if(e=r[n],~e.indexOf('"'+t+'"'))return!0;return!1},t.prototype.save=function(t,e){this.data[t]=e},t.prototype.get=function(t){return t in this.data?this.data[t]:!1},t.prototype.has=function(t){return t in this.data},t}(),e.exports=n},{}]},{},[1])(1)}),function(){!function(t){"use strict";var e,n,i;return e=t.DM||{},n=e.logger.getLogger("tracking","color: HotPink; font-weight: bold;"),i=function(){function t(){}return t.prototype.parse=function(t,e,n){var i,r,o,s,a,l,u;this.logViewUrls=t,this.duration=e,this.mode=n,this.partnerFn={},this.singlePings={},this.periodicPings=[],a=this.logViewUrls,u=[];for(i in a)s=a[i],l=i.split("@"),r=l[0],o=l[1],this.checkRuleAndUrl(i,o,s)?(this.createPartnerPingFunction(i,r,o,s),u.push(this.parsePartnerRule(i,o))):u.push(void 0);return u},t.prototype.checkRuleAndUrl=function(t,e,i){return void 0===i?(n.warn(t,": url is empty"),!1):i.match(/%session%/)?(n.warn(t,": %session% placeholder is not valid in player HTML5"),!1):"live"===this.mode&&null!=e&&e.indexOf("%")>-1?(n.warn(t,":",e,"is not valid for live mode"),!1):null==e||e.match(/^([0-9%ms,|]+)?(\/[0-9]+[%ms]?)?$/)?null!=e&&e.indexOf(",")>-1&&e.indexOf("|")>-1?(n.warn(t,":",e,"'is not a valid format (can't contain both ',' and '|')"),!1):!0:(n.warn(t,":",e,"is not a valid format"),!1)},t.prototype.createPartnerPingFunction=function(t,e,i,r){return this.partnerFn[t]=function(t){return function(o,s){var a,l;return a=Math.floor(s),l=r.replace("%time%",a),l=l.replace("%position%",Math.min(1,Math.floor(o/t.duration*1e3)/1e3)),n.log("Call",e,"("+i+") at "+a+"s =>",l),(new Image).src=l}}(this)},t.prototype.parsePartnerRule=function(t,e){var n;return void 0===e?this.setupSinglePing(t,0):(n=e.match(/^([0-9%ms,|]*)\/?([0-9]*[%ms]?)?$/),this.parseSinglePingRule(t,n[1]),null!=n[2]&&""!==n[2]?this.parsePeriodicPingRule(t,n[1],n[2]):void 0)},t.prototype.parseSinglePingRule=function(t,e){var n,i,r,o,s;if(""===e)return this.setupSinglePing(t,0);if(e.indexOf(",")>-1){for(o=e.split(","),s=[],i=0,r=o.length;r>i;i++)n=o[i],s.push(this.setupSinglePing(t,this.getTimeInSec(n)));return s}return e.indexOf("|")>-1?this.setupSinglePing(t,this.getFirstPingTime(e)):this.setupSinglePing(t,this.getTimeInSec(e))},t.prototype.setupSinglePing=function(t,e){return null==this.singlePings[e]&&(this.singlePings[e]=[]),this.singlePings[e].push(t)},t.prototype.parsePeriodicPingRule=function(t,e,n){var i,r;return i=""===e?0:e.indexOf(",")>-1?this.getLastPingTime(e):e.indexOf("|")>-1?this.getFirstPingTime(e):this.getTimeInSec(e),r=this.getTimeInSec(n,!1),this.setupPeriodicPing(t,r,i)},t.prototype.setupPeriodicPing=function(t,e,n){return this.periodicPings.push({key:t,interval:e,base:n,called:1})},t.prototype.getTimeInSec=function(t,e){var n,i;return null==e&&(e=!0),n=t.match(/^([0-9]+)([%ms]?)$/),i=function(){switch(n[2]){case"%":return this.duration/100;case"m":return 60;default:return 1}}.call(this),t=parseInt(n[1])*i,e?Math.floor(t):Math.floor(10*t)/10},t.prototype.getFirstPingTime=function(t){var e,n;return n=function(){var n,i,r,o;for(r=t.split("|"),o=[],n=0,i=r.length;i>n;n++)e=r[n],o.push(this.getTimeInSec(e));return o}.call(this),Math.min.apply(null,n)},t.prototype.getLastPingTime=function(t){var e,n;return n=function(){var n,i,r,o;for(r=t.split(","),o=[],n=0,i=r.length;i>n;n++)e=r[n],o.push(this.getTimeInSec(e));return o}.call(this),Math.max.apply(null,n)},t}(),e.trackingParser=new i,t.DM=e}(window)}.call(this),function(){!function(t){"use strict";var e,n,i;return e=t.DM||{},n=e.logger.getLogger("tracking","color: HotPink; font-weight: bold;"),i=function(){function t(t){this.$videoElement=t}return t.prototype.init=function(t,e,i){return this.logViewUrls=t,this.duration=e,this.mode=i,n.groupCollapsed("Init log_view_urls calls"),n.log("logviews given :",this.logViewUrls),this.$videoElement.off(".logview"),this.enabled=!0,null!=this.logViewUrls&&(this.setListeners(),this.parse()),n.groupEnd()},t.prototype.enable=function(){return this.enabled=!0},t.prototype.disable=function(){return this.enabled=!1},t.prototype.setListeners=function(){return this.watchedVideoTime=0,this.playerVideoTime=0,this.$videoElement.on("play.logview",function(t){return function(e){return t.enabled?(null===t.watchedVideoTime&&(t.watchedVideoTime=0,t.playerVideoTime=0,t.parse()),t.updateCurrentTime(e.target.currentTime)):void 0}}(this)),this.$videoElement.on("timeupdate.logview",function(t){return function(e){return null!=t.playerVideoTime?t.updateCurrentTime(e.target.currentTime):void 0}}(this)),this.$videoElement.on("seeking.logview",function(t){return function(){return t.playerVideoTime=null}}(this)),this.$videoElement.on("seeked.logview",function(t){return function(e){return t.playerVideoTime=e.target.currentTime}}(this)),this.$videoElement.on("ended.logview stop.logview",function(t){return function(e){return t.updateCurrentTime(e.target.currentTime),t.watchedVideoTime=null}}(this))},t.prototype.parse=function(){return e.trackingParser.parse(this.logViewUrls,this.duration,this.mode),this.partnerFn=e.trackingParser.partnerFn,this.singlePings=e.trackingParser.singlePings,this.periodicPings=e.trackingParser.periodicPings},t.prototype.updateCurrentTime=function(t){var e,n,i;if(this.enabled){if(n=t-this.playerVideoTime,"live"===this.mode&&n>20)return void(this.playerVideoTime=t);for(i=[];n>=0;)this.updateTimers(n>1?1:n),e=Math.floor(this.watchedVideoTime),this.doPings(e),i.push(n-=1);return i}},t.prototype.updateTimers=function(t){return this.watchedVideoTime+=t,this.playerVideoTime+=t},t.prototype.doPings=function(t){var e,n,i,r,o,s,a,l,u;if(null!=this.singlePings[t]){for(a=this.singlePings[t],i=0,o=a.length;o>i;i++)e=a[i],this.partnerFn[e](this.playerVideoTime,this.watchedVideoTime);delete this.singlePings[t]}for(l=this.periodicPings,u=[],r=0,s=l.length;s>r;r++)n=l[r],t>=n.base&&(t-n.base)/n.interval>=n.called?(this.partnerFn[n.key](this.playerVideoTime,this.watchedVideoTime),u.push(n.called++)):u.push(void 0);return u},t}(),e.tracking=i,t.DM=e}(window)}.call(this),function(t){function e(){function e(t){var e=l.parse(t),n=l.parseQueryString(e.hash,!0);return n.proxy=e.hostname,n}var u,c,h=DM.playerOptions.get("analytics_services");u=["CONTROLS_PLAY","CONTROLS_PAUSE","CONTROLS_FULLSCREEN","CONTROLS_VOLUME","CONTROLS_SEEK","CONTROLS_MUTED","CONTROLS_QUALITY","CONTROLS_SHARE","VIDEO_LOAD","VIDEO_INFOS","VIDEO_RESOLVED_CDN","VIDEO_OPEN","VIDEO_START","VIDEO_PLAYING","VIDEO_TIME_UPDATE","VIDEO_PROGRESS","VIDEO_WAITING","VIDEO_END","VIDEO_COMPLETED","ERROR","DIMENSIONS","EMBEDDER","AD_CALL_START","AD_CALL_END","AD_CALL_FAIL","AD_INSTREAM_PLAY","AD_INSTREAM_PLAYING","AD_INSTREAM_SKIP","AD_INSTREAM_CLICK","AD_INSTREAM_ERROR","AD_INSTREAM_TIMEOUT","AD_LOAD_START","AD_LOAD_END","AD_LOAD_TIMEOUT","AD_INIT_START","AD_INIT_END","AD_INIT_TIMEOUT","AD_START_START","AD_START_END","AD_START_TIMEOUT","AD_GLOBAL_START","AD_GLOBAL_END","AD_GLOBAL_TIMEOUT"],c=new n(u),c.defineInclusiveFilter("adsonly",["AD_CALL_START","AD_CALL_END","AD_CALL_FAIL","AD_INSTREAM_PLAY","AD_INSTREAM_PLAYING","AD_INSTREAM_SKIP","AD_INSTREAM_CLICK","AD_LOAD_START","AD_LOAD_END","AD_LOAD_TIMEOUT","AD_INIT_START","AD_INIT_END","AD_INIT_TIMEOUT","AD_START_START","AD_START_END","AD_START_TIMEOUT","AD_GLOBAL_START","AD_GLOBAL_END","AD_GLOBAL_TIMEOUT"]);var p={logger:a,dom:DM.playerOptions.get("app")},f=new s(p),g=!0;if(f.on(n.VIDEO_INFOS,function(t,e){g=!0;var n=this;DM.plugin("estat",e["owner.analytics_services"]&&e["owner.analytics_services"].estat,function(){n.setVideoInfo({serial:e["owner.analytics_services"]&&e["owner.analytics_services"].estat?e["owner.analytics_services"].estat:void 0,title:e.title,tags:e.tags,channel:e.channel,duration:e.duration,url:e.url},document.querySelector("video"))})}),f.on(n.VIDEO_TIME_UPDATE,function(t,e){g&&(g=!1,this.track({state:"play",pos:e.currentTime}))}),f.on([n.CONTROLS_PAUSE,n.CONTROLS_SEEK,n.VIDEO_WAITING],function(t,e){g||(g=!0,this.track({state:"pause",pos:e.lastTime?e.lastTime:e.currentTime}))}),f.on(n.VIDEO_END,function(t,e){g=!0,this.track({state:"stop",pos:e.currentTime}),this.stopTracking()}),c.register(f),h.pinba&&h.pinba.enable){var m=DM.playerOptions.get("userEnv"),p={logger:loggerPinba,baseURL:"http://www.dailymotion.com/track/",cc:m?m.cc:"undefined",as:m?m.as:"undefined"},v=new o(p);v.on(n.VIDEO_INFOS,function(t,e){this.setVideoInfo({xid:e.id,mode:e.mode})}),v.on(n.VIDEO_RESOLVED_CDN,function(t,n){var i=e(n);this.setVideoInfo(i)}),v.measureTime(n.CONTROLS_PLAY,n.VIDEO_RESOLVED_CDN,function(t){this.trackTiming("stream.resolve",t)}),v.measureTime(n.AD_CALL_START,n.AD_CALL_END,function(t){this.trackTiming("adcall",t)}),v.on(n.AD_CALL_FAIL,function(){this.track("adcall.failed")}),v.measureTime(n.AD_INSTREAM_PLAY,n.AD_INSTREAM_PLAYING,function(t){this.trackTiming("preroll",t)}),v.on(n.AD_INSTREAM_TIMEOUT,function(){this.track("preroll.timeout")}),v.on(n.AD_LOAD_START,function(){this.track("loadAd.init")}),v.on(n.AD_LOAD_TIMEOUT,function(){this.track("loadAd.timeout")}),v.measureTime(n.AD_LOAD_START,n.AD_LOAD_END,function(t){this.trackTiming("loadAd.time",t)}),v.on(n.AD_INIT_START,function(){this.track("initAd.init")}),v.on(n.AD_INIT_TIMEOUT,function(){this.track("initAd.timeout")}),v.measureTime(n.AD_INIT_START,n.AD_INIT_END,function(t){this.trackTiming("initAd.time",t)}),v.on(n.AD_START_START,function(){this.track("startAd.init")}),v.on(n.AD_START_TIMEOUT,function(){this.track("startAd.timeout")}),v.measureTime(n.AD_START_START,n.AD_START_END,function(t){this.trackTiming("startAd.time",t)}),v.on(n.AD_GLOBAL_START,function(){this.track("globalAd.init")}),v.on(n.AD_GLOBAL_TIMEOUT,function(){this.track("globalAd.timeout")}),v.measureTime(n.AD_GLOBAL_START,n.AD_GLOBAL_END,function(t){this.trackTiming("globalAd.time",t)}),v.measureTime(n.VIDEO_START,n.VIDEO_PLAYING,function(t,e){Array.isArray(e)&&e.length>0&&"boolean"==typeof(d=e[1]).resolvedCDN&&d.resolvedCDN?this.trackTiming("stream.play",t):this.trackTiming("stream.resolveandplay",t)});var y=function(){function t(){var t=+Date.now();if(u){if(!a)return c-Math.max(d,u)<r?void loggerPinba.log("Watcher: Steady Play not reached yet: ignoring"):(loggerPinba.log("Watcher: Reached steady play : Start Tracking!"),void(a=!0));d||(d=u),d>c&&t>d+o&&(loggerPinba.log("Watcher: Got rebuffering!! Track this!"),v.track("stream.rebuffering"),n(),l=!0)}}function e(){null===s&&(loggerPinba.log("Watcher: Starting rebuffering watcher"),s=setInterval(t.bind(this),i),l=!1)}function n(){null!==s&&(loggerPinba.log("Watcher: Stoping rebuffering watcher"),clearInterval(s),s=null,a=!1,u=null,d=null,c=null)}var i=200,r=2e3,o=500,s=null,a=!1,l=!1,u=null,c=null,d=null;return{startWatch:function(){l=!0},stopWatch:function(t,e){l=!1,n(t,e)},onTimeUpdate:function(t,n){if(l&&e(t,n),null!==s){var i=+Date.now();u||(u=i),c=i}},onWaiting:function(){d=+Date.now()},onSeek:function(t,e){l=!0,this.stopWatch(t,e)}}}();v.on([n.CONTROLS_PAUSE,n.VIDEO_END,n.VIDEO_LOAD],y.stopWatch.bind(y)),v.on(n.CONTROLS_SEEK,y.onSeek.bind(y)),v.on([n.VIDEO_PLAY,n.CONTROLS_PLAY,n.VIDEO_START],y.startWatch.bind(y)),v.on(n.VIDEO_TIME_UPDATE,y.onTimeUpdate.bind(y)),v.on(n.VIDEO_WAITING,y.onWaiting.bind(y)),c.register(v)}var p={params:{universal:!0,account:"UA-36954025-4",domain:"dailymotion.com",sampleRate:1}},_=new i(p);_.on(n.VIDEO_INFOS,function(t,e){this.session.save("video:duration",e.duration),this.trackEvent("Video Infos","Channel",e.channel,null,!0).trackEvent("Video Infos","Mode",e.mode,null,!0).trackEvent("User Infos","Time",(new Date).toTimeString(),null,!0)}),_.on(n.VIDEO_LOAD,function(t,e){var n,i,r;r=this;for(n in e)i=e[n],this.trackEvent("Video Infos",n,i)}),_.measureTime(n.VIDEO_START,n.VIDEO_PLAYING,function(t){this.trackTiming("Video","Loading time",t)}),_.measureTime(n.VIDEO_START,[n.VIDEO_END,n.SESSION_END,n.EXIT],function(t){var e=1e3*+this.session.get("video:duration"),n=t/e*100;!n||0>n?n=0:n>100&&(n=100),this.trackTiming("Video","Viewing time",n>>0)}),_.one(n.CONTROLS_PLAY,function(){this.trackEvent("Controls","Play")}),_.one(n.VIDEO_PLAYING,function(){this.trackEvent("Video Player","Playing")}),_.one(n.VIDEO_COMPLETED,function(){this.trackEvent("Video Player","Completed")}),_.on(n.ERROR,function(t,e){var n,i;"type"in e&&(n="player"==e.type?"Error Player":"Error API",i=e.src.split("?")[0],this.trackEvent(n,e.label,i))}),c.register(_);var T,A,w,D,b=document.referrer,E=/https?:\/\/([^\/]+)\.dailymotion\.com/.test(b),S=/https?:\/\/([^\/]+)\.dailymotion\.com\/hub/.test(b),k=DM.config("options");D=function(){return DM.utils.session.getSubVisitorGroup()<(E?25:0)},A=E&&DM.playerOptions.get("is_webapp")||"mobile"==k.device_type,w="tv"==k.device_type?"dailymotioniptv":A?"dailymotionmobilevid":E?"dailymotionwebvid":"dailymotionoffsite",E&&D()&&(w=A?"dailymotionmobile":"dailymotionweb"),w+=t.ENV,t.s_account=w,T=function(){return-1!=w.indexOf("dailymotionwebvid")?!1:-1!=w.indexOf("dailymotionmobilevid")&&E?!1:!0}(),syndicationKey=DM.playerOptions.get("syndication");var I=DM.pluginUrl("s_code");if(I&&T){var p={logger:loggerSC,pluginUrl:I},M=new r(p);M.on(n.VIDEO_INFOS,function(t,e){var n,i,r,o,s,a,l,u,c,d;u="free",e.svod?u="svod":e.tvod&&(u="tvod"),a=e.available_formats||["sd"],c=e["owner.partner"]?"partner":"ugc",d=e.partner?"partner":"ugc",n=[],n.push(c),n.push("verified:"+(e["owner.verified"]?"y":"n")),i=[],i.push(d),i.push("studio:"+(e.studio?"y":"n")),i.push("verified:"+(e.verified?"y":"n")),r=[],r.push("ads:"+(e.ads?"y":"n")),r.push("auditude:"+(this.session.has("auditude")?"y":"n")),r.push("encoding:"+a.pop()),r.push("explicit:"+(e.explicit?"y":"n")),r.push("vod:"+("vod"===e.mode?"y":"n")),r.push("promoted:"+(e.promoted?"y":"n")),o=[],o.push("isrc:"+(e.isrc?e.isrc:"n")),o.push("muyap:"+(e.muyap?e.muyap:"n")),s=[],s.push("userbrand:"+(e.userbrand?"y":"n")),s.push("advertising content:"+(e.advertising_content?"y":"n")),s.push("revshare:"+(e.claimer?"y":"n")),prop49=[],prop49.push("autoplay:"+(DM.playerOptions.get("autoplay")?"y":"n")),prop49.push("width:"+e.width),prop49.push("volume:"+(0==e.volume||1==e.muted?"n":"y"));var h=+new Date,p=new Date(1e3*e.created_time),f=new Date(h-p).getTime()/864e5,g=function(t){var e=t.referrer,n=t.createElement("a"),i=[e];return n.href=e,i.push(n.protocol+"//"+n.hostname),i.join(" | ")}(document);l=k.userEnv,this.set({prop3:l.version,eVar3:"D=c3",prop4:l.cc,eVar4:"D=c4",eVar7:k.s_server_time,prop9:"Video",eVar10:"D=c9",prop12:E?"internal":"external",eVar15:"D=c12",prop13:g,eVar16:"D=c13",prop14:e.channel,eVar17:"D=c14",prop15:syndicationKey?syndicationKey:"no syndication",eVar18:"D=c15",prop16:e["owner.parent"]?e["owner.parent"]:"none",eVar19:"D=c16",prop17:e.mode+"-"+u,eVar20:"D=c17",prop18:e["owner.username"],eVar21:"D=c18",prop19:n.join("|"),eVar22:"D=c19",prop20:i.join("|"),eVar23:"D=c20",prop21:e.id,eVar24:"D=c21",eVar25:"D=c22",prop23:E?"HTML5":"HTML5 | Iframe",eVar26:"D=c23",prop24:r.join("|"),eVar27:"D=c24",prop25:o.join("|"),eVar28:"D=c25",prop27:E?S?"hub":"video page":"Offsite/Player",eVar30:"D=c27",prop28:e.language,eVar31:"D=c28",prop29:null,eVar32:"D=c29",prop30:e["private"]?"private":"public",eVar33:"D=c30",prop33:s.join("|"),eVar52:"D=c33",prop45:0|f,eVar63:"D=c45",prop46:e.duration,eVar64:"D=c46",prop48:e.advertising&&null===e.advertising.type?e.advertising.reason:"ads",eVar72:"D=c48",prop49:prop49.join("|"),eVar73:"D=c49",eVar48:DM.utils.session.getVisitorGroup(),prop59:"v4:html5"}),this.session.save("video:title",[e.title,e.id].join("|")),this.session.save("video:infos",e),loggerSC.log("DMP_Stats.VIDEO_INFOS")}),M.on(n.VIDEO_LOAD,function(t,e){var n,i,r;r=this;for(n in e)i=e[n],this.session.save(n,i);loggerSC.log("DMP_Stats.VIDEO_LOAD",e)}),M.on(n.VIDEO_START,function(){var t=this.session.get("video:infos");this.media.open([t.title,t.id].join("|"),t.duration,"Dailymotion Video Player"),this.media.play(this.session.get("video:title"),0),loggerSC.log("DMP_Stats.VIDEO_START")}),M.on(n.CONTROLS_PLAY,{waitFor:n.VIDEO_START,sampling:D},function(t,e){this.media.play(this.session.get("video:title"),Math.round(e.currentTime)),loggerSC.log("DMP_Stats.CONTROLS_PLAY")}),M.on([n.CONTROLS_PAUSE,n.VIDEO_END],{sampling:D},function(t,e){this.media.stop(this.session.get("video:title"),Math.round(e.currentTime)),loggerSC.log("DMP_Stats.CONTROLS_PAUSE")}),M.on(n.CONTROLS_FULLSCREEN,function(){this.session.save("controls:fullscreen",1),loggerSC.log("DMP_Stats.CONTROLS_FULLSCREEN")}),M.on(n.CONTROLS_VOLUME,function(t,e){this.session.save("controls:volume",e),loggerSC.log("DMP_Stats.CONTROLS_VOLUME")}),M.on(n.CONTROLS_QUALITY,function(t,e){this.session.save("controls:quality",e),loggerSC.log("DMP_Stats.CONTROLS_QUALITY")}),M.on(n.VIDEO_COMPLETED,{sampling:D},function(){var t,e,n,i,r,o,s,a=this.session;t=[],e=a.has("controls:fullscreen")?"y":"n",t.push("fullscreen:"+e),n=a.has("controls:quality")?"y":"n",t.push("quality:"+n),i="n",t.push("export:"+i),r="n",t.push("subtitles:"+r),o=a.has("controls:volume")?"y":"n",t.push("volume:"+o),s=a.has("controls:share")?"y":"n",t.push("share:"+s),this.set({prop26:t.join("|"),eVar29:"D=c26"}),this.media.close(a.get("video:title")),loggerSC.log("DMP_Stats.VIDEO_COMPLETED")
}),c.register(M)}var p={logger:loggerXiti};return dm_xiti=new DMP_Stats_Xiti(p),dm_xiti.on(n.VIDEO_INFOS,function(t,e){if(e["owner.analytics_services"]&&e["owner.analytics_services"].xiti){var n=this,i=e["owner.analytics_services"].xiti,r=DM.playerOptions.get("id");r||(r=void 0),DM.plugin("xiti",!0,function(){var t={xtsite:i.website_id,xtsd:i.subdomain.replace(/https?:\/\//,""),xtn2:i.second_level_id,xtinternaldom:i.internal_domain.split("|"),refresh:10},o={xttype:"video",xtplayer:r,xtrichname:e.id+"_"+e.title,xtduration:e.duration,xtmode:"live"===e.mode?"live":"clip",xtquality:"",xtstream:"",xtextension:"9"};n.setVideoInfo(t,o,document.querySelector("video"))})}}),c.register(dm_xiti),c}if("DMP_Stats"in t){var n=t.DMP_Stats,i=t.DMP_Stats_GoogleAnalytics,r=t.DMP_Stats_SiteCatalyst,o=t.DMP_Stats_Pinba,s=(t.DMP_Stats_ATInternet,t.DMP_Stats_eStats),a=DM.logger.getLogger("eStats","color: green; font-weight: bold; font-size: 1.1em;");loggerPinba=DM.logger.getLogger("Pinba-Events","color: green; font-weight: bold; font-size: 1.1em;"),loggerSC=DM.logger.getLogger("SiteCatalyst","color: green; font-weight: bold; font-size: 1.1em;"),loggerXiti=DM.logger.getLogger("Xiti","color: green; font-weight: bold; font-size: 1.1em;"),AD_STEPS=DM.ads.timeouts.types;var l=DM.utils.Location;n.getInstance=function(){return this.instance||(this.instance=e()),this.instance}}}(window),function(){var t={}.hasOwnProperty,e=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};!function(t){"use strict";var n,i,r,o,s,a,l,u,c;return i=t.DM||{},i.ads=i.ads||{},o=i.ads.VASTWrapper,s=i.ads.VPAIDWrapper,r=i.ads.MediaFile,a=i.logger.getLogger("AdManager","color: purple; font-weight: bold;"),u=i.playerOptions,c=i.ads.timeouts.types,l=Modernizr,n=function(t){function n(t,e){this.videoWrapper=t,this.videoElement=e}var i,l,d,h;return e(n,t),n.supportedTypes=h={VAST:"vast/auditude",VPAID:"sdk/liverail"},n.states=d={INITIAL:"INITIAL",ERROR:"ERROR",DISABLED:"DISABLED",FETCHING:"FETCHING",FETCHED:"FETCHED"},i=function(t){var e,n;return e=t.advertising,n=$.map(h,function(t){return t}),e&&"ok"===e.status&&-1!==n.indexOf(e.type)},l=function(){return u.get("can_play_ad")},n.prototype.adWrapper=null,n.prototype.state=d.INITIAL,n.prototype._timeouts={},n.prototype.callInitAd=function(t,e){var n,i,o,s,a,l,u;return o=$.Deferred(),s=this.adWrapper.getMediaFileInstance(),n=this.adWrapper.getCreativeData(),i=this.adWrapper.getEnvironmentVars(this.videoWrapper,this.videoElement,t),(null!=e?e.LR_VIDEO_POSITION:void 0)&&(n.LR_VIDEO_POSITION=e.LR_VIDEO_POSITION),u=function(){s.unsubscribe(l,r.events.LOADED),s.unsubscribe(a,r.events.ERROR)},l=function(t){return function(){t.clearAdTimeout(c.INIT_AD),u(),"rejected"!==o.state()&&o.resolve(s)}}(this),a=function(t){return function(e){t.clearAdTimeout(c.INIT_AD),u(),s.stopAd(),o.reject(e)}}(this),s.subscribe(l,r.events.LOADED),s.subscribe(a,r.events.ERROR),this.setAdTimeout(c.INIT_AD,function(){a("initAd Timeout")}),this.setAdTimeout(c.AD_GLOBAL),s.initAd(this.videoElement.offsetWidth,this.videoElement.offsetHeight,"normal",600,n,i),o.promise()},n.prototype.initWithVideoInfo=function(t){if(this.state=d.INITIAL,a.log("New video info, reseting adWrapper"),!i(t))return a.log("ads disabled (API) :",t.advertising),this.adWrapper=null,this.state=d.DISABLED,void this.logNoAd(t);if(!l())return a.log("ads disabled (player)"),this.adWrapper=null,void(this.state=d.DISABLED);switch(t.advertising.type){case"vast/auditude":a.log("Init VASTWrapper"),this.adWrapper=new o;break;case"sdk/liverail":a.log("Init VPAIDWrapper"),this.adWrapper=new s(t.advertising)}},n.prototype.adsEnabled=function(){return null!==this.adWrapper},n.prototype.resetState=function(){return this.state=d.INITIAL},n.prototype.logNoAd=function(t){var e,n,i;i=!u.statsEnabled()||t.ad===!0||t.stats===!1||t.empty===!0,!i&&t.advertising&&t.advertising.logger_url&&(n=t.advertising.logger_url,n=n.replace("_WIDTH_",this.videoElement.offsetWidth),n=n.replace("_HEIGHT_",this.videoElement.offsetHeight),n=n.replace(/PTYPE_web/,"PTYPE_html"),e=(new Image).src=n)},n.prototype.setAdTimeout=function(t,e){var n,i;return null==e&&(e=null),-1===Object.keys(c).indexOf(t)?void a.warn("Unkonwn Timeout step:",t):void(null!=(n=this.adWrapper.getTimeoutDurationForStep(t))&&(i=function(e){return function(){var n,i;switch(t){case c.AD_GLOBAL:if(n=e._timeouts.INIT_AD?c.INIT_AD:e._timeouts.START_AD?c.START_AD:(a.error("Should never happen: "+t+" Timeout reached without any valid currentStep in",e._timeouts),null),null===n)return;a.log(""+t+" Timeout reached. Interrupting "+n),e._timeouts[n].callback(),e.clearAdTimeout(n);break;case c.LOAD_AD_UNIT:a.log(""+t+" Timeout reached.  Interrupting "+t),e._timeouts[t].callback(),e.clearAdTimeout(t)}"function"==typeof(i=e.adWrapper).onTimeoutReached&&i.onTimeoutReached(t)}}(this),this._timeouts[t]={callback:e,toId:setTimeout(i,n)}))},n.prototype.clearAdTimeout=function(t){var e;return(e=this._timeouts[t])?(clearTimeout(e.toId),delete this._timeouts[t]):void 0},n.prototype.prefetchAd=function(t){return a.log("prefetchAd"),this.state===d.INITIAL?this.adWrapper.prepareAdUnit(t):void 0},n.prototype.fetchAd=function(t,e){var n,i;switch(a.log("fetchAd"),n=$.Deferred(),"function"==typeof(i=this.adWrapper).watchFetchAd&&i.watchFetchAd(n.promise()),this.state){case d.INITIAL:case d.FETCHING:case d.FETCHED:this.setAdTimeout(c.LOAD_AD_UNIT,function(t){return function(){t.state=d.ERROR,n.reject("loadAdUnitTimeout")}}(this)),this.state=d.FETCHING,this.adWrapper.prepareAdUnit(t).done(function(t){return function(i){return t.clearAdTimeout(c.LOAD_AD_UNIT),"rejected"===n.state()?void(t.state=d.ERROR):t.state===d.ERROR?void n.reject("reason"):t.callInitAd(i,e).done(function(e){return"rejected"===n.state()?(t.state=d.ERROR,e.stopAd()):(t.state=d.FETCHED,n.resolve(e))}).fail(function(e){return t.state=d.ERROR,n.reject(e)})}}(this)).fail(function(t){return function(e){return t.clearAdTimeout(c.LOAD_AD_UNIT),t.state=d.ERROR,n.reject(e)}}(this));break;case d.ERROR:n.reject("Previous ad call returned an error");break;case d.DISABLED:n.reject("Ads disabled for this content");break;default:n.reject("adStatus: "+this.state)}return n.promise()},n}(i.Events),i.ads.AdManager=n,t.DM=i}(window)}.call(this),function(){var t=[].slice;!function(e){"use strict";var n,i,r,o,s;return i=e.DM||{},o=i.logger.getLogger("InstreamPlayer","color: purple; font-weight: bold;"),n=i.ads.AdManager,s=i.ads.timeouts.types,r=function(){function e(t){var e;this.backend=new DailymotionPlayerHTML(t),this.backend.out=this,e=$(this),this.stats=DMP_Stats.getInstance(),this.adManager=new n(this.backend.ui.videoFrame(),this.backend.player)}return e.prototype.backend=null,e.prototype.adManager=null,e.prototype.mediaFile=null,e.prototype.uiController=null,e.prototype.started=!1,e.prototype.adRunning=!1,e.prototype.stats=null,e.prototype.adType="preroll",e.prototype._ns=null,e.prototype.initAdsUI=function(){return null===this.uiController?(this.uiController=new i.controllers.AdsUI(document.body,this),i.observer.on(i.events.ads.AD_UI_SKIP,function(t){return function(){return t.adManager.setAdTimeout(s.STOP_AD,function(){t.stopAd()}),t.mediaFile.skipAd?t.mediaFile.skipAd():t.mediaFile.stopAd(),!1}}(this)),i.observer.on(i.events.ads.AD_UI_PLAY,this.resumeAd,this),i.observer.on("pageVisible",this.resumeAd,this)):void 0},e.prototype.bindMediaFileEvents=function(){var t,e,n,r,s,a,l;r=i.ads.MediaFile.events,l=this,e=$(this),t=$(this.backend),n=$(this.backend.ui.videoFrame()),this._ns=a="instream-"+ +new Date,this.mediaFile.subscribe(this.onAdStarted,r.VIDEO_START,this),this.mediaFile.subscribe(this.onAdRemainingTimeChange,r.REMAINING_TIME_CHANGE,this),this.mediaFile.subscribe(this.onAdPlaying,r.PLAYING,this),this.mediaFile.subscribe(this.onAdPaused,r.PAUSED,this),this.mediaFile.subscribe(this.onAdVideoComplete,r.VIDEO_COMPLETE,this),this.mediaFile.subscribe(this.onAdSkipped,r.SKIPPED,this),this.mediaFile.subscribe(this.onAdStopped,r.STOPPED,this),this.mediaFile.subscribe(this.onAdError,r.ERROR,this),this.mediaFile.subscribe(this.onAdDurationChange,r.DURATION_CHANGE,this),this.mediaFile.subscribe(this.onAdClickThru,r.CLICK_THRU,this),this.mediaFile.subscribe(this.onAdSkippableStateChange,r.SKIPPABLE_STATE_CHANGE,this),this.mediaFile.subscribe(this.onAdSkippableRemainingTimeChange,r.SKIPPABLE_REMAINING_TIME_CHANGE,this),t.on("playing."+a,function(){return function(){e.triggerHandler("ad_playing")}}(this)),s=function(t){return function(){return o.log("forcePlay!!"),t.play()}}(this),t.on("fullscreenchange."+a,function(t){return function(e,i){t.backend.ui.controls(!i.fullscreen&&!t.adRunning),i.fullscreen===!1?n.on("touchend."+a,s):n.off("touchend."+a,s),$(t).triggerHandler("fullscreenchange",{fullscreen:i.fullscreen})}}(this))},e.prototype.unbindMediaFileEvents=function(){var t;return t=i.ads.MediaFile.events,this._ns&&($(this.backend).off("."+this._ns),this._ns=null),this.mediaFile?(this.mediaFile.unsubscribe(this.onAdStarted,t.VIDEO_START),this.mediaFile.unsubscribe(this.onAdRemainingTimeChange,t.REMAINING_TIME_CHANGE),this.mediaFile.unsubscribe(this.onAdPlaying,t.PLAYING),this.mediaFile.unsubscribe(this.onAdPaused,t.PAUSED),this.mediaFile.unsubscribe(this.onAdVideoComplete,t.VIDEO_COMPLETE),this.mediaFile.unsubscribe(this.onAdSkipped,t.SKIPPED),this.mediaFile.unsubscribe(this.onAdStopped,t.STOPPED),this.mediaFile.unsubscribe(this.onAdError,t.ERROR),this.mediaFile.unsubscribe(this.onAdDurationChange,t.DURATION_CHANGE),this.mediaFile.unsubscribe(this.onAdClickThru,t.CLICK_THRU),this.mediaFile.unsubscribe(this.onAdSkippableStateChange,t.SKIPPABLE_STATE_CHANGE),this.mediaFile.unsubscribe(this.onAdSkippableRemainingTimeChange,t.SKIPPABLE_REMAINING_TIME_CHANGE)):void 0},e.prototype.onAdStarted=function(){this.adManager.clearAdTimeout(s.AD_GLOBAL),this.adManager.clearAdTimeout(s.START_AD),this.backend.forceFullscreen===!0&&(o.warn("ad started => manually disabling forceFullscreen for this session"),this.backend.forceFullscreen=!1),this.backend.ui.loading(!1),$(this).triggerHandler("ad_start")},e.prototype.onAdRemainingTimeChange=function(){var t;this.uiController.setAdCountDown(this.mediaFile.adRemainingTime),t=this.mediaFile.getAdDuration()-this.mediaFile.adRemainingTime,$(this).triggerHandler("ad_timeupdate",{time:t})},e.prototype.onAdPlaying=function(){var t;null!=(t=this.uiController)&&t.onAdPlaying(),$(this).triggerHandler("ad_play")},e.prototype.onAdPaused=function(){var t;$(this).triggerHandler("ad_pause"),null!=(t=this.uiController)&&t.onAdPaused()},e.prototype.onAdVideoComplete=function(){this.stopAd()},e.prototype.onAdSkipped=function(){this.stopAd(),$(this.backend.player).triggerHandler("play")},e.prototype.onAdStopped=function(){return this.onAdSkipped()},e.prototype.onAdError=function(t){o.log("onAdError:",t),this.stopAd()},e.prototype.onAdDurationChange=function(){this.uiController.setAdDuration(this.mediaFile.getAdDuration())},e.prototype.onAdClickThru=function(t,e,n){this.pauseAd(),n&&window.open(t)},e.prototype.onAdSkippableStateChange=function(){this.uiController.setSkipCountDown(this.mediaFile.adSkippableState?0:-1)},e.prototype.onAdSkippableRemainingTimeChange=function(){this.uiController.setSkipCountDown(this.mediaFile.adSkippableRemainingTime)},e.prototype.playEmpty=function(){return o.log("play empty src"),this.backend.ui.controls(!1),this.backend.out=this.backend,this.adRunning=!0,this.backend.ui.loading(!0),this.loadAndPlay({empty:!0,ad:!0}).pause(),this},e.prototype.playAd=function(){return this.adRunning?(o.log("play ad",this.mediaFile),this.initAdsUI(),this.uiController.create(this.mediaFile.getAdDuration(),this.backend.m["video-inline"]),this.backend.ui.controls(!1),this.backend.out=this.backend,this.adRunning=!0,this.bindMediaFileEvents(),this.adManager.setAdTimeout(s.START_AD,function(t){return function(){var e;"function"==typeof(e=t.mediaFile).onMediaTimeout&&e.onMediaTimeout(),$(t.backend.player).triggerHandler("play"),t.stopAd()}}(this)),this.mediaFile.startAd(),this):void 0},e.prototype.pauseAd=function(){return this.adRunning?(o.log("pause ad"),this.mediaFile.pauseAd()):void 0},e.prototype.resumeAd=function(){return o.log("resume ad"),this.mediaFile.resumeAd()},e.prototype.stopAd=function(){var t,e,n;if(this.adRunning)return o.log("stop ad"),o.groupEnd(),this.adManager.clearAdTimeout(s.AD_GLOBAL),this.adManager.clearAdTimeout(s.START_AD),this.adManager.clearAdTimeout(s.STOP_AD),i.observer.off(i.events.ads.AD_UI_PLAY,this.resumeAd),i.observer.off("pageVisible",this.resumeAd),this.unbindMediaFileEvents(),this.backend.ui.loading(!0),t=$(this),t.triggerHandler("ad_end"),null!=(e=this.mediaFile)&&e.stopAd(),null!=(n=this.uiController)&&n.destroy(),this.mediaFile=null,this.adRunning=!1,"postroll"!==this.adType&&t.one("canplay",function(t){return function(){return t.play()}}(this)),this.closeAd(),this},e.prototype.closeAd=function(){return this.backend.out=this,"preroll"===this.adType?this.playContent():"postroll"===this.adType?this.reloadAndRelated():void 0},e.prototype.playContent=function(){var t;return o.log("play content video"),t=$(this),t.one("playing",function(e){return function(){return t.triggerHandler("play"),e.backend.ui.controls(!0),e.backend.ui.autohide()}}(this)),this.loadAndPlay(this.contentInfo,this.contentCallback),this},e.prototype.loadAndPlay=function(){var e,n,i;return e=1<=arguments.length?t.call(arguments,0):[],(n=(i=this.backend).load.apply(i,e))?n.play():n},e.prototype.reloadAndRelated=function(){return this.backend.reload(this.savedVideo),this.backend.showRelated()},e.prototype.preload=function(t){return this.contentInfo=t,this.adManager.adsEnabled()?this.adManager.prefetchAd():void 0},e.prototype.load=function(t,e){return this.contentInfo=t,this.contentCallback=e,this.adType="preroll",o.groupCollapsed("Any ad to play before content video?"),this.adManager.initWithVideoInfo(this.contentInfo),this.fetchAd(),this},e.prototype.postroll=function(){return this.adType="postroll",this.savedVideo={url:this.backend.video_url,src:this.backend.player.src},o.groupCollapsed("Any ad to play after content video?"),this.fetchAd({LR_VIDEO_POSITION:"100%"}),this},e.prototype.fetchAd=function(t){return null==t&&(t=null),this.adManager.adsEnabled()?(this.started&&this.adManager.resetState(),this.started=!0,this.playEmpty(),this.adManager.fetchAd(this.contentInfo,t).fail(function(t){return function(e){var n;null!=(n=t.uiController)&&n.destroy(),o.warn("fetchAd failed:",e),t.stopAd()}}(this)).done(function(t){return function(e){t.mediaFile=e,t.playAd()}}(this))):(o.log("ads disabled for this device"),o.groupEnd(),this.closeAd())},e.prototype.setAudience=function(t){return this.backend.setAudience(t),this},e.prototype.setHlsHasFailed=function(t){return o.log("HLS is not supported, fallback to progressive"),this.backend.setHlsHasFailed(t),this},e.prototype.paused=function(){return this.adRunning?!0:this.backend.paused()},e.prototype.play=function(){return this.backend.play(),this},e.prototype.pause=function(){return this.backend.pause(),this},e.prototype.seek=function(t){return this.adRunning||this.backend.seek(t),this},e.prototype.currentTime=function(){return this.adRunning?0:this.backend.currentTime()},e.prototype.fullscreen=function(){return this.adRunning||this.backend.fullscreen(),this},e.prototype.muted=function(t){return this.adRunning||this.backend.muted(t),this},e.prototype.volume=function(t){return this.adRunning||this.backend.volume(t),this},e}(),i.InstreamPlayer=r,e.DM=i}(window)}.call(this);