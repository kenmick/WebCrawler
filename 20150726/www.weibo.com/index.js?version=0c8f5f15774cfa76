STK.namespace("v6page",function(a,b){var STK=arguments[0],$=arguments[1];
STK.register("lib.kit.io.ajax",function(a){var b=function(b,c,d){c=c|0||1;d=d||"fail";var e=b.args;e.__rnd&&delete e.__rnd;(new Image).src="http://weibolog.sinaapp.com/?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d;(new Image).src="http://s1.sinaedge.com/whb.gif?t="+c+"&u="+encodeURIComponent(b.url)+"&p="+encodeURIComponent(a.core.json.jsonToQuery(e))+"&m="+d};return function(c){var d={},e=[],f=null,g=!1,h=a.parseParam({url:"",method:"get",responseType:"json",timeout:3e4,onTraning:a.funcEmpty,isEncode:!0},c);h.onComplete=function(a){g=!1;c.onComplete(a,h.args);setTimeout(i,0)};h.onFail=function(a){g=!1;if(typeof c.onFail=="function")try{c.onFail(a,h.args)}catch(d){}setTimeout(i,0);try{b(h)}catch(d){}};h.onTimeout=function(a){try{b(h);c.onTimeout(a)}catch(d){}};var i=function(){if(!!e.length){if(g===!0)return;g=!0;h.args=e.shift();if(h.method.toLowerCase()=="post"){var b=a.core.util.URL(h.url);b.setParam("__rnd",+(new Date));h.url=b.toString()}f=a.ajax(h)}},j=function(a){while(e.length)e.shift();g=!1;if(f)try{f.abort()}catch(b){}f=null};d.request=function(a){a||(a={});c.noQueue&&j();if(!c.uniqueRequest||!f){e.push(a);a._t=0;i()}};d.abort=j;return d}});
STK.register("lib.kit.io.jsonp",function(a){return function(b){var c=a.parseParam({url:"",method:"get",responseType:"json",varkey:"_v",timeout:3e4,onComplete:a.funcEmpty,onTraning:a.funcEmpty,onFail:a.funcEmpty,isEncode:!0},b),d=[],e={},f=!1,g=function(){if(!!d.length){if(f===!0)return;f=!0;e.args=d.shift();e.onComplete=function(a){f=!1;c.onComplete(a,e.args);setTimeout(g,0)};e.onFail=function(a){f=!1;c.onFail(a);setTimeout(g,0)};a.jsonp(a.core.json.merge(c,{args:e.args,onComplete:function(a){e.onComplete(a)},onFail:function(a){try{e.onFail(a)}catch(b){}}}))}},h={};h.request=function(a){a||(a={});d.push(a);a._t=1;g()};h.abort=function(a){while(d.length)d.shift();f=!1;e=null};return h}});
STK.register("lib.kit.io.ijax",function(a){return function(b){var c=a.parseParam({url:"",timeout:3e4,isEncode:!0,abaurl:null,responseName:null,varkey:"callback",abakey:"callback"},b),d=[],e=null,f=!1;c.onComplete=function(a,d){f=!1;b.onComplete(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};c.onFail=function(a,d){f=!1;b.onFail(a,c.form,d);c.form=null;c.args=null;setTimeout(g,0)};var g=function(){var b;if(!!d.length){if(f===!0)return;f=!0;b=d.shift();c.args=b.args;c.form=b.form;e=a.ijax(c)}},h=function(a){while(d.length)d.shift();f=!1;if(e)try{e.abort()}catch(b){}e=null},i={};i.request=function(c,e){if(!a.isNode(c))throw"[lib.kit.io.ijax.request] need a form as first parameter";e||(e={});b.noQueue&&h();d.push({form:c,args:e});g()};i.abort=h;return i}});
STK.register("lib.kit.io.inter",function(a){var b=a.core.json.merge;return function(){var c={},d={},e={},f=function(a,b){return function(c,d){try{b.onComplete(c,d)}catch(f){}try{c.code==="100000"?b.onSuccess(c,d):b.onError(c,d)}catch(f){}for(var g in e[a])try{e[a][g](c,d)}catch(f){}}},g=function(a,b,c){return function(d){try{b.onComplete(d,c)}catch(f){}try{d.code==="100000"?b.onSuccess(d,c):b.onError(d,c)}catch(f){}for(var g in e[a])try{e[a][g](d,c)}catch(f){}}};c.register=function(a,b){if(typeof d[a]!="undefined")throw a+" registered";d[a]=b;e[a]={}};c.addHook=function(b,c){var d=a.core.util.getUniqueKey();e[b][d]=c;return d};c.rmHook=function(a,b){e[a]&&e[a][b]&&delete e[a][b]};c.getTrans=function(c,e){var g=b(d[c],e);g.onComplete=f(c,e);g.url+=(g.url.indexOf("?")>=0?"&":"?")+"ajwvr=6";g.withDomain&&(g.url+="&domain="+$CONFIG.domain);var h=d[c].requestMode,i="ajax";if(h==="jsonp"||h==="ijax")i=h;return a.lib.kit.io[i](g)};c.request=function(c,e,f){var h=b(d[c],e);h.onComplete=g(c,e,f);h.url+=(h.url.indexOf("?")>=0?"&":"?")+"ajwvr=6";h.withDomain&&(h.url+="&domain="+$CONFIG.domain);h=a.core.obj.cut(h,["noqueue"]);h.args=f;var i=d[c].requestMode;return i==="jsonp"?a.jsonp(h):i==="ijax"?a.ijax(h):a.ajax(h)};return c}});
STK.register("conf.trans.gallery",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("like",{url:"/p/aj/like/set",method:"post",withDomain:!0});c("getAlbumList",{url:"/p/aj/album/getlist",method:"post",withDomain:!0});c("cancelauth",{url:"/p/aj/app/cancelauth",method:"post",withDomain:!0});c("install",{url:"/p/aj/app/installapp",method:"post",withDomain:!0});c("singleinstall",{url:"/p/aj/app/installsingleapp",method:"post",withDomain:!0});c("hideapp",{url:"/p/aj/app/hideapp",method:"post",withDomain:!0});c("noInterest",{url:"/p/aj/app/hideapp",method:"post",withDomain:!0});return b});
STK.register("lib.kit.touch.cantouch",function(a){return STK.core.util.browser.IPAD});
STK.register("lib.kit.dom.hover",function(a){function b(b,c){var d=c.length;while(d--)if(c[d]===b||a.contains(c[d],b))return!0;return!1}var c={};return a.lib.kit.touch.cantouch?function(d){var e=d.act,f=d.extra||[],g=function(a){d.onmouseover.apply(e,[a])},h=function(a){d.onmouseout.apply(e,[a])},i=function(c,d){b(a.fixEvent(d).target,[e].concat(f))?g(d):h(d)};if(!("inited"in c)){c.inited=!0;a.custEvent.define(c,["tap"]);a.addEvent(document.body,"tap",function(b){a.custEvent.fire(c,"tap",b)})}a.custEvent.add(c,"tap",i);return{destroy:function(){a.removeEvent(document.body,"tap",i)}}}:function(b){var c=b.delay||300,d=b.moutDelay||c,e=b.isover||!1,f=b.act,g=b.extra||[],h=null,i=function(a){e&&b.onmouseover.apply(f,[a])},j=function(a){e||b.onmouseout.apply(f,[a])},k=function(a){e=!0;h&&clearTimeout(h);h=setTimeout(function(){i(a)},c)},l=function(a){e=!1;h&&clearTimeout(h);h=setTimeout(function(){j(a)},d)};a.core.evt.addEvent(f,"mouseover",k);a.core.evt.addEvent(f,"mouseout",l);for(var m=0,n=g.length;m<n;m+=1){a.core.evt.addEvent(g[m],"mouseover",k);a.core.evt.addEvent(g[m],"mouseout",l)}var o={};o.destroy=function(){a.core.evt.removeEvent(f,"mouseover",k);a.core.evt.removeEvent(f,"mouseout",l);for(var b=0,c=g.length;b<c;b+=1){a.core.evt.removeEvent(g[b],"mouseover",k);a.core.evt.removeEvent(g[b],"mouseout",l)}};return o}});
STK.register("lib.kit.dom.children",function(a){return function(b){if(!a.core.dom.isNode(b))throw"Parameter must be an HTMLEelement!";var c=[];for(var d=0,e=b.childNodes.length;d<e;d++)b.childNodes[d].nodeType==1&&c.push(b.childNodes[d]);return c}});
STK.register("lib.kit.extra.language",function(a){window.$LANG||(window.$LANG={});return function(b){var c=[].splice.call(arguments,1,arguments.length),d=[b,$LANG].concat(c),e=a.core.util.language.apply(this,d);return e}});
STK.register("pl.content.album.source.picview",function(a){var b=680,c=100,d=150,e='<#et userlist data><div node-type="album_show" class="PCD_slide" style="width:100%;height:100%;"><div class="slide_top W_tc"><span class="picnum" style="visibility:hidden;"><span node-type="num">1</span>/<span node-type="numAll"></span></span><a href="javascript:void(0)" class="close" title="å³é­" node-type="close">&times;</a></div><div class="b_pic"><table cellpadding="0" cellspacing="0"><tr><td><p class="pics"><img node-type="photo" src="" title="picname" /></p></td></tr></table><div class="cursor_mask"><a href="javascript:void(0)" node-type="prevU" class="W_fl pre" title="ä¸ä¸å¼ " hidefocus="true"></a><a href="javascript:void(0)" node-type="nextU" class="W_fr next" title="ä¸ä¸å¼ " hidefocus="true"></a></div><div class="pic_info clearfix"><div class="mask"></div><div class="info_wrap"><div class="W_fl info"><p node-type="des"></p></div><div class="W_fr opt"><a node-type="yLink" href="javascript:void(0)" target="_blank"></a></div></div></div></div><div class="s_pic" node-type="slide"><div class="s_pic_wrap clearfix"><div class="pageturner W_fl"><a href="javascript:void(0)" node-type="prevD" class="pre" title="ä¸ä¸é¡µ"><em class="W_ficon ficon_arrow_left">b</em></a></div><div class="s_pic_ul W_fl" style="position:relative;"><ul node-type="list"><#list data as list><li action-type="toPage" action-data="page=${list.index}&bigSrc=${list.bigSrc}"><a href="javascript:void(0)"><img src="${list.smallSrc}" width="80" height="80" alt="${list.title}" title="${list.title}" /></a></li></#list></ul></div><div class="pageturner W_fl"><a href="javascript:void(0)" node-type="nextD" class="next" title="ä¸ä¸é¡µ"><em class="W_ficon ficon_arrow_right">a</em></a></div></div></div></div></#et>',f='<li action-type="toPage" action-data="page=#{index}&bigSrc=#{bigSrc}"><a href="javascript:void(0)"><img src="#{smallSrc}" width="80" height="80" alt="#{title}" title="#{title}" /></a></li>';return function(g){var h=a.lib.kit.extra.language,i={},j,k,l,m,n=1,m,o,p,q,r,s,t,u,v,w,x,y,z=!1,A=6,B,C=[],D={},E=a.core.util.browser.IE6,F,G,H=["","width:100%","height:100%","position:fixed","_position:absolute","top:0","left:0","z-index:100000","overflow:hidden",""].join(";"),I=!1,J=function(b){if(!I){var c;if(b=="next"){c=G+1;if(c>g.transData.maxpage)return}else if(b=="prev"){c=F-1;if(c<=0)return}sendData={};sendData.page=c;sendData.id=g.transData.id;sendData.pl_name=g.transData.pl_name;sendData.album_filter=g.transData.album_filter;I=!0;g.trans.request(g.transName,{onSuccess:function(c){var d=c.data,e=[],h=[],i=d.pics.length;a.foreach(d.pics,function(b,c){e.push({title:b.title,smallSrc:b.img_small,bigSrc:b.img_big,link:b.name,linktext:b.link});var d=a.core.util.templet(f,{index:c,bigSrc:b.img_big,smallSrc:b.img_small,title:b.name});h.push(a.builder(d).box)});if(b=="next"){g.imgInfo=g.imgInfo.concat(e);while(h.length)s.appendChild(h.shift());w=a.lib.kit.dom.children(s);a.foreach(g.imgInfo,function(b,c){var d=a.queryToJson(w[c].getAttribute("action-data"));d.page=b.index=c+1;w[c].setAttribute("action-data",a.jsonToQuery(d))});G=G+1}else if(b=="prev"){g.imgInfo=e.concat(g.imgInfo);while(h.length)s.insertBefore(h.pop(),s.childNodes[0]);w=a.lib.kit.dom.children(s);a.foreach(g.imgInfo,function(b,c){var d=a.queryToJson(w[c].getAttribute("action-data"));d.page=b.index=c+1;w[c].setAttribute("action-data",a.jsonToQuery(d))});var j=parseInt(a.getStyle(s,"left"));a.setStyle(s,"left","-"+(j+y*i)+"px");F=F-1;n=i+n}x=w.length;B=x-A+1;P(n);T.drawArr();a.setStyle(s,"width",y*w.length+30+"px");Q(n,w[n-1]);I=!1},onFail:function(a){I=!1},onError:function(a){I=!1}},sendData)}},K,L=function(){if(!!E){var b=a.scrollPos().top+"px",c=a.core.util.winSize();k.style.top!=b&&(k.style.top=b);k.style.width=c.width;k.style.height=c.height}},M=function(b){z=!0;animate=a.core.ani.tween(s,{duration:350,end:function(){setTimeout(function(){z=!1},0)}}).play({left:b})},N=function(){a.core.arr.foreach(w,function(a,b){a.className=""})},O=function(a,b){if(D[a])b(D[a]);else{var c=new Image;c.onload=function(){var d=c.width,e=c.height;if(d>e){c.width="550";c.height=e*550/d}else{c.height="550";c.width=d*550/e}b(c);D[a]=c};c.src=a}},P=function(a){if(a==1){o.style.display="none";q.style.display="none";p.style.display="";r.style.display=""}else if(a==x){p.style.display="none";r.style.display="none";o.style.display="";q.style.display=""}else{o.style.display="";q.style.display="";p.style.display="";r.style.display=""}},Q=function(b,c){P(b);M(-y*C[b]);N();c.className="on";v.innerHTML=b;var e=g.imgInfo[b-1].bigSrc,f=function(c){var d=j.getDomList(!0),e=d.photo;c.title=g.imgInfo[b-1].title;c.setAttribute("node-type","photo");a.core.dom.replaceNode(c,e)};O(e,f);var h=a.trim(g.imgInfo[b-1].title||""),i=a.leftB(h,d)+"...";a.bLength(h)<d?l.des.innerHTML=h:l.des.innerHTML=i;l.yLink.innerHTML=g.imgInfo[b-1].linktext||"";l.yLink.href=g.imgInfo[b-1].link||"";g.imgInfo.length<=5&&J("next");b<=0||(b<5?J("prev"):b>g.imgInfo.length-5&&J("next"))},R={prevD:function(){if(!z){--n;if(n<1){n=1;return}Q(n,w[n-1])}},nextD:function(){if(!z){++n;if(n>x){n=x;return}Q(n,w[n-1])}},prevU:function(){a.core.evt.fireEvent(o,"click")},nextU:function(){a.core.evt.fireEvent(p,"click")},close:function(){j.hide();a.ui.mask.back();E&&clearInterval(K)},resize:function(){var b=a.core.util.winSize();k.style.width=b.width;k.style.height=b.height}},S={toPage:function(a){var b=parseInt(a.data.page,10);n=b;Q(n,a.el)}},T={init:function(){T.pars();T.build();T.bind();T.drawArr()},pars:function(){g=a.parseParam({imgInfo:null,trans:null,transName:null,transData:null},g||{});G=F=g.transData.page-0},build:function(){j=a.ui.layer();html=a.core.util.easyTemplate(e,g.imgInfo);j.html(html.toString());k=j.getBox();k.className="";k.style.cssText+=H;l=j.getDomList(!0);var d=a.core.util.winSize();d.height<b&&(l.slide.style.display="none");k.style.width=d.width;k.style.height=d.height;o=l.prevD;p=l.nextD;q=l.prevU;r=l.nextU;s=l.list;t=l.close;u=l.photo;v=l.num;w=a.lib.kit.dom.children(s);x=w.length;x==1&&(l.slide.style.display="none");y=c;a.setStyle(s,"position","relative");a.setStyle(s,"left","0px");l.numAll.innerHTML=x},bind:function(){a.addEvent(o,"click",R.prevD);a.addEvent(p,"click",R.nextD);a.addEvent(q,"click",R.prevU);a.addEvent(r,"click",R.nextU);a.addEvent(t,"click",R.close);a.addEvent(window,"resize",R.resize);a.core.evt.custEvent.define(i,["prev","next"]);m=a.core.evt.delegatedEvent(s);m.add("toPage","click",S.toPage)},drawArr:function(){C=[];if(x>A)for(var a=0;a<x+1;a++)a<3?C.push(0):a>x-3?C.push(x-6):C.push(a-3);else for(var a=0;a<B;a++)C.push(0)},show:function(b){b=a.parseParam({index:1},b||{});v.innerHTML=b.index;m.fireDom(w[b.index-1],"click");j.show();if(E){var c=a.scrollPos().top;k.style.top=c}else k.style.top="0px";E&&(K=setInterval(L,500));a.ui.mask.showUnderNode(k)},destroy:function(){a.removeEvent(o,"click",R.prevD);a.removeEvent(p,"click",R.nextD);a.removeEvent(q,"click",R.prevU);a.removeEvent(r,"click",R.nextU);a.removeEvent(t,"click",R.close);m.destroy();j&&j.destroy();clearInterval(K)}};T.init();i.show=T.show;i.destroy=T.destroy;return i}});
STK.register("conf.trans.follow",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("follow",{url:"/aj/f/followed",method:"post"});c("unFollow",{url:"/aj/f/unfollow",method:"post"});c("block",{url:"/aj/f/addblack",method:"post"});c("unBlock",{url:"/aj/f/delblack",method:"post"});c("removeFans",{url:"/aj/f/remove",method:"post"});c("follow_object",{url:"/p/aj/relation/follow",method:"post"});c("unFollow_object",{url:"/p/aj/relation/unfollow",method:"post"});c("unloginfollow",{url:"/p/aj/official/unloginfollow",method:"post"});c("proxy",{url:"/aj/proxy",method:"post"});return b});
STK.register("lib.kit.extra.listener",function(a){var b={},c={};c.define=function(c,d){if(b[c]!=null)throw"lib.kit.extra.listener.define: é¢éå·²è¢«å ç¨";b[c]=d;var e={};e.register=function(d,e){if(b[c]==null)throw"lib.kit.extra.listener.define: é¢éæªå®ä¹";a.listener.register(c,d,e)};e.fire=function(d,e){if(b[c]==null)throw"commonlistener.define: é¢éæªå®ä¹";a.listener.fire(c,d,e)};e.remove=function(b,d){a.listener.remove(c,b,d)};e.cache=function(b){return a.listener.cache(c,b)};return e};return c});
STK.register("conf.channel.follow",function(a){var b=["changeStatus"];return a.lib.kit.extra.listener.define("conf.channel.follow",b)});
STK.register("lib.kit.extra.merge",function(a){return function(a,b){var c={};for(var d in a)c[d]=a[d];for(var d in b)c[d]=b[d];return c}});
STK.register("conf.trans.validateCode",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("checkValidate",{url:"/aj/pincode/verified",method:"post"});return b});
STK.register("lib.kit.io.cssLoader",function(a){var b="",c="http://img.t.sinajs.cn/t4/",d="http://timg.sjs.sinajs.cn/t4/";if(typeof $CONFIG!="undefined"){c=$CONFIG.cssPath||c;b=$CONFIG.version||""}var e={};return function(f,g,h,i,j){i=i||b;h=h||function(){};var k=function(a,b){var c=e[a]||(e[a]={loaded:!1,list:[]});if(c.loaded){b(a);return!1}c.list.push(b);return c.list.length>1?!1:!0},l=function(a){var b=e[a].list;for(var c=0;c<b.length;c++)b[c](a);e[a].loaded=!0;delete e[a].list};if(!!k(f,h)){var m;j?m=d+f:m=c+f+"?version="+i;var n=a.C("link");n.setAttribute("rel","Stylesheet");n.setAttribute("type","text/css");n.setAttribute("charset","utf-8");n.setAttribute("href",m);document.getElementsByTagName("head")[0].appendChild(n);var o=a.C("div");o.id=g;a.core.util.hideContainer.appendChild(o);var p=3e3,q=function(){if(parseInt(a.core.dom.getStyle(o,"height"))==42){a.core.util.hideContainer.removeChild(o);l(f)}else if(--p>0)setTimeout(q,10);else{a.log(f+"timeout!");a.core.util.hideContainer.removeChild(o);delete e[f]}};setTimeout(q,50)}}});
STK.register("lib.dialog.loginLayer",function(a){var b,c="http://tjs.sjs.sinajs.cn/t5/register/js/page/remote/loginLayer.js";return function(d){d=a.core.obj.parseParam({lang:"zh-cn",loginSuccessUrl:encodeURIComponent(window.location.href)},d||{});if(window.WBtopGlobal_loginLayer)WBtopGlobal_loginLayer(d);else{if(b)return;b=!0;a.core.io.scriptLoader({url:c,onComplete:function(){b=!1;window.WBtopGlobal_loginLayer(d)},timeout:1e4,onTimeout:function(){b=!1}})}}});
STK.register("lib.dialog.authentication",function(a){return function(b){var c=a.lib.kit.extra.language,d=a.core.util.browser;b=a.parseParam({src:"http://weibo.com/a/verify/realname?stage=home_verification",icon:"warn",isHold:!0,width:"380px",height:"240px",title:c("#L{å¸å·éªè¯}")},b||{});var e={},f,g,h=!1,i="tblog_checkfailed_reform",j={init:function(){f=a.ui.dialog(b);var c=[];c.push('<iframe id="account_authentication" name="account_authentication" node-type="frame" width="'+b.width+'" height="'+b.height+'" allowtransparency="true" scrolling="no" frameborder="0" src=""></iframe>');var d=a.builder(c.join(""));f.setTitle(b.title);f.setContent(d.box);var e=f.getDomList()},show:function(){try{window.SUDA&&SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_box")}catch(c){}h||a.lib.kit.io.cssLoader("style/css/module/layer/layer_check_identity.css","js_style_css_module_layer_check_identity",function(){h=!0});f.show().setMiddle();g=a.E("account_authentication");var d=decodeURIComponent(b.src)+"&rnd=";g.attachEvent?g.attachEvent("onload",function(){g.height=b.height;f.setMiddle()}):g.onload=function(){g.height=b.height;f.setMiddle()};g.src=d+a.core.util.getUniqueKey()},destroy:function(){},hook:function(a,b){try{a=="100000"?j.verifySucc():j.verifyFail()}catch(c){}},verifySucc:function(){window.SUDA&&SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_success");f.hide();var b={title:c("#L{æç¤º}"),icon:"success",OK:function(){window.SUDA&&SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_play");history.go(0)},OKText:c("#L{è¿å¥é¦é¡µ}"),msg:c("#L{æ­åï¼æ¨çèº«ä»½å·²éªè¯æåï¼é©¬ä¸è¿å¥å¾®åã}")},d=a.ui.alert(b.msg,b);a.custEvent.add(d,"hide",function(){history.go(0)})},verifyFail:function(){window.SUDA&&SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_twotimes");f.hide();var b={title:c("#L{æç¤º}"),icon:"warn",OK:function(){SUDA.uaTrack&&SUDA.uaTrack(i,"checkfailed_triple");j.show()},OKText:c("#L{åæ¬¡éªè¯}"),msg:c("#L{æ±æ­ï¼æ¨çèº«ä»½ä¿¡æ¯ä¸åç¡®ï¼è¯·åæ¬¡éªè¯ã<br/>}")+'<a class="S_spetxt" suda-data="key=tblog_checkfailed_reform&value=checkfailed_havealook" href="http://weibo.com">'+c("#L{æ¨ä¹å¯ä»¥åä½éªå¾®åï¼éååéªè¯èº«ä»½ä¿¡æ¯>>}")+"</a>"},d=a.ui.alert(b.msg,b);a.custEvent.add(d,"hide",function(){history.go(0)})}};j.init();e.destroy=j.destory;e.show=j.show;window.App=window.App||{};window.App.checkRealName=j.hook;return e}});
STK.register("lib.dialog.memberDialog",function(a){var b='<div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="" node-type="icon"></span></dt><dd node-type="inner"><p class="S_txt1" node-type="textLarge"></p><p class="S_txt1" node-type="textComplex"></p><p class="S_txt2" node-type="textSmall"></p></dd></dl></div><div class="W_layer_btn S_bg1"><a href="javascript:void(0);" class="W_btn_b" node-type="OK"></a><a href="javascript:void(0);" class="W_btn_a" node-type="cancel"></a><a href="http://vip.weibo.com/paycenter?pageid=byebank" class="W_btn_a" node-type="member"><span><em class="W_icon icon_member"></em>#L{ç«å³å¼éä¼å}</span></a></div>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.lib.kit.extra.language,e=function(e,f){var g,h,i,j,k,l;g=a.parseParam({title:"&nbsp;",icon:"warn",textLarge:e,textComplex:"",textSmall:"",OK:a.funcEmpty,OKText:d("#L{ç¡®å®}"),cancel:a.funcEmpty,cancelText:d("#L{ç¡®è®¤}")},f);g.icon=c[g.icon];h={};i=a.ui.dialog();i.setContent(d(b));l=i.getDomList(!0);l.icon.className=g.icon;l.textLarge.innerHTML=g.textLarge;l.textComplex.innerHTML=g.textComplex;l.textSmall.innerHTML=g.textSmall;l.OK.innerHTML="<span>"+g.OKText+"</span>";l.cancel.innerHTML="<span>"+g.cancelText+"</span>";i.setTitle(g.title);i.getDomList().title.style.borderBottomStyle="none";var m=function(){j=!0;k=a.htmlToJson(l.textComplex);i.hide()};a.addEvent(l.OK,"click",m);a.addEvent(l.cancel,"click",i.hide);a.custEvent.add(i,"hide",function(){a.custEvent.remove(i,"hide",arguments.callee);a.removeEvent(l.OK,"click",m);a.removeEvent(l.cancel,"click",i.hide);j?g.OK(k):g.cancel(k)});i.show().setMiddle();h.dia=i;return h};return function(b){b=a.parseParam({type:"follow",errortype:"1"},b);var c,f,g={textLarge:d("#L{æ¨å·²è¾¾å°ææå³æ³¨ä¸éï¼}"),textComplex:d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{ææå³æ³¨ä¸éç«å³æé«}'),textSmall:d('#L{å¯}<a href="http://vip.weibo.com/paycenter?pageid=byebank" class="S_link2">#L{å¼éä¼å}</a>#L{æåå°ææå³æ³¨åå°è³10äººä»¥ä¸ï¼åæ·»å }'),OKText:d("#L{ç®¡çæçææå³æ³¨}"),OK:function(){a.preventDefault();window.location.href="/"+$CONFIG.uid+"/whisper"}},h={textLarge:d("#L{æ¨å·²è¾¾å°å³æ³¨ä¸éï¼}"),textComplex:d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{å³æ³¨ä¸éç«å³æé«}'),textSmall:d('#L{å¯}<a href="http://vip.weibo.com/paycenter?pageid=byebank" class="S_link2">#L{å¼éä¼å}</a>#L{æåå°å³æ³¨åå°è³2000äººä»¥ä¸ï¼åæ·»å }'),OKText:d("#L{ç®¡çæçå³æ³¨}"),OK:function(){a.preventDefault();window.location.href="/"+$CONFIG.uid+"/follow"}};if(b.type=="quiet"){switch(parseInt(b.errortype,10)){case 2:g.textLarge=d("#L{æ¨å½åå·²è¾¾ä¼åç­çº§ææå³æ³¨ä¸éå¦ï¼}");g.textSmall="";g.textComplex=d('<a href="http://vip.weibo.com/privilege" class="S_link2">#L{äºè§£æ´å¤ä¼åç¹æä¿¡æ¯Â»}</a>');break;case 1:g.textLarge=d("#L{æ¨å·²è¾¾å°ææå³æ³¨ä¸éï¼}");g.textSmall="";g.textComplex=d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{ææå³æ³¨ä¸éç«å³æé«}');break;case 3:g.textLarge=d("#L{æ¨å·²è¾¾å°ææå³æ³¨ä¸éï¼}");g.textComplex=d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{ææå³æ³¨ä¸éç«å³æé«}');g.textSmall=d('#L{å¯}<a href="http://vip.weibo.com/paycenter">#L{å¼éä¼å}</a>#L{æå°ææå³æ³¨åå°è³10äººä»¥ä¸ï¼åæ·»å }')}c=g}else{switch(parseInt(b.errortype,10)){case 2:h.textLarge=d("#L{æ¨å½åå·²è¾¾ä¼åç­çº§å³æ³¨ä¸éå¦ï¼}");h.textSmall="";h.textComplex=d('<a href="http://vip.weibo.com/privilege" class="S_link2">#L{äºè§£æ´å¤ä¼åç¹æä¿¡æ¯Â»}</a>');break;case 1:h.textLarge=d("#L{æ¨å·²è¾¾å°å³æ³¨ä¸éï¼}");h.textSmall="";h.textComplex=d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{å³æ³¨ä¸éç«å³æé«}');break;case 3:h.textLarge=d("#L{æ¨å·²è¾¾å°å³æ³¨ä¸éï¼}");h.textComplex=d('#L{å¼é}<a href="http://vip.weibo.com/privilege">#L{å¾®åä¼å}</a>ï¼#L{å³æ³¨ä¸éç«å³æé«}');h.textSmall=d('#L{å¯}<a href="http://vip.weibo.com/paycenter">#L{å¼éä¼å}</a>#L{æå°å³æ³¨åå°è³2000äººä»¥ä¸ï¼åæ·»å }')}c=h}f=e("",c);parseInt(b.errortype,10)==2?f.dia.getDomList().member.style.display="none":f.dia.getDomList().cancel.style.display="none"}});
STK.register("lib.dialog.ioError",function(a){var b=a.lib.kit.extra.language,c,d;return function(d,e,f){var g={},h,i,j=function(){},k={init:function(){k.data()},data:function(){i=a.parseParam({auto:!0,call:j,ok:j,cancel:j,beside:null},f);h=a.parseParam({location:"",oKText:b("#L{ç¡® å®}"),cancelText:b("#L{å æ¶}"),suda:""},e.data);h.msg=e.msg||b("#L{ç³»ç»ç¹å¿}");e.data.OKText&&(h.okText=e.data.OKText);h.OK=function(){a.preventDefault();var b=a.queryToJson(h.suda||"");b=b.ok||{};window.SUDA&&SUDA.uaTrack&&b.key&&SUDA.uaTrack(b.key,b.value);i.ok();h.location&&(window.location.href=h.location)};h.cancel=function(){a.preventDefault();var b=a.queryToJson(h.suda||"");b=b.cancel||{};window.SUDA&&SUDA.uaTrack&&b.key&&SUDA.uaTrack(b.key,b.value);i.cancel()}},run:function(){var a=l[e.code]||l[100001];return a()||i.call(h,e)},destroy:function(){c&&c.destroy()}},l={100001:function(){if(i.beside)a.ui.tipAlert(h.msg,a.core.json.merge(h,{autoHide:!1,icon:"warnS"})).beside(i.beside);else{var b=a.ui.alert(h.msg.split("\\n"),a.core.json.merge(h,{icon:"warnB"}));a.addClassName(b.getOuter(),"W_translateZ")}},100002:function(){a.lib.dialog.loginLayer({lang:window.$CONFIG&&window.$CONFIG.lang||"zh-cn"})},100003:function(){a.ui.confirm(h.msg.split("\n"),h)},100004:function(){c||(c=a.lib.dialog.authentication());c.show()},100005:function(){h.type=e.data&&(e.data.type?e.data.type:"follow");h.errortype=e.data&&(e.data.errortype||"1");return a.lib.dialog.memberDialog(h||{})},100008:function(){a.lib.dialog.loginLayer({lang:window.$CONFIG&&window.$CONFIG.lang||"zh-cn"})}};k.init();g.getdata=function(){return h};g.getAction=function(a){return a?l[a]:l};g.getCode=function(){return e.code||""};g.run=k.run;i.auto&&k.run();return g}});
STK.register("lib.dialog.validateCode",function(a){var b=window.$LANG,c=a.lib.kit.extra.language,d="/aj/pincode/pin?_wv=5&type=rule&lang="+$CONFIG.lang+"&ts=",e={dialog_html:'<div class="layer_point layer_verification"><div class="clearfix"><div class="v_img W_fl"><img height="25" width="250" class="yzm_img"/></div><div class="v_change W_fl"><a href="javascript:void(0);" class="yzm_change" action-type="yzm_change"><span class="W_ficon ficon_rotate S_ficon">e</span><span class="font S_txt1">#L{æ¢ä¸ç»}</span></a></div></div><div class="v_text yzm_wng"><span class="v_text">#L{è¯·è¾å¥ä¸é¢é®é¢çç­æ¡}ï¼</span><input type="text" class="yzm_input ontext W_input" action-type="yzm_input"/></div><div class="W_layer W_layer_pop yzm_error" style="display:none;top:70px;left:200px;"><div class="content layer_mini_info"><p class="main_txt"><i class="W_icon icon_rederrorS"></i><span class="txt S_txt1"></span><a class="W_ficon ficon_close S_ficon yzm_hideError">X</a></p><div class="W_layer_arrow"><span class="W_arrow_bor W_arrow_bor_b"><i class="S_line3"></i><em class="S_bg2_br"></em></span></div></div></div></div><div class="W_layer_btn S_bg1"><a class="W_btn_a btn_34px yzm_submit" href="javascript:void(0);" action-type="yzm_submit">#L{ç¡®å®}</a><a class="W_btn_b btn_34px yzm_cancel" href="javascript:void(0);" action-type="yzm_cancel" action-data="value=frombtn">#L{åæ¶}</a></div>'},f;return function(){if(f)return f;var b={},g={},h,i,j,k,l=function(){g.yzm_error.innerHTML="";g.yzm_error_layer.style.display="none";a.removeClassName(g.yzm_wng,"v_wrong")},m=function(b){g.yzm_error.innerHTML=b;g.yzm_error_layer.style.display="";a.addClassName(g.yzm_wng,"v_wrong")},n=function(){a.lib.kit.io.cssLoader("style/css/module/layer/layer_verifycode.css","js_style_css_module_layer_layer_verifycode",function(){h||o();l();h.setTop();h.show();t.changesrc();h.setMiddle();g.input_text.value="";a.hotKey.add(document.documentElement,["esc"],t.closeDialog,{type:"keyup",disableInInput:!0})})},o=function(){h=a.ui.dialog({isHold:!0});h.setTitle(c("#L{è¯·è¾å¥éªè¯ç }"));h.setContent(c(e.dialog_html));var b=h.getBox();s(b);u()},p=function(b){a.conf.trans.validateCode.request("checkValidate",{onError:function(){m(c("#L{éªè¯ç éè¯¯}"));t.changesrc();j=!1;g.input_text.value=""},onFail:function(){m(c("#L{éªè¯ç éè¯¯}"));t.changesrc();g.input_text.value="";j=!1},onSuccess:function(b,c){j=!1;var d=b.data.retcode;l();g.input_text.value="";h.hide();var e=i.requestAjax,f=a.lib.kit.extra.merge(i.param,{retcode:d});e.request(f)}},b)},q=function(){},r=function(){},s=function(b){g.vImg=a.core.dom.sizzle("img.yzm_img",b)[0];g.yzm_change=a.core.dom.sizzle("a.yzm_change",b)[0];g.yzm_submit=a.core.dom.sizzle("a.yzm_submit",b)[0];g.yzm_cancel=a.core.dom.sizzle("a.yzm_cancel",b)[0];g.input_text=a.core.dom.sizzle("input.yzm_input",b)[0];g.yzm_wng=a.core.dom.sizzle("div.yzm_wng",b)[0];g.yzm_error=a.core.dom.sizzle("div.yzm_error span.txt",b)[0];g.yzm_error_layer=a.core.dom.sizzle("div.yzm_error",b)[0];g.yzm_hideError=a.core.dom.sizzle(".yzm_hideError",b)[0]},t={enter:function(){a.fireEvent(g.yzm_submit,"click")},changesrc:function(){var b=d+a.getUniqueKey();g.vImg.setAttribute("src",b);try{g.yzm_change.blur()}catch(c){}},checkValidateCode:function(){l();var b=a.core.str.trim(g.input_text.value);b?j||p({secode:b,type:"rule"}):m(c("#L{è¯·è¾å¥éªè¯ç }"));try{g.yzm_submit.blur()}catch(d){}},closeDialog:function(b){typeof b=="object"&&b.el&&h.hide();typeof i=="object"&&i.onRelease&&typeof i.onRelease=="function"&&i.onRelease();a.hotKey.remove(document.documentElement,["esc"],t.closeDialog,{type:"keyup"});try{a.preventDefault()}catch(c){}},onFocus:function(b){b=a.core.evt.getEvent();var c=b.target||b.srcElement,d=c.value;d||l()}},u=function(){var b=h.getBox();k=a.core.evt.delegatedEvent(b);k.add("yzm_change","click",function(){t.changesrc();a.preventDefault()});k.add("yzm_submit","click",function(){t.checkValidateCode();a.preventDefault()});k.add("yzm_cancel","click",t.closeDialog);a.core.evt.addEvent(g.yzm_hideError,"click",l);a.core.evt.addEvent(g.input_text,"focus",t.onFocus);a.core.evt.addEvent(g.input_text,"blur",t.onFocus);a.hotKey.add(g.input_text,["enter"],t.enter,{type:"keyup"})},v=function(){if(h){k.destroy();a.core.evt.removeEvent(g.yzm_hideError,"click",l);a.core.evt.removeEvent(g.input_text,"focus",t.onFocus);a.core.evt.removeEvent(g.input_text,"blur",t.onFocus);h&&h.destroy&&h.destroy()}j=h=f=null},w=function(a,b,c){if(a.code=="100027"){i=c;n()}else if(a.code==="100000")try{var d=c.onSuccess;d&&d(a,b)}catch(e){}else try{var d=c.onError;d&&d(a,b)}catch(e){}};r();r=null;b.destroy=v;b.validateIntercept=w;b.addUnloadEvent=function(){h&&a.core.evt.addEvent(window,"unload",v)};f=b;return b}});
STK.register("lib.follow.utils.follow",function(a){var b=a.lib.kit.extra.merge,c=a.conf.channel.follow;return function(d){var e={};d=a.parseParam({trans:a.conf.trans.follow,transNameFollow:"follow",transNameUnfollow:"unFollow",transNameBlock:"block",transNameUnBlock:"unBlock",transNameRemoveFans:"removeFans",refer_sort:"",refer_flag:""},d);var f=a.lib.kit.extra.merge,g=a.lib.dialog.validateCode(),h=function(b,c){a.lib.dialog.ioError(b.code,b)},i=function(e,h){var j=b({uid:undefined,objectid:undefined,f:0,extra:"",refer_sort:d.refer_sort,refer_flag:d.refer_flag,location:window.$CONFIG&&$CONFIG.location||"",oid:window.$CONFIG&&$CONFIG.oid||"",wforce:1,nogroup:!1},h),k=e+(j.objectid?"_object":"");if(e==="follow"){j.api?k="proxy":j.unlogin&&(k="unloginfollow");var l=d.trans.getTrans(k,{onComplete:function(b,d){var j={onSuccess:function(a,b){var d=f(h,a.data),g=h.onSuccessCb;typeof g=="function"&&g(d);c.fire("changeStatus",{uid:d.uid,objectid:d.objectid,action:e,both:d.relation&&d.relation.follow_me==1})},onError:function(b,c){b.code==100050?a.ui.confirm(b.msg,{OK:function(){h.wforce=0;i(e,h)}}):a.lib.dialog.ioError(b.code,b);var d=h.onFailCb;typeof d=="function"&&d()},requestAjax:l,param:d,onRelease:function(){var a=h.onFailCb;typeof a=="function"&&a()}};g.validateIntercept(b,d,j)}});l.request(j)}else d.trans.request(k,{onSuccess:function(a,b){var d=f(h,a.data),g=h.onSuccessCb;typeof g=="function"&&g(d);c.fire("changeStatus",{uid:d.uid,objectid:d.objectid,action:e,fan:d.relation&&d.relation.follow_me==1})},onError:function(b,c){a.lib.dialog.ioError(b.code,b);var d=h.onFailCb;typeof d=="function"&&d()}},j)};e.follow=function(a){i(d.transNameFollow,a)};e.unFollow=function(a){i(d.transNameUnfollow,a)};e.block=function(a){i(d.transNameBlock,a)};e.unBlock=function(a){i(d.transNameUnBlock,a)};e.removeFans=function(a){i(d.transNameRemoveFans,a)};return e}});
STK.register("conf.trans.setGroup",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("list",{url:"/aj/f/group/list",method:"get"});c("update",{url:"/aj/f/group/update",method:"post"});c("batchSet",{url:"/aj3/attention/aj_group_batchupdate_v4.php",method:"post"});c("add",{url:"/aj/f/group/add",method:"post"});c("recommendfollow",{url:"/aj/f/recomafterfollow",method:"get"});c("closerecommend",{url:"/aj/f/closerecommend",method:"get"});c("checkcloserelation",{url:"/aj/f/checkcloserelation",method:"post"});c("addCloseFriend",{url:"/aj/f/createclosefriend",method:"post"});c("followGroup",{url:"/aj/f/group/followedgroup",method:"post"});return b});
STK.register("lib.kit.dom.parseDOM",function(a){return function(a){for(var b in a)a[b]&&a[b].length==1&&(a[b]=a[b][0]);return a}});
STK.register("lib.kit.dom.parentAttr",function(a){return function(a,b,c){var d;if(a&&b){c=c||document.body;while(a&&a!=c&&!(d=a.getAttribute(b)))a=a.parentNode}return d}});
STK.register("lib.kit.extra.getDiss",function(a){return function(){var b={},c=0,d={location:$CONFIG.location};arguments[0]&&!a.core.dom.isNode(arguments[0])&&(b=arguments[c++]);b=a.lib.kit.extra.merge(b,d);if(!arguments[c])return b;b=a.lib.kit.extra.merge(b,a.core.json.queryToJson(a.lib.kit.dom.parentAttr(arguments[c++],"diss-data",arguments[c])||""));return b}});
STK.register("lib.kit.extra.parseURL",function(a){return function(){return STK.historyM&&STK.historyM.parseURL?STK.historyM.parseURL():a.core.str.parseURL(location.href)}});
STK.register("lib.dialog.groupListPanel",function(a){var b=a.lib.kit.extra.language,c=b("#L{æçæ¨è}");return function(c){var d={},e=a.C("div"),f={},g={},h,i=a.delegatedEvent(e),j=$CONFIG.imgPath+"style/images/common/transparent.gif",k=[{mode:"special",className:"W_ico16 i_conn_public",title:b("#L{ææäººå¯è§}")},{mode:"normal",className:"W_ico16 i_conn_public",title:b("#L{ææäººå¯è§}")}],l=function(a,b,c){if(!!a){c&&(c=c.toUpperCase());var d=a[b];while(d){if(d.nodeType==1&&(c?d.nodeName==c:!0))break;d=d[b]}return d}},m=c.multi?'style="display:none;"':'<#if (item.belong==1)><#else>style="display:none;"</#if>',n='<ul node-type="#{mode}" class="group_ul #{addOnClass} clearfix"></ul>',o=a.core.util.easyTemplate('<#et listItem gList><#list gList as item><li class="group_li" ><label for="${item.gid}" ><input action-type="select" id="${item.gid}" type="checkbox"<#if (item.recom_join)> recom_join="1" </#if><#if (item.belong==1 || item.recom_join || item.gid == 0)>checked="checked"</#if> <#if (item.ogname)>ogname="${item.ogname}"</#if>class="W_checkbox" value="${item.gid}"><span class="group_name <#if (item.gid==0 || item.recom_join)>W_autocut</#if>"  node-type="gplist_${item.gid}_gname"><span><#if (item.ogname)>${item.ogname}<#elseif (item.gname)>${item.gname}</#if></span><#if (item.needIcon == 1)><span class="W_icon icon_askS" action-type="specialAttentionTip"></span><#elseif (item.gid == 0)><i class="new_group_tag">'+b("#L{æ°åç»}")+"</i></#if>"+"<#if (item.gid == 0)>"+'<em class="S_txt2">('+b("#L{å»ºè®®åå»ºå¹¶å å°è¯¥ç»}")+'</em></span><em class="S_txt2">)</em>'+"<#elseif (item.recom_join)>"+'<em class="S_txt2">('+b("#L{å»ºè®®å å°è¯¥ç»}")+'</em></span><em class="S_txt2">)</em>'+"</#if>"+"<#if (item.recom_add)>"+'<em class="S_txt2">('+b("#L{å¾éæ­¤ç»å³å¯å°è¿ä¸ªå¸å·æ¨èç»ç²ä¸}")+'</em></span><em class="S_txt2">)</em>'+"</#if>"+"</label>"+"</li>"+"</#list>"+"</#et>"),p,q='<div class="W_layer W_layer_pop"><div class="content layer_mini_info"> <p class="main_txt"><i class="W_icon icon_succ"></i><span class="txt S_txt1">#L{ä¸æ³éè¿Taçæ¯ä¸æ¡å¾®åï¼<br>å¯ä»¥å°å¶å å°è¿ä¸ªåç»éï¼æ¹ä¾¿å¨é¦é¡µæ¥ç}</span></p><div class="W_layer_arrow"><span node-type="arrow" class="W_arrow_bor"><i class="S_line3"></i><em class="S_bg2_br"></em></span></div></div></div>',r=function(b){var c=document.createTextNode(b),d=a.C("div");d.appendChild(c);var e=d.innerHTML;d=c=null;return e},s=function(){var b="";for(var d=0;d<k.length;d++){d!=k.length-1?k[d].addOnClass="spec":k[d].addOnClass="";b+=a.templet(n,k[d])}e.innerHTML=b;h=a.lib.kit.dom.parseDOM(a.core.dom.builder(e).list);c.data&&A(c.data)},t=function(){for(var b=0;b<k.length;b++){var d=k[b].mode;if(d=="system"&&f[d]){c.fromFollow&&a.foreach(f[d],function(a,b){a.fromFollow=1});var e=o(f[d]).toString(),g=c.fromFollow?h.special:h.normal;g&&a.insertHTML(g,e,"afterbegin")}else if(f[d]){var e=o(f[d]).toString();h[d].innerHTML+=e}}!f.special&&h.special&&(h.special.style.display="none")};lengthLimit=function(b){var c=a.fixEvent(b).target;a.bLength(c.value)>16&&(c.value=a.leftB(c.value,16))},onEnter=function(b){if(b.keyCode===13){var c=a.fixEvent(b).target;a.fireEvent(c,"blur")}};var u=function(b){var c=l(b,"parentNode","li");if(!!c){var d=a.sizzle('input[action-type="select"]',c)[0];g[d.id]||(g[d.id]={});return g[d.id]}},v={show:function(c){p=a.ui.bubble(b(q)).show().beside(c.el,{pos:"bottom-left",offsetX:-10,offsetY:2})},hide:function(){p.hide()}},w=function(){i.add("specialAttentionTip","mouseover",v.show);i.add("specialAttentionTip","mouseout",v.hide)},x=function(){s();w()},y=function(){return e},z=function(b){var c=b.mode||"normal";f[c]=f[c]||[];f[c].push(b);var d=o([b]).toString();a.insertHTML(h[c],d,"beforeend")},A=function(d){f={};if(a.isArray(d))for(var e=0,g=d.length;e<g;e++){d[e].gid=="0"||d[e].recom_join==1?d[e].mode="special":d[e].mode="normal";c.fromFollow&&d[e].gname==b("#L{ç¹å«å³æ³¨}")&&(d[e].needIcon=1);var h=d[e].mode;f[h]=f[h]||[];f[h].push(d[e])}t()},B=function(){var b=[],c={suda:[],diss:{allGroup:0,autoSelect:0,gid:[],uid:$CONFIG.uid}},d=a.sizzle('input[action-type="select"]',e),f,g;c.diss.allGroup=d.length;for(var h=d.length;h--;){var i={};f=g=!1;if(d[h].checked){f=!0;var j=u(d[h]);if(j){i.gid=d[h].value;i.gid=="0"&&(i.ogname=d[h].getAttribute("ogname")||"");b.push(i)}}if(d[h].getAttribute("recom_join")){g=!0;c.diss.autoSelect++;c.diss.gid.push(d[h].value)}(g||f)&&c.suda.push(d[h].value+(g?"_a":"_b")+(f?"_1":"_0"))}b.suda_diss=c;return b},C=function(){t()},D=function(){f={};t()},E=function(){i.destroy();g=null;f=null;h=null;e=null},F=function(){var b=a.sizzle('input[action-type="select"]',e);return b.length};x();d.getOuter=y;d.length=F;d.add=z;d.setData=A;d.getData=B;d.reset=C;d.clear=D;d.destroy=E;return d}});
STK.register("lib.dialog.vipError",function(a){var b='<#et temp data><div node-type="outer" class="layer_point"><dl class="point clearfix"><dt><span class="${data.icon}" node-type="icon"></span></dt><dd node-type="inner">${data.info}</dd></dl></div><div class="W_layer_btn S_bg1"><a href="javascript:void(0);" <#if (data.lbtnStyle == 1)>class="W_btn_a"<#else if (data.lbtn == 0)>class="W_btn_b"</#if> node-type="lbtn"><span><#if (data.lbtnIcon == 1)><i class="W_icon icon_member"></i></#if>${data.lbtnText}</span></a><a href="javascript:void(0);" <#if (data.rbtnStyle == 1)>class="W_btn_a"<#else if (data.rbtn == 0)>class="W_btn_b"</#if> node-type="rbtn"><span><#if (data.rbtnIcon == 1)><i class="W_icon icon_member"></i></#if>${data.rbtnText}</span></a></div></#et>',c={success:"icon_succM",error:"icon_errorM",warn:"icon_warnM","delete":"icon_delM",question:"icon_questionM"},d=a.lib.kit.extra.language,e=function(e){var f,g,h;f=a.parseParam({title:"&nbsp;",icon:"warn",info:"",lbtnFunc:a.funcEmpty,lbtnStyle:0,lbtnIcon:0,lbtnText:d("#L{ç«å³å¼éä¼å}"),rbtnFunc:a.funcEmpty,rbtnStyle:0,rbtnIcon:0,rbtnText:d("#L{ç«å³å¼éä¼å}")},e);f.icon=c[f.icon];g=a.ui.dialog();g.setContent(a.core.util.easyTemplate(b,f).toString());h=g.getDomList(!0);g.setTitle(f.title);g.getDomList().title.style.borderBottomStyle="none";var i=function(){f.lbtnFunc();g.hide()},j=function(){f.rbtnFunc();g.hide()};a.addEvent(h.lbtn,"click",i);a.addEvent(h.rbtn,"click",j);a.custEvent.add(g,"hide",function(){a.custEvent.remove(g,"hide",arguments.callee);a.removeEvent(h.lbtn,"click",i);a.removeEvent(h.rbtn,"click",j)});g.show().setMiddle();return g};return function(a,b){if(a=="100096"||a=="100098"){b.lbtnStyle=0;b.lbtnIcon=0;b.lbtnText=d("#L{ç®¡çåç»}");b.rbtnStyle=1;b.rbtnIcon=1;b.rbtnText=d("#L{å¼éä¼å}");b.rbtnFunc=function(){location.href="http://vip.weibo.com/paycenter?form=group"}}else if(a=="100097"){b.lbtnStyle=0;b.lbtnIcon=0;b.lbtnText=d("#L{ç®¡çåç»}");b.rbtnStyle=0;b.rbtnIcon=0;b.rbtnText=d("#L{ç¥éäº}")}return e(b)}});
STK.register("lib.dialog.setGroup",function(a){var b=30,c="http://rs.sinajs.cn/sgmark.gif",d=a.lib.kit.extra.language,e=a.lib.kit.extra.merge;return function(){function C(a){return s.extraPostData?e(a,typeof s.extraPostData=="function"?s.extraPostData():s.extraPostData):a}var f={},g=!1,h=0,i,j=5,k=a.ui.dialog(),l=a.ui.alert,m,n={groupBox:'<div class="layer_set_group" node-type="group_panel"><input type="hidden" node-type="uid" name="touid" ><div class="remark_set" node-type="remarkPanel"><label for=""><em class="W_fb">#L{å¤æ³¨åç§°ï¼}</em><input type="text" node-type="remarkInput" name="remark" class="W_input" value="#L{å¡«åå¤æ³¨åç§°}"></label></div><div class="group_box"><h4 class="tit W_fb" node-type="message">#L{éæ©åç»ï¼}</h4><div class="loading_box" node-type="loading"><i class="W_loading"></i><span class="S_txt1">æ­£å¨å è½½ï¼è¯·ç¨å</span></div><div class="choose_area"><div class="group_list" node-type="groupList"></div><div node-type="addGroupPanel"><div class="opt_area" node-type="showBtnBox"><a href="javascript:void(0);" class="W_btn_b" action-type="showBtn"><em class="W_ficon ficon_add S_ficon">+</em>#L{åå»ºæ°åç»}</a></div><div style="display:block;" class="add_group clearfix" node-type="addGroupBox"><div class="W_fl"><input type="text" node-type="groupInput" class="W_input" value="#L{æ°åçµ}"><a href="javascript:void(0);" class="W_btn_a" action-type="addGroup" node-type="addGroup">#L{åå»º}</a><a action-type="hideBtn" href="javascript:void(0);" action-type="hideBtn">#L{åæ¶}</a></div></div></div></div><div class="reco_area" style="display:none;" node-type="samelist"><div class="WB_cardtitle_a" ><h4 class="obj_name"><span class="main_title W_fb" node-type="recommMsg">#L{Ta çç²ä¸ä¹å³æ³¨}</span></h4><div class="opt_box"><a href="javascript:void(0);"  suda-uatrack="key=V6addattenlayer&value=change" action-type="refresh" class="opt_change S_txt1" node-type="refreshbtn"><em class="W_ficon ficon_rotate W_f14 S_ficon">e</em>#L{æ¢ä¸æ¢}</a></div></div><ul class="pt_ul clearfix" node-type="userList"></ul></div></div></div><div class="W_layer_btn S_bg1" node-type="confirmBox"><a href="javascript:void(0);" suda-data="key=V6addattenlayer&value=save" class="W_btn_a btn_34px" action-type="submit" node-type="submit">#L{ä¿å­}</a><a href="javascript:void(0);" suda-data="key=V6addattenlayer&value=cancel" class="W_btn_b btn_34px" action-type="cancel">#L{åæ¶}</a></div>',checkBox:'<input type="checkbox" value="{value}" name="gid" class="W_checkbox" {checked} id="group_{groupId}"><label for="group_{groupId}">{name}</label>',userlist:'<#et data data><li class="picitems" uid="${data.uid}"><div class="midbox"><p class="pic_wrap"><span class="pic_box"><a href="${data.profile_url}" suda-data="key=V6addattenlayer&value=head" target="_blank"><img src="${data.profile_image_url}" width="50" height="50" alt="${data.fnick}"  class="pic"></a><a href="${data.profile_url}"  class="icon_bed" target="_blank"><em class="W_icon  ${data.icon}"></em></a></span></p><p class="name W_tc" ><a href="${data.profile_url}" target="_blank" suda-data="key=V6addattenlayer&value=nickname" class="S_txt1">${data.fnick}</a></p><p class="opt" node-type="widget_followBtnBox" action-data="uid=${data.uid}&fnick=${data.fnick}&template=2&nogroup=1&refer_sort=similar&refer_flag=similar&location=afterfollow_v6"><a href="javascript:;" action-type="follow" suda-data="key=V6addattenlayer&value=follow" class="W_btn_b btn_22px"><em class="W_ficon ficon_add S_ficon">+</em>å³æ³¨</a></p></div></li></#et>'},o={title:"#L{å³æ³¨æå}",setGroupTitle:"#L{è®¾ç½®åç»}",gEmpty:"#L{åç»åä¸è½ä¸ºç©º}",rEmpty:"#L{å¤æ³¨åä¸è½ä¸ºç©º}",gMaxLen:"#L{è¯·ä¸è¦è¶è¿16ä¸ªå­ç¬¦}",gDefVal:"#L{æ°åç»}",okLabel:"#L{è®¾ç½®æå}",rDefVal:"#L{è®¾ç½®å¤æ³¨}",message:'#L{ä¸º   <span class="W_fb">%s</span>  éæ©åç»}',recommMsg:'#L{<span class="W_fb">%s</span>  çç²ä¸ä¹å³æ³¨}',repeat:"#L{æ­¤åç»åå·²å­å¨}"},p=!1,q=[],r=!1,s,t,u,v,w,x,y,z,A,B,D=function(a){u.remarkInput.value=d(o.rDefVal);u.groupInput.value=d(o.gDefVal);u.showBtnBox.style.display="";u.addGroupBox.style.display="none";u.loading.style.display="";u.groupList.innerHTML=""},E=function(){},F=function(b,c){var e,f;if(b=="addGroup"){e=d("#L{åå»º}");f="addGroup"}else{e=d("#L{ä¿å­}");f="submit"}if(c=="normal"){a.addClassName(u[b],"btn_noloading");a.removeClassName(u[b],"W_btn_a_disable");u[f].innerHTML=e}else{a.addClassName(u[b],"W_btn_a_disable");a.removeClassName(u[b],"btn_noloading");u[f].innerHTML=d("#L{ä¿å­ä¸­...}")}},G=function(b){D(b);s=a.parseParam({uid:"",fnick:"",sex:"m",hasRemark:!0,fromFollow:!1,groupList:[],recommend:[],title:d(o.setGroupTitle),successCb:function(){},cancelCb:function(){},extraPostData:{},remark:undefined},b);r=s.fromFollow;r&&(s.title=d(o.title));b.tarEl&&(s=a.lib.kit.extra.getDiss(s,b.tarEl));A=s.successCb;B=s.cancelCb;u.uid.value=s.uid;u.remarkInput.value=d(o.rDefVal);if(s.hasRemark){u.remarkInput.removeAttribute("disabled");u.remarkPanel.style.display=""}else{u.remarkInput.setAttribute("disabled","disabled");u.remarkPanel.style.display="none"}s.groupList.length?M(s.groupList):R.request({uid:s.uid});s.recommend.length?N(s.recommend):N([]);u.message.innerHTML=d(o.message,s.fnick);u.recommMsg.innerHTML=d(o.recommMsg,s.fnick);k.setTitle(s.title);k.getDomList().close.setAttribute("suda-uatrack","key=V6addattenlayer&value=shutdown");k.insertElement(u.group_panel,"beforeend");k.insertElement(u.confirmBox,"beforeend");s.fromFollow||(u.remarkPanel.style.display="none");k.show();window.WBEXP&&window.WBEXP.collect({V6addattenlayer:"addatten"})},H=function(b){if(!!b){if(s&&s.fromFollow!=!0)return;var d=parseInt(Math.random()*1e4),e=a.C("img");e.src=c+"?n="+b.allGroup+"_"+b.autoSelect+"&gid="+b.gid.join(",")+"&uid="+b.uid+"&rd="+d;document.body.appendChild(e);setTimeout(function(){e.parentNode.removeChild(e)},3e3)}},I=function(a){var a=a||{};k.hide()},J={defVal:d(o.gDefVal),check:function(b){var c="";b===""||b===this.defVal?c=o.gEmpty:a.core.str.bLength(b)>16&&(c=o.gMaxLen);return d(c)},checkRepeat:function(a){var b="";for(var c=q.length;c--;)if(a===q[c].gname){b=o.repeat;break}return d(b)},showError:function(b){m=a.ui.tipAlert('<span class="txt S_txt1">'+b+"</span>",{autoHide:!1,icon:"rederrorS"}).beside(u.groupInput,{pos:"top-middle"})},hideError:function(){m&&m.hide&&m.hide();m=undefined}},K={defVal:d(o.rDefVal),check:function(b){var c="";b===""?c=o.rEmpty:a.core.str.bLength(b)>16&&(c=o.gMaxLen);return d(c)},showError:function(a){},hideError:function(){}},L=function(b){var c=a.C("li"),d=n.checkBox.replace(/\{value\}/g,b.gid).replace(/\{groupId\}/g,b.gid).replace(/\{name\}/g,b.gname).replace(/\{checked\}/g,b.belong?"checked":"");c.innerHTML=d;return c},M=function(b){var c=b,d=b.recommend,e={data:c,fnick:s.fnick,uid:s.uid,fromFollow:r};t=a.lib.dialog.groupListPanel(e);u.groupList.appendChild(t.getOuter());u.loading.style.display="none";c.length>=20&&(u.addGroupPanel.style.display="none")},N=function(a){i=a;if(!!i){var b=i.length;if(b==0){u.samelist.style.display="none";u.userList.innerHTML="";return}window.WBEXP&&window.WBEXP.collect({V6addattenlayer:"similar"});var c=[];u.samelist.style.display="";u.refreshbtn.style.display=b>j?"":"none";P()}},O=function(a){a.icon="";a.verified?a.verified_type==0?a.icon="icon_pf_approve":a.verified_type>=1&&a.verified_type<=7&&(a.icon="icon_pf_approve_co"):a.verified_type==220&&(a.icon="icon_pf_club")},P=function(){var b,c=[],d=i.length,e=[];for(var f=0;f<d&&f<j;f++){h>=d&&(h=h-d);b=i[h];h++;O(b);var g=a.core.util.easyTemplate(n.userlist,b).toString();e.push(b.uid);c.push(g)}u.userList.innerHTML=c.join("");var k="p2p:"+e.join("_")+":"+$CONFIG.uid+":"+s.uid;window.WBEXP&&window.WBEXP.collect({similarhead:k})},Q={errorCd:function(b,c){g=!1;if(b.code=="100096"||b.code=="100097"||b.code=="100098"){var d=a.lib.dialog.vipError(b.code,{info:b.data.html,lbtnFunc:function(){location.href=b.data.gurl}});a.custEvent.add(d,"hide",I)}else a.lib.dialog.ioError(b.code,b);F("submit","normal")},getGroupSuccess:function(a,b){M(a.data);i=a.data.recommend||[];N(i)},setGroupSuccess:function(b,c){g=!1;F("submit","normal");I();A(b,c);a.ui.tip("lite",{msg:d(o.okLabel),type:"succM",timer:"500"})},setGroupError:function(a,b){g=!1;J.showError(a.msg)},addGroupSuccess:function(a,b){F("addGroup","normal");var c=a.data,e;u.addGroupPanel.style.display=c.length>=20?"none":"";for(var f in c)if(c[f].belong===1){e=c[f];break}e&&q.push(e);t.add(e);W.hideAddPanel();u.groupInput.value=d(o.gDefVal);t.length()>=20&&(u.addGroupPanel.style.display="none")}},R=a.conf.trans.setGroup.getTrans("list",{onSuccess:Q.getGroupSuccess,onError:Q.errorCd}),S=function(b){a.conf.trans.setGroup.getTrans("update",{onSuccess:Q.setGroupSuccess,onError:Q.errorCd,onFail:Q.errorCd}).request(C(b))},T=a.conf.trans.setGroup.getTrans("batchSet",{onSuccess:Q.setGroupSuccess,onError:Q.errorCd}),U=function(b){a.conf.trans.setGroup.getTrans("add",{onSuccess:Q.addGroupSuccess,onError:function(b,c){F("addGroup","normal");a.lib.dialog.ioError(b.code,b)}}).request(b)},V=function(b){var c=document.createTextNode(b),d=a.C("div");d.appendChild(c);var e=d.innerHTML;d=c=null;return e},W={showAddPanel:function(){u.showBtnBox.style.display="none";u.addGroupBox.style.display="";u.groupInput.focus()},hideAddPanel:function(){u.showBtnBox.style.display="";u.addGroupBox.style.display="none";J.hideError();u.groupInput.value=J.defVal},addGroup:function(){var b=V(a.trim(u.groupInput.value)),c=J.check(b)||J.checkRepeat(b);if(c)J.showError(c);else{J.hideError();F("addGroup","loading");U({name:b,ispublic:""})}},submit:function(){if(!g){g=!0;var b={};p=!0;b.type="s";var c=t.getData(),e=[],f=u.remarkInput.value;f===d(o.rDefVal)&&(f="");b.remark=f;var h=u.uid.value;b.user=h;b.gid=a.jsonToStr(c);if(c.suda_diss&&s.fromFollow==!0){var i=c.suda_diss.suda,j=c.suda_diss.diss;window.SUDA&&window.SUDA.uaTrack&&window.SUDA.uaTrack("group_aftermark","save:"+i.join(","))}F("submit","loading");S(b)}},followEnd:function(b){if(b.action=="follow"){var c=b.uid;if(!i)return;var d=i.length;for(var e=d-1;e>=0;e--)if(i[e].uid==c){i.splice(e,1);break}i.length<=j&&(u.refreshbtn.style.display="none");var f=a.sizzle("[uid="+c+"]",u.userList)[0];f&&a.tween(f,{end:function(){if(i.length>=j){var b=h-1;b>=i.length&&(b=0);O(i[b]);var c=a.core.util.easyTemplate(n.userlist,i[b]).toString(),d="p2p:"+i[b].uid+":"+$CONFIG.uid+":"+s.uid;window.WBEXP&&window.WBEXP.collect({similarhead:d});a.insertHTML(f,c,"afterend")}a.removeNode(f);f=null},duration:800}).play({opacity:0})}},cancel:function(){p=!1;I()},inputFocus:function(b){return function(c){var c=a.fixEvent(c),d=c.target,e=d.value;b.hideError();e===b.defVal&&(d.value="")}},inputBlur:function(b){return function(c){var c=a.fixEvent(c),d=c.target,e=a.trim(d.value);e||(d.value=b.defVal)}},inputMaxLen:function(c){var c=a.fixEvent(c),d=c.target,e=d.value,f=a.core.str.bLength(e);c.keyCode=="13"?W.submit():f>b&&(d.value=a.core.str.leftB(e,b))}},X=function(){_();Y();Z()},Y=function(){var b=k.getDomList().close;b&&b.setAttribute("suda-uatrack","key=group_aftermark&value=close");a.custEvent.define(f,["hide"]);v=a.core.evt.delegatedEvent(k.getDomList().inner);w=W.inputFocus(J);x=W.inputBlur(J);y=W.inputFocus(K);z=W.inputBlur(K);a.addEvent(u.remarkInput,"focus",y);a.addEvent(u.remarkInput,"blur",z);a.addEvent(u.groupInput,"focus",w);a.addEvent(u.groupInput,"blur",x);a.addEvent(u.remarkInput,"keyup",W.inputMaxLen);a.addEvent(u.groupInput,"keyup",W.inputMaxLen);v.add("showBtn","click",W.showAddPanel);v.add("hideBtn","click",W.hideAddPanel);v.add("addGroup","click",W.addGroup);v.add("submit","click",W.submit);v.add("cancel","click",W.cancel);v.add("refresh","click",P);a.conf.channel.follow.register("changeStatus",W.followEnd)},Z=function(){a.custEvent.add(k,"hide",function(){a.custEvent.fire(f,["hide"]);p||B();var b=t.getData();b&&b.suda_diss&&H(b.suda_diss.diss);J.hideError()})},_=function(){var b=a.core.dom.builder(d(n.groupBox));u=a.lib.kit.dom.parseDOM(b.list)},ba=function(){a.custEvent.undefine(f,["hide"]);a.removeEvent(u.remarkInput,"focus",y);a.removeEvent(u.remarkInput,"blur",z);a.removeEvent(u.groupInput,"focus",w);a.removeEvent(u.groupInput,"blur",x);a.removeEvent(u.remarkInput,"keyup",W.inputMaxLen);a.removeEvent(u.groupInput,"keyup",W.inputMaxLen);a.conf.channel.follow.remove("changeStatus",W.followEnd);w=null;x=null;y=null;z=null;v&&v.destroy();recommend&&recommend.destroy()};X();f.show=G;f.hide=I;f.destroy=ba;return f}});
STK.register("lib.follow.followButton",function(a){function i(c,d,e){a.foreach(h,function(b){a.removeClassName(c,b)});a.foreach([].concat(d[1]),function(b){a.addClassName(c,b)});e===!1?c.innerHTML=b(d[0]):a.ui.badge(c,b(d[0]));c.setAttribute("action-type",d[2])}var b=a.lib.kit.extra.language,c=a.templet,d=a.conf.channel.follow,e=a.lib.kit.extra.merge,f=a.lib.kit.dom.hover,g={0:{temp_follow:['<em class="W_ficon ficon_right S_ficon">Y</em>#L{å·²å³æ³¨}<em class="W_ficon ficon_arrow_down_lite S_ficon">g</em>',"W_btn_d","unFollow"],temp_followBoth:['<em class="W_ficon ficon_addtwo S_ficon">Z</em>#L{äºç¸å³æ³¨}<em class="W_ficon ficon_arrow_down_lite S_ficon">g</em>',"W_btn_d","unFollow"],temp_unfollow:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_c","follow"],temp_unfollowFan:['<em class="W_ficon ficon_right S_ficon">Y</em><em class="W_vline S_line1"></em><em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_c","follow"],temp_block:["#L{è§£é¤é»åå}","W_btn_d","unBlock"],temp_loading:['<i class="W_loading"></i>#L{å³æ³¨ä¸­}',"W_btn_c","noop"],temp_loading2:['<i class="W_loading"></i>#L{åæ¶å³æ³¨ä¸­}',"W_btn_d","noop"],temp_layer:['<div class="layer_menu_list_b" style="position:absolute;z-index:3000;"><div class="list_wrap"><div class="list_content W_f14"><ul class="list_ul"><li action-type="ok" class="item"><a href="javascript:void(0);" suda-data="key=tblog_profile_v6&value=cancel_atten" class="tlink S_txt1">#L{åæ¶å³æ³¨}</a></li><li class="item" action-type="setGroup"><a href="javascript:void(0);" suda-data="key=tblog_profile_v6&value=set_up_groups" class="tlink S_txt1">#L{è®¾ç½®åç»}</a></li></ul></div></div>'],temp_layerOffset:{x:1,y:2,width:0}},1:{temp_follow:['<em class="W_ficon ficon_right">Y</em>#L{å·²å³æ³¨}<em class="W_ficon ficon_arrow_down_lite">g</em>',"W_btn_b","unFollow"],temp_followBoth:['<em class="W_ficon ficon_addtwo">Z</em>#L{äºç¸å³æ³¨}<em class="W_ficon ficon_arrow_down_lite">g</em>',"W_btn_b","unFollow"],temp_unfollow:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_unfollowFan:['<em class="W_ficon ficon_right">Y</em><em class="W_vline S_line1"></em><em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_block:["#L{è§£é¤é»åå}","W_btn_b","unBlock"],temp_loading:['<i class="W_loading"></i>#L{å³æ³¨ä¸­}',"W_btn_b","noop"],temp_loading2:['<i class="W_loading"></i>#L{åæ¶å³æ³¨ä¸­}',"W_btn_b","noop"],temp_layer:['<div class="layer_menu_list" style="position:absolute;z-index:3000;"><ul><li action-type="ok"><a href="javascript:void(0);">#L{åæ¶å³æ³¨}</a></li><li action-type="setGroup"><a href="javascript:void(0);">#L{è®¾ç½®åç»}</a></li></ul></div>']},2:{temp_follow:["#L{å·²å³æ³¨}",["W_btn_b","W_btn_b W_btn_b_disable"],"noop"],temp_followBoth:["#L{å·²å³æ³¨}",["W_btn_b","W_btn_b W_btn_b_disable"],"noop"],temp_unfollow:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_unfollowFan:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_block:["#L{è§£é¤é»åå}","W_btn_b","unBlock"],temp_loading:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","noop"],temp_loading2:["#L{å·²å³æ³¨}","W_btn_b",""],temp_layer:[""]},3:{temp_follow:['<em class="W_ficon ficon_right">Y</em>#L{å·²å³æ³¨}',"W_btn_b W_btn_b_disable","noop"],temp_followBoth:['<em class="W_ficon ficon_right">Y</em>#L{å·²å³æ³¨}',"W_btn_b W_btn_b_disable","noop"],temp_unfollow:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_unfollowFan:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_block:["#L{è§£é¤é»åå}","W_btn_b","unBlock"],temp_loading:['<i class="W_loading"></i>#L{å³æ³¨ä¸­}',"W_btn_b","noop"],temp_loading2:['<i class="W_loading"></i>#L{åæ¶å³æ³¨ä¸­}',"W_btn_b","noop"],temp_layer:[""]},4:{temp_follow:['<em class="W_ficon ficon_right">Y</em>#L{å·²å³æ³¨}<em class="W_ficon ficon_arrow_down_lite">g</em>',"W_btn_b","unFollow"],temp_followBoth:['<em class="W_ficon ficon_addtwo">Z</em>#L{äºç¸å³æ³¨}<em class="W_ficon ficon_arrow_down_lite">g</em>',"W_btn_b","unFollow"],temp_unfollow:['<em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_b","follow"],temp_unfollowFan:['<em class="W_ficon ficon_right">Y</em><em class="W_vline S_line1"></em><em class="W_ficon ficon_add">+</em>#L{å³æ³¨}',"W_btn_c","follow"],temp_block:["#L{è§£é¤é»åå}","W_btn_b","unBlock"],temp_loading:['<i class="W_loading"></i>#L{å³æ³¨ä¸­}',"W_btn_b","noop"],temp_loading2:['<i class="W_loading"></i>#L{åæ¶å³æ³¨ä¸­}',"W_btn_b","noop"],temp_layer:['<div class="layer_menu_list_b" style="position:absolute;z-index:3000;"><div class="list_wrap"><div class="list_content W_f14"><ul class="list_ul"><li action-type="ok" class="item"><a href="javascript:void(0);" suda-data="key=tblog_profile_v6&value=cancel_atten" class="tlink S_txt1">#L{åæ¶å³æ³¨}</a></li><li class="item" action-type="setGroup"><a href="javascript:void(0);" suda-data="key=tblog_profile_v6&value=set_up_groups" class="tlink S_txt1">#L{è®¾ç½®åç»}</a></li></ul></div></div>','<div class="layer_menu_list_b" style="position:absolute;z-index:3000;"><div class="list_wrap"><div class="list_content W_f14"><ul class="list_ul"><li action-type="ok" class="item"><a href="javascript:void(0);" suda-data="key=tblog_profile_v6&value=cancel_atten" class="tlink S_txt1">#L{åæ¶å³æ³¨}</a></li></ul></div></div>'],temp_layerOffset:{x:1,y:2,width:0}}},h=["W_btn_a","W_btn_b","W_btn_c","W_btn_d","W_btn_a_disable","W_btn_b_disable","W_btn_c_disable","W_btn_d_disable"],j=function(a,b){if(a.type!="mouseout"&&a.type!="mouseover")return!1;var c=a.relatedTarget?a.relatedTarget:a.type=="mouseout"?a.toElement:a.fromElement;while(c&&c!=b)c=c.parentNode;return c!=b};return function(c){function q(a){return c.extraPostData?e(a,typeof c.extraPostData=="function"?c.extraPostData():c.extraPostData):a}var h={},c=a.parseParam({outer:null,outNodeExpr:'[node-type="followBtnBox"]',refer_sort:"",refer_flag:"",extraPostData:{},needSync:!1,followOpts:null},c),k,l=null,m=a.lib.follow.utils.follow(c.followOpts),n=a.lib.dialog.setGroup,o=a.ui.confirm,p=a.delegatedEvent(c.outer),r=function(b){return a.core.dom.dir.parent(b,{expr:c.outNodeExpr})[0]},s={"click:follow":function(b){a.preventDefault();var d=r(b.el);if(!!d){var e=b.el,f=a.queryToJson(d.getAttribute("action-data")||""),j=d.innerHTML,o,p=f.template||"0";f.onSuccessCb=function(b){var c=b.relation,d=c&&c.follow_me==1;i(l=e,g[p][d?"temp_followBoth":"temp_follow"]);a.custEvent.fire(h,"change",{state:"follow",spec:b});b.groupList=b.group;b.fromFollow=!0;if(!b.nogroup){k||(k=n());setTimeout(function(){k.show(b);a.custEvent.fire(h,"showDialog")},700)}};f.onFailCb=function(b){o&&(d.innerHTML=o);a.custEvent.fire(h,"showDialog")};f.onRelease=function(){d.innerHTML=j};setTimeout(function(){o=d.innerHTML;i(e,g[p].temp_loading,!1);f.refer_sort=f.refer_sort||c.refer_sort;f.refer_flag=f.refer_flag||c.refer_flag;f=q(f);m.follow(f)},0)}},"mouseout:unFollow":function(b){a.preventDefault();if(!!j(b.evt,b.el)){var c=r(b.el);if(c){clearTimeout(c.t);c.t=null}}},"mouseover:unFollow":function(b){a.preventDefault();if(!!j(b.evt,b.el)){var c=r(b.el);if(!c)return;c.confirm||(c.t=setTimeout(function(){var d=b.el,e=a.queryToJson(c.getAttribute("action-data")||""),j=c.innerHTML,o=e.template||"0",p,r;if(!!g[o].temp_layer[0]){e.onSuccessCb=function(b){var c=b.relation,e=c&&c.follow_me==1;i(l=d,g[o][e?"temp_unfollowFan":"temp_unfollow"]);a.custEvent.fire(h,"change",{state:"unfollow",spec:b})};e.onFailCb=function(a){p&&(c.innerHTML=p)};var s=function(){p=c.innerHTML;i(d,g[o].temp_loading2,!1);e.refer_sort="";e=q(e);m.unFollow(e);c.hover.destroy();c.confirm.hide();setTimeout(function(){c.confirm.hide();c.confirm.destroy();c.confirm=null},100)},t=function(b){var c=a.core.util.browser.IE6?"width":"minWidth",e=g[o].temp_layerOffset?g[o].temp_layerOffset.width|0:0;b.style[c]=d.offsetWidth-(parseInt(a.getStyle(b,"padding-left"))||0)-(parseInt(a.getStyle(b,"padding-right"))||0)-(parseInt(a.getStyle(b,"border-left"))||0)-(parseInt(a.getStyle(b,"border-right"))||0)+e+"px"},u=g[o].temp_layer[0];e.isinterest==="true"&&(u=g[o].temp_layer[1]);c.confirm=a.ui.mlayer(u,{stopClickPropagation:!0}).on("ok","click",s).on("setGroup","click",function(){k||(k=n());k.show(e);c.confirm.hide();a.custEvent.fire(h,"showDialog")});c.hover=f({act:d,extra:[c.confirm.getBox()],delay:200,isover:!0,onmouseover:function(){c.confirm.getState()||t(c.confirm.show().beside(d,{pos:"bottom-left",offsetX:v,offsetY:w}).getBox())},onmouseout:function(){c.confirm.hide();clearTimeout(r)}});var v=g[o].temp_layerOffset?g[o].temp_layerOffset.x|0:0,w=g[o].temp_layerOffset?g[o].temp_layerOffset.y|0:0;t(c.confirm.show().beside(d,{pos:"bottom-left",offsetX:v,offsetY:w}).getBox())}},200))}},"click:unBlock":function(c){var d=r(c.el);if(!!d){var e=c.el,f=a.queryToJson(d.getAttribute("action-data")||""),g=d.innerHTML,i=f.template||"0";f.onSuccessCb=function(){window.location.reload()};var j=function(){f=q(f);m.unBlock(f)};o(b("#L{ç¡®è®¤å°æ­¤ç¨æ·ä»ä½ çé»ååä¸­ç§»é¤åï¼}"),{OK:j});a.custEvent.fire(h,"showDialog")}}},t=function(b){var d=b.uid,e=b.objectid,f=b.action.toLowerCase(),h=b.both,j=b.fan,k=a.sizzle(c.outNodeExpr,c.outer);for(var m=0,n=k.length;m<n;m++){var o=k[m],p=a.sizzle("[action-type=noop],[action-type=follow],[action-type=unFollow],[action-type=unBlock]",o)[0],q=a.queryToJson(o.getAttribute("action-data")),r=q.template||"0";l!=p&&(q.uid&&q.uid==d||q.objectid&&q.objectid==e)&&(f=="unfollow"?i(p,g[r][j?"temp_unfollowFan":"temp_unfollow"],!1):f=="unblock"?i(p,g[r].temp_unfollow,!1):f=="follow"&&i(p,g[r][h?"temp_followBoth":"temp_follow"],!1))}l=null},u=function(){a.custEvent.define(h,["change","showDialog"]);a.foreach(s,function(a,b){b=b.split(":");p.add(b[1],b[0],a)});c.needSync&&d.register("changeStatus",t)},v=function(){if(c.outer){a.foreach(s,function(a,b){p.remove(b,"click",a)});p.destroy()}c.needSync&&d.remove("changeStatus",t)},w=function(){c.outer&&u()};w();h.destroy=v;return h}});
STK.register("conf.trans.relation",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("cfinvite",{url:"/aj/invite/unread",method:"get"});c("followby",{url:"/aj/relation/followbyother",method:"get"});c("adds",{url:"/aj/relation/groupupdate",method:"post"});c("addmulti",{url:"/aj/f/group/update",method:"post"});c("addone",{url:"/aj/relation/groupupdate",method:"post"});c("removes",{url:"/aj/f/group/remove",method:"post"});c("unFollow",{url:"/aj/f/unfollow",method:"post"});c("remarkname",{url:"/aj/f/remarkname",method:"post"});c("addgroup",{url:"/aj/f/group/add",method:"post"});c("renameGroup",{url:"/aj/relation/rename",method:"post"});c("deletegroup",{url:"/aj/relation/delete",method:"post"});c("removecf",{url:"/aj/f/removeclosefriend",method:"post"});c("getLeftNavCount",{url:"/aj/relation/groupnums",method:"post"});c("getInviteList",{url:"/aj/invite/mailinvite",method:"post"});c("getInviteMessage",{url:"/aj/invite/mobileinvite",method:"post"});c("cleartrashfans",{url:"/aj/f/trash/cleartrashfans",method:"post"});c("deltrashfans",{url:"/aj/f/trash/deltrashfans",method:"post"});c("confirmfans",{url:"/aj/f/trash/confirmfans",method:"post"});c("recommendfollow",{url:"/aj/f/recomafterfollow",method:"get"});c("closerecommend",{url:"/aj/f/closerecommend",method:"get"});c("newuserguide",{url:"/aj/user/interest/newuserguide",method:"get"});c("mayinterested",{url:"/aj/user/interest/list",method:"get"});c("uninterested",{url:"/aj/user/interest/uninterested",method:"post"});c("userCard",{url:"/aj/user/cardv5",method:"get"});c("userCard2",{url:"http://weibo.com/aj/user/newcard",method:"get",requestMode:"jsonp",varkey:"callback"});c("userCard2_abroad",{url:"http://www.weibo.com/aj/user/newcard",method:"get",requestMode:"jsonp",varkey:"callback"});c("follow",{url:"/aj/f/followed",method:"post"});c("follow_register",{url:"/nguide/aj/relation/followed",method:"post"});c("unfollow_register",{url:"/nguide/aj/relation/unfollow",method:"post"});c("block",{url:"/aj/f/addblack",method:"post"});c("unBlock",{url:"/aj/f/delblack",method:"post"});c("removeFans",{url:"/aj/f/remove",method:"post"});c("requestFollow",{url:"/ajax/relation/requestfollow",method:"post"});c("questions",{url:"/aj/invite/attlimit",method:"get"});c("answer",{url:"/aj/invite/att",method:"post"});c("setRemark",{url:"/aj/f/remarkname",method:"post"});c("recommendusers",{url:"/aj/f/recommendusers",method:"get"});c("recommendAttUsers",{url:"/aj/f/worthfollowusers",method:"get"});c("recommendPopularUsers",{url:"/aj/user/interest/recommendpopularusers",method:"get"});c("mayinterestedweiqun",{url:"/aj/weiqun/getinterestedlist",method:"get"});c("moreData",{url:"/aj/f/listuserdetail",method:"get"});c("getInvite",{url:"/aj/invite/unread",method:"get"});c("quiet_addUser",{url:"/aj/f/addwhisper",method:"post"});c("quiet_removeUser",{url:"/aj/f/delwhisper",method:"post"});c("quiet_know",{url:"/aj/tipsbar/closetipsbar",method:"post"});c("groupUserList",{url:"/aj/f/group/getgroupmembers",method:"get"});c("groupSubmit",{url:"/aj/f/group/list",method:"get"});c("wqList",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_may_interest.php",method:"get"});c("uninterestedWq",{url:"/aj/proxy?api=http://recom.i.t.sina.com.cn/1/weiqun/weiqun_uninterest.php",method:"get"});c("inviteNeglect",{url:"/aj/invite/handleinvite",method:"post"});c("checkNeglect",{url:"/aj/invite/shieldedlist",method:"post"});c("inviteLift",{url:"/aj/invite/lift",method:"post"});c("inviteAccept",{url:"/aj/invite/handleinvite",method:"post"});c("searchByTel",{url:"/aj/relation/getuserbymobile",method:"post"});c("inviteCloseTips",{url:"/aj/invite/closetips",method:"post"});c("checkrelation",{url:"/aj/f/checkrelation",method:"post"});c("addCloseFriend",{url:"/aj/f/createclosefriend",method:"post"});c("recommendCf",{url:"/aj/user/closefriend/recommend",method:"get"});c("clearInvalidUsers",{url:"/aj/f/clearinvalidfriends",method:"post"});c("unIstCf",{url:"/aj/user/closefriend/deny",method:"post"});c("fanslikemore",{url:"/aj/relation/fanslikemore",method:"get"});c("getProfileInfo",{url:"/aj/relation/getprofileinfo",method:"get"});c("interestlist",{url:"/aj/user/interest/profileinfo",method:"get"});c("recommendGroupMember",{url:"/aj/user/group/recommend",method:"get"});c("followGroup",{url:"/aj/f/group/followedgroup",method:"post"});c("recommendWholeGroup",{url:"/aj/relation/rename",method:"post"});c("recommendUserAdd",{url:"/aj/f/group/addrecommenduser",method:"post"});c("recommendUserRemove",{url:"/aj/f/group/remove",method:"post"});c("specialAttentionClose",{url:"/aj/limit/increment",method:"get"});c("friendShield",{url:"/aj/mblog/friendsmblogshield",method:"post"});c("friendRecover",{url:"/aj/mblog/friendsshieldrecover",method:"post"});c("rightmod_getCloseFriendRecommend",{url:"/aj/f/recomfriendsmore",method:"get"});c("unsubscribe",{url:"/aj/relation/unsubscribe",method:"post"});c("batch",{url:"/aj/f/group/batch",method:"post"});c("attention",{url:"/aj/relation/attention",method:"get"});c("recommend",{url:"/aj/f/group/recommend",method:"get"});c("interest_uninterested",{url:"/aj/relation/uninterested",method:"post"});c("clearTrash",{url:"/p/aj/relation/cleanfans",method:"post"});c("scanfans",{url:"/p/aj/relation/scanfans",method:"post"});c("getquiet",{url:"/aj/f/lenovo",method:"get"});c("interestUnFollow",{url:"/p/aj/relation/unfollow",method:"post"});c("removeGroup",{url:"/p/aj/groupchat/removeuser",method:"post"});c("reportGroup",{url:"/aj/groupchat/report",method:"post"});c("shieldGroup",{url:"/aj/groupchat/addblack",method:"post"});c("joinGroup",{url:"/p/aj/groupchat/applygroup",method:"post"});c("quietuserIgnore",{url:"/p/aj/relation/ignoreslientuser",method:"post"});return b});
STK.register("lib.kit.extra.refreshpl",function(a){return function(b,c){function g(e,g){var h=f(b);if(!!h){var i=FM.getURL().path,j=a.queryToJson(FM.getURL().query);j.pids=h;var k=a.jsonToQuery(j),l="";if(d){j=j?j:"";l=i+"?"+k+"#_0";FM.setState(l,g)}else c.iereload&&window.location.reload()}}function f(b){var c=[];if(a.isNode(b)){c.push(e(b));return c.join("|")}a.foreach(a.sizzle(b),function(a,b){c.push(e(a))});return c[0]?c.join("|"):!1}function e(a){return!a||a==document.body?!1:a.id?a.id:e(a.parentNode)}var d=$CONFIG.bigpipe==="true",c=c||{};g(c||{})}});
STK.register("conf.trans.longFeed",function(a){var b=a.lib.kit.io.inter(),c=b.register;c("dellongfeed",{url:"/p/aj/official/dellongfeed",method:"post"});return b});
STK.register("lib.kit.dom.parentElementBy",function(a){return function(a,b,c){if(!a||!b)throw new Error("ä¼ å¥çåæ°ä¸ºç©º");var d=0,e;a=a.parentNode;while(a&&a.parentNode){d++;e=c(a);if(e===!1)return!1;if(e===!0)return a;if(e===b)return null;a=a.parentNode;if(d>3e4)return!1}return null}});
STK.register("lib.kit.extra.selectArea",function(a){var b={source:"3818214747",language:"zh-cn"},c="http://i.api.weibo.com/2/common/",d={country:c+"get_country.json",province:c+"get_province.json",city:c+"get_city.json"},e={list:["country","province","city"],map:{main:"country",country:"province",province:"city"},data:{},codes:{}};return function(c,f){var g={},h,i={init:function(){i.pars();i.onview();i.render()},pars:function(){f=f||{};h=a.parseParam(b,f);var c=f.value||"",d=c.length;if(d>0&&d%3==0)for(var g=0,i=d/3;g<i;g++)e.codes[e.list[g]]=c.substring(0,(g+1)*3)},onview:function(){for(var b in c){var d=a.C("option");d.value=f.text;d.innerHTML=f.text;c[b].appendChild(d)}},render:function(){var b=e.list;for(var f=0,g=b.length;f<g;f++){var j=f==0?"main":b[f-1];(function(b){var f=e.map[b],g=a.parseParam(h,{}),j=c[f];g[b]=e.codes[b]||"";i.getArea(d[f],g,function(b){i.build(j,b);e.codes[f]&&(a.core.util.browser.IE6?a.sizzle("option[value="+e.codes[f]+"]",j)[0].selected=!0:j.value=e.codes[f])})})(j)}},change:function(b,f){var g=b.tagName=="SELECT"?b:a.fixEvent(b).target,j;for(var k in c)if(g==c[k]){j=k;break}var l=e.map[k];i.reset(j);if(g.selectedIndex!=0)if(e.data[g.value])i.build(c[l],e.data[g.value]);else{var m=a.parseParam(h,{});m[j]=g.value;i.getArea(d[l],m,function(a){i.build(c[l],a);e.data[g.value]=a;f&&f()})}},build:function(b,c){var d=0;for(var e in c){d++;var f=a.C("option");f.value=e;f.innerHTML=c[e];b.appendChild(f)}d?b.removeAttribute("disabled"):b.setAttribute("disabled","disabled")},getArea:function(b,c,d){a.jsonp({url:b,args:c,onComplete:function(a){var b={};a.code===1&&(b=i.fishData(a.data));d&&d(b)},onFail:function(a){}})},clear:function(a){var b=a.options;for(var c=b.length-1;c>0;c--)a.removeChild(b[c])},fishData:function(a){var b={};for(var c in a){var d=a[c];for(var e in d)b[e]=d[e]}return b},reset:function(a){var b=e.map,d=function(a){var e=b[a];c[e].disabled="disabled";i.clear(c[e]);b[e]&&d(e)};d(a)}},j={init:function(){i.init();j.bind()},bind:function(){if(c)for(var b in c){if(b==e.list[e.list.length-1])continue;a.addEvent(c[b],"change",i.change)}},destory:function(){for(var b in c)a.removeEvent(c[b],"change",i.change)}};j.init();g.destory=j.destory;return g}});
$.register("pl.content.miniTab.source.addsSelect",function(a){return function(b){function k(c){var d=FM.getURL().path,e=a.queryToJson(FM.getURL().query),f="cityid="+c;f=encodeURIComponent(f);var g=b.id+"_filter";e[g]=f;var h=a.jsonToQuery(e);FM.setState(d+"?"+h+"#_0")}var c,d=a.lib.kit.extra.selectArea,e=a.lib.kit.extra.language,f=a.delegatedEvent(b),g=e('<div class="layer_sel_location"><div class="sel_box clearfix"><span class="WB_select S_bg2 S_line1"><span class="S_txt1" node-type="province_box">ç/ç´è¾å¸</span> <em class="W_ficon ficon_arrow_down_lite S_ficon">g</em><select name="province" node-type="province_select" style = "position: absolute;left: 0;width: 108px;height: 28px;z-index: 9999; background: #fff; border: 0;opacity:0;filter:alpha(opacity=0);cursor:pointer;"></select></span><span href="#1" class="WB_select S_bg2 S_line1"><span class="S_txt1" node-type="city_box">ä¸é</span> <em class="W_ficon ficon_arrow_down_lite S_ficon">g</em><select name="city" node-type="city_select" style = "position: absolute;left: 0;width: 108px;height: 28px;   z-index: 9999; background: #fff; border: 0;opacity:0;filter:alpha(opacity=0);cursor:pointer;"></select></span><span class="btn_bed"  action-type="btn_bed"><a href="#" class="W_btn_a">#L{ç¡®è®¤}</a></span></div><div node-type="near_box" class="list_box clearfix"><div class="list_title">#L{æè¿è®¿é®}</div><div class="list_item"><ul class="ul_item W_fb clearfix"></ul></div></div><div node-type="line" class="disline S_line2"></div><div node-type="list_box" class="list_box clearfix"><div class="list_title">#L{ç­é¨åå¸}</div><div class="list_item"><ul class="ul_item clearfix"></ul></div></div></div>'),h=e("#L{ä¸é}"),i="weibo_page_dis_area",j;f.add("addsSelect","click",function(b){function s(){setTimeout(function(){n.innerHTML=p.getElementsByTagName("option")[p.selectedIndex].innerHTML;o.innerHTML=r.getElementsByTagName("option")[r.selectedIndex].innerHTML})}var c=b.el,e;try{e=a.strToJson(decodeURIComponent(c.getAttribute("action-data")))}catch(f){e=[]}j&&j.hide();j=a.ui.bubble({showWithAni:"fadeInDown:fast",hideWithAni:"fadeOutUp:fast",autoRelease:!0,clickBlankToHide:!0}).setContent(g).show().beside(c,{pos:"bottom-right",appendTo:document.body});var l=j.getDomList().near_box,m=j.getDomList().list_box,n=j.getDomList().province_box,o=j.getDomList().city_box,p=j.getDomList().province_select,q=j.getDomList().line,r=j.getDomList().city_select;j.on("submit","click",function(a){j.hide();k(a.data.cityid)});a.addEvent(p,"change",s);a.addEvent(r,"change",s);j.on("hide",function(){j=null;a.removeEvent(p,"change",s);a.removeEvent(r,"change",s)});d({province:p,city:r},{text:h,value:"001"});var t;try{t=a.storage.get(i);t=a.strToJson(t);t[0].id;t[0].name}catch(f){t=[]}if(t&&t.length){var u=l.getElementsByTagName("ul"),v="";for(var w=0;w<t.length;w++)v=v+'<li class="item"><a href="javascript:void(0);" action-type="submit" action-data="cityid='+t[w].id+'" class="S_txt1">'+t[w].name+"</a></li>";u[0].innerHTML=v}else l.style.display="none";if(e&&e.length>0){var x=m.getElementsByTagName("ul"),y="";for(var w=0;w<e.length;w++)y=y+'<li class="item"><a href="javascript:void(0);" action-type="submit" action-data="cityid='+e[w].id+'" class="S_txt1">'+e[w].name+"</a></li>";x[0].innerHTML=y}else m.style.display="none";if(m.style.display==="none"||l.style.display==="none")q.style.display="none";j.on("btn_bed","click",function(){var b=p.value,c=r.value,d=!0;if(b==h){b="001000";d=!1}if(c==h){c=b+"000";d=!1}if(d){var e=p.getElementsByTagName("option")[p.selectedIndex].innerHTML,f=r.getElementsByTagName("option")[r.selectedIndex].innerHTML,g={name:f,id:c},l=["åäº¬","å¤©æ´¥","ä¸æµ·","éåº","é¦æ¸¯","æ¾³é¨"];for(var m=0;m<l.length;m++)e==l[m]&&(g={name:e,id:b+"000"});var n=STK.storage.get(i);try{n=a.strToJson(n);n[0].id;n[0].name}catch(o){n=[]}n.unshift(g);while(n.length>10)n.pop();STK.storage.set(i,a.jsonToStr(n))}k(c);j.hide()})});return{destroy:function(){f.destroy()}}}});
STK.register("pl.content.miniTab.source.init",function(a){var b=a.pl.content.album.source.picview,c=a.lib.kit.dom.children,d=a.lib.kit.extra.language;return function(e){function q(){e.innerHTML=""}a.core.dom.isNode(e)||a.log("[pl.content.miniTab.source.init]: node is not a Node!");var f={},g,h,i,j,k,l,m=a.delegatedEvent(e),n,o=[],p=a.pl.content.miniTab.source.addsSelect(e);a.foreach(a.sizzle("li[uid]",e),function(b,c){if(b.style.display==="none"){o.push(b);a.removeNode(b);b.style.display=""}});var r=function(){var d=a.sizzle("[action-type=choosePic]",e);if(d.length>0){var f=[],h=a.queryToJson(g.gallery[0].getAttribute("ajdata")||"");a.foreach(d,function(b,d){var e=c(b)[0],g=a.queryToJson(b.getAttribute("action-data")||"");f.push({title:e.title,smallSrc:e.src,bigSrc:decodeURIComponent(g.big_src)||e.src.replace("small","large"),index:g.index||d+1,link:decodeURIComponent(g.url),linktext:decodeURIComponent(g.url_name)})});var i={imgInfo:f,trans:a.conf.trans.gallery,transName:"getAlbumList",transData:h};l=b(i)}},s=function(){n=a.lib.follow.followButton({outer:e});a.custEvent.add(n,"change",function(b,c){if(c.state==="follow"){c=c.spec;a.foreach(a.sizzle("li[uid="+c.uid+"]",e),function(b){setTimeout(function(){var c=o.shift();if(c)a.replaceNode(c,b);else{a.removeNode(b);a.sizzle("li[uid]",e).length===0&&q()}},500)})}});g=a.builder(e).list;m.add("choosePic","click",function(a){l||r();l.show({index:a.data.page})});m.add("cancelauth","click",function(b){a.ui.confirm(d("#L{ç¡®è®¤åæ¶ææå}ï¼")).ok(function(){a.conf.trans.gallery.getTrans("cancelauth",{onSuccess:function(a){b.el.style.display="none"},onError:function(b){a.lib.dialog.ioError(b.code,b)}}).request(b.data)})});m.add("install","click",function(b){a.ui.confirm(d("#L{ç¡®è®¤å®è£å}ï¼")).ok(function(){a.conf.trans.gallery.getTrans("install",{onSuccess:function(c){var d=a.core.dom.dir(b.el,{expr:"li",dir:"parent"})[0];d&&(d.style.display="none")},onError:function(b){a.lib.dialog.ioError(b.code,b)}}).request(b.data)})});m.add("singleinstall","click",function(b){a.ui.confirm(d("#L{ç¡®è®¤å®è£å}ï¼")).ok(function(){a.conf.trans.gallery.getTrans("singleinstall",{onSuccess:function(c){var d=a.core.dom.dir(b.el,{expr:"li",dir:"parent"})[0];d&&(d.style.display="none");u.bpfilter()},onError:function(b){a.lib.dialog.ioError(b.code,b)}}).request(b.data)})});m.add("hide","click",function(b){a.conf.trans.gallery.getTrans("hideapp",{onSuccess:function(c){b.el.innerHTML=c.data.text||"";b.data.is_visible=c.data.is_visible;b.el.setAttribute("action-data",a.jsonToQuery(b.data))},onError:function(b){a.lib.dialog.ioError(b.code,b)}}).request(b.data)});if("more"in g&&"morelist"in g){h=g.more[0];i=g.morelist[0];j=h.parentNode;i&&document.body.appendChild(i);k=a.lib.kit.dom.hover({act:h,extra:[i],delay:300,onmouseover:function(){i.style.display="";a.addClassName(j,"W_arrow_turn");var b=a.position(h),c=h.offsetHeight,d=h.offsetWidth,e=i.offsetWidth;i&&a.setXY(i,{t:b.t+c+2,l:b.l-(e-d)})},onmouseout:function(){i.style.display="none";a.removeClassName(j,"W_arrow_turn")}})}},t=function(b){a.preventDefault();var c=a.core.dom.dir(b.el,{expr:'[node-type="followBtnBox"]',dir:"parent"})[0],f=a.queryToJson(c.getAttribute("action-data")),g=a.core.json.merge({},{uid:f.uid,refer_flag:"unfollow"});a.ui.confirm(d("#L{ç¡®è®¤è¦åæ¶å¯¹%sçå³æ³¨åï¼}",f.fnick),{OK:function(){a.conf.trans.relation.getTrans("unFollow",{onSuccess:function(c){var d=a.core.dom.dir(b.el,{expr:"li",dir:"parent"})[0];setTimeout(function(){var b=o.shift();if(b)a.replaceNode(b,d);else{a.removeNode(d);a.sizzle("li[uid]",e).length===0&&a.lib.kit.extra.refreshpl(e,{iereload:!0})}},100)},onError:function(b){a.lib.dialog.ioError(b.code,b)}}).request(f)}});return!1},u={delete_article:function(b){function c(c){a.conf.trans.longFeed.request("dellongfeed",{onSuccess:function(c){a.ui.tip("lite",{msg:d("#L{å é¤æå}"),timer:2e3}).on("hide",function(){var c=u.getItem(b.el);c&&a.removeNode(c);var d=a.sizzle("[node-type='article_list_item']",e).length;d==0&&u.bpfilter()})},onFail:function(b){a.lib.dialog.ioError(b.code,b)},onError:function(b){a.lib.dialog.ioError(b.code,b)}},c)}confirmHandle=a.ui.tip("confirm",{msg:d("#L{ç¡®å®è¦å é¤æ­¤æç« ï¼}"),okCallback:function(){c(b.data)}});confirmHandle.setLayerXY(b.el);confirmHandle.aniShow();return!1},getItem:function(b){var c=a.lib.kit.dom.parentElementBy(b,e,function(a){if(a.getAttribute("node-type")=="article_list_item")return!0});return c},bpfilter:function(a){var b=a||FM.getURL().href;$CONFIG.bigpipe==="true"?FM.setState(b,!0):window.location.href=a},no_interest:function(b){a.conf.trans.gallery.getTrans("noInterest",{onSuccess:function(b){var c=a.lib.kit.dom.parentElementBy(el,e,function(a){if(a.getAttribute("node-type")=="userItem")return!0}),d=b.data.html;if(!!c&&!!d){a.insertHTML(c,d,"BeforeBegin");a.removeNode(c);var f=a.sizzle("[node-type='userItem']",e).length;f==0&&u.bpfilter()}},onError:function(b){a.lib.dialog.ioError(b.code,b)},onFail:function(b){a.lib.dialog.ioError(b.code,b)}}).request(b.data)}};m.add("cancel_follow_single","click",t);m.add("delarticlelist","click",u.delete_article);m.add("no_interest","click",u.no_interest);s();var v=function(){i&&(i.style.display="none");k&&k.destroy();l&&l.destroy();p&&p.destroy();m.destroy();n.destroy()};f.destroy=v;return f}});
FM.register("pl.content.miniTab.index",function(b,c){return a.pl.content.miniTab.source.init(a.E(b),c)})});
