!function(a,b){"function"==typeof define&&define.amd&&"function"==typeof require&&require.version?define("swfobject/vhs",b):a.swfobject=b()}(this,function(){var a=function(){function b(){if(!S){try{var a=L.getElementsByTagName("body")[0].appendChild(r("span"));a.parentNode.removeChild(a)}catch(b){return}S=!0;for(var c=O.length,d=0;c>d;d++)O[d]()}}function c(a){S?a():O[O.length]=a}function d(a){if(typeof K.addEventListener!=D)K.addEventListener("load",a,!1);else if(typeof L.addEventListener!=D)L.addEventListener("load",a,!1);else if(typeof K.attachEvent!=D)s(K,"onload",a);else if("function"==typeof K.onload){var b=K.onload;K.onload=function(){b(),a()}}else K.onload=a}function e(){N?f():g()}function f(){var a=L.getElementsByTagName("body")[0],b=r(E);b.setAttribute("type",H);var c=a.appendChild(b);if(c){var d=0;!function(){if(typeof c.GetVariable!=D){var e=c.GetVariable("$version");e&&(e=e.split(" ")[1].split(","),V.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)])}else if(10>d)return d++,void setTimeout(arguments.callee,10);a.removeChild(b),c=null,g()}()}else g()}function g(){var a=P.length;if(a>0)for(var b=0;a>b;b++){var c=P[b].id,d=P[b].callbackFn,e={success:!1,id:c};if(V.pv[0]>0){var f=q(c);if(f)if(!t(P[b].swfVersion)||V.wk&&V.wk<312)if(P[b].expressInstall&&i()){var g={};g.data=P[b].expressInstall,g.width=f.getAttribute("width")||"0",g.height=f.getAttribute("height")||"0",f.getAttribute("class")&&(g.styleclass=f.getAttribute("class")),f.getAttribute("align")&&(g.align=f.getAttribute("align"));for(var l={},m=f.getElementsByTagName("param"),n=m.length,o=0;n>o;o++)"movie"!=m[o].getAttribute("name").toLowerCase()&&(l[m[o].getAttribute("name")]=m[o].getAttribute("value"));j(g,l,c,d)}else k(f),d&&d(e);else v(c,!0),d&&(e.success=!0,e.ref=h(c),d(e))}else if(v(c,!0),d){var p=h(c);p&&typeof p.SetVariable!=D&&(e.success=!0,e.ref=p),d(e)}}}function h(a){var b=null,c=q(a);if(c&&"OBJECT"==c.nodeName)if(typeof c.SetVariable!=D)b=c;else{var d=c.getElementsByTagName(E)[0];d&&(b=d)}return b}function i(){return!T&&t("6.0.65")&&(V.win||V.mac)&&!(V.wk&&V.wk<312)}function j(a,b,c,d){T=!0,z=d||null,A={success:!1,id:c};var e=q(c);if(e){"OBJECT"==e.nodeName?(x=l(e),y=null):(x=e,y=c),a.id=I,(typeof a.width==D||!/%$/.test(a.width)&&parseInt(a.width,10)<310)&&(a.width="310"),(typeof a.height==D||!/%$/.test(a.height)&&parseInt(a.height,10)<137)&&(a.height="137"),L.title=L.title.slice(0,47)+" - Flash Player Installation";var f=V.ie&&V.win?"ActiveX":"PlugIn",g="MMredirectURL="+K.location.toString().replace(/&/g,"%26")+"&MMplayerType="+f+"&MMdoctitle="+L.title;if(typeof b.flashvars!=D?b.flashvars+="&"+g:b.flashvars=g,V.ie&&V.win&&4!=e.readyState){var h=r("div");c+="SWFObjectNew",h.setAttribute("id",c),e.parentNode.insertBefore(h,e),e.style.display="none",function(){4==e.readyState?e.parentNode.removeChild(e):setTimeout(arguments.callee,10)}()}m(a,b,c)}}function k(a){if(V.ie&&V.win&&4!=a.readyState){var b=r("div");a.parentNode.insertBefore(b,a),b.parentNode.replaceChild(l(a),b),a.style.display="none",function(){4==a.readyState?a.parentNode.removeChild(a):setTimeout(arguments.callee,10)}()}else a.parentNode.replaceChild(l(a),a)}function l(a){var b=r("div");if(V.win&&V.ie)b.innerHTML=a.innerHTML;else{var c=a.getElementsByTagName(E)[0];if(c){var d=c.childNodes;if(d)for(var e=d.length,f=0;e>f;f++)1==d[f].nodeType&&"PARAM"==d[f].nodeName||8==d[f].nodeType||b.appendChild(d[f].cloneNode(!0))}}return b}function m(a,b,c){var d,e=q(c);if(V.wk&&V.wk<312)return d;if(e)if(typeof a.id==D&&(a.id=c),V.ie&&V.win){var f="";for(var g in a)a[g]!=Object.prototype[g]&&("data"==g.toLowerCase()?b.movie=a[g]:"styleclass"==g.toLowerCase()?f+=' class="'+a[g]+'"':"classid"!=g.toLowerCase()&&(f+=" "+g+'="'+a[g]+'"'));var h="";for(var i in b)b[i]!=Object.prototype[i]&&(h+='<param name="'+i+'" value="'+b[i]+'" />');e.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>",Q[Q.length]=a.id,d=q(a.id)}else{var j=r(E);j.setAttribute("type",H);for(var k in a)a[k]!=Object.prototype[k]&&("styleclass"==k.toLowerCase()?j.setAttribute("class",a[k]):"classid"!=k.toLowerCase()&&j.setAttribute(k,a[k]));for(var l in b)b[l]!=Object.prototype[l]&&"movie"!=l.toLowerCase()&&n(j,l,b[l]);e.parentNode.replaceChild(j,e),d=j}return d}function n(a,b,c){var d=r("param");d.setAttribute("name",b),d.setAttribute("value",c),a.appendChild(d)}function o(a){var b=q(a);b&&"OBJECT"==b.nodeName&&(V.ie&&V.win?(b.style.display="none",function(){4==b.readyState?p(a):setTimeout(arguments.callee,10)}()):b.parentNode.removeChild(b))}function p(a){var b=q(a);if(b){for(var c in b)"function"==typeof b[c]&&(b[c]=null);b.parentNode.removeChild(b)}}function q(a){var b=null;try{b=L.getElementById(a)}catch(c){}return b}function r(a){return L.createElement(a)}function s(a,b,c){a.attachEvent(b,c),R[R.length]=[a,b,c]}function t(a){var b=V.pv,c=a.split(".");return c[0]=parseInt(c[0],10),c[1]=parseInt(c[1],10)||0,c[2]=parseInt(c[2],10)||0,b[0]>c[0]||b[0]==c[0]&&b[1]>c[1]||b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]?!0:!1}function u(a,b,c,d){if(!V.ie||!V.mac){var e=L.getElementsByTagName("head")[0];if(e){var f=c&&"string"==typeof c?c:"screen";if(d&&(B=null,C=null),!B||C!=f){var g=r("style");g.setAttribute("type","text/css"),g.setAttribute("media",f),B=e.appendChild(g),V.ie&&V.win&&typeof L.styleSheets!=D&&L.styleSheets.length>0&&(B=L.styleSheets[L.styleSheets.length-1]),C=f}V.ie&&V.win?B&&typeof B.addRule==E&&B.addRule(a,b):B&&typeof L.createTextNode!=D&&B.appendChild(L.createTextNode(a+" {"+b+"}"))}}}function v(a,b){if(U){var c=b?"visible":"hidden";S&&q(a)?q(a).style.visibility=c:u("#"+a,"visibility:"+c)}}function w(a){var b=/[\\\"<>\.;]/,c=null!=b.exec(a);return c&&typeof encodeURIComponent!=D?encodeURIComponent(a):a}{var x,y,z,A,B,C,D="undefined",E="object",F="Shockwave Flash",G="ShockwaveFlash.ShockwaveFlash",H="application/x-shockwave-flash",I="SWFObjectExprInst",J="onreadystatechange",K=window,L=document,M=navigator,N=!1,O=[e],P=[],Q=[],R=[],S=!1,T=!1,U=!0,V=function(){var a=typeof L.getElementById!=D&&typeof L.getElementsByTagName!=D&&typeof L.createElement!=D,b=M.userAgent.toLowerCase(),c=M.platform.toLowerCase(),d=/win/.test(c?c:b),e=/mac/.test(c?c:b),f=/webkit/.test(b)?parseFloat(b.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,g=!1,h=[0,0,0],i=null;if(typeof M.plugins!=D&&typeof M.plugins[F]==E)i=M.plugins[F].description,!i||typeof M.mimeTypes!=D&&M.mimeTypes[H]&&!M.mimeTypes[H].enabledPlugin||(N=!0,g=!1,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),h[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),h[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),h[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof K.ActiveXObject!=D)try{var j=new ActiveXObject(G);j&&(i=j.GetVariable("$version"),i&&(g=!0,i=i.split(" ")[1].split(","),h=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(k){}return{w3:a,pv:h,wk:f,ie:g,win:d,mac:e}}();!function(){V.w3&&((typeof L.readyState!=D&&"complete"==L.readyState||typeof L.readyState==D&&(L.getElementsByTagName("body")[0]||L.body))&&b(),S||(typeof L.addEventListener!=D&&L.addEventListener("DOMContentLoaded",b,!1),V.ie&&V.win&&(L.attachEvent(J,function(){"complete"==L.readyState&&(L.detachEvent(J,arguments.callee),b())}),K==top&&!function(){if(!S){try{L.documentElement.doScroll("left")}catch(a){return void setTimeout(arguments.callee,0)}b()}}()),V.wk&&!function(){return S?void 0:/loaded|complete/.test(L.readyState)?void b():void setTimeout(arguments.callee,0)}(),d(b)))}(),function(){V.ie&&V.win&&window.attachEvent("onunload",function(){for(var b=R.length,c=0;b>c;c++)R[c][0].detachEvent(R[c][1],R[c][2]);for(var d=Q.length,e=0;d>e;e++)o(Q[e]);for(var f in V)V[f]=null;V=null;for(var g in a)a[g]=null;a=null})}()}return{registerObject:function(a,b,c,d){if(V.w3&&a&&b){var e={};e.id=a,e.swfVersion=b,e.expressInstall=c,e.callbackFn=d,P[P.length]=e,v(a,!1)}else d&&d({success:!1,id:a})},getObjectById:function(a){return V.w3?h(a):void 0},embedSWF:function(a,b,d,e,f,g,h,k,l,n,o){var p={success:!1,id:b};V.w3&&!(V.wk&&V.wk<312)&&a&&b&&d&&e&&f?(o&&(S=!0),v(b,!1),c(function(){d+="",e+="";var c={};if(l&&typeof l===E)for(var o in l)c[o]=l[o];c.data=a,c.width=d,c.height=e;var q={};if(k&&typeof k===E)for(var r in k)q[r]=k[r];if(h&&typeof h===E)for(var s in h)typeof q.flashvars!=D?q.flashvars+="&"+s+"="+h[s]:q.flashvars=s+"="+h[s];if(t(f)){var u=m(c,q,b);c.id==b&&v(b,!0),p.success=!0,p.ref=u}else{if(g&&i())return c.data=g,void j(c,q,b,n);v(b,!0)}n&&n(p)})):n&&n(p)},switchOffAutoHideShow:function(){U=!1},ua:V,getFlashPlayerVersion:function(){return{major:V.pv[0],minor:V.pv[1],release:V.pv[2]}},hasFlashPlayerVersion:t,createSWF:function(a,b,c){return V.w3?m(a,b,c):void 0},showExpressInstall:function(a,b,c,d){V.w3&&i()&&j(a,b,c,d)},removeSWF:function(a){V.w3&&o(a)},createCSS:function(a,b,c,d){V.w3&&u(a,b,c,d)},addDomLoadEvent:c,addLoadEvent:d,getQueryParamValue:function(a){var b=L.location.search||L.location.hash;if(b){if(/\?/.test(b)&&(b=b.split("?")[1]),null==a)return w(b);for(var c=b.split("&"),d=0;d<c.length;d++)if(c[d].substring(0,c[d].indexOf("="))==a)return w(c[d].substring(c[d].indexOf("=")+1))}return""},expressInstallCallback:function(){if(T){var a=q(I);a&&x&&(a.parentNode.replaceChild(x,a),y&&(v(y,!0),V.ie&&V.win&&(x.style.display="block")),z&&z(A)),T=!1}}}}();return a}),function(a){"use strict";var b=function(a,c,d){return 1===arguments.length?b.get(a):b.set(a,c,d)};b._document=document,b._navigator=navigator,b.defaults={path:"/"},b.get=function(a){return b._cachedDocumentCookie!==b._document.cookie&&b._renewCache(),b._cache[a]},b.set=function(c,d,e){return e=b._getExtendedOptions(e),e.expires=b._getExpiresDate(d===a?-1:e.expires),b._document.cookie=b._generateCookieString(c,d,e),b},b.expire=function(c,d){return b.set(c,a,d)},b._getExtendedOptions=function(c){return{path:c&&c.path||b.defaults.path,domain:c&&c.domain||b.defaults.domain,expires:c&&c.expires||b.defaults.expires,secure:c&&c.secure!==a?c.secure:b.defaults.secure}},b._isValidDate=function(a){return"[object Date]"===Object.prototype.toString.call(a)&&!isNaN(a.getTime())},b._getExpiresDate=function(a,c){switch(c=c||new Date,typeof a){case"number":a=new Date(c.getTime()+1e3*a);break;case"string":a=new Date(a)}if(a&&!b._isValidDate(a))throw new Error("`expires` parameter cannot be converted to a valid Date instance");return a},b._generateCookieString=function(a,b,c){a=a.replace(/[^#$&+\^`|]/g,encodeURIComponent),a=a.replace(/\(/g,"%28").replace(/\)/g,"%29"),b=(b+"").replace(/[^!#$&-+\--:<-\[\]-~]/g,encodeURIComponent),c=c||{};var d=a+"="+b;return d+=c.path?";path="+c.path:"",d+=c.domain?";domain="+c.domain:"",d+=c.expires?";expires="+c.expires.toUTCString():"",d+=c.secure?";secure":""},b._getCookieObjectFromString=function(c){for(var d={},e=c?c.split("; "):[],f=0;f<e.length;f++){var g=b._getKeyValuePairFromCookieString(e[f]);d[g.key]===a&&(d[g.key]=g.value)}return d},b._getKeyValuePairFromCookieString=function(a){var b=a.indexOf("=");return b=0>b?a.length:b,{key:decodeURIComponent(a.substr(0,b)),value:decodeURIComponent(a.substr(b+1))}},b._renewCache=function(){b._cache=b._getCookieObjectFromString(b._document.cookie),b._cachedDocumentCookie=b._document.cookie},b._areEnabled=function(){var a="cookies.js",c="1"===b.set(a,1).get(a);return b.expire(a),c},b.enabled=b._areEnabled(),"function"==typeof define&&define.amd&&"function"==typeof require&&require.version?define("cookies/vhs",function(){return b}):"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=b),exports.Cookies=b):window.Cookies=b}(),function(a,b){"object"==typeof exports?module.exports=b(require("jQuery"),require("swfobject"),require("Cookies")):"function"==typeof define&&define.amd&&"function"==typeof require&&require.version?define("vhs",["jquery/nyt","swfobject/vhs","cookies/vhs"],b):a.VHS=b(a.jQuery,a.swfobject,a.Cookies)}(this,function(a,b,c){"use strict";var d=a;if("undefined"==typeof d)throw new Error("VHS requires jQuery");var e=function(a){return{ready:function(b){var c,f,g=d(a);g.one("vhs:ready",function(a,c){b(c)}),g.each(function(a,b){var g=d(b);f=g.data("ready"),f&&(c=e.findInstance(g),g.trigger("vhs:ready",c))})},loaded:function(b){var c,f,g=d(a);g.one("vhs:loaded",function(a,c){b(c)}),g.each(function(a,b){var g=d(b);f=g.data("loaded"),f&&(c=e.findInstance(g),g.trigger("vhs:loaded",c))})}}};return e.config={allowMultiplePlayers:!1},e.api=e.api||{},e.html=e.html||{},e.configs=e.configs||{},function(a){function b(a){return d[a]}function c(a){return a=null==a?"":String(a),a&&(e.lastIndex=0,e.test(a))?a.replace(e,b):a}this.VHS=a;var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},e=/[&<>"'`]/g,f=window._||{};f.escape=f.escape||c,this.VHS=this.VHS||{},this.VHS.templates=this.VHS.templates||{},this.VHS.templates.cover=function(a){{var b,c="";f.escape,Array.prototype.join}return c+='<div class="vhs-player-cover-background vhs-'+(null==(b=a.mode)?"":b)+'-cover"></div>\n',"mobile"===a.mode&&(c+='\n    <i class="vhs-icon-play vhs-cover-play-button vhs-mobile-play-button"></i>\n'),c+='\n<div class="vhs-media-action-overlay vhs-'+(null==(b=a.mode)?"":b)+'-cover">\n    <i class="vhs-icon-play vhs-cover-play-button"></i>\n\n    ',"clean"!==a.mode&&(c+='\n    <div class="vhs-metadata-container">\n\n        ',"duration"===a.mode?c+='\n            <section class="vhs-metadata">\n                <span class="vhs-video-cta">Play Video</span>\n                <span class="vhs-video-length">'+(null==(b=a.data.duration)?"":b)+"</span>\n            </section>\n        ":("article"===a.mode||"offsite"===a.mode||"mobile"===a.mode)&&(c+='\n            <section class="vhs-metadata">\n                ',"mobile"!==a.mode&&(c+="\n                    ",a.data.channelName&&(c+='\n                        <span class="vhs-channel-name">'+(null==(b=a.data.channelName)?"":b)+"</span>\n                    "),c+="\n                    ",a.data.showName&&(c+='\n                        <span class="vhs-show-name">'+(null==(b=a.data.showName)?"":b)+"</span>\n                    "),c+="\n                "),c+="\n                ",c+=a.data.byline?'\n                    <span class="vhs-byline">'+(null==(b=a.data.byline)?"":b)+"</span>\n                ":'\n                    <span class="vhs-byline vhs-no-byline"></span>\n                ',c+='\n                <span class="vhs-video-cta">Play Video</span>\n                <span class="vhs-video-length">'+(null==(b=a.data.duration)?"":b)+'</span>\n            </section>\n            <section class="vhs-video-title">\n                <span>'+(null==(b=a.data.headline)?"":b)+"</span>\n            </section>\n        "),c+="\n    </div>\n    "),c+="\n\n    ","offsite"===a.mode&&(c+='\n        <i class="vhs-icon-times-video-logo vhs-embedded-player-cover-logo"></i>\n    '),c+="\n\n</div>\n"},this.VHS.templates.endSlate=function(a){{var b,c="";f.escape,Array.prototype.join}return c+='<div class="vhs-end-slate-background"></div>\n<div data-id="'+(null==(b=a.data.id)?"":b)+'" class="vhs-player-header" data-vhs-et-module="end-slate" data-vhs-et-region="end-slate-header">\n    <div class="vhs-video-title">\n        <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button" data-vhs-et-name="link-logo"></a>\n        ',a.data.byline||(a.titleClasses="vhs-no-byline"),c+='\n        <div class="vhs-video-title-wrapper '+(null==(b=a.titleClasses)?"":b)+'">\n            <p class="vhs-data"> '+(null==(b=a.data.headline)?"":b)+'</p>\n            <span class="vhs-byline"><span>'+(null==(b=a.data.byline)?"":b)+'</span></span>\n        </div>\n    </div>\n</div>\n<div class="vhs-end-slate" data-vhs-et-module="end-slate" data-vhs-et-region="end-slate-share">\n    <div class="vhs-social">\n        <button class="vhs-anchor-button vhs-social-icon-wrapper vhs-replay-button" data-vhs-et-name="replay">\n            <h2>Replay</h2>\n            <i class="vhs-icon-replay"></i>\n        </button>\n        ',a.url||(c+='\n        <a class="vhs-anchor-button vhs-social-icon-wrapper" target="_blank" href="'+(null==(b=a.url||a.data.domain+a.data.seo_url)?"":b)+'" data-vhs-et-name="link-logo">\n            <h2>Times Video</h2>\n            <i class="vhs-anchor-button vhs-icon-times-video-logo"></i>\n        </a>\n        '),c+='\n        <button class="vhs-anchor-button vhs-share-item vhs-social-icon-wrapper" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook">\n            <h2>Share</h2>\n            <i class="vhs-icon-facebook"></i>\n        </button>\n        <button class="vhs-anchor-button vhs-share-item vhs-social-icon-wrapper" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter">\n            <h2>Tweet</h2>\n            <i class="vhs-icon-twitter"></i>\n        </button>\n    </div>\n</div>\n'},this.VHS.templates.pauseSlate=function(a){{var b,c="";f.escape,Array.prototype.join}if(c+='<div class="vhs-player-header-background"></div>\n<div data-id="'+(null==(b=a.data.id)?"":b)+'" class="vhs-player-header vhs-pause-slate vhs-top-banner">\n    <div class="vhs-video-title">\n        <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button '+(null==(b=a.view.logoClasses)?"":b)+'"></a>\n        ',a.data.byline||(a.view.titleClasses+=" vhs-no-byline"),c+='\n        <div class="vhs-video-title-wrapper '+(null==(b=a.view.titleClasses)?"":b)+'">\n\n            ',!a.linkUrl||a.isOnSite&&a.isEmbeddedOnly?c+='\n                <p class="vhs-data"> '+(null==(b=a.data.headline)?"":b)+" </p>\n            ":(c+='\n                <p class="vhs-data"> <a href="'+(null==(b=a.linkUrl)?"":b)+'?action=click&amp;gtype=vhs&amp;version=vhs-heading&amp;module=vhs&amp;region=title-area" ',a.isOnSite||(c+=' target="_blank" '),c+=" > "+(null==(b=a.data.headline)?"":b)+" </a> </p>\n            "),c+='\n\n            <span class="vhs-byline">\n                <span>'+(null==(b=a.data.byline)?"":b)+"</span>\n            </span>\n        </div>\n    </div>\n    ",a.showShareTools&&(c+='\n    <div class="vhs-tools '+(null==(b=a.view.shareClasses)?"":b)+'" data-vhs-et-module="video-player-share" data-vhs-et-region="playback-share">\n        <div class="vhs-social">\n            <button class="vhs-share-item vhs-icon-facebook" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook"></button>\n            <button class="vhs-share-item vhs-icon-twitter" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter"></button>\n        </div>\n        <div class="vhs-embed">\n            <button class="vhs-share-menu vhs-icon-embed" alt="embed" data-vhs-et-name="share-embed"></button>\n        </div>\n    </div>\n    '),c+='\n</div>\n<div class="vhs-share-module-overlay"></div>\n',a.showShareTools){c+='\n<div class="vhs-share-module" data-vhs-et-module="video-player-share" data-vhs-et-region="playback-extended-share">\n    <div class="vhs-share-module-arrow"></div>\n    <div class="vhs-share-module-inner">\n        <div class="vhs-times-video-link vhs-share-section">\n            <div class="vhs-icon-group">\n                <span>Times Video</span>\n                <a href="http://www.nytimes.com/video" target="_blank" class="vhs-times-logo vhs-icon-times-video-logo vhs-anchor-button"></a>\n            </div>\n        </div>\n        <div class="vhs-share-sidebar">\n            <div class="vhs-social vhs-share-section">\n                <div class="vhs-icon-group">\n                    <span>Share</span>\n                    <button class="vhs-share-item vhs-icon-facebook" alt="facebook" data-share-handler="popup" data-share-name="facebook" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-facebook"></button>\n                </div>\n                <div class="vhs-icon-group">\n                    <span>Tweet</span>\n                    <button class="vhs-share-item vhs-icon-twitter" alt="twitter" data-share-handler="urlshortener" data-share-name="twitter" data-share-url="'+(null==(b=a.url)?"":b)+'" data-vhs-et-name="share-twitter"></button>\n                </div>\n            </div>\n            <div class="vhs-embed vhs-share-section">\n                <div class="vhs-icon-group">\n                    <label for="vhs-embed-form">Embed</label>\n                    <button class="vhs-icon-embed" alt="embed"></button>\n                    <div class="vhs-embed-form-container">\n                        ';var d=a.data.article_data&&a.data.article_data.id?"&amp;articleId="+a.data.article_data.id:"";c+="\n                        ";var e=!d&&a.data.blogpost_data&&a.data.blogpost_data.url?"&amp;blogPostUrl="+a.data.blogpost_data.url:"";c+='\n                        <input\n                            onClick="this.setSelectionRange(0, this.value.length)"\n                            id="vhs-embed-form"\n                            type="text"\n                            value="<iframe width=&quot;480&quot; height=&quot;373&quot; frameborder=&quot;0&quot; scrolling=&quot;no&quot; allowfullscreen=&quot;true&quot; marginheight=&quot;0&quot; marginwidth=&quot;0&quot; id=&quot;nyt_video_player&quot; title=&quot;New York Times Video - Embed Player&quot; src=&quot;http://graphics8.nytimes.com/bcvideo/1.0/iframe/embed.html?videoId='+(null==(b=a.data.id)?"":b)+"&amp;playerType=embed"+(null==(b=d)?"":b)+(null==(b=e)?"":b)+'&quot;></iframe>">\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n'}return c+="\n\n\n"}}.call({},e),e.util={extend:function(a){function b(){}return Object.create?Object.create(a):(b.prototype=a,new b)},checkFlashSupport:function(){var a="undefined"!=typeof b?b.getFlashPlayerVersion():0;return a&&a.major>=10},checkHtmlSupport:function(){var a=document.createElement("video"),b=document.createElement("canvas").getContext,c=!1;return a&&b&&(c=!0),c},supportWebM:function(){var a='video/webm; codecs="vp8, vorbis"';return this.canPlayType(a)},supportH264:function(){var a='video/mp4; codecs="avc1.42E01E"',b='video/mp4; codecs="avc1.42E01E, mp4a.40.2"';return this.canPlayType(a)||this.canPlayType(b)},canPlayType:function(a){var b=document.createElement("video");return"function"==typeof b.canPlayType&&""!==b.canPlayType(a)},getDeviceType:function(){for(var a=null,b=navigator.userAgent.toLowerCase(),c=[["android_chrome","(android.*chrome)"],["android_firefox","(android.*firefox)"],["android_legacy","(android )(2|3)"],["android_ics","(android 4.0)"],["android_jellybean","(android 4.)(1|2|3)"],["android_kitkat","(android 4.4)"],["ie_mobile","(windows phone os).*(iemobile)"],["ipad","ipad"],["kindle","kindle"],["iphone","iphone"],["other mobile","(touchpad|blackberry|opera mobi)"]],d=0;d<c.length;d++){var e=new RegExp(c[d][1]),f=b.match(e);null!==f&&(a=c[d][0])}return a||"desktop"},isIphone:function(){var a=e.util.getNavigator(),b=a.userAgent.toLowerCase(),c=b.match("iphone"),d=null!==c?!0:!1;return d},isIpad:function(){var a=e.util.getNavigator(),b=a.userAgent.toLowerCase();return-1!==b.indexOf("ipad")?!0:!1},isIE9:function(){var a=e.util.getNavigator(),b=a.userAgent.toLowerCase();return-1!==b.indexOf("msie 9")?!0:!1},isAndroid:function(){var a=e.util.getNavigator(),b=a.userAgent.toLowerCase();return-1!==b.indexOf("android")?!0:!1},isSafari:function(){var a=e.util.getNavigator(),b=a.userAgent.toLowerCase();return-1!==b.indexOf("safari")&&-1===b.indexOf("chrome")?!0:!1},supportsAds:function(){return"android_legacy"===e.util.getDeviceType()||"android_ics"===e.util.getDeviceType()?!1:!0},supportsAutoplay:function(){return!(e.util.isAndroid()||e.util.isIpad()||e.util.isIphone())},getErrorMessage:function(a,b,c){var d,e=a;if(d=b&&"vod"===b?"This video is currently unavailable.":"This stream is not currently available.",e&&e.code)switch(e.code){case e.MEDIA_ERR_ABORTED:d="The video playback was aborted. Please refresh to resume playback.";break;case e.MEDIA_ERR_NETWORK:d="The video connection was lost. Please refresh to resume playback.";break;case e.MEDIA_ERR_DECODE:d="There was a video playback error. Please refresh to resume playback.";break;case e.MEDIA_ERR_SRC_NOT_SUPPORTED:d=c?"This video is currently unavailable. Please refresh to try again.":"The video format is currently not supported in this browser."}return d},getDocument:function(){return document},getNavigator:function(){return navigator},getHost:function(){return window.location.host},getParentHostname:function(){try{return parent.window.location.hostname}catch(a){return""}},getReferrer:function(){return document.referrer},getSupportedType:function(a){return"flash"===a||this.supportH264()?"mp4":this.supportWebM()?"webm":void 0},supportsFullscreen:function(){return e.api.Fullscreen.prototype._canRequestFullScreen()},zeptoInUse:function(){return"object"==typeof d.zepto},jqueryInUse:function(){return"string"==typeof d.fn.jquery},getScript:function(a){e.util.jqueryInUse()?(a.dataType="script",d.ajax(a)):e.util.getScriptNative(a)},getScriptNative:function(a){var b,c,d,f,g,h,i=document.createElement("script");b=a.url,c=a.success,d=a.error,i.type="text/javascript",i.src=b,i.onload=function(){"function"==typeof c&&c()},i.onerror=function(a){"function"==typeof d&&d(a)},h=e.util.getDocument(),f=h.getElementsByTagName("head")[0],f?f.appendChild(i):(g=h.getElementsByTagName("body")[0],g&&g.appendChild(i))},normalizeUnit:function(a){var b="px";return"string"==typeof a&&(a=-1===a.indexOf("%")&&-1===a.indexOf("px")?[a,b].join(""):a),a},inIframe:function(){try{return window.self!==window.top}catch(a){return!0}},isOnNYTDomain:function(){var a,b=this.getReferrer();return this.inIframe()&&b&&-1===b.indexOf(".nytimes.com")?!1:this.inIframe()||(a=this.getParentHostname(),-1!==a.indexOf(".nytimes.com"))?!0:!1},seekStringToSeconds:function(a){var b,c=0,d=this.getUrlParameterByName("t"),e={h:3600,m:60,s:1};return isNaN(d)?(b=d.match(/[0-9]+[hms]+/g)||[],b.forEach(function(a){if(a){var b=a[a.length-1],d=parseInt(a.slice(0,a.length-1),10);c+=d*e[b]}}),c):Number(d)},getCurrentURL:function(){return window.location.href},getUrlParameterByName:function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&#]"+a+"=([^&#]*)"),c=b.exec(this.getCurrentURL());return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},getEnvFromHost:function(){var a=e.util.getHost()||"",b="production";return"localhost"===a?b="localhost":-1!==a.indexOf(".dev.")?b="development":(-1!==a.indexOf(".stg.")||-1!==a.indexOf(".sbx."))&&(b="staging"),b}},e.api.Logger=function(a){this.debug=a.options.debug,this.canConsole=a.options.debug&&window.console},e.api.Logger.prototype={log:function(){this.canConsole&&window.console.log(arguments)},info:function(){this.canConsole&&window.console.info(arguments)},warn:function(){this.canConsole&&window.console.warn(arguments)},error:function(){this.canConsole&&window.console.error(arguments)}},e.plugin=function(a,b,c){var d=c||!1,f=e.api._plugins||{};return f[a]={enable:d,proto:b},e.api._plugins=f,f},e.api.Plugins=function(a){this.player=a,this._plugins=e.api._plugins,this._pluginInstances=[],this.register()},e.api.Plugins.prototype.register=function(){var a,b,c=this,d=this.player.options,e=function(){this._player=c.player,this._container=c.player.container,this._data=c.player._data,this._options=c.player.options,this._logger=c.player.logger};for(a in this._plugins)(d[a]===!0||this._plugins[a].enable===!0&&d[a]!==!1)&&(e.prototype=this._plugins[a].proto,b=new e,b._name=a,this._pluginInstances.push(b),"function"==typeof b._initialize&&b._initialize(),this.listeners(b))},e.api.Plugins.prototype.reload=function(){var a,b;for(a in this._pluginInstances)b=this._pluginInstances[a],b._data=this.player._data},e.api.Plugins.prototype.listeners=function(a){var b=function(b,c){"function"==typeof a[c]&&this.player.on(e.api.events[b],function(b){a[c](b)})},c={READY:"_ready",LOADED:"_loaded",PLAY:"_play",PAUSE:"_pause",MUTE:"_mute",SEEKED:"_seeked",ENDED:"_ended",PLAYING:"_playing",AD_STARTED:"_ad_started",AD_COMPLETED:"_ad_completed",AD_PAUSED:"_ad_paused",AD_RESUMED:"_ad_resumed",AD_SKIPPED:"_ad_skipped",GO_FULLSCREEN:"_go_fullscreen",EXIT_FULLSCREEN:"_exit_fullscreen",PROGRESS:"_progress",TIME_UPDATE:"_time_update",LOAD_START:"_loadstart",ERROR:"_error",HD_ON:"_hd_on",HD_OFF:"_hd_off",SHOW_CONTROLS:"_show_controls",HIDE_CONTROLS:"_hide_controls",RENDERED:"_rendered",TRACKING_EVENT:"_tracking_event",RENDITION_NOT_FOUND:"_rendition_not_found"};for(var d in c)c.hasOwnProperty(d)&&b.call(this,d,c[d])},e.plugin("webtrends",{_initialize:function(){this.utils=e.util,this.tracked=!1,this.firstPlay=!0,this.trackingHistory=[],this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1},getId:function(){if(this._data||this._options.id){var a=this._data?this._data.id:this._options.id;return a}return this._logger.warn("VHS::PLUGIN::WEBTRENDS:: ID is not defined"),!1},getName:function(){if(this._data||this._options.name){var a=this._data?this._data.headline:this._options.name;return a}return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: NAME is optional <video data-setup=\'{"name: "name_video"}\'></video>'),!1},getCategory:function(){var a;if(this._data)this._data.section&&(a=this._data.section.content);else{if(!this._options.category)return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: CATEGORY is optional <video data-setup=\'{"category: "category_video"}\'></video>'),!1;a=this._options.category}return a},getSeries:function(){var a="";if(this._data)this._data.contentSeries&&(a=this._data.contentSeries.name);else{if(!this._options.series)return this._logger.warn('VHS::PLUGIN::WEBTRENDS:: SERIES is optional <video data-setup=\'{"series: "series_video"}\'></video>'),!1;a=this._options.series}return a},getParams:function(a){var b=["DCS.dcssip","www.nytimes.com","DCS.dcsuri","/video/"+this.getName()+"/"+a.action+".html","WT.ti","Video "+this.getName()+" "+a.ti,"WT.cg_n","Video","WT.videoCategory",this.getCategory(),"WT.videoEvent",a.event,"WT.videoLoad",a.load,"WT.videoName",this.getName(),"WT.z_gpt","Multimedia","WT.z_gpst","Video","WT.z_gpsst","Video-"+a.gpsst,"WT.z_vid",this.getId(),"WT.z_vpt",this._player.getPlayerType()+"|"+this.utils.getDeviceType(),"WT.z_vft",this.getSeries(),"WT.z_dcsm",1];return a.z_vaud&&"Audio"===a.action&&b.push("WT.z_vaud",a.z_vaud),b},track:function(a){if("undefined"!=typeof window.dcsMultiTrack){if(this._logger.info("VHS::PLUGIN::WEBTRENDS::",a),window.dcsMultiTrack.apply(this,a),this.trackingHistory.length>0){for(var b=0,c=this.trackingHistory.length;c>b;b++)window.dcsMultiTrack.apply(this,this.trackingHistory[b]);this.trackingHistory=[]}}else this.trackingHistory.push(a)},_play:function(){if(!this.tracked){var a,b={action:"Play",event:"play",gpsst:"Play"};this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(b.ti=this._options.autoPlayNext?"Play":"PlayStart",b.load="auto",this.firstPlay=!1):this.firstPlay?(b.ti="PlayStart",b.load="user",this.firstPlay=!1):this._options.userInitiatedNext?(b.ti="Play",b.load="user"):this.videoCompleted&&!this.adStarted&&this.mediaChanged?(b.ti="Play",b.load="auto"):this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?(b.ti="Play",b.load="auto"):(b.ti="Play",b.load="user"),a=this.getParams(b),this.track(a),this.tracked=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1}},_mute:function(a){var b;b=this.getParams(a?{action:"Audio",event:"AudioOff",load:"null",gpsst:"Audio",ti:"Audio",z_vaud:"Off"}:{action:"Audio",event:"AudioOn",load:"null",gpsst:"Audio",ti:"Audio",z_vaud:"On"}),this.track(b)},_ended:function(){
var a=this.getParams({action:"Finish",event:"finish",load:"null",gpsst:"Play",ti:"FinishStop"});this.track(a),this.tracked=!1,this.videoCompleted=!0},_go_fullscreen:function(){var a=this.getParams({action:"GoBig",event:"Go Big",load:"null",gpsst:"Play",ti:"GoBig"});this.track(a)},_exit_fullscreen:function(){var a=this.getParams({action:"GoSmall",event:"Go Small",load:"null",gpsst:"Play",ti:"GoSmall"});this.track(a)},_ad_started:function(){this.adStarted=!0},_ad_completed:function(){this.adCompleted=!0},_ad_skipped:function(){this.adCompleted=!0},_loadstart:function(){this.tracked=!1,this.mediaChanged=!0}},!0),e.plugin("comscore",{_initialize:function(){this.tracked=!1},loadLibrary:function(a){var b=("https:"===document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com/beacon.js";e.util.getScript({url:b,success:a,dataType:"script"})},getParams:function(a){var b=this._player.adPlaying()?"09":"02",c={c1:1,c2:"3005403",c3:"",c4:"",c5:b};return this._logger.log("VHS::PLUGIN::COMSCORE::",c),c},track:function(){var a=this.getParams();"undefined"!=typeof COMSCORE&&COMSCORE.beacon?COMSCORE.beacon(a):this.loadLibrary(function(){"undefined"!=typeof COMSCORE&&COMSCORE.beacon&&COMSCORE.beacon(a)})},_playing:function(){this.tracked||(this.track(),this.tracked=!0)},_ended:function(){this.tracked=!1},_ad_started:function(){this.track()},_loadstart:function(){this.tracked=!1}},!0),e.plugin("eventTracker",{_initialize:function(){this.util=e.util,this.ETEvents={USER_PLAY:"user-play",MID_STREAM_PLAY:"mid-stream-play",AUTO_PLAY_NEXT:"auto-play-next",AUTO_PLAY_START:"auto-play-start",VIDEO_COMPLETE:"video-complete",PAUSE:"pause",UNPAUSE:"unpause",GO_FULLSCREEN:"go-fullscreen",EXIT_FULLSCREEN:"exit-fullscreen",MUTED:"muted",UNMUTED:"unmuted",SKIP_AD:"skip-ad",AD_START:"ad-start",AD_COMPLETE:"ad-complete",PLAYER_LOAD:"player-load",PERCENT_25_VIEWED:"percent-25-viewed",PERCENT_50_VIEWED:"percent-50-viewed",PERCENT_75_VIEWED:"percent-75-viewed",SEEK:"seek",AD_PAUSE:"ad-pause",AD_RESUME:"ad-resume",MEDIA_ERROR:"media-error",HD_ON:"hd-on",HD_OFF:"hd-off",VIDEO_TIME_TO_START:"video-time-to-start",CONVIVA_NOT_INITIALIZED:"conviva-not-initialized",CONVIVA_NOT_INITIALIZED_YET:"conviva-not-initialized-yet",CONVIVA_LOAD_FAILURE:"conviva-library-load-failure",CONVIVA_INIT_FAILURE:"conviva-library-init-failure",CONVIVA_LOAD_TIME:"conviva-library-load-time",QOS_LOAD_FAILURE:"qos-library-load-failure",RENDITION_NOT_FOUND:"rendition-not-found",FW_ADMANAGER_LOAD_ERROR:"fw-admanager-load-error",FW_AD_MANAGER_LOAD_TIMEOUT:"fw-ad-manager-load-timeout",CHERRY_API_REQUEST_ERROR:"cherry-api-request-error",OSMF_HLS_PLUGIN_LOAD_FAILED:"osmf-hls-plugin-load-failed",OSMF_QOS_PLUGIN_LOAD_FAILED:"osmf-qos-plugin-load-failed",OSMF_CONVIVA_PLUGIN_LOAD_FAILED:"osmf-conviva-plugin-load-failed",OSMF_CONVIVA_PLUGIN_INIT_FAILED:"osmf-conviva-plugin-init-failed",OSMF_CONVIVA_PLUGIN_INIT_TIMEOUT:"osmf-conviva-plugin-init-timeout",OSMF_FW_AD_REQUEST_TIMEOUT:"osmf-fw-ad-request-timeout",OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:"osmf-fw-ad-manager-load-timeout",OSMF_FW_AD_MANAGER_LOAD_TIME:"osmf-fw-ad-manager-load-time"},this.tracker=null,this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.firstPlay=!0,this.trackingHistory=[],this.adDurationCache=null,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.loadedTimestamp=null,this.endTimestamp=null,this.startUpTimeSent=!1,this.percentages={duration:0,calculate:function(a,b){if(!(1>a||b.length<1)){this.duration=a;for(var c=b.length-1;c>=0;c--)this[b[c]]=.01*a*b[c];this.ready=!0}}}},isAdPlaying:function(){return this._player&&this._player.adsController&&(this._player.adsController.isContentPlaying||this._player.adsController.isInitializing)},getId:function(){if(this._data||this._options.id){var a=this._data?this._data.id:this._options.id;return a}return this._logger.warn("VHS::PLUGIN::EVENTTRACKER:: ID is not defined"),!1},getName:function(){if(this._data||this._options.name){var a=this._data?this._data.headline:this._options.name;return a}return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: NAME is optional <video data-setup=\'{"name: "name_video"}\'></video>'),!1},getCategory:function(){var a;if(this._data)this._data.section&&(a=this._data.section.content);else{if(!this._options.category)return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: CATEGORY is optional <video data-setup=\'{"category: "category_video"}\'></video>'),!1;a=this._options.category}return a},getSeries:function(){var a="";if(this._data)this._data.contentSeries&&(a=this._data.contentSeries.name);else{if(!this._options.series)return this._logger.warn('VHS::PLUGIN::EVENTTRACKER:: SERIES is optional <video data-setup=\'{"series: "series_video"}\'></video>'),!1;a=this._options.series}return a},getPrimaryPlaylistId:function(){var a;return this._data?(this._data.playlist&&(a=this._data.playlist.id),a):(this._logger.warn("VHS::PLUGIN::EVENTTRACKER:: playlistId missing _data"),!1)},getCurrentVideoPosition:function(){var a,b=0;return this._element&&this._element.length>0&&this._element[0].currentTime&&(a="function"==typeof this._element[0].currentTime?this._element[0].currentTime():this._element[0].currentTime,b=Math.round(a)),b},getErrorCode:function(a){var b="";return this._element&&this._element.length>0&&this._element[0].error?b=this._element[0].error.code:a&&a.error&&a.error.code&&(b=a.error.code),b},getTrackingObject:function(a){var b=this,c={subject:"video-nytv",url:window.location.href||"",referrer:document.referrer||"",playerType:b._player.getPlayerType()||"",device:b.util.getDeviceType(),tech:b._player.getType(),event:a||"",playerVersion:e._version,playerUsage:b._options.usage||"",playerMode:b._options.mode,videoDeliveryMethod:b._options.live?"live":"vod"};switch(a){case this.ETEvents.USER_PLAY:case this.ETEvents.AUTO_PLAY_NEXT:case this.ETEvents.AUTO_PLAY_START:case this.ETEvents.VIDEO_COMPLETE:case this.ETEvents.PAUSE:case this.ETEvents.UNPAUSE:case this.ETEvents.PERCENT_25_VIEWED:case this.ETEvents.PERCENT_50_VIEWED:case this.ETEvents.PERCENT_75_VIEWED:case this.ETEvents.PLAYER_LOAD:case this.ETEvents.SEEK:case this.ETEvents.MEDIA_ERROR:case this.ETEvents.HD_ON:case this.ETEvents.HD_OFF:case this.ETEvents.QOS_LOAD_FAILURE:case this.ETEvents.CONVIVA_NOT_INITIALIZED:case this.ETEvents.CONVIVA_NOT_INITIALIZED_YET:case this.ETEvents.CONVIVA_LOAD_FAILURE:case this.ETEvents.CONVIVA_INIT_FAILURE:case this.ETEvents.CONVIVA_LOAD_TIME:case this.ETEvents.RENDITION_NOT_FOUND:case this.ETEvents.FW_ADMANAGER_LOAD_ERROR:case this.ETEvents.FW_AD_MANAGER_LOAD_TIMEOUT:case this.ETEvents.OSMF_HLS_PLUGIN_LOAD_FAILED:case this.ETEvents.OSMF_QOS_PLUGIN_LOAD_FAILED:case this.ETEvents.OSMF_CONVIVA_PLUGIN_LOAD_FAILED:case this.ETEvents.OSMF_CONVIVA_PLUGIN_INIT_FAILED:case this.ETEvents.OSMF_CONVIVA_PLUGIN_INIT_TIMEOUT:case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME:c=this.addBaseVideoProps(c),c=this.addVideoProps(c);break;case this.ETEvents.GO_FULLSCREEN:case this.ETEvents.EXIT_FULLSCREEN:case this.ETEvents.MUTED:case this.ETEvents.UNMUTED:case this.ETEvents.VIDEO_TIME_TO_START:case this.ETEvents.OSMF_FW_AD_REQUEST_TIMEOUT:c=this.addBaseVideoProps(c),c=this.addVideoProps(c),this.isAdPlaying()&&(c=this.addAdProps(c));break;case this.ETEvents.SKIP_AD:case this.ETEvents.AD_START:case this.ETEvents.AD_COMPLETE:case this.ETEvents.AD_PAUSE:case this.ETEvents.AD_RESUME:c=this.addBaseVideoProps(c),c=this.addAdProps(c)}return c},addVideoProps:function(a){var b=a;return b.videoFranchise=this.getSeries(),b.videoDuration=this._player.getDuration(),b.videoSection=this.getCategory(),b.videoSubSection="",b.videoPrimaryPlaylistId=this.getPrimaryPlaylistId(),b.videoTimeOfEvent=this.getCurrentVideoPosition(),b},addBaseVideoProps:function(a){var b=a;return b.videoId=this.getId(),b.videoName=this.getName(),b.videoType=this.isAdPlaying()?"ad":"video",b},addAdProps:function(a){var b=a;return this.adDurationCache=null===this.adDurationCache?this._player.adDuration():this.adDurationCache,b.adPosition="preroll",b.adDuration=Math.round(this.adDurationCache),b},track:function(a){if(this._logger.info("VHS::PLUGIN::EVENTTRACKER::",a),this.tracker)this.tracker.track(a);else if("undefined"!=typeof window.NYTD&&window.NYTD.EventTracker){if(this.tracker=new window.NYTD.EventTracker,this.trackingHistory.length>0){for(var b=this.trackingHistory.length,c=b-1;c>=0;c--)this.tracker.track(this.trackingHistory[c]);this.trackingHistory=[]}this.tracker.track(a)}else this.trackingHistory.push(a)},videoStartUpTime:function(){this.startUpTimeSent=!0;var a=this.getTrackingObject(this.ETEvents.VIDEO_TIME_TO_START),b=this.endTimestamp,c=this.loadedTimestamp,d=this._player?this._player.playerStartTimestamp:null;b&&c&&d&&(a.videoTimeToStartFromLoaded=b.getTime()-c.getTime(),a.videoTimeToStartFromInit=b.getTime()-d.getTime(),this.track(a))},_loadstart:function(){this._logger.info("VHS::PLUGIN::EVENTTRACKER::LOADSTART"),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.mediaChanged=!0},_play:function(){var a={};this.tracked?this.paused&&!this._player.hdRenditionChanging&&(a=this.getTrackingObject(this.ETEvents.UNPAUSE),this.track(a),this.paused=!1):(this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(a=this.getTrackingObject(this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this._options.autoPlayNext?this.ETEvents.AUTO_PLAY_NEXT:this.ETEvents.AUTO_PLAY_START),this.firstPlay=!1,this.startUpTimeSent||(this.endTimestamp=new Date,this.videoStartUpTime())):a=this.getTrackingObject(this._options.userInitiatedNext?this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this.ETEvents.USER_PLAY:this.videoCompleted&&!this.adStarted&&this.mediaChanged?this.ETEvents.AUTO_PLAY_NEXT:this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?this.ETEvents.AUTO_PLAY_NEXT:this._player.startupSeek?this.ETEvents.MID_STREAM_PLAY:this.ETEvents.USER_PLAY),this.track(a),this.tracked=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.startUpTimeSent=!0)},_pause:function(){if(this._player&&(this._options.live||this._player.getDuration()>0)&&!this._player.hdRenditionChanging){var a=this.getTrackingObject(this.ETEvents.PAUSE);this.track(a),this.paused=!0}},_seeked:function(){if(!this._player.hdRenditionChanging){var a=this.getTrackingObject(this.ETEvents.SEEK);this.track(a)}},_mute:function(a){var b;b=this.getTrackingObject(a?this.ETEvents.MUTED:this.ETEvents.UNMUTED),this.track(b)},_go_fullscreen:function(){var a=this.getTrackingObject(this.ETEvents.GO_FULLSCREEN);this.track(a)},_exit_fullscreen:function(){var a=this.getTrackingObject(this.ETEvents.EXIT_FULLSCREEN);this.track(a)},_ended:function(){var a=this.getTrackingObject(this.ETEvents.VIDEO_COMPLETE);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.videoCompleted=!0},_ad_started:function(){var a;this.adDurationCache=null,a=this.getTrackingObject(this.ETEvents.AD_START),this.track(a),this.adStarted=!0,this.startUpTimeSent||!this._options.autoplay||this._options.userInitiatedPlay||(this.endTimestamp=new Date,this.videoStartUpTime())},_ad_completed:function(){var a=this.getTrackingObject(this.ETEvents.AD_COMPLETE);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0},_ad_skipped:function(){var a=this.getTrackingObject(this.ETEvents.SKIP_AD);this.track(a),this.tracked=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0},_ad_paused:function(){var a=this.getTrackingObject(this.ETEvents.AD_PAUSE);this.track(a)},_ad_resumed:function(){var a=this.getTrackingObject(this.ETEvents.AD_RESUME);this.track(a)},_hd_on:function(){var a=this.getTrackingObject(this.ETEvents.HD_ON);this.track(a)},_hd_off:function(){var a=this.getTrackingObject(this.ETEvents.HD_OFF);this.track(a)},_loaded:function(){this._logger.info("VHS::PLUGIN::EVENTTRACKER::LOADED");var a=this.getTrackingObject(this.ETEvents.PLAYER_LOAD);this.track(a),this.loadedTimestamp=new Date},_error:function(a){var b=this.getTrackingObject(this.ETEvents.MEDIA_ERROR);b.errorCode=this.getErrorCode(a),this.track(b)},_time_update:function(a){var b=this._player.getDuration(),c=Math.round(parseInt(a,10)),d=Math.round(parseInt(b,10));this.percentages.ready&&this.percentages.duration==d||this.percentages.calculate(d,[25,50,75]);var e={};c>0&&(c>=this.percentages[25]&&!this.tracked25Percent?(e=this.getTrackingObject(this.ETEvents.PERCENT_25_VIEWED),this.track(e),this.tracked25Percent=!0):c>=this.percentages[50]&&!this.tracked50Percent?(e=this.getTrackingObject(this.ETEvents.PERCENT_50_VIEWED),this.track(e),this.tracked50Percent=!0):c>=this.percentages[75]&&!this.tracked75Percent&&(e=this.getTrackingObject(this.ETEvents.PERCENT_75_VIEWED),this.track(e),this.tracked75Percent=!0))},_rendition_not_found:function(a){var b=this.getTrackingObject(this.ETEvents.RENDITION_NOT_FOUND);this.track(b)},_tracking_event:function(a){var b;if(a&&a.data&&a.data.name)switch(a.data.name){case this.ETEvents.CONVIVA_NOT_INITIALIZED:this.track(this.getTrackingObject(this.ETEvents.CONVIVA_NOT_INITIALIZED));break;case this.ETEvents.FW_ADMANAGER_LOAD_ERROR:b=this.getTrackingObject(this.ETEvents.FW_ADMANAGER_LOAD_ERROR),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.CHERRY_API_REQUEST_ERROR:b=this.getTrackingObject(this.ETEvents.CHERRY_API_REQUEST_ERROR),b.videoId=this.getId(),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.QOS_LOAD_FAILURE:b=this.getTrackingObject(this.ETEvents.QOS_LOAD_FAILURE),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.CONVIVA_LOAD_FAILURE:b=this.getTrackingObject(this.ETEvents.CONVIVA_LOAD_FAILURE),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"",this.track(b);break;case this.ETEvents.CONVIVA_INIT_FAILURE:b=this.getTrackingObject(this.ETEvents.CONVIVA_INIT_FAILURE),b.code=a.data.code?a.data.code:"",b.message=a.data.message?a.data.message:"",this.track(b);break;case this.ETEvents.CONVIVA_LOAD_TIME:b=this.getTrackingObject(this.ETEvents.CONVIVA_LOAD_TIME),b.loadtime=a.data.loadtime?a.data.loadtime:-1,this.track(b);break;case this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME:b=this.getTrackingObject(this.ETEvents.OSMF_FW_AD_MANAGER_LOAD_TIME),b.loadtime=a.data.loadtime?a.data.loadtime:-1,this.track(b);break;default:this.track(this.getTrackingObject(a.data.name))}},_rendered:function(a){this._element=this._player.element,this.bind()},trackDom:function(a){var b=a.data("vhsEtName"),c=a.closest("[data-vhs-et-module]").data("vhsEtModule")||"default-module",e=a.closest("[data-vhs-et-region]").data("vhsEtRegion")||c,f={action:"click",region:e,module:c,eventName:b,version:"video",pgType:"video-player"},g=this._getCanonicalUrl(),h={subject:"module-interactions",assetUrl:g,moduleData:JSON.stringify(f),sourceApp:d('meta[name="sourceApp"]').attr("content")||"nytv"};this.track(h)},bind:function(){var a=this;this._container.on("click","[data-vhs-et-name]",function(b){a.trackDom(d(this))})},_getCanonicalUrl:function(){var a,b=d('link[rel="canonical"]').attr("href");return(!b||b.length<1)&&(a=document.location.origin,a||(a=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),b=a+document.location.pathname),b}},!0),e.plugin("tagx",{_initialize:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.trackingHistory=[],this.paused=!1,this.firstPlay=!0,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.loadedTimestamp=null,this.endTimestamp=null,this.startUpTimeSent=!1,this.adDurationCache=null,this.events={PLAYER_LOAD:"player-load",VIDEO_LOAD:"video-load",USER_PLAY:"user-play",MID_STREAM_PLAY:"mid-stream-play",AUTO_PLAY_NEXT:"auto-play-next",AUTO_PLAY_START:"auto-play-start",VIDEO_COMPLETE:"video-complete",PAUSE:"pause",RESUME:"resume",PERCENT_25_VIEWED:"percent-25-viewed",PERCENT_50_VIEWED:"percent-50-viewed",PERCENT_75_VIEWED:"percent-75-viewed",SEEK:"seek",GO_FULLSCREEN:"go-fullscreen",EXIT_FULLSCREEN:"exit-fullscreen",MUTED:"muted",UNMUTED:"unmuted",HD_ON:"hd-on",HD_OFF:"hd-off",SKIP_AD:"skip-ad",AD_START:"ad-start",AD_PAUSE:"ad-pause",AD_RESUME:"ad-resume",AD_COMPLETE:"ad-complete",MEDIA_ERROR:"media-error",VIDEO_TIME_TO_START:"video-time-to-start",CONVIVA_NOT_INITIALIZED:"conviva-not-initialized",CONVIVA_NOT_INITIALIZED_YET:"conviva-not-initialized-yet",CONVIVA_LOAD_FAILURE:"conviva-library-load-failure",CONVIVA_INIT_FAILURE:"conviva-library-init-failure",CONVIVA_LOAD_TIME:"conviva-library-load-time",QOS_LOAD_FAILURE:"qos-library-load-failure",RENDITION_NOT_FOUND:"rendition-not-found",FW_ADMANAGER_LOAD_ERROR:"fw-admanager-load-error",FW_AD_MANAGER_LOAD_TIMEOUT:"fw-ad-manager-load-timeout",CHERRY_API_REQUEST_ERROR:"cherry-api-request-error",OSMF_HLS_PLUGIN_LOAD_FAILED:"osmf-hls-plugin-load-failed",OSMF_QOS_PLUGIN_LOAD_FAILED:"osmf-qos-plugin-load-failed",OSMF_CONVIVA_PLUGIN_LOAD_FAILED:"osmf-conviva-plugin-load-failed",OSMF_CONVIVA_PLUGIN_INIT_FAILED:"osmf-conviva-plugin-init-failed",OSMF_CONVIVA_PLUGIN_INIT_TIMEOUT:"osmf-conviva-plugin-init-timeout",OSMF_FW_AD_REQUEST_TIMEOUT:"osmf-fw-ad-request-timeout",OSMF_FW_AD_MANAGER_LOAD_TIMEOUT:"osmf-fw-ad-manager-load-timeout",OSMF_FW_AD_MANAGER_LOAD_TIME:"osmf-fw-ad-manager-load-time"},this.video_type={VIDEO:"video",AD:"ad"},this.videoConfig={videoType:this.video_type.VIDEO,module:"video-player"},this.adConfig={videoType:this.video_type.AD,module:"video-player"}},track:function(a,b,c){var d=["interaction","tagx-event-video"],e=this.getTrackingData(a,b,c);if(window.TAGX){if(window.TAGX.EventProxy.trigger(a,e,d),this.trackingHistory.length>0){for(var f=this.trackingHistory.length,g=f-1;g>=0;g--){var h=this.trackingHistory[g];window.TAGX.EventProxy.trigger(h.name,h.data,h.interaction)}this.trackingHistory=[]}}else this.trackingHistory.push({name:a,data:e,interaction:d})},getTrackingData:function(a,b,c){var e=b.module||"video-player",f=b.region||"",g=b.action||"",h=b.videoType||this.video_type.VIDEO,i=a===this.events.VIDEO_COMPLETE?"completed":this._player.isPaused()?"paused":"playing",j={module:e,version:this._player.getPlayerType()||"unknown",state:i,contentCollection:this._player.getCategory(),region:f,action:g,contentPlacement:"0",contentId:this._player.getVideoId(),eventName:a,eventTimestamp:(new Date).getTime(),mData:d.extend({videoName:this._player.getTitle()},c)};return"video-player"===e&&(j=this.addVideoData(j,h)),j},addVideoData:function(a,b){return a.mData.device=e.util.getDeviceType(),a.mData.playerMode=this._options.mode,a.mData.playerType=this._player.getPlayerType()||"",a.mData.playerUsage=this._options.usage||"",a.mData.playerVersion=e._version,a.mData.tech=this._player.getType(),a.mData.videoDeliveryMethod=this._options.live?"live":"vod",a.mData.videoDuration=this._player.getDuration(),a.mData.videoFranchise=this._player.getSeries(),a.mData.videoPrimaryPlaylistId=this._player.getPrimaryPlaylistId(),a.mData.videoSection=this._player.getCategory(),a.mData.videoSubSection="",a.mData.videoTimeOfEvent=this._player.getCurrentTime(),a.mData.videoType=b,b===this.video_type.AD&&(a.mData.adPosition="preroll",this.adDurationCache=null===this.adDurationCache?this._player.adDuration():this.adDurationCache,a.mData.adDuration=Math.round(this.adDurationCache)),a},getErrorCode:function(a){var b="";return this._element&&this._element.length>0&&this._element[0].error?b=this._element[0].error.code:a&&a.error&&a.error.code&&(b=a.error.code),b},videoStartUpTime:function(){var a,b,c=this._player?this._player.playerStartTimestamp:null;this.startUpTimeSent=!0,this.endTimestamp&&this.loadedTimestamp&&c&&(a=this._player.adPlaying()?this.adConfig:this.videoConfig,b={videoTimeToStartFromLoaded:this.endTimestamp.getTime()-this.loadedTimestamp.getTime(),videoTimeToStartFromInit:this.endTimestamp.getTime()-c.getTime()},this.track(this.events.VIDEO_TIME_TO_START,a,b))},_loaded:function(){this._logger.info("VHS::PLUGIN::TAGX::LOADED"),this.track(this.events.PLAYER_LOAD,this.videoConfig),this.loadedTimestamp=new Date},_loadstart:function(){this._logger.info("VHS::PLUGIN::TAGX::LOADSTART"),this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.paused=!1,this.mediaChanged=!0,this.track(this.events.VIDEO_LOAD,this.videoConfig)},_play:function(){var a=this.events.USER_PLAY;this.trackedPlay?this.paused&&!this._player.hdRenditionChanging&&this.track(this.events.RESUME,this.videoConfig):(this._options.autoplay&&this.firstPlay&&!this._options.userInitiatedPlay?(a=this._player.startupSeek?this.events.MID_STREAM_PLAY:this._options.autoPlayNext?this.events.AUTO_PLAY_NEXT:this.events.AUTO_PLAY_START,this.startUpTimeSent||(this.endTimestamp=new Date,this.videoStartUpTime())):a=this._options.userInitiatedNext?this.events.USER_PLAY:this.videoCompleted&&!this.adStarted&&this.mediaChanged?this.events.AUTO_PLAY_NEXT:this.videoCompleted&&this.adStarted&&this.adCompleted&&this.mediaChanged?this.events.AUTO_PLAY_NEXT:this._player.startupSeek?this.events.MID_STREAM_PLAY:this.events.USER_PLAY,this.trackedPlay=!0,this.firstPlay=!1,this.mediaChanged=!1,this.videoCompleted=!1,this.adStarted=!1,this.adCompleted=!1,this.startUpTimeSent=!0,this.track(a,this.videoConfig)),this.paused=!1},_pause:function(){this._player&&(this._options.live||this._player.getDuration()>0)&&!this._player.hdRenditionChanging&&(this.paused=!0,this.track(this.events.PAUSE,this.videoConfig))},_ended:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.videoCompleted=!0,this.track(this.events.VIDEO_COMPLETE,this.videoConfig)},_time_update:function(a){var b=Math.round(parseInt(a,10)),c=Math.round(parseInt(this._player.getDuration(),10));if(!(1>c||1>b)){var d,e=.25*c,f=.5*c,g=.75*c;b>0&&(b>=e&&f>b&&!this.tracked25Percent?(d=this.events.PERCENT_25_VIEWED,this.tracked25Percent=!0):b>=f&&g>b&&!this.tracked50Percent?(d=this.events.PERCENT_50_VIEWED,this.tracked50Percent=!0):b>=g&&!this.tracked75Percent&&(d=this.events.PERCENT_75_VIEWED,this.tracked75Percent=!0),d&&this.track(d,this.videoConfig))}},_seeked:function(){this._player.hdRenditionChanging||this.track(this.events.SEEK,this.videoConfig)},_mute:function(a){var b=a?this.events.MUTED:this.events.UNMUTED,c=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(b,c)},_go_fullscreen:function(){var a=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(this.events.GO_FULLSCREEN,a)},_exit_fullscreen:function(){var a=this._player.adPlaying()?this.adConfig:this.videoConfig;this.track(this.events.EXIT_FULLSCREEN,a)},_hd_on:function(){this.track(this.events.HD_ON,this.videoConfig)},_hd_off:function(){this.track(this.events.HD_OFF,this.videoConfig)},_ad_started:function(){this.adStarted=!0,this.adDurationCache=null,this.track(this.events.AD_START,this.adConfig),this.startUpTimeSent||!this._options.autoplay||this._options.userInitiatedPlay||(this.endTimestamp=new Date,this.videoStartUpTime())},_ad_completed:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0,this.track(this.events.AD_COMPLETE,this.adConfig)},_ad_skipped:function(){this.trackedPlay=!1,this.tracked25Percent=!1,this.tracked50Percent=!1,this.tracked75Percent=!1,this.adCompleted=!0,this.track(this.events.SKIP_AD,this.adConfig)},_ad_paused:function(){this.track(this.events.AD_PAUSE,this.adConfig)},_ad_resumed:function(){this.track(this.events.AD_RESUME,this.adConfig)},_error:function(a){var b=this._player.adPlaying()?this.adConfig:this.videoConfig,c={};c.errorCode=this.getErrorCode(a),this.track(this.events.MEDIA_ERROR,b,c)},_rendition_not_found:function(){this.track(this.events.RENDITION_NOT_FOUND,this.videoConfig)},_tracking_event:function(a){var b={};if(a&&a.data&&a.data.name){switch(a.data.name){case this.events.FW_ADMANAGER_LOAD_ERROR:case this.events.QOS_LOAD_FAILURE:case this.events.CONVIVA_LOAD_FAILURE:b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"";break;case this.events.CHERRY_API_REQUEST_ERROR:b.videoId=this._player.getVideoId(),b.errorStatus=a.data.errorStatus?a.data.errorStatus:"",b.errorThrown=a.data.errorThrown?a.data.errorThrown:"";break;case this.events.CONVIVA_INIT_FAILURE:b.code=a.data.code?a.data.code:"",b.message=a.data.message?a.data.message:"";break;case this.events.CONVIVA_LOAD_TIME:case this.events.OSMF_FW_AD_MANAGER_LOAD_TIME:b.loadtime=a.data.loadtime?a.data.loadtime:-1}this.track(a.data.name,this.videoConfig,b)}},_rendered:function(){this._element=this._player.element,this.bindTaggedDomElement()},bindTaggedDomElement:function(){var a=this;this._container&&this._container.on("click","[data-vhs-et-name]",function(b){a.trackDomClickEvent(d(this))})},trackDomClickEvent:function(a){var b=a.data("vhsEtName"),c=a.closest("[data-vhs-et-module]").data("vhsEtModule")||"default-module",d=a.closest("[data-vhs-et-region]").data("vhsEtRegion")||c,e={module:c,videoType:this.video_type.VIDEO,region:d,action:"click"};this.track(b,e)}},!0),e.plugin("upt",{_initialize:function(){this.utils=e.util,this.body=d("body").first(),this.uptContainer=d(document.createElement("div")),this.hideElement(this.uptContainer),this.body.append(this.uptContainer),this.uptURL=[document.location.protocol,"//up.nytimes.com/"].join("");var a=window.dcsvid||d("meta[name='WT.dcsvid']").attr("content")||"";this.uid=encodeURIComponent(a),this.tracked=!1,this.trackedUptProgress=!1},getParams:function(a){var b=this._data&&this._data.publish_url?"http://www.nytimes.com"+encodeURIComponent(this._data.publish_url):"",c=encodeURIComponent(window.location.href),d=encodeURIComponent(a.event),e=encodeURIComponent(null!==a.value||"undefined"!==a.value&&""!==a.value?['{"',a.event,'":"',a.value,'"}'].join(""):""),f=["d=",0,"&m=","","&ui=",this.uid,"&u=",b,"&r=",c,"&e=",d,"&p=",e].join("");return f},track:function(a){if(!this._player.hasOwnProperty("adsController")||!this._player.adsController.isContentPlaying){this._logger.info("VHS::PLUGIN::UPT::",a);var b=d(document.createElement("img"));b.attr("src",this.uptURL+"?"+a),this.hideElement(b),this.uptContainer&&(this.uptContainer.empty(),this.uptContainer.append(b))}},hideElement:function(a){return a.css({width:"0px",height:"0px",border:"0px"}),a.hide(),a},_play:function(){if(!this.tracked){var a=this.getParams({event:"videoStart",value:""});this.track(a),this.tracked=!0}},_ended:function(){var a=this.getParams({event:"videoComplete",value:""});this.track(a),this.tracked=!1,this.trackedUptProgress=!1},_time_update:function(a){var b=this._player.getDuration(),c=Math.round(parseInt(a,10)),d=Math.round(parseInt(b,10)),e=Math.round(.75*d);if(c>0&&c===e&&!this.trackedUptProgress){var f=this.getParams({event:"videoWatched",value:"75%"});this.track(f),this.trackedUptProgress=!0}},_loadstart:function(){this.tracked=!1,this.trackedUptProgress=!1}},!0),e.plugin("playNext",{_initialize:function(){this.playlist=null,this.currentVideo=0},_ended:function(){var a=this;this.getPlaylistData(function(){var b=a.playlist.videos[a.currentVideo];a._data.id===b.id&&(a.currentVideo=a.currentVideo+1),a._options.poster="",a._player.load(b.id,!0),a.currentVideo=a.currentVideo+1})},getPlaylistData:function(a){var b=this;b.playlist?a():this._player.getData(this._data.playlist.id,"playlist",function(c){b.playlist=c,a()})}},!1),e.plugin("sharetools",{_initialize:function(){this.config={facebook:{name:"facebook",active:!0,postUrl:"http://www.facebook.com/sharer.php",shareParameters:{url:"u"},smid:"fb-share",width:655,height:430},twitter:{name:"twitter",active:!0,postUrl:"https://twitter.com/share",shareParameters:{url:"url",title:"text",related:"nytimes",via:"nytvideo"},smid:"tw-share",width:600,height:450}},this.bind(this._container),this._container.addClass("vhs-plugin-"+this._name)},openShareHandler:function(a,b,c){var e,f=d(a),g=f.data("shareName"),h=f.data("shareHandler"),i=f.data("shareUrl"),j=this[h],k=this.config[g],l=i?i:c.tiny_url||c.url;k&&(e=d.extend({},k,{shareUrl:l})),e=this.checkShareDataOverride(e,c),"function"==typeof j&&j.call(this,e,c)},checkShareDataOverride:function(a,b){return b.blogpost_data&&b.blogpost_data.url&&(a.shareUrl=b.blogpost_data.url,a.headline=b.blogpost_data.headline||""),b.article_data&&b.article_data.publish_url&&(a.shareUrl="http://www.nytimes.com"+b.article_data.publish_url,a.headline=b.article_data.headline||""),a},popup:function(a){var b=a.encoded?a.postUrl:a.postUrl+"?"+a.shareParameters.url+"="+encodeURIComponent(a.shareUrl);window.open(b,a.name+"Share","toolbar=0,status=0,height="+a.height+",width="+a.width+",scrollbars=yes,resizable=yes")},urlshortener:function(a,b){var c="",e=/[\?&]share_url=([^&#]*)/,f=e.exec(window.location.search),g=a.name,h="",i="http://www.nytimes.com/svc/bitly/shorten.jsonp",j=a.shareUrl,k=a.headline||b.headline||"";if(k&&(h+="&text="+encodeURIComponent(k)),a.shareParameters&&(a.shareParameters.related&&(h+="&related="+encodeURIComponent(a.shareParameters.related)),a.shareParameters.via&&(h+="&via="+encodeURIComponent(a.shareParameters.via))),j===b.tiny_url)return void this.popup(d.extend({},a,{postUrl:a.postUrl+"?url="+encodeURIComponent(b.tiny_url)+h,encoded:!0}));null!==f&&(c=decodeURIComponent(f[1].replace(/\+/g," ")));var l=['<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">',"<html><head>",'<script type="text/javascript" src="http://graphics8.nytimes.com/js/common.js"></script>','<script type="text/javascript">',"function loadShortUrl() {","var url;",'var ricoUrl = "',c,'".replace(/\\s/g, "");',"if (ricoUrl.length > 0) {","shortUrlRedirect(ricoUrl);","} else {","NYTD.jQuery.ajax({",'url: "',i,'",','dataType: "jsonp",','data: { "url" : "',j,'" },','jsonpCallback: "callback",',"cache: true","}).success(function(data, textStatus, jqXHR){","if (data && data.payload && data.payload.short_url) {","short_url = data.payload.short_url;","url = short_url;","}","shortUrlRedirect(url);","}).error(function(jqXHR, textStatus, errorThrown){","shortUrlRedirect(url);","});","}","};","function shortUrlRedirect(url) {",'window.location.href = "',a.postUrl,'?url=" + encodeURIComponent(url) + "',h,'";',"};","</script>","</head>",'<body onload="loadShortUrl();"></body></html>'].join(""),m=window.open("",g+"Share","toolbar=0,status=0,height="+a.height+",width="+a.width+",scrollbars=yes,resizable=yes");m.document.write(l),m.document.close()},bind:function(a){var b=this;a.on("click",".vhs-share-item[data-share-handler]",function(a){b.openShareHandler.call(b,this,a,b._data)}),a.on("click",".vhs-share-module-overlay",d.proxy(function(){e.util.jqueryInUse()&&a.find(".vhs-share-module, .vhs-share-module-overlay").fadeToggle(),a.find(".vhs-pause-slate, .nytd-player-controls").toggleClass("vhs-share-showing"),this._player.play()},b)),a.on("click",".vhs-share-menu",d.proxy(function(){this._player.pause(),e.util.jqueryInUse()&&a.find(".vhs-share-module, .vhs-share-module-overlay").fadeToggle().find("input").select().focus(),a.find(".vhs-pause-slate, .nytd-player-controls").toggleClass("vhs-share-showing")},b)),a.on("click",".vhs-icon-group span",function(){d(this).siblings("button").first().trigger("click");var a=d(this).siblings("a").first();a.length>0&&window.open(a.attr("href"),"_blank")})}},!0),e.plugin("endSlate",{shareToolsClass:"vhs-plugin-sharetools",el:null,template:e.templates.endSlate,
replayButtonClick:function(){this._player.seek(0),this._player.play()},canRender:function(){var a=this._player.options.playNext===!0,b=!a&&!!this._container&&this._container.length>0&&!!this._data&&this._container.hasClass(this.shareToolsClass);return null!==this.options&&"object"==typeof this.options&&b},renderSlate:function(){var a;this.canRender()&&(a=d.extend({},this.options,{data:this._data}),this.el=d('<div class="vhs-plugin-'+this._name+'" />'),this.el.html(this.template(a)),this._container.prepend(this.el))},removeSlate:function(){this.isVisible()&&(this.el.remove(),this.el=null)},isVisible:function(){return this.el&&this.el.length},_initialize:function(){var a=this._player.options[this._name];(a===!0||"true"===a)&&(a={}),this.options=a},_ready:function(){this.canRender()&&(this._container.addClass("vhs-plugin-"+this._name),this._container.on("click",".vhs-replay-button",d.proxy(this.replayButtonClick,this)))},_show_controls:function(){this.isVisible()&&this._player.modules&&this._player.modules.controls&&"function"==typeof this._player.modules.controls.hide&&this._player.modules.controls.hide(!0)},_play:function(){this.removeSlate()},_playing:function(){this.removeSlate()},_ad_started:function(){this.removeSlate()},_ended:function(){this.renderSlate()}},!0),e.plugin("controlsOverlay",{shareToolsClass:"vhs-plugin-sharetools",defaults:{mode:"clean"},template:e.templates.pauseSlate,renderContainer:function(){this.el=d('<div class="vhs-plugin-container-'+this._name+'" style="display: none;" />').prependTo(this._container),this.templateFn=this.options.template||this.template,this._container.addClass("vhs-plugin-"+this._name)},renderSlate:function(a){var b;this.isEnabled&&"function"==typeof this.templateFn&&"object"==typeof this._data&&(this.options.showShareTools=this.isValidShareUrl(),this.options.isOnSite=e.util.isOnNYTDomain(),this.options.linkUrl=this.getVideoLinkUrl(),this.options.isEmbeddedOnly=this.isEmbeddedOnly(),b=d.extend({},this.options,{view:this.viewSettings[this.options.mode],data:this._data}),this._player.options.shareOptions&&this._player.options.shareOptions.url&&(b.url=this._player.options.shareOptions.url),this.el.find(".vhs-pause-slate[data-id]").length||this.el.append(this.templateFn(b)),e.util.jqueryInUse()?this.el.show().find(".vhs-pause-slate, .vhs-player-header-background").stop(!0,!1).fadeTo(a.fadeArgs[0],a.fadeArgs[1]):this.el.show().find(".vhs-pause-slate, .vhs-player-header-background").css({opacity:a.fadeArgs[1]}),this.setupTimesVideoLinks())},removeSlate:function(a){var b,c=this;this.isEnabled&&(b=this.el.find(".vhs-pause-slate, .vhs-player-header-background, .vhs-share-module, .vhs-share-module-overlay"),e.util.jqueryInUse()?b.fadeTo(a.fadeArgs[0],a.fadeArgs[1],function(){c.el.find(".vhs-pause-slate").removeClass("vhs-share-showing"),c.el.empty()}):(b.css({opacity:a.fadeArgs[1]}),this.el.find(".vhs-pause-slate").removeClass("vhs-share-showing"),this.el.empty()))},createOptions:function(){var a=d.extend({},this.defaults,this._player.options[this._name]||{});return a.mode=e.util.isAndroid()||e.util.isIphone()?"clean":a.mode,a},isValidShareUrl:function(){var a=!1;return a=!this.isEmbeddedOnly(),this.options.url&&(a=!0),this._player.options.shareOptions&&this._player.options.shareOptions.url&&(a=!0),this._data.article_data&&this._data.article_data.publish_url&&(a=!0),this._data.blogpost_data&&this._data.blogpost_data.url&&(a=!0),a},isEmbeddedOnly:function(){return"object"==typeof this._data.playlist&&Object.getOwnPropertyNames(this._data.playlist).length>0?!1:!0},getVideoLinkUrl:function(){return this.isEmbeddedOnly()?this._data.article_data&&this._data.article_data.publish_url?"http://www.nytimes.com"+this._data.article_data.publish_url:this._data.blogpost_data&&this._data.blogpost_data.url?this._data.blogpost_data.url:null:this._data.domain+this._data.publish_url},setupTimesVideoLinks:function(){this._player.options.deeplinkingToTimesVideo?"titleandlogo"===this.getDeepLinkingType()?this.bindTitleAndLogo():this.bindPlayerArea():this.bindTitleAndLogo()},getDeepLinkingType:function(){var a,b,d=c.get("nytvhsdeeplinking");return d||(d=10*Math.random()>5?"titleandlogo":"playerarea",a=new Date,b=new Date(a.setMonth(a.getMonth()+1)),c.set("nytvhsdeeplinking",d,{expires:b})),d},bindTitleAndLogo:function(){var a=this,b=this.el.find(".vhs-video-title-wrapper .vhs-data a"),c=this.el.find(".vhs-player-header .vhs-times-logo");b.off("click"),b.one("click",d.proxy(function(b){b.preventDefault(),a.pauseAndRedirect("title-area")},this)),this.options.linkUrl&&(c.off("click"),c.one("click",d.proxy(function(b){b.preventDefault(),a.pauseAndRedirect("times-logo-area")},this)))},bindPlayerArea:function(){var a=this,b=this._player.container.find(".nytd-player-video-area");0===b.length&&(this._player.container.append('<div class="nytd-player-video-area"></div>'),b=this._player.container.find(".nytd-player-video-area")),b.addClass("nytd-clickable-area"),b.off(),b.one("click",function(){a.pauseAndRedirect("video-area")})},pauseAndRedirect:function(a){this._player.pause();var b=this.getRedirectUrl(a);window.open(b,"_blank")},getRedirectUrl:function(a){var b,c,d="?action=click&gtype=vhs&version=vhs-heading&module=vhs&region="+a;return this._player.options.deeplinkingToTimesVideo?(b="times-logo-area"===a||"title-area"===a?"&video-click-enabled=false":"&video-click-enabled=true",c=Math.round(this._player.getCurrentTime()),this.getVideoLinkUrl()+d+b+"&t="+c+"&cview=true"):"times-logo-area"===a?"http://nytimes.com/video":this.getVideoLinkUrl()+d},_initialize:function(){this.options=this.createOptions()},_rendered:function(){this.isEnabled=this._data&&"clean"!==this.options.mode&&"object"==typeof this.viewSettings[this.options.mode],this.isEnabled&&this._container.hasClass(this.shareToolsClass)&&this.renderContainer(),"clean"==this.options.mode&&this.destroy()},_show_controls:function(a){this._player.adPlaying()||this._player.isEnded()||this.renderSlate(a)},_hide_controls:function(a){this._player.adPlaying()||this._player.isEnded()||this.removeSlate(a)},_ad_started:function(){this.removeSlate({fadeArgs:[0,1]})},_ended:function(){this.removeSlate({fadeArgs:[0,1]})},destroy:function(){var a=function(){};this._show_controls=a,this._hide_controls=a,this._ad_started=a},viewSettings:{share:{logoClasses:"vhs-no-pipe",titleClasses:"vhs-invisible"},article:{logoClasses:"",titleClasses:""},offsite:{logoClasses:"",titleClasses:""}}},!0),e.plugin("stats",{_initialize:function(){this.stats=!1,this.videoStats={droppedFrames:0,decodedFrames:0,videoDecodedBytes:0,audioDecodedBytes:0,bitrate:0,mimetype:"",volume:100,videoId:0,dimensions:{width:0,height:0},videoResolution:{width:0,height:0},streamType:"http",bandwidth:0,buffered:0,currentTime:0}},_loaded:function(){this._player.element[0];this.videoStats.videoId=this._data?this._data.id:this._options.id||-1},_time_update:function(a){var b=this._player.element[0];this.videoStats.decodedFrames=b.webkitDecodedFrameCount,this.videoStats.droppedFrames=b.webkitDroppedFrameCount,this.videoStats.videoDecodedBytes=b.webkitVideoDecodedByteCount,this.videoStats.audioDecodedBytes=b.webkitAudioDecodedByteCount,this.videoStats.currentTime=a,this.videoStats.volume=b.volume,this.videoStats.buffered=b.buffered,this.videoStats.videoResolution={width:b.videoWidth,height:b.videoHeight},this.videoStats.dimensions={width:this._container.width(),height:this._container.width()}}},!1),e.plugin("vpaidUpdateAd",{_time_update:function(a){this._player.element.get(0)&&"function"==typeof this._player.element.get(0).updateAd&&this._player.element.get(0).updateAd({videoTime:a})}},!0),e.libraries=e.libraries||{},e.libraries.conviva={loading:!1,failed:!1,callbacks:[],checkForQueuedCallback:function(){if(e.libraries.conviva.callbacks.length>0){var a=e.libraries.conviva.callbacks.pop(),b=a.callback,c=a.context;"function"==typeof b&&"object"==typeof c&&b.apply(c)}},queuePlayback:function(a){e.libraries.conviva.callbacks=[{context:a,callback:a.play}]}},e.api.Conviva=function(a){this._player=a,this._options=a.options,this._logger=a.logger,this.listenersSetup=!1,this.LIBRARY_URL="http://livepassdl.conviva.com/ver/2.88.0.23377/LivePass.js",this.FLASH_PLUGIN_URL="https://livepassdl.conviva.com/OSMF/ConvivaOSMFPlugin_OSMF2_0_FP10_0.swf",this.CUSTOMER_ID="c3.NYTimes",this.SERVICE_URL="http://livepass.conviva.com",this._options.debugConviva&&"production"!==this._options.env&&(this.CUSTOMER_ID="c3.NYTimes-Test",this.SERVICE_URL="https://testonly.conviva.com"),this._options.conviva&&"function"==typeof this._player.getType&&"html5"===this._player.getType()&&this.initialize()},e.api.Conviva.prototype={initialize:function(){var a=this;this.utils=e.util,this.session=null,this.sessionInitialized=!1,"function"!=typeof Conviva||!Conviva.hasOwnProperty("LivePass")||Conviva.LivePass.ready||Conviva.LivePass.pending?this.loadConvivaLibrary(function(){a.convivaInitialize()}):this.convivaInitialize()},loadConvivaLibrary:function(a){var b,c=this;e.libraries.conviva.loading||(this.convivaLoadStartTimestamp=new Date,b=function(a,b,d){c&&c._player&&"function"==typeof c._player.trigger&&(c._player.trigger(e.api.events.TRACKING_EVENT,{data:{name:"conviva-library-load-failure",errorStatus:b||"",errorThrown:d||""}}),c.convivaFailure())},e.util.getScript({url:this.LIBRARY_URL,success:a,error:b,timeout:3e3,cache:!0,dataType:"script"}),e.libraries.conviva.loading=!0)},convivaInitialize:function(){var a=this;"function"==typeof Conviva&&Conviva.hasOwnProperty("LivePass")&&(Conviva.LivePass.toggleTraces(this._options.debug),Conviva.LivePass.init(this.SERVICE_URL,this.CUSTOMER_ID,function(b){a.livePassNotifier(b)}))},livePassNotifier:function(a){var b;a&&0===a.code?(this._logger.info("Conviva LivePass initialized successfully."),e.libraries.conviva.checkForQueuedCallback(),this.convivaLoadEndTimestamp=new Date,this.convivaLoadStartTimestamp&&(b=this.convivaLoadEndTimestamp.getTime()-this.convivaLoadStartTimestamp.getTime(),this._player.trigger(e.api.events.TRACKING_EVENT,{data:{name:"conviva-library-load-time",loadtime:b}}))):a&&Conviva.LivePass.ready?this._logger.info("Conviva LivePass post-initialization feedback.\n 	Code: "+a.code+";\n 	Message: "+a.message):a&&(this._logger.info("Conviva LivePass failed to initialize!\n 	Conviva metrics will not be captured! 	Code: "+a.code+"; 	Message: "+a.message),this._player.trigger(e.api.events.TRACKING_EVENT,{data:{name:"conviva-library-init-failure",code:a.code,message:a.message}}),this.convivaFailure())},convivaFailure:function(){for(var a in window.vhs_instances)window.vhs_instances.hasOwnProperty(a)&&window.vhs_instances[a].options&&(window.vhs_instances[a].options.conviva=!1);e.libraries.conviva.failed=!0,e.libraries.conviva.checkForQueuedCallback()},getSource:function(){var a="";return this._player&&this._player.modules&&this._player.modules.renditions&&(a=this._player.modules.renditions.getActive()),a},getParams:function(){var a={},b=this._player._data?this._player._data.headline:this._options.name,c=this._options.id?"["+this._options.id+"]"+b:b;return"function"==typeof Conviva&&Conviva.hasOwnProperty("ConvivaContentInfo")&&Conviva.ConvivaContentInfo&&(a=Conviva.ConvivaContentInfo.createInfoForLightSession(c),a.cdnName=Conviva.ConvivaContentInfo.CDN_NAME_AKAMAI,a.streamUrl=this.getSource(),a.isLive=this._options.live,a.playerName=this._player.getPlayerType(),a.tags={autoplay:this._options.autoplay,mode:"html5",version:e._version},this._logger.info("VHS::MODULE::CONVIVA:: cdnName",a.cdnName),this._logger.info("VHS::MODULE::CONVIVA:: playerName",a.playerName),this._logger.info("VHS::MODULE::CONVIVA:: streamUrl",a.streamUrl),this._logger.info("VHS::MODULE::CONVIVA:: isLive",a.isLive)),a},startConvivaSession:function(){if(!this.sessionInitialized&&this._player&&this._player.element&&"function"==typeof this._player.getType&&"html5"===this._player.getType()){var a=this._player.element[0],b={},c=this._player.getDuration();"function"==typeof Conviva&&Conviva.hasOwnProperty("LivePass")&&(this.session&&(Conviva.LivePass.cleanupMonitoringSession(a),this.session.cleanup(),this._logger.info("VHS::MODULE::CONVIVA:: cleanup session")),b=this.getParams(),this.session=Conviva.LivePass.createSession(a,b),this.session.setContentLength(c),this._logger.info("VHS::MODULE::CONVIVA:: creating session"),this.sessionInitialized=!0)}},endConvivaSession:function(){var a;this.session&&this._player&&this._player.element&&"function"==typeof Conviva&&Conviva.hasOwnProperty("LivePass")&&(a=this._player.element[0],Conviva.LivePass.cleanupMonitoringSession(a),this.session.cleanup(),this.session=null,this._logger.info("VHS::MODULE::CONVIVA:: end session"),this.sessionInitialized=!1,this._player.videoChanged=!0)},setupListeners:function(){var a=this;return this.listenersSetup?!1:(this._player.on(e.api.events.ENDED,function(){a._ended()}),void(this.listenersSetup=!0))},trackVideo:function(){this._logger.info("VHS::MODULE::CONVIVA:: track video");var a=!1;return"function"==typeof Conviva&&Conviva.hasOwnProperty("LivePass")&&Conviva.LivePass.ready?(this.setupListeners(),this._player.options.ads&&e.util.supportsAds()||this.startConvivaSession(),a=!0):(this._logger.info("VHS::MODULE::CONVIVA:: not initialized yet"),this._player.trigger(e.api.events.TRACKING_EVENT,{data:{name:"conviva-not-initialized-yet"}}),e.libraries.conviva.queuePlayback(this._player)),a},_ended:function(){this.endConvivaSession()}},e.libraries=e.libraries||{},e.libraries.qos={loading:!1,loaded:!1,failed:!1,callbacks:[],reset:function(){e.libraries.qos.loading=!1,e.libraries.qos.loaded=!1,e.libraries.qos.failed=!1,e.libraries.qos.callbacks=[]},queueInitialization:function(a,b){e.libraries.qos.callbacks.push({context:a,callback:b})},initializePlayersForQos:function(){if(e.libraries.qos.callbacks.length>0){var a=e.libraries.qos.callbacks.pop(),b=a.callback,c=a.context;"function"==typeof b&&"object"==typeof c&&b.apply(c)}}},e.api.Qos=function(a){this._player=a,this._options=a.options,this._logger=a.logger,this.buffering=!1,this.firstPlay=!0,this.paused=!0,this.ended=!1,this.sessionExists=!1,this.CONFIG_PATH=this._options.qosConfigUrl||"http://ma800-r.analytics.edgesuite.net/config/beacon-8173.xml?enableGenericAPI=1",this.SWF_PATH="http://79423.analytics.edgekey.net/csma/plugin/csma.swf",this.JS_URL="http://79423.analytics.edgekey.net/js/csma.js",this._options.qos&&"html5"===this._options.mode&&!e.config.allowMultiplePlayers&&this.initialize()},e.api.Qos.prototype={initialize:function(){window.AKAMAI_MEDIA_ANALYTICS_CONFIG_FILE_PATH=this.CONFIG_PATH,e.libraries.qos.loaded&&!e.libraries.qos.loading?this.qosInitialize():!e.libraries.qos.loaded&&e.libraries.qos.loading?e.libraries.qos.queueInitialization(this,this.qosInitialize):this.loadQosLibrary()},loadQosLibrary:function(){var a=this;e.libraries.qos.loading=!0,e.util.getScript({url:this.JS_URL,success:function(){e.libraries.qos.loaded=!0,e.libraries.qos.loading=!1,a.qosInitialize(),e.libraries.qos.initializePlayersForQos()},error:function(b,c,d){a.qosLoadLibraryErrorHandler(b,c,d)},timeout:3e3,cache:!0,dataType:"script"})},qosInitialize:function(){var a,b=this;this._player.on(e.api.events.LOAD_START,d.proxy(this.onLoadStart,this)),this._player.on(e.api.events.PLAY,d.proxy(this.onPlay,this)),this._player.on(e.api.events.PAUSE,d.proxy(this.onPause,this)),this._player.on(e.api.events.PROGRESS,d.proxy(this.onProgress,this)),this._player.on(e.api.events.ENDED,d.proxy(this.onEnded,this)),this._player.on(e.api.events.ERROR,function(a){b.onMediaError(a)}),this._player.on(e.api.events.AD_STARTED,d.proxy(this.onAdStarted,this)),this._player.on(e.api.events.AD_COMPLETED,d.proxy(this.onAdCompleted,this)),this._player.on(e.api.events.AD_SKIPPED,d.proxy(this.onAdSkipped,this)),this._player.on(e.api.events.AD_STOPPED,d.proxy(this.onAdStopped,this)),this._player.on(e.api.events.AD_FIRST_QUARTILE,d.proxy(this.onAdFirstQuartile,this)),this._player.on(e.api.events.AD_MIDPOINT,d.proxy(this.onAdMidpoint,this)),this._player.on(e.api.events.AD_THIRD_QUARTILE,d.proxy(this.onAdThirdQuartile,this)),this._player.on(e.api.events.AD_ERROR,d.proxy(this.onAdError,this)),a=function(){b.setupPlugin(),b._player.options.autoplay&&!b._player.isPaused()&&b.akaPlugin&&(b.setVideoData(),b.akaPlugin.handleSessionInit(),b.akaPlugin.handlePlaying(),b.firstPlay=!1,b.sessionExists=!0)},this._player.rendered?a():this._player.on(e.api.events.RENDERED,function c(){a(),b._player.off(e.api.events.RENDERED,c)})},setupPlugin:function(){var a=this;this.akaPluginCallBack={},this.akaPluginCallBack.streamHeadPosition=function(){return a._player.getCurrentTime()},this.akaPluginCallBack.streamLength=function(){return a._player.duration()},this.akaPluginCallBack.streamURL=function(){return a._player.getCurrentSource()},this.akaPlugin=new window.AkaHTML5MediaAnalytics(this.akaPluginCallBack),this.setPlayerData()},qosLoadLibraryErrorHandler:function(a,b,c){this._player&&"function"==typeof this._player.trigger&&this._player.trigger(e.api.events.TRACKING_EVENT,{data:{name:"qos-library-load-failure",errorStatus:b||"",errorThrown:c||""}}),e.libraries.qos.loading=!1,e.libraries.qos.loaded=!1,e.libraries.qos.failed=!0;for(var d in window.vhs_instances)window.vhs_instances.hasOwnProperty(d)&&window.vhs_instances[d].options&&(window.vhs_instances[d].options.qos=!1)},onLoadStart:function(){this.firstPlay=!0,this.akaPlugin&&(this.sessionExists&&!this.ended&&this.akaPlugin.handlePlayEnd("Interupted.New.Media.Requested"),this.setVideoData(),this.akaPlugin.handleSessionInit(),this.sessionExists=!0,this.ended=!1)},onPlay:function(){this.akaPlugin&&(this.firstPlay?(this.akaPlugin.handlePlaying(),this.firstPlay=!1):this.paused&&this.akaPlugin.handleResume()),this.paused=!1},onPause:function(){this.akaPlugin&&this.akaPlugin.handlePause(),this.paused=!0},onProgress:function(){var a,b,c=this._player.video;!c||c.ended||c.paused||c.buffered.length<=0||(a=Math.floor(c.buffered.end(c.buffered.length-1)),b=Math.floor(this._player.getCurrentTime()),b>=a?this.onBufferStart():this.onBufferEnd())},onBufferStart:function(){this.akaPlugin&&(this.buffering=!0,this.akaPlugin.handleBufferStart())},onBufferEnd:function(){this.akaPlugin&&this.buffering&&(this.akaPlugin.handleBufferEnd(),this.buffering=!1)},onEnded:function(){this.firstPlay=!0,this.ended=!0,this.akaPlugin&&this.akaPlugin.handlePlayEnd("Play.End.Detected")},onMediaError:function(a){var b="";this.akaPlugin&&(a.currentTarget&&a.currentTarget.error&&(b=a.currentTarget.error),this.akaPlugin.handleError(b))},onAdStarted:function(){this.onAdLoaded(),this.akaPlugin&&this.akaPlugin.handleAdStarted()},onAdCompleted:function(){this.akaPlugin&&this.akaPlugin.handleAdCompleted()},onAdSkipped:function(){this.akaPlugin&&this.akaPlugin.handleAdStopped()},onAdStopped:function(){this.akaPlugin&&this.akaPlugin.handleAdStopped()},onAdFirstQuartile:function(){this.akaPlugin&&this.akaPlugin.handleAdFirstQuartile()},onAdMidpoint:function(){this.akaPlugin&&this.akaPlugin.handleAdMidPoint()},onAdThirdQuartile:function(){this.akaPlugin&&this.akaPlugin.handleAdThirdQuartile()},onAdError:function(a){this.akaPlugin&&this.akaPlugin.handleAdError()},onAdLoaded:function(){this.akaPlugin&&this.akaPlugin.handleAdLoaded({adTitle:this._player.getAdTitle(),adDuration:this._player.adDuration()})},setPlayerData:function(){this.akaPlugin&&(this.akaPlugin.setData("mode",this._options.mode),this.akaPlugin.setData("autoplay",this._options.autoplay),this.akaPlugin.setData("version",e._version),this.akaPlugin.setData("playerId",this._player.getPlayerType()),this._options.live===!0?this.akaPlugin.setData("deliveryType","L"):this.akaPlugin.setData("deliveryType","O"))},setVideoData:function(){this.akaPlugin&&(this.akaPlugin.setData("title",this._player.getTitle()),this.akaPlugin.setData("contentLength",this._player.getDuration()),this.akaPlugin.setData("category",this._player.getCategory()),this.akaPlugin.setData("videoId",this._player.getVideoId()))}},e.configs.features={"test-feature":{environments:{production:!1,staging:!1,development:!0,localhost:!0}},"flash-hd-switch-seek":{environments:{production:!0,staging:!0,development:!0,localhost:!0}},"poster-image-select":{ticket:"https://jira.nyt.net/browse/VR-6438",environments:{production:!0,staging:!0,development:!0,localhost:!0}}},e.api.FeatureFlags=function(a){this._player=a,this._options=a.options,this._logger=a.logger,this.config=e.configs.features||{}},e.api.FeatureFlags.prototype={isEnabled:function(a){var b=!1;if(a in this.config){try{b=this.config[a].environments[this._options.env]}catch(c){this._logger.warn("feature flags: config for feature '"+a+"' in env '"+this._options.env+"' is missing or malformed")}"boolean"!=typeof b&&(b=!1)}return b}},e.api.Controls=function(a){var b=['<div class="nytd-player-controls">','<span class="nytd-player-controls-play vhs-icon-play"></span>','<span class="nytd-player-controls-reload vhs-icon-reload"></span>','<span class="nytd-player-controls-exclamation vhs-icon-exclamation"></span>','<div class="nytd-player-controls-ad-label">Advertisement</div>','<div class="nytd-player-controls-live-label">LIVE</div>','<div class="nytd-player-controls-error-msg">Error</div>','<div class="nytd-player-controls-current-time">00:00</div>','<div class="nytd-player-controls-progress">','<span class="nytd-player-controls-progress-marker vhs-icon-circle"></span>','<span class="nytd-player-controls-progress-time"></span>','<span class="nytd-player-controls-progress-buffer"></span>','<span class="nytd-player-controls-progress-scrubber"></span>',"</div>",'<span class="nytd-player-controls-fullscreen vhs-icon-resize-full"></span>','<span class="nytd-player-controls-volume vhs-icon-volume-up"></span>','<span class="nytd-player-controls-hd vhs-icon-hd-off"></span>','<div class="nytd-player-controls-duration">00:00</div>',"</div>"].join("");this.player=a,this.rendered=!1,this.seeking=!1,this.draggingMarker=!1,this.mouseoverContainer=!0,this.controlsVisible=!1,this.element=d(b),this.device=e.util.getDeviceType(),this.live=this.player&&this.player.options&&this.player.options.live?!0:!1,this.touchedControls=!1},e.api.Controls.prototype={initialize:function(){this.render(),this.registerUI(),this.actions(),this.listeners(),this.live&&this.configureLive()},render:function(){return this.rendered||"android_legacy"===this.device||"ie_mobile"===this.device?!1:(this.player.container.append(this.element),this.rendered=!0,void(this.controlsVisible=!0))},registerUI:function(){this.ui={play:this.element.find(".nytd-player-controls-play"),reload:this.element.find(".nytd-player-controls-reload"),fullscreen:this.element.find(".nytd-player-controls-fullscreen"),volume:this.element.find(".nytd-player-controls-volume"),progress:this.element.find(".nytd-player-controls-progress"),marker:this.element.find(".nytd-player-controls-progress-marker"),progressBuffer:this.element.find(".nytd-player-controls-progress-buffer"),progressTime:this.element.find(".nytd-player-controls-progress-time"),duration:this.element.find(".nytd-player-controls-duration"),current:this.element.find(".nytd-player-controls-current-time"),errormsg:this.element.find(".nytd-player-controls-error-msg"),hd:this.element.find(".nytd-player-controls-hd")}},actions:function(){var a=this;this.ui.play.on("click",function(b){a.player.togglePlay(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.reload.on("click",function(b){a.player.reloadVideo(),a.live||a.player.play(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.fullscreen.on("click",function(b){a.player.toggleFullscreen(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),e.util.supportsFullscreen()||(this.ui.fullscreen.addClass("vhs-icon-disabled"),this.ui.fullscreen.off()),this.ui.volume.on("click",function(b){a.player.toggleVolume(),a.player.isTouch&&(b.preventDefault(),b.stopPropagation())}),this.ui.marker.on("click",function(a){a.preventDefault(),a.stopPropagation()}),this.ui.progress.on("mousedown touchstart",function(b){b.stopPropagation(),a.draggingMarker=!0}),this.ui.progress.on("touchstart click",function(b){b.preventDefault(),b.stopPropagation(),a.seek(b)}),this.ui.hd.on("click",function(b){b.preventDefault(),b.stopPropagation(),a.player.adPlaying()||(a.player.toggleHD(b),a.setHDIconState())}),d(document).on("mouseup touchend",d.proxy(this.onDocumentMouseup,this)),d(document).on("mousemove touchmove",d.proxy(this.onDocumentMousemove,this)),e.util.jqueryInUse()&&this.element.hover(function(){a.element.addClass("nytd-player-controls-hover")},function(){a.element.removeClass("nytd-player-controls-hover")})},listeners:function(){this.player.on(e.api.events.PLAY,d.proxy(this.onPlay,this)),this.player.on(e.api.events.PLAYING,d.proxy(this.onPlay,this)),this.player.on(e.api.events.ENDED,d.proxy(this.onEnded,this)),this.player.on(e.api.events.LEVEL_ENDLIST,d.proxy(this.hlsEndListFound,this)),this.player.on(e.api.events.AD_COMPLETED,d.proxy(this.onAdCompleted,this)),this.player.on(e.api.events.AD_PAUSED,d.proxy(this.onAdPaused,this)),this.player.on(e.api.events.AD_RESUMED,d.proxy(this.onAdResumed,this)),this.player.on(e.api.events.AD_STARTED,d.proxy(this.onAdStarted,this)),this.player.on(e.api.events.AD_TIME_UPDATE,d.proxy(this.onAdTimeUpdate,this)),this.player.on(e.api.events.AD_SKIPPED,d.proxy(this.onAdSkipped,this)),this.player.on(e.api.events.AD_STOPPED,d.proxy(this.onAdStopped,this)),this.player.on(e.api.events.PAUSE,d.proxy(this.onPause,this)),this.player.on(e.api.events.MUTE,d.proxy(this.onMute,this)),this.player.on(e.api.events.DURATION_CHANGE,d.proxy(this.onDurationChange,this)),this.player.on(e.api.events.TIME_UPDATE,d.proxy(this.onTimeupdate,this)),this.player.on(e.api.events.GO_FULLSCREEN,d.proxy(this.onEnterFullscreen,this)),this.player.on(e.api.events.EXIT_FULLSCREEN,d.proxy(this.onExitFullscreen,this)),this.player.on(e.api.events.ERROR,d.proxy(this.onError,this)),this.player.on(e.api.events.LOAD_START,d.proxy(this.onLoadStart,this)),this.player.on(e.api.events.PROGRESS,d.proxy(this.onProgress,this)),this.player.on(e.api.events.VIDEO_FLASH_BYTES_LOADED_CHANGE,d.proxy(this.onVideoFlashBytesLoadedChange,this)),this.player.container.on("touchend",d.proxy(this.onTouchEndVideo,this)),this.element.on("touchend",d.proxy(this.onTouchEndControls,this)),this.player.container.on("mouseenter",d.proxy(this.onMouseEnterVideo,this)),this.player.container.on("mouseleave",d.proxy(this.onMouseLeaveVideo,this)),this.player.container.on("mousemove",d.proxy(this.onMouseMoveVideo,this)),this.element.on("mouseenter",d.proxy(this.onMouseEnterControls,this)),this.element.on("mouseleave",d.proxy(this.onMouseLeaveControls,this))},configureLive:function(){this.element.addClass("nytd-player-live-controls"),this.element.addClass("withouthd")},configureVOD:function(){this.element.removeClass("nytd-player-live-controls"),this.renderHdButton(this.player._data&&this.player._data.renditions&&!this.player.options.live)},hlsEndListFound:function(){this.configureVOD()},onMouseEnterVideo:function(){this.mouseoverContainer=!0,this.show(),this.element.hasClass("nytd-player-controls-hover")||this.startFadeOutTimer()},onMouseLeaveVideo:function(){this.mouseoverContainer=!1,this.player.isPaused()?"desktop"===this.device&&this.startFadeOutTimer(2e3,!0):this.hide()},onMouseMoveVideo:function(){this.mouseoverContainer&&!this.controlsVisible&&(this.show(),this.element.hasClass("nytd-player-controls-hover")||this.startFadeOutTimer())},onMouseEnterControls:function(){clearInterval(this.controlsHideTimeout)},onMouseLeaveControls:function(){this.mouseoverContainer&&this.controlsVisible&&this.startFadeOutTimer()},onTouchEndVideo:function(a){this.touchedControls||(a.preventDefault(),this.player.adPlaying()?this.show():this.controlsVisible?this.startFadeOutTimer(100):(this.show(),this.startFadeOutTimer()),d(a.target).click()),this.touchedControls=!1},onTouchEndControls:function(a){a.preventDefault(),this.touchedControls=!0,this.show(),this.player.adPlaying()||this.startFadeOutTimer(),d(a.target).click()},onPlay:function(){this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.hideErrorSlate(),this.setHDIconState(),this.startFadeOutTimer(300)},onEnded:function(){this.ui.play.addClass("vhs-icon-play").removeClass("vhs-icon-pause"),this.live&&"html5"===this.player.getType()&&this.configureVOD(),this.show()},onAdCompleted:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.ui.play.removeClass("vhs-icon-pause").addClass("vhs-icon-play"),this.player.isTouch&&this.hide()},onAdPaused:function(){this.ui.play.removeClass("vhs-icon-pause").addClass("vhs-icon-play"),this.show()},onAdResumed:function(){this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.startFadeOutTimer(300)},onAdStarted:function(){this.element.addClass("nytd-player-ad-controls"),this.ui.hd.addClass("vhs-icon-hd-disabled"),this.ui.play.addClass("vhs-icon-pause").removeClass("vhs-icon-play"),this.player.poster&&this.player.poster.hide(),this.player.isTouch&&this.show()},onAdSkipped:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.player.isTouch&&this.hide()},onAdStopped:function(){this.element.removeClass("nytd-player-ad-controls"),this.ui.hd.removeClass("vhs-icon-hd-disabled"),this.player.isTouch&&this.hide()},onPause:function(a){this.ui.play.addClass("vhs-icon-play").removeClass("vhs-icon-pause"),this.show()},onMute:function(a){a?this.ui.volume.addClass("vhs-icon-volume-off").removeClass("vhs-icon-volume-up"):this.ui.volume.addClass("vhs-icon-volume-up").removeClass("vhs-icon-volume-off")},onEnterFullscreen:function(){e.util.isIpad()&&(this.hide(!0),this.player.element.attr("controls","controls")),this.ui.fullscreen.addClass("vhs-icon-resize-default").removeClass("vhs-icon-resize-full")},onExitFullscreen:function(){e.util.isIpad()&&(this.show(),this.player.element.removeAttr("controls")),this.ui.fullscreen.addClass("vhs-icon-resize-full").removeClass("vhs-icon-resize-default")},onError:function(a){this.player.logger.error("!!! Error Event",a),this.live?this.showLiveStreamDownMsg(a):this.showVodErrorMsg(a)},onLoadStart:function(){this.hideErrorSlate()},onDurationChange:function(a){var b=parseInt(a,10);this.ui.duration.html(this.formatTime(b))},onTimeupdate:function(a){this.seeking||this.updateProgressUI(a)},onAdTimeUpdate:function(a){var b=this.player.adDuration()-a,c=this.formatTime(b);this.ui.duration.html(c),this.player.options.skipAd&&this.player.skipAdUpdate(b)},onDocumentMousemove:function(a){var b,c,d,e;this.draggingMarker&&this.player&&"function"==typeof this.player.duration&&(c=0,d=0,e=0,b=this.player.isTouch&&a&&a.originalEvent&&a.originalEvent.touches?a.originalEvent.touches[0].pageX||a.originalEvent.changedTouches[0].pageX:a.pageX,d=-1*(this.ui.progress.offset().left-b),d>c&&d<this.ui.progress.width()?e=this.player.duration()*d/this.ui.progress.width():d>=this.ui.progress.width()&&(e=this.player.duration()),this.player.seek(e),this.updateProgressUI(e),this.seeking=!0)},onDocumentMouseup:function(){var a=this;this.draggingMarker=!1,setTimeout(function(){a.seeking=!1},500)},onProgress:function(a){var b=0,c=0;if(this.player&&this.player.element&&this.player.element[0]&&this.player.element[0].buffered&&this.player.element[0].buffered.end)try{var d=this.player.element[0].buffered.length-1;d>=0&&(c=this.player.element[0].buffered.end(d))}catch(e){this.player.logger.error("error getting the buffer from the video element",e)}b=this.getTimePosition(c),this.ui.progressBuffer.css({width:b+"%"})},onVideoFlashBytesLoadedChange:function(a){var b=a&&a.data&&a.data.bytesloaded?a.data.bytesloaded:0,c=a&&a.data&&a.data.bytestotal?a.data.bytestotal:0,d=c>0?Math.round(b/c*100):0;this.ui.progressBuffer.css({width:d+"%"})},show:function(){var a=[400,1];this.player.logger.log("controls show"),clearInterval(this.controlsHideTimeout),this.controlsVisible=!0,e.util.jqueryInUse()?this.element.stop(!0,!1).fadeTo(a[0],a[1]):this.element.css({
opacity:a[1]}),this.player.trigger(e.api.events.SHOW_CONTROLS,{fadeArgs:a})},hide:function(a){var b=[400,0];if(this.player.logger.log("controls hide"),!this.player.firstPlay||a){var c=this;e.util.jqueryInUse()?this.element.stop(!0,!1).fadeTo(b[0],b[1],function(){c.controlsVisible=!1}):(this.element.css({opacity:b[1]}),this.controlsVisible=!1),this.player.trigger(e.api.events.HIDE_CONTROLS,{fadeArgs:b})}},startFadeOutTimer:function(a,b){if(b=b||!1,!b&&this.player.isPaused())return!1;this.player.logger.log("controls startFadeOutTimer");var c=a||6e3,d=this;clearInterval(this.controlsHideTimeout),this.controlsHideTimeout=setTimeout(function(){d.hide()},c)},seek:function(a){var b=0;b=this.player.isTouch?a.originalEvent.touches[0].pageX||a.originalEvent.changedTouches[0].pageX:a.pageX;var c=-1*(this.ui.progress.offset().left-b),d=Math.round(this.player.duration()*c/this.ui.progress.width());this.player.seek(d),this.updateProgressUI(d)},formatTime:function(a){var b,c,d;return b=parseInt(a,10),0>b&&(b=0),c=Math.floor(b/60),d=b-60*c,10>c&&(c="0"+c),10>d&&(d="0"+d),c+":"+d},getTimePosition:function(a){var b=a/this.player.duration()*100;return parseFloat(b.toFixed(2))},updateProgressUI:function(a){var b,c=this.getTimePosition(a);this.ui.progressTime.css({width:c+"%"}),b=(this.ui.progressTime.width()-9)/this.ui.progress.width()*100,this.ui.marker.css({left:b.toFixed(2)+"%"}),this.ui.current.html(this.formatTime(a))},onSourceError:function(){this.live||3!==this.player.element[0].networkState||this.player.trigger(e.api.events.ERROR,{error:{code:203,msg:"NETWORK_NO_SOURCE: All video sources unavailable."}})},showLiveStreamDownMsg:function(a){var b=this.player.element&&this.player.element[0]?this.player.element[0].error:null,c=e.util.getErrorMessage(b);this.element.addClass("nytd-player-error-controls"),this.ui.errormsg.html(c),b&&b.code&&b.code===b.MEDIA_ERR_SRC_NOT_SUPPORTED&&this.player&&this.player.element[0]&&""===this.player.element[0].canPlayType("application/x-mpegURL")&&this.element.addClass("nytd-player-error-not-supported")},showVodErrorMsg:function(a){if(a){var b,c=a.currentTarget?a.currentTarget.error:a.error,d=!0;this.element.addClass("nytd-player-error-controls"),"html5"===this.player.options.mode&&c&&c.code&&c.code===c.MEDIA_ERR_SRC_NOT_SUPPORTED&&this.player&&this.player.element[0]&&""===this.player.element[0].canPlayType("video/mp4")&&(this.element.addClass("nytd-player-error-not-supported"),d=!1),b=e.util.getErrorMessage(c,"vod",d),this.ui.errormsg.html(b),this.show()}},hideErrorSlate:function(){this.element.removeClass("nytd-player-error-controls"),this.element.removeClass("nytd-player-error-not-supported"),this.ui.errormsg.html("")},renderHdButton:function(a){a?this.element.removeClass("withouthd"):this.element.addClass("withouthd")},setHDIconState:function(){this.player.enableHD?this.ui.hd.addClass("vhs-icon-hd-on"):this.ui.hd.removeClass("vhs-icon-hd-on")}},e.api.Fullscreen=function(a){this.player=a,this.listeners()},e.api.Fullscreen.prototype={_permissionGranted:!1,_isFullscreen:!1,_resizeProxy:null,listeners:function(){this._resizeProxy=d.proxy(this.onVHSFullscreenResize,this),d(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange vhsfullscreenchange",d.proxy(this.onFullscreenChange,this)),d(window).on("keydown",d.proxy(this.onEscKey,this))},_canRequestFullScreen:function(a){var b=a||document.createElement("video"),c=function(a,b){return"function"==typeof a[b]};return c(b,"requestFullscreen")||c(b,"webkitRequestFullscreen")||c(b,"webkitEnterFullScreen")||c(b,"mozRequestFullScreen")||c(b,"msRequestFullscreen")},onFullscreenChange:function(){if(this.getPermission()){var a=this.player.container,b=a.data("ratioFix");return e.util.isIpad()?(this.isEnabled()?this.player.trigger(e.api.events.GO_FULLSCREEN):(this.player.trigger(e.api.events.EXIT_FULLSCREEN),this.setPermission(!1)),!1):void(this.isEnabled()?(this.player.trigger(e.api.events.GO_FULLSCREEN),a.width(d(document).width())):(this.player.trigger(e.api.events.EXIT_FULLSCREEN),a.css({height:b?0:e.util.normalizeUnit(this.player.options.height),width:e.util.normalizeUnit(this.player.options.width)}),this.setPermission(!1)))}},onVHSFullscreenResize:function(){if(this.getPermission()){var a=this.computePlayerRect(),b={width:e.util.normalizeUnit(a.width),height:e.util.normalizeUnit(a.height),left:e.util.normalizeUnit(a.left),top:e.util.normalizeUnit(a.top),"padding-bottom":0};this.player.container.css(b)}},computePlayerRect:function(){{var a,b,c,f=d(window).height(),g=d(window).width(),h=f*(16/9),i=g*(9/16);this.player.container}return g>f&&(i=f),h>g&&(h=g,i=9*h/16),a=.5*(g-h),b=0>=a?.5*(f-i):0,c={width:e.util.normalizeUnit(h),height:e.util.normalizeUnit(i),left:e.util.normalizeUnit(a),top:e.util.normalizeUnit(b)}},onEscKey:function(a){var b=a.keyCode||a.which;27===b&&this.exit()},vhsEnterFullscreen:function(){this.renderVHSFullscreenElement(),this._isFullscreen=!0,this.onFullscreenChange(),this.onVHSFullscreenResize(),d(window).resize(this._resizeProxy)},vhsExitFullscreen:function(){this.removeVHSFullscreenElement(),this._isFullscreen=!1,this.onFullscreenChange(),d(window).off("resize",this._resizeProxy)},enter:function(){var a=this.player.container[0],b=function(a,b){return"function"==typeof a[b]};this.setPermission(!0),(e.util.isIpad()||e.util.isAndroid())&&(a=this.player.element.get(0)),b(a,"requestFullscreen")?a.requestFullscreen():b(a,"webkitRequestFullscreen")?a.webkitRequestFullscreen():b(a,"webkitEnterFullScreen")?a.webkitEnterFullScreen():b(a,"mozRequestFullScreen")?a.mozRequestFullScreen():b(a,"msRequestFullscreen")?(a.msRequestFullscreen(),this.player.container.addClass("ms-fullscreen")):this.vhsEnterFullscreen()},exit:function(){if(this.getPermission()){var a=this.player.container[0];e.util.isIpad()&&(a=this.player.element.get(0)),"function"==typeof a.webkitCancelFullScreen?a.webkitCancelFullScreen():"function"==typeof document.exitFullscreen?document.exitFullscreen():"function"==typeof document.webkitExitFullscreen?document.webkitExitFullscreen():"function"==typeof document.mozCancelFullScreen?document.mozCancelFullScreen():"function"==typeof document.msExitFullscreen?(document.msExitFullscreen(),this.player.container.removeClass("ms-fullscreen")):this.vhsExitFullscreen()}},getPermission:function(){return this._permissionGranted},setPermission:function(a){this._permissionGranted=a},isEnabled:function(){var a=e.util.getDocument();return a.fullScreen||a.mozFullScreen||a.webkitIsFullScreen||this.player.container.get(0).webkitIsFullScreen||this._isFullscreen||a.msIsFullScreen},renderVHSFullscreenElement:function(){var a=this.player.container,b=this.player.controls,c=1e5;a.data("style",a.attr("style")),a.css({position:"fixed",top:0,left:0,"z-index":c}),d('<div class="nytd-player-fullscreen"></div>').appendTo("body").css({width:"100%",height:"100%",background:"#000",position:"fixed",top:0,left:0,zIndex:c-1}),d("body").data("overflow",d("body").css("overflow")),d("body").css("overflow","hidden"),b.data("style",b.attr("style")),b.css("z-index",c+1)},removeVHSFullscreenElement:function(){var a=this.player.container,b=this.player.controls;d("body").css("overflow",d("body").data("overflow")),a.attr("style",a.data("style")),b.attr("style",b.data("style")),d(".nytd-player-fullscreen").remove()}},e.api.RenditionSelector=function(a){this.renditionsData=null,this.activeRendition=null,this.LIMITS=d.extend({SD:{min:360,max:480},HD:{min:480,max:720}},a&&a.renditions?a.renditions:{})},e.api.RenditionSelector.prototype={findNearest:function(a,b,c,d,e){for(var f=-1,g=a.length,h=1080+e,i=0;g>i;i++){var j=Math.abs(e-a[i][b]);h>=j&&a[i][b]>=d&&a[i][b]<=c&&(f=i,h=j)}return f},filterByFileType:function(a,b){for(var c={},d=[],e=b.length,f=0;e>f;f++)!c.hasOwnProperty(b[f].height)&&b[f]&&b[f].url&&b[f].url.indexOf(a)>-1&&(d.push(b[f]),c[b[f].height]=!0);return d},getCompatibleRenditions:function(a,b){var c=this.filterByFileType("."+e.util.getSupportedType(b),a);if(!c.length&&"flash"===b){c=this.filterByFileType(".flv",a);for(var d=0;d<c.length;d++)c[d].url=c[d].url.replace(".flv","")}return c.sort(function(a,b){var c=a.height,d=b.height;return c>d?1:d>c?-1:c===d?-1:1}),c},getClosestRendition:function(a,b,c,d,e){var f,g=c?"HD":"SD",h=this.LIMITS[g].max,i=this.LIMITS[g].min,j="url"===e?"":{};return b=c?this.LIMITS[g].max:b,this.renditionsData=this.getCompatibleRenditions(a,d),f=this.findNearest(this.renditionsData,"height",h,i,b),-1===f&&(f=this.renditionsData.length>>1),this.renditionsData&&this.renditionsData[f]&&("url"===e?j=this.renditionsData[f].url:(j=this.renditionsData[f],j&&j.type&&(j.bitrate=this.getBitrate(j.type)))),j},getClosestRenditionUrl:function(a,b,c,d){return this.getClosestRendition(a,b,c,d,"url")},getClosestRenditionObject:function(a,b,c,d){return this.getClosestRendition(a,b,c,d,"object")},getBitrate:function(a){var b={video_xs_2g_mob:100,video_l_3g_mob:350,video_xxxl_hb_mm:1200,video_s_3g_hp:350,video_l_bb_lib:620,video_xl_bb_art:700,video_xxl_bb_mm:850,video_s_nb_well:450,video_well_s_nb:360,syndication:8e3,mobile_win:90,mobile_reg2:106,mobile_reg:56,video_s_nb:275,video_s_bb:514,video_l_nb:464,video_l_bb:714,video_a_nb:525,video_a_bb:750,video_well_s:550,touch_itunes:1328,mobile_iphone:160,video_xl_bb_mm:720,video_144p_mp4:248,video_240p_mp4:369,video_360p_mp4:935,video_480p_mp4:1513,video_720p_mp4:2545,video_1080p_mp4:3689,video_240p_webm:369,video_360p_webm:968,video_480p_webm:1568,video_720p_webm:2632};return b[a]||2400},resetActive:function(){this.activeRendition=null},setActive:function(a){this.activeRendition=a},getActive:function(){return this.activeRendition},findRenditionByUrl:function(a){for(var b=0,c=this.renditionsData.length;c>b;b++)if(this.renditionsData[b].url===a)return this.renditionsData[b]}},e.api.Responsive=function(a){this.player=a,this.setResponsiveClass=d.proxy(this.setResponsiveClass,this),this.setResponsiveClass(),this.bindWindow()},e.api.Responsive.prototype.bindWindow=function(a){d(window).off("resize."+this.player.instance,this.setResponsiveClass),d(window).on("resize."+this.player.instance,this.setResponsiveClass)},e.api.Responsive.prototype.destroy=function(){d(window).off("resize."+this.player.instance,this.setResponsiveClass)},e.api.Responsive.classSizes={XXSMALL:{className:"vhs-xxs",rule:"lte",size:335},XSMALL:{className:"vhs-xs",rule:"lt",size:390},SMALL:{className:"vhs-s",rule:"lt",size:540},MEDIUM:{className:"vhs-m",rule:"lt",size:720},LARGE:{className:"vhs-l",rule:"lt",size:945},XLARGE:{className:"vhs-xl",rule:"lt",size:1050},XXLARGE:{className:"vhs-xxl",rule:"gte",size:1050}},e.api.Responsive.orderedClassSizes=[e.api.Responsive.classSizes.XXSMALL,e.api.Responsive.classSizes.XSMALL,e.api.Responsive.classSizes.SMALL,e.api.Responsive.classSizes.MEDIUM,e.api.Responsive.classSizes.LARGE,e.api.Responsive.classSizes.XLARGE,e.api.Responsive.classSizes.XXLARGE],e.api.Responsive.prototype.setResponsiveClass=function(){var a,b,c=this.player.container,d=c.get(0).offsetWidth,f=e.api.Responsive.orderedClassSizes.length,g=e.api.Responsive.orderedClassSizes,h=!1,i="",j={lt:function(a,b){return b>a},lte:function(a,b){return b>=a},gte:function(a,b){return a>=b}};for(b=0;f>b;b++)a=g[b],!h&&j[a.rule](d,a.size)?(h=!0,c.addClass(a.className)):i+=a.className+" ";c.removeClass(i)},e.api.Poster=function(a){this.player=a,this.ui={play:""},this.defaultMode="duration",this.template=e.templates&&e.templates.cover?e.templates.cover:null},e.api.Poster.prototype={getUrl:function(){var a,b=[];if("undefined"!=typeof this.player.options.poster)a=this.player.options.poster;else if(this.player._data)if(this.player.modules.features.isEnabled("poster-image-select"))a=this.getClosestPosterMatch();else{b=this.player._data.images;for(var c in b)"videoSmall"===b[c].type&&(a=this.player.staticBaseUrl+b[c].url)}return a},getAvailableImages:function(){var a,b,c=this.player._data.images||[],d=c.length,e=[],f=[],g=[{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-96x54.png",width:96,height:54},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-225x126.png",width:225,height:126},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-310x174.png",width:310,height:174},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-500x281.png",width:500,height:281},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-1050x591.png",width:1050,height:591},{url:this.player.staticBaseUrl+"video/static-timesvideo/img/video-default-16by9-1920x1080.png",width:1920,height:1080}];for(a=0;d>a;a++)c[a].type&&c[a].type.indexOf("videoSixteenByNine")>-1?e.push({url:this.player.staticBaseUrl+c[a].url,width:c[a].width,height:c[a].height}):f.push({url:this.player.staticBaseUrl+c[a].url,width:c[a].width,height:c[a].height}),"videoSmall"===c[a].type&&(b={url:this.player.staticBaseUrl+c[a].url,width:500,height:281});return 0===e.length&&(e=b?[b]:f.length>0?f:g),e},getClosestPosterMatch:function(){var a,b,c,d,e=this.getAvailableImages(),f=e.length,g=this.player.container.get(0).offsetWidth,h=.1;if(0===f)return"";if(1===f)return e[0].url;for(a=0;f>a;a++){if(e[a].width===g){b=e[a];break}e[a].width<=g&&(void 0===c||c.width<e[a].width)&&(c=e[a],c.widthDiff=Math.abs(c.width-g)),e[a].width>=g&&(void 0===d||d.width>e[a].width)&&(d=e[a],d.widthDiff=Math.abs(d.width-g))}return!b&&c&&d&&c.widthDiff<d.widthDiff&&c.widthDiff<g*h&&(b=c),b=b||d||c,b.url},render:function(){var a=this,b=this.getUrl(),c=['<div class="nytd-player-poster">',"</div>"].join("");return b?(this.element&&this.element.remove(),this.element=d(c).css({width:e.util.normalizeUnit(this.player.options.width),height:e.util.normalizeUnit(this.player.options.height),background:"url("+b+") center center no-repeat","background-size":"cover"}),this.player.poster=this.element,this.processCover(),this.player.container.prepend(this.element),!this.player.options.nativeControls||this.player.options.controls||this.player.options.cover||this.element.hide(),this.player.on(e.api.events.PLAYING,function(){a.hide()}),this.player.on(e.api.events.AD_STARTED,function(){a.hide()}),void this.player.on(e.api.events.RENDITION_NOT_FOUND,function(){a.hide()})):!1},renderNativePoster:function(){var a=this.getUrl();a&&this.player&&this.player.element&&"html5"===this.player.getType()&&this.player.element.attr("poster",a)},removeNativePoster:function(){this.player&&this.player.element&&"html5"===this.player.getType()&&this.player.element.removeAttr("poster")},update:function(){var a=this.getUrl();this.element&&a&&this.element.css({background:"url("+a+") center center no-repeat","background-size":"cover"})},handleOnClick:function(){var a=this;this.element&&this.element.on("click",function(){a.player.firstPlay&&a.player.addLoader(),a.player.rendered===!1?"flash"===a.player.getType()?(a.player.on(e.api.events.RENDERED,function b(){a.player.play(),a.player.off(e.api.events.RENDERED,b)}),a.player.render()):(a.player.render(),a.player.play()):a.player.play(),a.hide(),a.player.container&&a.player.options.spacebarToggleEnabled&&a.player.container.focus()})},hide:function(){var a=this;this.element&&!this.player.isIphone?this.element.hide():this.player.isIphone&&this.player.element&&this.player.element.one("webkitendfullscreen",function(){a.player&&(a.player.adsController&&(a.player.adsController.isCompleted=!1,a.player.adsController.isContentPlaying=!1),a.player.element&&(a.player.element.off(),a.player.element.remove()),a.player.rendered=!1,a.player.listenersInitialized=!1)})},processCover:function(){if(this.player.options.cover&&!this.player.options.autoplay&&this.template){var a=this.player.options.cover.mode||this.defaultMode;switch(a=a.toLowerCase()){case"duration":case"clean":case"article":case"mobile":break;default:a=this.defaultMode}0===this.player.getDuration()&&(a="clean"),this.renderCover(a)}},renderCover:function(a){var b,c=this.formatDuration(this.player.getDuration()),e={mode:a||this.defaultMode,data:{headline:"",byline:"",duration:c,channelName:"",showName:""}};this.player._data&&(e.data.headline=this.player._data.headline,e.data.byline=this.player._data.byline,e.data.showName=this.player._data.playlist.display_name,e.data.channelName=this.player._data.playlist.parent_display_name),b=d.trim(this.template(e)),this.element&&(this.element.append(b),this.ui.play=this.element.find(".vhs-icon-play"))},formatDuration:function(a){var b=parseInt(a,10),c=Math.floor(b/3600),d=Math.floor((b-3600*c)/60),e=b-3600*c-60*d,f="";return c?(f=c+":",f+=("0"+d).slice(-2)+":"):d?f+=d+":":f="00:",f+=("0"+e).slice(-2)}},e.api.Errors=function(a){this.player=a,this.options=a.options,this.logger=a.logger,this.errorContainer=null,this.messages={},this.messages[e.api.events.RENDITION_NOT_FOUND]="This video is not currently supported on your browser.",this.initialize()},e.api.Errors.prototype={initialize:function(){var a=this;this.player.on(e.api.events.RENDITION_NOT_FOUND,function(){a.logger.error("RENDITION_NOT_FOUND. Update Error Slate."),a.updateErrorSlate(e.api.events.RENDITION_NOT_FOUND)}),this.player.on(e.api.events.PLAY,function(){a.logger.log("Playing a video. Hide Error Slate."),a.hideErrorSlate()}),this.player.on(e.api.events.AD_STARTED,function(){a.logger.log("Playing an ad. Hide Error Slate."),a.hideErrorSlate()})},createErrorSlate:function(a){this.errorContainer&&this.errorContainer.remove(),this.icon='<i class="vhs-icon-alert"></i>',this.errorContainer=d('<div class="vhs-error-slate"><p>'+this.icon+"</p></div>"),this.player.container.append(this.errorContainer)},updateErrorSlate:function(a){this.errorContainer||this.createErrorSlate(),this.errorContainer.find("p").html(this.icon+this.messages[a]),e.util.jqueryInUse()?this.errorContainer.fadeIn(100):this.errorContainer.show()},hideErrorSlate:function(){var a=this;this.errorContainer&&this.errorContainer.is(":visible")&&(e.util.jqueryInUse()?this.errorContainer.fadeOut(100,function(){a.errorContainer&&a.errorContainer.hide()}):this.errorContainer.hide())}},e.api.events={READY:"ready",LOADED:"loaded",PLAY:"play",PAUSE:"pause",MUTE:"mute",PLAYING:"playing",PROGRESS:"progress",SEEKED:"seeked",ENDED:"ended",BUFFERING:"buffering",BUFFER_FULL:"bufferfull",DURATION_CHANGE:"durationchange",TIME_UPDATE:"timeupdate",GO_FULLSCREEN:"gofullscreen",EXIT_FULLSCREEN:"exitfullscreen",AD_STARTED:"adstarted",AD_PAUSED:"adpaused",AD_RESUMED:"adresumed",AD_COMPLETED:"adcompleted",AD_TIME_UPDATE:"adtimeupdate",AD_PROGRESS:"adprogress",AD_SKIPPED:"adskipped",AD_STOPPED:"adstopped",AD_FIRST_QUARTILE:"ad-first-quartile",AD_MIDPOINT:"ad-mid-point",AD_THIRD_QUARTILE:"ad-third-quartile",AD_ERROR:"ad-error",RENDITION_CHANGED:"renditionchanged",LOADED_DATA:"loadeddata",RENDERED:"rendered",LOAD_START:"loadstart",ERROR:"error",STALLED:"stalled",WAITING:"waiting",VIDEO_READY:"video:ready",VIDEO_LOADING:"video:loading",VIDEO_FLASH_BYTES_LOADED_CHANGE:"video:flash:bytesloadedchange",VIDEO_FLASH_BUFFER_TIME_CHANGE:"video:flash:buffertimechange",LEVEL_ENDLIST:"levelendlist",HD_ON:"hdon",HD_OFF:"hdoff",SHOW_CONTROLS:"showcontrols",HIDE_CONTROLS:"hidecontrols",TRACKING_EVENT:"trackingevent",RENDITION_NOT_FOUND:"renditionnotfound"},e.api.Player=function(a,b){this.MAX_SD_RENDITION=480,this.enableHD=!1,this.isIphone=e.util.isIphone(),this._data=null,this._evts={},this.poster=null,this.totalTimeToSkipAd=15,this.skipAdThreshold=20,this.isReady=!1,this.isLoaded=!1,this.seeking=!1,this.readyCallbacks=[],this.loadedCallbacks=[],this.instance=b,this.isTouch="ontouchstart"in document.documentElement,this.videoFullscreen=!1,this.listenersInitialized=!1,this.rendered=!1,this.rendering=!1,this.queuedPlayOnRendered=!1,this.adPaused=!1,this.adSkipped=!1,this.hdRenditionChanging=!1,this.videoChanged=!1,this.modules={fullscreen:null,renditions:null,responsive:null,conviva:null,errors:null,qos:null},this.playerStartTimestamp=new Date;var c=this.isIphone?!1:!0;this.options=d.extend({id:"",name:null,category:null,element:null,container:null,type:null,src:null,source:null,render:!0,width:600,height:338,muted:!1,preload:"none",autoplay:!1,duration:null,controls:c,nativeControls:!1,nativePoster:!1,loop:!1,ads:!0,skipAd:!0,cover:!0,shareOptions:{articleId:null,blogPostUrl:null,url:null},loader:!0,freewheel:null,siteSection:null,playlist:!1,ratio:"16:9",debug:!1,api:!0,usage:"vanilla_js",mode:null,live:!1,userInitiatedPlay:!1,userInitiatedNext:!1,autoPlayNext:!1,onReady:null,onLoaded:null,renditions:{},conviva:!0,debugConviva:!1,qos:!0,flashHdSwitchSeek:!1,qosConfigUrl:null,enableVHSFullscreen:!1,spacebarToggleEnabled:!0},a),this.controlsIsVisible=!0,this.controlsRendered=!1,this.initialize()},e.api.Player.prototype={initialize:function(){this.logger=new e.api.Logger(this),this.validateEnvironment(),this.setupEnvPaths(),this.options.debugPathSWF=this.options.debugPathSWF||"../../"+e._version+"-"+e._release+"/vhs-debug.swf",this.swf=this.options.debug&&this.options.debugPathSWF?this.options.debugPathSWF:this.staticBaseUrl+"video/vhs/"+e._version+"-"+e._release+"/vhs.swf",this.device=e.util.getDeviceType(),this.firstPlay=!0,this.firstEnded=!0,this.restoreHDState(),this.ensureOptionDependencies(),this.validate()&&this.create()},ensureOptionDependencies:function(){if(e.util.supportsAutoplay()||(this.options.autoplay=!1),!this.options.cover||this.options.poster||this.options.id&&this.options.api||(this.options.cover=!1),this.options.loop&&(this.options.ads=!1,this.options.analytics=!1),this.options.conviva===!1&&(this.options.qos=!1),this.options.qos&&(this.options.conviva=!1),this.options.deeplinking){var a=e.util.getCurrentURL();this.startupSeek=e.util.seekStringToSeconds(a),e.util.getUrlParameterByName("cview")&&(this.defaultAdsState=this.options.ads,this.options.ads=!1)}this.options.analytics===!1&&(this.options.comscore=!1,this.options.conviva=!1,this.options.eventTracker=!1,this.options.qos=!1,this.options.upt=!1,this.options.webtrends=!1,this.options.tagx=!1)},validateEnvironment:function(){var a=["localhost","development","staging","production"],b=["www.nytimes.com","cooking.nytimes.com","paidpost.nytimes.com","brandedplaylist.nytimes.com"],c=e.util.getHost();void 0!==this.options.env||this.options.debug?(-1===d.inArray(this.options.env,a)||-1!==d.inArray(c,b))&&(this.options.env="production"):this.options.env=e.util.getEnvFromHost()},setupEnvPaths:function(){switch(this.options.env){case"localhost":this.apiBaseDomain="http://video-api.dev.nytimes.com",this.staticBaseUrl="http://static.dev.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;case"development":this.apiBaseDomain="http://www.stg.nytimes.com",this.staticBaseUrl="http://static.dev.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;case"staging":this.apiBaseDomain="http://www.stg.nytimes.com",this.staticBaseUrl="http://static.stg.nytimes.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_test/AdManager.swf",this.fwServer="http://fw.stg.nytimes.com/ad/g/1",this.fwNetworkId=379535,this.fwProfile="ny_times_prop_as3_test";break;default:this.apiBaseDomain="http://www.nytimes.com",this.staticBaseUrl="http://static01.nyt.com/",this.fwAdManager="http://adm.fwmrm.net/p/nytimes_live/AdManager.swf",this.fwServer="http://fw.nytimes.com/ad/g/1",this.fwNetworkId=379536,this.fwProfile="ny_times_prop_as3"}this.options.apiBaseDomain&&(this.apiBaseDomain=this.options.apiBaseDomain),this.apiBasePath=this.options.apiBasePath||"/svc/video/api/v2/",this.apiBaseUrl=this.apiBaseDomain+this.apiBasePath},create:function(){var a=this,b=this.options.id;this.element=this.options.element||null,this.modules.features||(this.modules.features=new e.api.FeatureFlags(this)),this.options.flashHdSwitchSeek=this.modules.features.isEnabled("flash-hd-switch-seek"),this.modules.renditions=new e.api.RenditionSelector(this.options),this.detectTearsheeting(),this.renderContainer(),this.plugins=new e.api.Plugins(this),this.modules.conviva||(this.modules.conviva=new e.api.Conviva(this)),this.modules.qos||(this.modules.qos=new e.api.Qos(this)),this.modules.errors||(this.modules.errors=new e.api.Errors(this)),""!==this.options.id&&this.options.api?this.getData(b,"video",function(b){a._data=b,a.plugins.reload(),a.renderPlayer()}):this.renderPlayer(),e.styleLoaded||this.loadControlsStyle(),this.modules.fullscreen=e.util.supportsFullscreen()||this.options.enableVHSFullscreen?new e.api.Fullscreen(this):null},destroy:function(a){this.element&&("html5"===this.options.mode?(this.isPaused()||this.video.pause(),this.adsController&&("function"==typeof this.adsController.unregisterContextListeners&&this.adsController.unregisterContextListeners(),this.adsController.isContentPlaying&&this.adsController.stop()),this.element.attr("src",""),this.element.off(),this.element.unbind(),this.element.remove()):"flash"===this.options.mode&&"undefined"!=typeof b&&this.objectId&&b.removeSWF(this.objectId)),this.container&&this.container.remove(),delete window.vhs_instances[this.instance],"function"==typeof a&&a()},validate:function(){var a=!0;if(""===this.options.id&&null===this.options.src&&null===this.options.source)throw a=!1,new Error("ID, SRC or SOURCE should be provided");if(""===this.options.id&&null===this.options.name)throw a=!1,new Error("NAME should be provided");if(null===this.options.element&&null===this.options.container)throw a=!1,new Error("CONTAINER should be provided");return a},getData:function(a,b,c){var f=this.apiBaseUrl+b+"/"+a,g=a,h=this;for(var i in window.vhs_instances)a===window.vhs_instances[i].options.id&&(g=this.instance);this.options.shareOptions&&(this.options.shareOptions.articleId?f+="?articleId="+encodeURIComponent(this.options.shareOptions.articleId):this.options.shareOptions.blogPostUrl&&(f+="?blogPostUrl="+encodeURIComponent(this.options.shareOptions.blogPostUrl))),d.ajax({url:f,cache:!0,dataType:"jsonp",jsonpCallback:"vhs_callback_"+g,timeout:15e3,success:function(a){c(h.transformData(a,b))},error:function(a,b,c){h.logger.error("error",a,b,c),h.trigger(e.api.events.TRACKING_EVENT,{data:{name:"cherry-api-request-error",errorStatus:b,errorThrown:c}})}})},transformData:function(a,b){return"object"==typeof a&&"video"===b&&"string"==typeof a.byline&&(a.byline=0===a.byline.toLowerCase().indexOf("by ")||0===a.byline.length?a.byline:["By ",a.byline].join("")),a},renderPlayer:function(){var a=this.options.render&&this.options.cover===!1||this.options.autoplay===!0;this.on(e.api.events.RENDERED,function(){a&&this.modules.poster&&this.modules.poster.handleOnClick()}),this.registerSharedListeners(),this.options.autoplay?this.poster=d("<div></div>"):this.renderPoster(),this.modules.responsive||(this.modules.responsive=new e.api.Responsive(this)),(this.options.ads&&this.options.skipAd&&this.options.controls||this.options.deeplinking)&&this.renderSkipAd(),!a&&this.modules.poster&&this.modules.poster.handleOnClick(),a?(this.on(e.api.events.RENDERED,function b(){this._loaded(),this._ready(),this.off(e.api.events.RENDERED,b)}),this.render()):(this._loaded(),this._ready())},renderPoster:function(){this.modules.poster&&this.modules.poster.element?this.modules.poster.update():(this.modules.poster=new e.api.Poster(this),this.modules.poster.render())},render:function(){},renderContainer:function(){var a=this,b=this.options.container;return this.element?(this.container=d("<div></div>"),this.container.insertAfter(this.element)):this.container=null!==b&&"object"==typeof b&&b.length?b:d("#"+b),this.container.addClass("nytd-player-container"),"16:9"===this.options.ratio&&"100%"===this.options.height&&"100%"===this.options.width?this.container.css({background:"#000","padding-bottom":"56.25%",height:0,position:"relative",overflow:"hidden",width:e.util.normalizeUnit(this.options.width)}).data("ratioFix",!0):this.container.css({width:e.util.normalizeUnit(this.options.width),height:e.util.normalizeUnit(this.options.height)}),this.on("playing",function(){a.options.controls&&a.isTouch&&a.modules.controls.hide()}),this.container},loadControlsStyle:function(){var a=d("head"),b=this.staticBaseUrl+"video/vhs/"+e._version+"-"+e._release+"/vhs.css";this.options.debug&&(b="../../"+e._version+"-"+e._release+"/vhs.css",this.options.debugPathCSS&&(b=this.options.debugPathCSS)),e.styleLoaded||(a.append('<style type="text/css">.nytd-player-controls{ display: none; }</style>'),a.append('<link href="'+b+'" rel="stylesheet">'),e.styleLoaded=!0)},_skipAd:function(){this.trigger(e.api.events.AD_SKIPPED),this.skipAd()},renderSkipAd:function(){var a=this;this.skipAdElement=d('<div class="nytd-player-ad-skip-ad" style="display: none;"><span></span><button>skip ad</button></div>'),this.container.append(this.skipAdElement),this.skipAdElement.bind("click",function(b){d(this).hasClass("vhs-countdown-done")&&(b.preventDefault(),a._skipAd())}),this.on(e.api.events.AD_STARTED,function(){a.skipAdElement&&(a.skipAdElement.removeClass("vhs-countdown-done").addClass("vhs-countdown-started").show(),a.skipAdButtonVisible=!1)}),this.on(e.api.events.AD_COMPLETED,function(){a.hideSkipAd()}),this.on(e.api.events.AD_SKIPPED,function(){a.hideSkipAd()}),this.on(e.api.events.AD_STOPPED,function(){a.hideSkipAd()})},hideSkipAd:function(){this.skipAdElement&&this.skipAdElement.hide()},skipAdUpdate:function(a){var b,c,d=Math.round(a),e=("0"+d).slice(-2),f=this.skipAdElement.find("span"),g=(this.skipAdElement.find("button"),Math.round(this.adDuration()));g>=this.skipAdThreshold?d>this.totalTimeToSkipAd?(b=d-this.totalTimeToSkipAd,c=("0"+b).slice(-2),f.html("YOU CAN SKIP THIS AD IN <strong>"+c+"</strong> SECONDS")):this.skipAdButtonVisible||(this.skipAdElement.removeClass("vhs-countdown-started"),this.skipAdElement.addClass("vhs-countdown-done"),this.skipAdButtonVisible=!0):f.html("YOUR VIDEO WILL START IN <strong>"+e+"</strong> SECONDS")},renderControls:function(){this.modules.controls||(this.modules.controls=new e.api.Controls(this),this.modules.controls.initialize(),this.controls=this.modules.controls.element,this.modules.controls.renderHdButton(this._data&&this._data.renditions&&!this.options.live))},_loaded:function(){"function"==typeof this.options.onLoaded&&this.options.onLoaded.apply(this);for(var a=this.loadedCallbacks.length,b=0;a>b;b++)"function"==typeof this.loadedCallbacks[b]&&this.loadedCallbacks[b].apply(this);this.isLoaded=!0,this.container.data("loaded",!0),this.container.trigger("vhs:loaded",this),this.trigger(e.api.events.LOADED)},loaded:function(a){this.isLoaded?a.apply(this):this.loadedCallbacks.push(a)},_ready:function(){"function"==typeof this.options.onReady&&this.options.onReady.apply(this);for(var a=this.readyCallbacks.length,b=0;a>b;b++)"function"==typeof this.readyCallbacks[b]&&this.readyCallbacks[b].apply(this);this.isReady=!0,this.container.data("ready",!0),this.container.trigger("vhs:ready",this),this.trigger(e.api.events.READY),this.readyCallbacks=[]},ready:function(a){this.isReady?a.apply(this):this.readyCallbacks.push(a)},on:function(a,b){if("function"!=typeof b)throw new Error("The callback argument should be a function");this._evts[a]=this._evts[a]||[],this._evts[a].unshift(b)},off:function(a,b){var c;if(this._evts.hasOwnProperty(a)){if(!b)return void delete this._evts[a];c=this._evts[a]||[];for(var d=0,e=c.length;e>d;d++)if(c[d]===b){c.splice(d,1);break}}},trigger:function(a,b){if(this._evts&&"object"==typeof this._evts)for(var c in this._evts)if(c===a)for(var d=this._evts[c]||[],e=d.length-1;e>=0;e--)"function"==typeof d[e]&&d[e].call(this,b)},toggleFullscreen:function(){this.fullscreen(!this.isFullscreen())},isFullscreen:function(){return this.modules.fullscreen.isEnabled()},fullscreen:function(a){if(!this.modules.fullscreen)return!1;var b=this.modules.fullscreen,c=a===!1?!1:!0;c&&this.poster&&this.poster.hide(),
c?b.enter():b.exit()},getSiteSection:function(){function a(a){var b=""===a?"none":a;return b.replace(/[^a-zA-Z]/g,"").toLowerCase()}var b=d('meta[name="CG"]').attr("content")||"",c=d('meta[name="SCG"]').attr("content")||"",e=d('meta[name="PT"]').attr("content")||"",f=a(b)+"_"+a(c)+"_"+a(e);return f},getPlayerType:function(){var a=d('meta[name="PT"]').attr("content"),b=d('meta[name="PST"]').attr("content"),c=d('meta[name="slug"]').attr("content"),e=a&&b?a.toLowerCase()+"-"+b.toLowerCase():null,f=null;return this.options.type?f=this.options.type:"multimedia-interactive"===e&&c?f=e+"|"+c:e?f=e:this.logger.error("Player TYPE should be provided"),f},getVideoId:function(){var a="unknown";return this._data&&this._data.id?a=this._data.id:this.options&&this.options.id&&(a=this.options.id),a},getTitle:function(){var a="";return this.options.name?a=this.options.name:this._data&&this._data.headline&&(a=this._data.headline),a},getCategory:function(){var a="";return this.options.category?a=this.options.category:this._data&&this._data.section&&this._data.section.content&&(a=this._data.section.content),a},getSeries:function(){var a="";return this.options.series?a=this.options.series:this._data&&this._data.contentSeries&&(a=this._data.contentSeries.name),a},getDuration:function(){var a=0;return this.options.duration?a=this.options.duration:this._data&&this._data.duration?a=this._data.duration:this.video&&(a="function"==typeof this.video.duration?this.video.duration():this.video.duration),a/1e3||0},getPrimaryPlaylistId:function(){var a="";return this.options.playlistId?a=this.options.playlistId:this._data&&this._data.playlist&&(a=this._data.playlist.id),a},togglePlay:function(){this.isPaused()||this.isEnded()?this.play():this.pause()},hideControls:function(){this.modules&&this.modules.controls&&this.modules.controls.hide()},showControls:function(){this.modules&&this.modules.controls&&this.modules.controls.show()},addLoader:function(){this.container&&this.options.loader&&0===this.container.find(".vhs-loader").length&&this.container.append('<div class="vhs-loader"></div>')},removeLoader:function(){var a;this.container&&(a=this.container.find(".vhs-loader"),a.length>0&&a.remove())},registerSharedListeners:function(){this.on(e.api.events.PLAY,function(){this.firstPlay=!1,this.pauseOtherPlayers(),this.removeLoader()}),this.on(e.api.events.AD_STARTED,function(){this.firstPlay=!1,this.pauseOtherPlayers(),this.removeLoader()}),this.on(e.api.events.AD_RESUMED,function(){this.pauseOtherPlayers()})},pauseOtherPlayers:function(){if(!e.config.allowMultiplePlayers)for(var a in window.vhs_instances)this.instance!==a&&window.vhs_instances[a].pause()},triggerHDEvent:function(){this.enableHD?(c.enabled&&c.set("nytvhshd","1"),this.trigger(e.api.events.HD_ON)):(c.enabled&&c.set("nytvhshd"),this.trigger(e.api.events.HD_OFF))},restoreHDState:function(){this.enableHD="1"===c.get("nytvhshd")},bindStartupSeekEvents:function(){var a=this,b="html5"===this.options.mode?e.api.events.VIDEO_READY:e.api.events.PLAY;this.on(e.api.events.RENDERED,function c(){this.on(b,function d(){a.off(b,d),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(e.api.events.RENDERED,c)}),this.options.ads&&(this.on(e.api.events.AD_COMPLETED,function d(){this.on(b,function c(){a.off(b,c),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(e.api.events.AD_COMPLETED,d)}),this.on(e.api.events.AD_SKIPPED,function f(){this.on(b,function c(){a.off(b,c),this.startupSeek<this.getDuration()&&a.seek(this.startupSeek)}),this.off(e.api.events.AD_SKIPPED,f)})),this.on(e.api.events.ENDED,function g(){a.off(e.api.events.ENDED,g),a.resetStartupSeekState()})},resetStartupSeekState:function(){this.options.ads=this.defaultAdsState?this.defaultAdsState:this.options.ads,"flash"===this.options.mode&&this.startupSeek&&this.restoreAdsStatus(),this.startupSeek=void 0},detectTearsheeting:function(){e.config.ts||(e.config.ts=!0,function(a){var b,c,d,e,f,g=window.location.search,h="",i="_ro",j=1;if(g){if(b=/[&?]tsdel=/.exec(g),!b){if(c=/[&?]tspid=([^&#]*)/.exec(g),!c)return;f=c[1],d=a?"tearsheet.fw.nytimes.com":"tearsheet.fw.stg.nytimes.com",h=encodeURIComponent(["Candidate-Ads=",f,";","Internal-Call;","Opt-Out;","Testing-Placement=true;","Commercial-Pattern=14852;;","Target-Server;","domain=",d,";","Reload-Ads=",f].join(""))}e=new Date,e.setTime(e.getTime()+24*j*60*60*1e3),document.cookie=i+"="+h+";expires="+e+";domain=.nytimes.com;path=/"}}("production"===this.options.env))}},e.api.HtmlFive=function(a,b){e.api.Player.call(this,a,b)},e.api.HtmlFive.prototype=e.util.extend(e.api.Player.prototype),e.api.HtmlFive.prototype.getType=function(){return"html5"},e.api.HtmlFive.prototype.load=function(a,b){var c=this,d=b||!1;this.hdRenditionChanging=!1,this.resetStartupSeekState(),this.getData(a,"video",function(a){c._data=a,c.plugins.reload(),c.renderSource(),c.trigger(e.api.events.LOAD_START),c.modules.poster&&(c.modules.poster.update(),c.options.nativePoster&&c.modules.poster.removeNativePoster()),c.element[0].load(),c.adPlaying()&&c.trigger(e.api.events.AD_STOPPED),c.adsController&&(c.adsController.isCompleted=!1,c.adsController.isContentPlaying=!1),d&&c.play()})},e.api.HtmlFive.prototype.render=function(){this.on(e.api.events.RENDERED,function(){this.options.muted&&this.mute(!0),this.trigger(e.api.events.LOAD_START),this.options.autoplay&&this.play()}),this.startupSeek&&this.bindStartupSeekEvents(),this.options.autoplay&&this.addLoader(),this.renderElement(),this.container.append(this.element),this.video=this.element[0],this.primeVideoElement(),this.renderElementAttr(),this.renderSource(),this.options.controls&&!this.options.nativeControls&&(this.renderControls(),this.element.find("source").on("error",d.proxy(this.modules.controls.onSourceError,this.modules.controls))),this.registerListeners(),this.rendered=!0,this.trigger(e.api.events.RENDERED)},e.api.HtmlFive.prototype.primeVideoElement=function(){var a=e.util.isIpad()||e.util.isIphone()||e.util.isAndroid();a&&this.video&&(this.video.play(),this.video.pause())},e.api.HtmlFive.prototype.renderElement=function(){if(this.options.element){var a=this.options.element;this.element=a.clone(!0),a.remove()}else this.element=d("<video />")},e.api.HtmlFive.prototype.renderElementAttr=function(){var a=this.element.attr("id"),b=this.options.cover||this.options.autoplay?"auto":this.options.preload;this.element.attr({preload:b,"x-webkit-airplay":"allow"}),this.element.css({height:"100%",width:"100%"}),"16:9"===this.options.ratio&&"100%"===this.options.height&&"100%"===this.options.width&&this.element.css({position:"absolute",top:0,left:0}),this.options.loop&&this.element.attr("loop","loop"),this.options.src&&this.element.attr("src",this.options.src),a&&""!==a||this.element.attr("id","video_"+(new Date).getTime()),(this.options.nativeControls||"android_legacy"===this.device||"ie_mobile"===this.device)&&(this.options.nativeControls=!0,this.element.attr("controls","controls")),this.modules.poster&&this.options.nativePoster&&this.modules.poster.renderNativePoster()},e.api.HtmlFive.prototype.renderSource=function(){var a,b;if(this.options.src)b=this.options.src;else if(this.options.source){this.element.empty();for(var c in this.options.source)a=d("<source />"),a.attr({src:this.options.source[c],type:c}),this.element.append(a)}else this._data&&this._data.renditions&&(b=this.modules.renditions.getClosestRenditionUrl(this._data.renditions,this.element.height(),this.enableHD));b?(this.element.attr("src",b),this.modules.renditions.setActive(b)):this.options.source?this.modules.renditions.setActive(this.options.source):(this.trigger(e.api.events.RENDITION_NOT_FOUND),this.modules.renditions.resetActive()),this.videoChanged=!0},e.api.HtmlFive.prototype.adPlaying=function(){return this.adsController&&this.adsController.isContentPlaying?!0:!1},e.api.HtmlFive.prototype.adInitializing=function(){return this.adsController&&this.adsController.isInitializing?!0:!1},e.api.HtmlFive.prototype.adCompleted=function(){return this.adsController&&this.adsController.isCompleted?!0:!1},e.api.HtmlFive.prototype.getAdTitle=function(){var a="";return this.adsController&&(a=this.adsController.getAdTitle()),a},e.api.HtmlFive.prototype.fixForAndroidHLSBug=function(){"android_jellybean"===this.device&&this.firstEnded&&(this.pause(),this.play(),this.firstEnded=!1)},e.api.HtmlFive.prototype.registerListeners=function(){var a=this,b=this.element.attr("controls");this.listenersInitialized===!1&&(this.element.on(e.api.events.LOADED_DATA,function(){a.trigger(e.api.events.VIDEO_READY)}),this.element.on("play",function(){a.logger.log("html5 play event"),a.options.ads&&!a.adPlaying()&&!a.adCompleted()&&e.util.supportsAds()?a.adsController?a.adsController.nextAd(function(a,b){this.start()}):a.adsController=new e.html.Ads(a,function(a,b){this.start()}):a.adPaused&&!a.adCompleted()?(a.adPaused=!1,a.trigger(e.api.events.AD_RESUMED)):a.adPlaying()||a.trigger(e.api.events.PLAY)}),b||this.isTouch||this.element.on("click",function(b){a.togglePlay(),b.stopPropagation()}),this.element.on("playing",function(){a.logger.log("html5 playing event"),a.modules.poster&&a.modules.poster.hide(),a.adPlaying()||a.adInitializing()||a.trigger(e.api.events.PLAYING)}),this.element.on("progress",function(b){a.adPlaying()?a.trigger(e.api.events.AD_PROGRESS,b):a.trigger(e.api.events.PROGRESS,b)}),this.element.on("timeupdate",function(b){a.adPlaying()?a.trigger(e.api.events.AD_TIME_UPDATE,a.video.currentTime):a.trigger(e.api.events.TIME_UPDATE,a.video.currentTime)}),this.element.on("seeked",function(){a.logger.log("html5 seeked event"),a.adPlaying()||a.trigger(e.api.events.SEEKED)}),this.element.on("pause",function(){a.logger.log("html5 pause event"),a.isEnded()||(a.adPlaying()||a.adInitializing()?a.adPlaying()&&!a.adSkipped&&(a.adPaused=!0,a.trigger(e.api.events.AD_PAUSED)):a.trigger(e.api.events.PAUSE))}),this.element.on("durationchange",function(){a.trigger(e.api.events.DURATION_CHANGE,a.element[0].duration||0)}),this.element.on("ended",function(){a.logger.log("html5 ended event"),a.adPlaying()||a.trigger(e.api.events.ENDED),a.options.live&&a.fixForAndroidHLSBug()}),this.element.on(e.api.events.ERROR,function(b){a.logger.log("html5 error event",b),a.trigger(e.api.events.ERROR,b)}),this.element.on(e.api.events.STALLED,function(b){a.logger.log("html5 stalled event",b),a.trigger(e.api.events.STALLED,b)}),this.element.on(e.api.events.WAITING,function(){a.logger.log("html5 waiting event"),a.trigger(e.api.events.WAITING)}),this.initializeSpacebarToggle(),this.listenersInitialized=!0)},e.api.HtmlFive.prototype.initializeSpacebarToggle=function(){var a=this;this.options.spacebarToggleEnabled&&(this.container.attr("tabindex","-1"),this.container.off("keydown.vhs"),this.container.on("keydown.vhs",function(b){b&&32===b.keyCode&&(b.preventDefault(),a.togglePlay())}))},e.api.HtmlFive.prototype.reloadVideo=function(){this.video&&(this.video.load(),this.video.play(),this.trigger(e.api.events.LOAD_START))},e.api.HtmlFive.prototype.toggleVolume=function(){this.mute(!this.isMuted())},e.api.HtmlFive.prototype.duration=function(){return this.video?this.video.duration:0},e.api.HtmlFive.prototype.play=function(){var a=this;this.firstPlay&&!this.options.autoplay&&this.addLoader();var b=function(){var b=!0;return a.videoChanged&&a.options.conviva&&a.modules&&a.modules.conviva&&!e.libraries.conviva.failed&&(b=a.modules.conviva.trackVideo(),b&&(a.videoChanged=!1)),b},c=function(){b()&&a.modules.renditions.getActive()&&a.video&&a.video.play()};this.rendered?c():"desktop"===e.util.getDeviceType()?(this.on(e.api.events.LOAD_START,function d(){c(),a.off(e.api.events.LOAD_START,d)}),this.render()):(this.render(),c())},e.api.HtmlFive.prototype.pause=function(){this.video&&this.video.pause()},e.api.HtmlFive.prototype.isPaused=function(){return this.video?this.video.paused:!0},e.api.HtmlFive.prototype.isEnded=function(){return this.video?this.video.ended:!1},e.api.HtmlFive.prototype.mute=function(a){var b;b=a===!1?!1:!0,this.element[0].muted=b,this.trigger(e.api.events.MUTE,b)},e.api.HtmlFive.prototype.isMuted=function(){return this.video?this.video.muted:void 0},e.api.HtmlFive.prototype.getCurrentTime=function(){return this.video?this.video.currentTime:0},e.api.HtmlFive.prototype.getCurrentSource=function(){return this.video?this.video.src||this.video.currentSrc:""},e.api.HtmlFive.prototype.seek=function(a){var b=this.element[0];if("number"!=typeof a)throw new Error("time argument should be a Number");if(0>a||a>b.duration)throw new Error("time should be greater than 0 and lower than the duration of the video");b.currentTime=a},e.api.HtmlFive.prototype.skipAd=function(){this.adSkipped=!0,this.adsController.stop()},e.api.HtmlFive.prototype.adDuration=function(){var a=0;return this.adsController&&(a=this.adsController.currentSlot?this.adsController.currentSlot.getTotalDuration():this.adsController.getAdInstanceDuration()),a},e.api.HtmlFive.prototype.toggleHD=function(){var a=this,b=this.element.get(0),c=b.currentTime;this.hdRenditionChanging=!0,this.enableHD=!this.enableHD,b.pause(),this.renderSource(),this.triggerHDEvent(),this.element.one("canplaythrough",function(){b.currentTime=c,b.play()}),this.element.one("seeked",function(){a.hdRenditionChanging=!1}),b.load()},e.html.Ads=function(a,b){var c=this,d=!0;switch(this.player=a,this.callback=b,this.adsLoaded=!1,this.serverURL="http://fw.nytimes.com/ad/g/1",this.siteSectionId=this.player.options.siteSection||this.player.options.freewheel||this.player.getSiteSection(),this.isCompleted=!1,this.isContentPlaying=!1,this.currentSlot=null,this.isInitializing=!0,this.adStarted=!1,this.player.options.env){case"development":case"staging":this.networkId=379535,this.profileId="379535:ny_times_js_test",this.adManagerUrl="http://adm.fwmrm.net/p/nytimes_test/AdManager.js",this.serverURL="http://fw.stg.nytimes.com/ad/g/1",d=!1;break;default:this.networkId=379536,this.profileId="379536:ny_times_js_live",this.adManagerUrl="http://adm.fwmrm.net/p/nytimes_live/AdManager.js"}this.player.element[0].pause(),this.loadAdManager(function(){c.adManager=new tv.freewheel.SDK.AdManager,c.adManager.setNetwork(c.networkId),c.adManager.setServer(c.serverURL),c.setupAdContext()})},e.html.Ads.prototype.nextAd=function(a){this.callback=a,this.isCompleted=!1,this.setupAdContext()},e.html.Ads.prototype.loadAdManager=function(a){var b=this,c=function(a,b,c){this.player.options.ads=!1,this.adStarted=!1,this.isCompleted=!0,this.isContentPlaying=!1,this.isInitializing=!1,this.player.adSkipped=!1,this.player.element[0].play(),this.player.trigger(e.api.events.TRACKING_EVENT,{data:{name:e.api.events.FW_ADMANAGER_LOAD_ERROR,errorStatus:b||"",errorThrown:c||""}})};e.util.getScript({url:b.adManagerUrl,success:function(){a.call(b)},error:function(a,d,e){c.call(b,a,d,e)},cache:!0,dataType:"script",timeout:5e3})},e.html.Ads.prototype.setupAdContext=function(){var a=(this.player.element,this.player.element.attr("id"),this.player.container.attr("id")),b=this.player.getDuration(),c=this.player.instance;this.player._data&&this.player._data.id?c=this.player._data.id:this.player.options&&this.player.options.id&&(c=this.player.options.id),this.theContext&&"function"==typeof this.theContext.dispose&&(this.unregisterContextListeners(),this.theContext.dispose()),this.theContext=this.adManager.newContext(),this.theContext.registerVideoDisplayBase(a),this.theContext.setProfile(this.profileId),this.theContext.setVideoAsset(c,b,this.networkId),this.theContext.setSiteSection(this.siteSectionId,this.networkId),this.registerContextListeners(),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_START_DETECT_TIMEOUT,1e4,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_PROGRESS_DETECT_TIMEOUT,1e4,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.setParameter(tv.freewheel.SDK.PARAMETER_RENDERER_VIDEO_DISPLAY_CONTROLS_WHEN_PAUSE,!1,tv.freewheel.SDK.PARAMETER_LEVEL_GLOBAL),this.theContext.addTemporalSlot("Preroll_1",tv.freewheel.SDK.ADUNIT_PREROLL,0),this.theContext.submitRequest(2)},e.html.Ads.prototype.registerContextListeners=function(){this.theContext&&tv&&tv.freewheel&&"function"==typeof this.theContext.addEventListener&&(this.theContext.addEventListener(tv.freewheel.SDK.EVENT_REQUEST_COMPLETE,d.proxy(this.onRequestComplete,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_SLOT_ENDED,d.proxy(this.onSlotEnded,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_SLOT_STARTED,d.proxy(this.onSlotStarted,this)),this.theContext.addEventListener(tv.freewheel.SDK.EVENT_AD,d.proxy(this.onEventAd,this)))},e.html.Ads.prototype.unregisterContextListeners=function(){this.theContext&&tv&&tv.freewheel&&"function"==typeof this.theContext.removeEventListener&&(this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_REQUEST_COMPLETE),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_SLOT_ENDED),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_SLOT_STARTED),this.theContext.removeEventListener(tv.freewheel.SDK.EVENT_AD,d.proxy(this.onEventAd,this)))},e.html.Ads.prototype.onRequestComplete=function(a){if(this.adsLoaded=!0,this.prerollSlots=[],this.midrollSlots=[],this.overlaySlots=[],this.postrollSlots=[],a.success)for(var b=this.theContext.getTemporalSlots(),c=0,d=b.length;d>c;c++){var e=b[c];switch(e.getTimePositionClass()){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.prerollSlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL:this.midrollSlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY:this.overlaySlots.push(e);break;case tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL:this.postrollSlots.push(e)}}this.prerollSlots&&this.prerollSlots.length?this.callback(null,this.prerollSlots):this.callback(new Error("No prerolls available"))},e.html.Ads.prototype.getState=function(){return this.isCompleted},e.html.Ads.prototype.onEventAd=function(a){if(a&&a.subType)switch(a.subType){case tv.freewheel.SDK.EVENT_AD_FIRST_QUARTILE:this.player.trigger(e.api.events.AD_FIRST_QUARTILE);break;case tv.freewheel.SDK.EVENT_AD_MIDPOINT:this.player.trigger(e.api.events.AD_MIDPOINT);break;case tv.freewheel.SDK.EVENT_AD_THIRD_QUARTILE:this.player.trigger(e.api.events.AD_THIRD_QUARTILE);break;case tv.freewheel.SDK.EVENT_ERROR:this.player.trigger(e.api.events.AD_ERROR,a);break;case tv.freewheel.SDK.EVENT_AD_CLICK:case tv.freewheel.SDK.EVENT_AD_IMPRESSION:case tv.freewheel.SDK.EVENT_AD_IMPRESSION_END:case tv.freewheel.SDK.EVENT_AD_COMPLETE:case tv.freewheel.SDK.EVENT_AD_MUTE:case tv.freewheel.SDK.EVENT_AD_UNMUTE:case tv.freewheel.SDK.EVENT_AD_PAUSE:case tv.freewheel.SDK.EVENT_AD_RESUME:case tv.freewheel.SDK.EVENT_AD_REWIND:case tv.freewheel.SDK.EVENT_AD_EXPAND:case tv.freewheel.SDK.EVENT_AD_COLLAPSE:case tv.freewheel.SDK.EVENT_AD_MINIMIZE:case tv.freewheel.SDK.EVENT_AD_ACCEPT_INVITATION:case tv.freewheel.SDK.EVENT_AD_CLOSE:case tv.freewheel.SDK.EVENT_RESELLER_NO_AD:}},e.html.Ads.prototype.onSlotStarted=function(a){var b=a.slot.getTimePositionClass(),c=a.slot.getTotalDuration();if(c>0)switch(b){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.isCompleted=!1,this.isContentPlaying=!0,this.adStarted=!0,this.setCurrentlyPlayingSlot(this.prerollSlots[0]),this.player.trigger(e.api.events.AD_STARTED)}},e.html.Ads.prototype.onSlotEnded=function(a){var b=a.slot.getTimePositionClass(),c=a.slot.getTotalDuration();switch(b){case tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL:this.prerollSlots.length&&(this.prerollSlots.shift(),this.prerollSlots.length?(this.prerollSlots[0].play(),this.setCurrentlyPlayingSlot(this.prerollSlots[0])):this.resumeContent(c));break;case tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL:case tv.freewheel.SDK.TIME_POSITION_CLASS_MIDROLL:case tv.freewheel.SDK.TIME_POSITION_CLASS_OVERLAY:case tv.freewheel.SDK.TIME_POSITION_CLASS_DISPLAY:}},e.html.Ads.prototype.setPlayerSource=function(){var a=this.player.modules.renditions.getActive(),b=this.player.element.find("source").length>0;b?this.player.element.removeAttr("src"):this.player.element.attr("src",a)},e.html.Ads.prototype.resumeContent=function(a){var b=this;!this.player.adSkipped&&(a&&a>0||this.adStarted)&&this.player.trigger(e.api.events.AD_COMPLETED),this.adStarted=!1,this.isCompleted=!0,this.isContentPlaying=!1,this.setPlayerSource(),this.player.element[0].load(),this.player&&this.player.options.conviva&&this.player.modules&&this.player.modules.conviva&&this.player.modules.conviva.startConvivaSession(),this.player.element[0].play(),this.setCurrentlyPlayingSlot(null),this.theContext&&this.theContext.setVideoState(tv.freewheel.SDK.VIDEO_STATE_PLAYING),this.player.on(e.api.events.ENDED,function(){b.theContext&&b.theContext.setVideoState(tv.freewheel.SDK.VIDEO_STATE_COMPLETED)}),this.player.adSkipped=!1},e.html.Ads.prototype.setCurrentlyPlayingSlot=function(a){this.currentSlot=a},e.html.Ads.prototype.getCurrentlyPlayingSlot=function(){return this.currentSlot},e.html.Ads.prototype.getAdTitle=function(){var a,b=this.getCurrentlyPlayingSlot(),c=[],d="";return b&&(c=b.getAdInstances(),c.length>0&&(a=c[0],a&&(d=a.getAdId()))),d},e.html.Ads.prototype.getAdInstanceDuration=function(){var a,b=this.getCurrentlyPlayingSlot(),c=[],d=0;return b&&(c=b.getAdInstances(),c.length>0&&(a=c[0],a&&(d=a.getDuration()))),d},e.html.Ads.prototype.start=function(){this.isInitializing=!1,this.player.options.ads&&(this.prerollSlots&&this.prerollSlots.length?(this.isCompleted=!1,this.isContentPlaying=!0,this.setCurrentlyPlayingSlot(this.prerollSlots[0]),this.prerollSlots[0].play()):this.resumeContent())},e.html.Ads.prototype.stop=function(){this.currentSlot&&this.currentSlot.stop()},e.html.Ads.prototype.pause=function(){this.player.element[0].pause()},e.html.Ads.prototype.resume=function(){this.player.element[0].play()},e.api.Flash=function(a,b){e.api.Player.call(this,a,b)},e.api.Flash.prototype=e.util.extend(e.api.Player.prototype),e.api.Flash.prototype.getType=function(){return"flash"},e.api.Flash.prototype.load=function(a,b){var c=this,d=b||!1;this.hdRenditionChanging=!1,this.resetStartupSeekState(),this.adPlaying()&&this.stopAd(),this.getData(a,"video",function(a){c._data=a,c.plugins.reload(),c.renderSource(),c.trigger(e.api.events.LOAD_START),c.modules.poster&&c.modules.poster.update(),d&&c.play()})},e.api.Flash.prototype.restoreAdsStatus=function(){this.video&&this.video.setAdsStatus({status:this.options.ads,fwAdManager:this.fwAdManager,fwServer:this.fwServer,fwNetworkId:this.fwNetworkId,fwProfile:this.fwProfile,fwSiteSection:this.options.siteSection||this.options.freewheel||this.getSiteSection()})},e.api.Flash.prototype.render=function(){this.rendering||this.rendered||(this.rendering=!0,this.element&&this.element.remove(),this.options.autoplay&&this.addLoader(),this.renderElement(),this.options.controls&&!this.options.nativeControls&&this.renderControls(),this.registerListeners())},e.api.Flash.prototype.renderElement=function(){var a="video_"+(new Date).getTime(),c={instance:this.instance},f=this,g=!0,h=d("<div></div>");h.attr("id",a),this.container.append(h),this.objectId=a,this.options.muted&&(c.muted=!0),c.live=this.options.live,c.ads=this.options.ads,c.id=this.options.id||"",c.autoplay=this.options.autoplay,c.env=this.options.env,c.type=this.getPlayerType(),c.version=e._version,c.hdSwitchSeek=this.options.flashHdSwitchSeek,c.spacebarToggleEnabled=this.options.spacebarToggleEnabled,c.loop=this.options.loop,c.ads&&(c.mediaLocation=this.options.live?this.options.src:null,c.fwAdManager=this.fwAdManager,c.fwServer=this.fwServer,c.fwNetworkId=this.fwNetworkId,c.fwProfile=this.fwProfile,c.fwSiteSection=this.options.siteSection||this.options.freewheel||this.getSiteSection()),c.conviva=this.options.conviva,this.modules.conviva&&(c.CONVIVA_PLUGIN_URL=this.modules.conviva.FLASH_PLUGIN_URL,c.CONVIVA_CUSTOMER_ID=this.modules.conviva.CUSTOMER_ID,c.CONVIVA_SERVICE_URL=this.modules.conviva.SERVICE_URL),c.qos=this.options.qos,this.modules.qos&&(c.QOS_CONFIG_PATH=this.modules.qos.CONFIG_PATH,c.QOS_SWF_PATH=this.modules.qos.SWF_PATH);var i={allowFullScreen:!0,allowScriptAccess:"always",wmode:"opaque",seamlessTabbing:!1,swliveconnect:!0,quality:"high",bgcolor:"#000000"},j={id:a},k=function(a){};this.startupSeek&&this.bindStartupSeekEvents(),this.options.autoplay&&this.on(e.api.events.RENDERED,function l(){f.logger.log("RENDERED RECEIVED. HAPPENS WHEN FLASH RETURNS VIDEO_READY"),f.play(),f.off(e.api.events.RENDERED,l)}),b.embedSWF(this.swf,a,"100%","100%","11.0",null,c,i,j,k,g)},e.api.Flash.prototype.externalInterface=function(){this.logger.log("ExternalInterface initialized"),this.element=this.container.find("object"),this.video=this.element[0];var a=this,b=function(){a.rendered||(a.rendered=!0,a.trigger(e.api.events.RENDERED)),a.off(e.api.events.VIDEO_READY,b)};this.on(e.api.events.VIDEO_READY,b),this.renderSource(),this.modules.renditions.getActive()||b()},e.api.Flash.prototype.renderSource=function(){var a,b,c,d=this.options,f=d.id,g=d.name,h=d.category,i=this.hdUserInteraction?"true":"false";if(d.src)a=this.options.src;else if(d.source)for(var j in d.source)"video/mp4"===j&&(a=d.source[j]);else{if(!this._data||!this._data.renditions)throw new Error("at least one rendition should be provided.");f=this._data.id,g=this._data.headline,c=this.modules.renditions.getClosestRenditionObject(this._data.renditions,this.element.height(),this.enableHD,this.getType()),c&&c.url&&(a=c.url,b=c.bitrate),this._data.section&&(h=this._data.section.content)}a?(this.modules.renditions.setActive(a),this.video.loadPlayerData({id:f,name:g,url:a,type:"video/mp4",duration:this.getDuration(),hdInteraction:i,bitrate:b,category:h})):(this.trigger(e.api.events.RENDITION_NOT_FOUND),this.modules.renditions.resetActive())},e.api.Flash.prototype.registerListeners=function(){this.on(e.api.events.BUFFERING,function(){this.addLoader()}),this.on(e.api.events.BUFFER_FULL,function(){this.removeLoader()})},e.api.Flash.prototype.duration=function(){return this.video?this.video.duration():0},e.api.Flash.prototype.skipAd=function(){this.video&&this.video.skipAd()},e.api.Flash.prototype.stopAd=function(){this.video&&(this.video.stopAd(),this.trigger(e.api.events.AD_STOPPED))},e.api.Flash.prototype.playAd=function(){this.video&&this.video.playAd()},e.api.Flash.prototype.pauseAd=function(){this.video&&this.video.pauseAd()},e.api.Flash.prototype.stop=function(){this.video&&this.video.stopVideo()},e.api.Flash.prototype.reloadLiveVideo=function(){var a=this;this.on(e.api.events.VIDEO_READY,function b(){a.logger.log("Reload LIVE Video VIDEO_READY (flash)"),a.video.playVideo(),a.off(e.api.events.VIDEO_READY,b)}),this.renderSource(),this.modules&&this.modules.controls&&this.modules.controls.configureLive()},e.api.Flash.prototype.play=function(){var a=this;this.firstPlay&&!this.options.autoplay&&this.addLoader();var b=function(){a.modules.renditions.getActive()&&a.video&&(a.firstPlay&&a.trigger(e.api.events.LOAD_START),a.adPlaying()?a.playAd():a.options.live&&a.isEnded()?a.reloadLiveVideo():a.video.playVideo&&a.video.playVideo())};if(this.rendered)b();else if(this.rendering){if(this.options.autoplay||this.queuedPlayOnRendered)return;this.queuedPlayOnRendered=!0,this.on(e.api.events.RENDERED,function c(){b(),a.off(e.api.events.RENDERED,c),a.queuedPlayOnRendered=!1})}else this.on(e.api.events.RENDERED,function d(){b(),a.off(e.api.events.RENDERED,d)}),this.render()},e.api.Flash.prototype.pause=function(){this.rendered&&(this.adPlaying()?this.pauseAd():this.isContentPlaying()&&this.video.pauseVideo())},e.api.Flash.prototype.isPaused=function(){return this.video?this.video.isPaused():!0},e.api.Flash.prototype.isEnded=function(){return this.video?this.video.isEnded():!1},e.api.Flash.prototype.isContentPlaying=function(){return this.video?this.video.isContentPlaying():void 0},e.api.Flash.prototype.adPlaying=function(){return this.video?this.video.adPlaying():void 0},e.api.Flash.prototype.adCompleted=function(){return this.video?this.video.adComplete():void 0},e.api.Flash.prototype.adDuration=function(){return this.video?this.video.adDuration():0},e.api.Flash.prototype.adCurrentTime=function(){return this.video?this.video.adCurrentTime():void 0},e.api.Flash.prototype.seek=function(a){if("number"!=typeof a)throw new Error("time argument should be a Number");if(0>a||a>this.video.duration())throw new Error("time should be greater than 0 and lower than the duration of the video");this.video.seek({seconds:a})},e.api.Flash.prototype.reloadVideo=function(){var a=this;this.on(e.api.events.VIDEO_READY,function b(){a.logger.log("Reload Video VIDEO_READY (flash)"),a.play(),a.off(e.api.events.VIDEO_READY,b)}),this.renderSource(),this.trigger(e.api.events.LOAD_START)},e.api.Flash.prototype.mute=function(a){this.video&&(a?this.video.mute():this.video.unmute())},e.api.Flash.prototype.unmute=function(){this.video&&this.video.unmute()},e.api.Flash.prototype.toggleVolume=function(){this.video&&this.mute(!this.video.isMuted())},e.api.Flash.prototype.isMuted=function(){return this.video?this.video.isMuted():void 0},e.api.Flash.prototype.onElementClick=function(){this.togglePlay()},e.api.Flash.prototype.getCurrentTime=function(){return this.video?this.video.currentTime():0},e.api.Flash.prototype.getCurrentSource=function(){return this.video?this.video.getCurrentSource():""},e.api.Flash.prototype.toggleHD=function(a){var b=this.video.currentTime(),c=this;this.on(e.api.events.VIDEO_READY,function d(){c.logger.log("Flash HD Rendition Switch VIDEO_READY"),c.play(),c.off(e.api.events.VIDEO_READY,d),c.seek(b),c.hdRenditionChanging=!1}),this.hdRenditionChanging=!0,this.enableHD=!this.enableHD,this.hdUserInteraction=null!==a.type.match(/(click|touch)/gi),this.pause(),this.renderSource(),this.hdUserInteraction=!1,this.triggerHDEvent()},window.vhs_instances=window.vhs_instances||{},e.styleLoaded=!1,e.findInstance=function(a){var b,c;if(a&&("string"==typeof a?c=a:"object"==typeof a&&"function"==typeof a.attr&&(c=a.attr("id")),c))for(var d in window.vhs_instances)if(window.vhs_instances.hasOwnProperty(d)&&(b=window.vhs_instances[d].container,b&&"object"==typeof b&&"function"==typeof b.attr&&b.attr("id")===c))return window.vhs_instances[d]},e.player=function(a){var b,c,d=(new Date).getTime(),f="player_"+Math.round(Math.random()*d),g=e.util;return a.mode=a.mode||"flash",(c=e.findInstance(a.container))?(window.console&&"function"==typeof window.console.error&&window.console.error("VHS ERROR: Container is already in use.  Please destroy before creating a new VHS instance using this container: ",a.container),c):(!g.getSupportedType()||g.checkFlashSupport()&&"html5"!==a.mode&&!g.isSafari()?(a.mode="flash",b=new e.api.Flash(a,f)):(a.mode="html5",a.source&&e.util.isIE9()&&(a.ads=!1),b=new e.api.HtmlFive(a,f)),b&&(window.vhs_instances[f]=b,b.instanceId=f),b)},e.auto=function(){var a,b,c,f,g=d("figure[data-nytd]");if(g.length>0)for(a=0,b=g.length;b>a;a++)f=g.eq(a),c=f.data("setup")||{},c.id=c.nytd||f.data("nytd"),c.container=f,c.usage="figure_tag",e.player(c)},e.shortcuts=function(){d&&d(function(){e.auto()})},e._version="2.32.0",e._release="385",e._build="desktop",e.shortcuts(),e});