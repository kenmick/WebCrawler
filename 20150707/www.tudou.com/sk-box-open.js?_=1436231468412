(function(b){window.XBox={version:"v2.0.11",init:function(a){var c=b.defaultConfig(a.site,this.version);b.util.extend(c,a||{});if(",1,2,3,14,15,50,51,52,61,62,".indexOf(","+c.site+",")!=-1)b.content=new b.KuBox(c)},clean:function(){b.content.cleanRefresh();b.content._bword()==""&&b.content._uword("")},kUpdate:function(a){b.content.kUpdate(a,!0)},yUpdate:function(a){b.content.yUpdate(a)},cUpdate:function(){b.content.cUpdate()}};b.util={readCookie:function(a){var c="";a+="=";if(document.cookie.length>
0&&(offset=document.cookie.indexOf(a),offset!=-1)){offset+=a.length;end=document.cookie.indexOf(";",offset);if(end==-1)end=document.cookie.length;c=unescape(document.cookie.substring(offset,end))}return c},writeCookie:function(a,c,d,b,f){var h="";d!=null&&(h=new Date((new Date).getTime()+d*36E5),h="; expires="+h.toGMTString());document.cookie=a+"="+escape(c)+h+(f==null?"":"; path="+f)+(b==null?"":";domain="+b)},updateHistory:function(a,c){try{if(c){var d=this.readCookie(a);eval("var items="+(d||"[]"));
var b={};b.q=encodeURIComponent(c);for(d=0;d<items.length;d++){var f=items[d];for(k in f)k=="q"&&f[k]==b.q&&items.splice(d,1)}for(items.unshift(b);items.length>10;)items.pop();b="[";for(d=0;d<items.length;d++){f=items[d];d>0&&(b+=",");b+="{";var h=0;for(k in f)h>0&&(b+=","),h++,b+='"'+k+'":"'+f[k]+'"';b+="}"}b+="]";this.writeCookie(a,b,720,".soku.com","/")}}catch(l){}},cleanHistory:function(a){this.writeCookie(a,"",720,".soku.com","/")},timeOut:function(a,c,d){if(typeof a==="function"){if(!this.timeOutContext)this.timeOutContext=
{};var c=c||100,d=d||null,b=this.sample(a);this.timeOutContext[b]&&window.clearTimeout(this.timeOutContext[b]);this.timeOutContext[b]=window.setTimeout(function(){a.apply(d)},c);return this.timeOutContext[b]}},interval:function(a,c,d){if(typeof a==="function"){if(!this.intervalContext)this.intervalContext={};var c=c||100,d=d||null,b=this.sample(a);this.intervalContext[b]&&window.clearInterval(this.intervalContext[b]);this.intervalContext[b]=window.setInterval(function(){a.apply(d)},c);return this.intervalContext[b]}},
delayLocation:function(a){this.timeOut(function(){document.location=a},100)},debounce:function(a,c,d){var b=this;return function(){b.timeOut(a,c,d)}},sample:function(a,c){if(!a)return"";var c=c||30,d=a.toString().match(/[a-zA-Z]/g).join(""),b=Math.floor(d.length/6),f=d.length-b;return d.substring(b,f-b>c?b+c:f)},localServer:function(){return(window.location.protocol?window.location.protocol:"http:")+"//"+(window.location.hostname?window.location.hostname:"www.soku.com")},localPath:function(a){for(var c=
"",d=document.getElementsByTagName("script"),b=0;d&&b<d.length;b++){var f=this.trim(d[b].src);if(f&&f.indexOf("js/sk-box")>-1){c=f.indexOf("js/sk-box");c=f.substring(0,c)+(a||"");break}}return c},isFunction:function(a){return Object.prototype.toString.call(a)==="[object Function]"},isArray:function(a){return Object.prototype.toString.call(a)==="[object Array]"},isNodeList:function(a){return Object.prototype.toString.call(a)==="[object NodeList]"},isObject:function(a){return Object.prototype.toString.call(a)===
"[object Object]"},isString:function(a){return Object.prototype.toString.call(a)==="[object String]"},trim:function(a){return String.prototype.trim?a==null||a==void 0?"":String.prototype.trim.call(a):a==null||a==void 0?"":a.toString().replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")},extend:function(a,c){for(var d in c)c.hasOwnProperty(d)&&c[d]!=null&&c[d]!=void 0&&(a[d]=c[d])},contain:function(a,c){if(!a||!c)return!1;for(k in a)if(a[k]==c)return!0;return!1},_subString:function(a,c,d,e){a=b.util.trim(a);
if(a==""||c<=0)return a;c=/^[0-9a-zA-Z\[\]\/\s.,')("!&?:-]+$/.test(a)?d:c;if(a.length<=c)return a;return a.substring(0,c)+(e||"")},htmlEscape:function(a){if(!a)return a;return a.replace(/[<\">&]/g,function(a){switch(a){case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";case "&":return"&amp;"}})},isEmptyObject:function(a){if(!a)return!0;for(k in a)return!1;return!0},isEmpty:function(a){return!b.util.isNotEmpty(a)},isNotEmpty:function(a){return(this.isArray(a)||this.isNodeList(a)||
this.isObject(a))&&a.length&&a.length>0}};b.events={ev:function(a){return a?a:window.event},element:function(a){a=this.ev(a);return a.target||a.srcElement},stop:function(a){a=this.ev(a);a.preventDefault?a.preventDefault():a.returnValue=!1},bind:function(a,c){var d=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){var e=b.util.isString(a)?c[a]:a,f=d?d.concat(Array.prototype.slice.call(arguments,0)):arguments;return e.apply(c||e,f)}},attachEvent:function(a,c,d,b,f){if(a){if(c==
"keypress"&&(navigator.appVersion.match(/Konqueror|Safari|rv:11|KHTML/)||a.attachEvent))c="keydown";a.addEventListener?a.addEventListener(c,d,b):a.attachEvent&&(a["e"+c+(f||"")+d]=d,a[c+(f||"")+d]=function(){return a["e"+c+(f||"")+d](window.event)},a.attachEvent("on"+c,a[c+(f||"")+d]))}},listen:function(a,c,d){b.events.attachEvent(a,c,d,!1,null)},listenLive:function(a,c,d,e,f){b.events.attachEvent(a,d,this.bind(function(a){var d=b.events.element(a);(d.getAttribute("sk_live")==c||c=="")&&e.apply(d,
arguments)},this),f||!1,c)}};b.browser={ua:navigator.userAgent.toLowerCase(),isOpera:function(){return this.ua.indexOf("opera")>-1},isChrome:function(){return/chrome/.test(this.ua)},isSafari:function(){return!this.isChrome()&&/safari/.test(this.ua)},isIE:function(){return!this.isOpera()&&this.ua.indexOf("msie")>-1},isIE6:function(){return!this.isOpera()&&this.ua.indexOf("msie 6")>-1},isIE7:function(){return!this.isOpera()&&this.ua.indexOf("msie 7")>-1},isIE8:function(){return!this.isOpera()&&this.ua.indexOf("msie 8")>
-1},isGecko:function(){return!this.isSafari()&&this.ua.indexOf("gecko")>-1}};b.dom={g:function(a){if("string"==typeof a||a instanceof String)return document.getElementById(a);else if(a&&a.nodeName&&(a.nodeType==1||a.nodeType==9))return a;return null},visible:function(a){return this.g(a).style.display!="none"},hide:function(){for(var a=0;a<arguments.length;a++)this.g(arguments[a]).style.display="none"},show:function(){for(var a=0;a<arguments.length;a++)this.g(arguments[a]).style.display="block"},getHeight:function(a){a=
this.g(a);return a.offsetHeight},addClass:function(a,c){if(a=this.g(a))a.className=""==a.className?c:a.className+" "+c},removeClass:function(a,c){if(a=this.g(a))a.className=a.className.replace(RegExp("(^| )"+c+"( |$)"),"$1").replace(/ $/,"")},hasClass:function(a,c){for(var d=a.className.split(/\s+/),b=0;b<d.length;b++)if(d[b]==c)return!0;return!1},attr:function(a,c,d){var b=c;if(typeof c==="string")if(d===void 0)return a&&a.getAttribute(c);else b={},b[c]=d;for(var f in b)a.setAttribute(f,b[f])},isTag:function(a,
c){if(!a)return!1;return a.tagName.toLowerCase()==c.toLowerCase()},cleanChild:function(a){for(;a.childNodes.length>0;)a.removeChild(a.firstChild)},gc:function(a,c,d){var e=[],f,h,l;if(!(a=b.util.trim(a)))return null;if("undefined"==typeof c)c=document;else if(c=this.g(c),!c)return e;d&&(d=b.util.trim(d).toUpperCase());if(c.getElementsByClassName){h=c.getElementsByClassName(a);c=h.length;for(f=0;f<c;f++)l=h[f],d&&l.tagName!=d||(e[e.length]=l)}else{a=RegExp("(^|\\s)"+a+"(\\s|$)");h=d?c.getElementsByTagName(d):
c.all||c.getElementsByTagName("*");c=h.length;for(f=0;f<c;f++)l=h[f],a.test(l.className)&&(e[e.length]=l)}return e}};b.defaultConfig=function(a){var c=b.util.localPath(),d=c?c+"css/s_kubox.css":"",c=c?c+"m/css/m_kubox.css":"",e=function(a){var c=$("i.btn_clean");c[0]&&(a?c.show():c.hide())};switch(a.toString()){case "1":return{kUrl:"http://tip.soku.com/search_tip_1",yUrl:"http://tip.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,queryUrl:function(a){return a?b.util.localServer()+
"/v?keyword="+encodeURIComponent(a):""}};case "2":return{kUrl:"http://tip.soku.com/search_tip_1",yUrl:"http://tip.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,queryUrl:function(a){return a?b.util.localServer()+"/search_video/q_"+encodeURIComponent(a):""}};case "3":return{kUrl:"http://tip.tudou.soku.com/search_tip_1",yUrl:"http://tip.tudou.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,queryUrl:function(a){return a?b.util.localServer()+"/t/nisearch/"+encodeURIComponent(a):
""}};case "14":return{clientMark:"__ysuid",target:"_blank",kUrl:"http://tip.soku.com/search_tip_1",yUrl:"http://tip.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,enterOpen:!1,queryUrl:function(a){return a?"http://www.soku.com/search_video/q_"+encodeURIComponent(a):""}};case "15":return{target:"_blank",kUrl:"http://tip.tudou.soku.com/search_tip_1",yUrl:"http://tip.tudou.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,queryUrl:function(a){return a?"http://www.soku.com/t/nisearch/"+
encodeURIComponent(a):""}};case "50":return{skin:"simple",contentId:"id_xbox",iframe:!1,kUrl:"http://tip.soku.com/search_keys",yUrl:"http://tip.soku.com/search_yun",cUrl:"http://tip.soku.com/history",css:c,queryUrl:function(a){return a?b.util.localServer()+"/m/s/video?q="+encodeURIComponent(a):""},whenInput:e};case "51":return{skin:"simple",contentId:"id_xbox",iframe:!1,kUrl:"http://tip.soku.com/search_keys",yUrl:"http://tip.soku.com/search_yun",cUrl:"http://tip.soku.com/history",css:c,queryUrl:function(a){return a?
b.util.localServer()+"/m/y/video?q="+encodeURIComponent(a):""},whenInput:e};case "52":return{skin:"simple",iframe:!1,contentId:"id_xbox",kUrl:"http://tip.tudou.soku.com/search_keys",yUrl:"http://tip.soku.com/search_yun",cUrl:"http://tip.soku.com/history",css:c,queryUrl:function(a){return a?b.util.localServer()+"/m/t/video?q="+encodeURIComponent(a):""},whenInput:e};case "61":return{skin:"simple",size:5,clientMark:"__ysuid",target:"_blank",kUrl:"http://tip.soku.com/search_keys",yUrl:"http://tip.soku.com/search_yun",
cUrl:"http://tip.soku.com/history",css:c,queryUrl:function(a){return a?"http://www.soku.com/m/y/video?q="+encodeURIComponent(a):""}};case "62":return{kUrl:"http://tip.soku.com/search_tip_1",yUrl:"http://tip.soku.com/search_tip_1",cUrl:"http://tip.soku.com/history",css:d,sendLog:!1,queryUrl:function(a){return a?b.util.localServer()+"/search_video/q_"+encodeURIComponent(a):""}};default:return{}}};b.XDomain=function(a){this.settings={proxy:"about:blank"};b.util.extend(this.settings,a||{});this.box=document.body||
document.getElementsByTagName("head")[0]};b.util.extend(b.XDomain.prototype,{send:function(a){var c={url:null,success:function(){},dataType:"string"};b.util.extend(c,a||{});if(c.url&&typeof c.url==="string"){c.url+=(c.url.indexOf("?")>0?"&":"?")+"windowname=get";var d=document.createElement("iframe");d.style.display="none";d._state=0;this.box.appendChild(d);b.events.listen(d,"load",b.events.bind(function(){if(d._state==1){var a=d.contentWindow.name?c.dataType=="object"?eval("("+d.contentWindow.name+
")"):c.dataType=="string"?d.contentWindow.name:null:null;c.success&&typeof c.success==="function"&&c.success.call(this,a);this._destory(d)}else if(d._state==0)d._state=1,d.contentWindow.location.replace(this.settings.proxy)},this));d.src=c.url}},_destory:function(a){a.contentWindow.document.write("");a.contentWindow.close();this.box.removeChild(a)}});b.UUID={create:function(){var a=(new Date(1582,10,15,0,0,0,0)).getTime(),c=(new Date).getTime()-a,a=this._getIntegerBits(c,0,31),d=this._getIntegerBits(c,
32,47),c=this._getIntegerBits(c,48,59)+"1",b=this._getIntegerBits(this._rand(4095),0,7),f=this._getIntegerBits(this._rand(4095),0,7),h=this._getIntegerBits(this._rand(8191),0,7)+this._getIntegerBits(this._rand(8191),8,15)+this._getIntegerBits(this._rand(8191),0,7)+this._getIntegerBits(this._rand(8191),8,15)+this._getIntegerBits(this._rand(8191),0,15);return a+d+c+b+f+h},_getIntegerBits:function(a,c,d){for(var a=this._returnBase(a,16),b=[],f="",h=0,h=0;h<a.length;h++)b.push(a.substring(h,h+1));for(h=
Math.floor(c/4);h<=Math.floor(d/4);h++)f+=!b[h]||b[h]==""?"0":b[h];return f},_returnBase:function(a,c){return a.toString(c).toUpperCase()},_rand:function(a){return Math.floor(Math.random()*(a+1))}};b.autoremind=function(a){var c={minChars:0,maxChars:15,delay:150,searchId:"headq",enterOpen:!0,request:function(){},moveUp:function(){},moveDown:function(){},enter:function(){}};b.util.extend(c,a||{});var d=document.getElementById(c.searchId),e={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,
DOWN:40,DELETE:46,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,INSERT:45,SHIFT:16,CTRL:17,ALT:18,CAPSLOCK:20,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F9:120,F10:122,F12:123};b.events.listen(d,"keypress",b.events.bind(function(a){a=a||window.event;switch(a.which?a.which:a.keyCode){case e.RETURN:c.enter.apply(this,arguments);if(c.enterOpen)a.preventDefault?a.preventDefault():a.returnValue=!1;break;case e.UP:c.moveUp.apply(this,arguments);a.preventDefault?a.preventDefault():a.returnValue=!1;break;
case e.DOWN:c.moveDown.apply(this,arguments);a.preventDefault?a.preventDefault():a.returnValue=!1;break;case e.ESC:case e.PAGE_UP:case e.PAGE_DOWN:case e.END:case e.HOME:case e.INSERT:case e.CTRL:case e.ALT:case e.LEFT:case e.RIGHT:case e.SHIFT:case e.TAB:case e.CAPSLOCK:case e.F1:case e.F2:case e.F3:case e.F4:case e.F5:case e.F6:case e.F7:case e.F10:case e.F11:case e.F12:break;default:b.util.timeOut(function(){var a=b.util.trim(d.value).length;a>=c.minChars&&a<=c.maxChars&&c.request.apply(this,arguments)},
c.delay)}},this))};b.log=function(a){this.cons={LOG_M_SELECT:"0",LOG_MOUSE_SELECT:"1",LOG_KEY_SELECT:"2"};this.settings={site:"",costSize:10,abtest:"",sendLog:!0};b.util.extend(this.settings,a||{});this.costRepository={};this.costRepositorySize=0;this.startCost=function(a){this.costRepositorySize>=this.settings.costSize||(this.costRepository[a]=(new Date).getTime(),this.costRepositorySize++)};this.endCost=function(a){var d=this.costRepository[a];d&&(this.costRepository[a]=(new Date).getTime()-d)};
this.sendCost=function(){if(this.settings.sendLog){var a=[];for(k in this.costRepository){var d=this.costRepository[k];d&&a.push(d)}if(a.length!=0)this.costRepository={},this.costRepositorySize=0,a=a.join(","),this._request(this._buildLogUrl_cost({type:4,cost:a})),this._request(this._buildLogUrl_cost({type:4,cost:a},"http://p.l.youku.com/sokubox"))}};this.sendExposure=function(a){this.settings.sendLog&&(this._request(this._buildLogUrl_exposure(a||{})),this._request(this._buildLogUrl_exposure(a||{},
"http://p.l.youku.com/sokubox")))};this.sendUse=function(a){this.settings.sendLog&&(this._request(this._buildClickLogUrl(a||{})),this._request(this._buildLogUrl_use(a||{})),this._request(this._buildLogUrl_use(a||{},"http://p.l.youku.com/sokubox")))};this._buildClickLogUrl=function(a){var d="http://lstat.youku.com/sokuClick.php";d+="?type="+(a.type||"");d+="&pos="+(a.pos||"");d+="&keyword="+encodeURIComponent(a.qword||"");d+="&url="+encodeURIComponent(a.url||"");d+="&site="+(this.settings.site||"");
return d};this._buildLogUrl_exposure=function(a,d){var b=d||"http://log.soku.com/sak.gif";b+="?cf="+this._getCF(this.settings.site);b+="&dv="+this._getVersion(this.settings.abtest,a.dataver);b+="&kq="+(a.wordtype||"");b+="&re="+encodeURIComponent(this._getRefer());return b};this._buildLogUrl_cost=function(a,d){var b=d||"http://log.soku.com/sak.gif";b+="?cf="+this._getCF(this.settings.site);b+="&re="+encodeURIComponent(this._getRefer());b+="&cost="+(a.cost||"");return b};this._buildLogUrl_use=function(a,
d){var b=d||"http://log.soku.com/sak.gif";b+="?cf="+this._getCF(this.settings.site);b+="&pos="+(a.pos||"");b+="&kt="+(a.operate||"0");b+="&kq="+(a.wordtype||"");b+="&ki="+(a.windex||"000");b+="&dv="+this._getVersion(this.settings.abtest,a.dataver);var f=document.getElementById("log_param_soku"),f=f?f.getAttribute("keyword"):"";b+="&lk="+(f||"");b+="&ok="+encodeURIComponent(a.bword||"");b+="&k="+encodeURIComponent(a.qword||"");b+="&re="+encodeURIComponent(this._getRefer());b+="&kct="+(a.kct||"");b+=
"&url="+encodeURIComponent(a.url||"");return b};this.getKB=function(a){var b="";b+=this._getCF(this.settings.site)||"00";b+=a.pos||"0";b+=a.operate||"0";b+=a.wordtype||"0";b+=a.windex||"000";b+=this._getVersion(this.settings.abtest,a.dataver,"0","0000");b+=this._fullBit(a.kct,2);var e=document.getElementById("log_param_soku"),e=e?e.getAttribute("keyword"):"";b+="_"+(e||"");b+="_"+encodeURIComponent(a.bword||"");return b};this._fullBit=function(a,b){if(!a)return"00";if(a.length>=b)return a;for(var e=
"",f=0;f<b-a.length;f++)e+="0";return e+a};this._getRefer=function(){var a=document.referrer||"";if(a!="")return a;return window.location};this._getVersion=function(a,b,e,f){if(b&&b.length>=5)return b;a=(a=this._getAbtest(a))?a:b?"0":e||"";return(b||f||"")+a};this._getAbtest=function(a){return a?a.substring(a.length-1,a.length):""};this._getCF=function(a){var b=",50,51,52,61,".indexOf(","+a+",")>-1?"1":"0";a+="";switch(a){case "50":a="1";break;case "51":a="2";break;case "52":a="3";break;case "14":case "61":a=
"4";break;case "15":a="5"}return b+a};this._request=function(a){var b=new Image,e="soku_sio_log_"+Math.floor(Math.random()*2147483648).toString(36);window[e]=b;b.onload=b.onerror=b.onabort=function(){b.onload=b.onerror=b.onabort=null;b=window[e]=null};b.src=a}};b.KuBox=function(a){this.settings={site:"",searchId:"headq",size:10,target:"_self",contentId:null,refreshId:"_xbox_refresh",abtest:"",skin:"classics",historyName:"SK_QUERY",history:!1,crossHistory:!1,controlButton:!1,sendLog:!0,iframe:!0,enterOpen:!0,
clientMark:null,kUrl:null,yUrl:null,cUrl:null,css:null,queryUrl:function(){},beforeEnter:function(){return!0},whenInput:function(){},appendHeader:function(){},appendFooter:function(){},appendItem:function(){},beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){}};b.util.extend(this.settings,a||{});this.repository={};this.log=new b.log({site:this.settings.site,sendLog:this.settings.sendLog,abtest:this.settings.abtest});this.XDomain=new b.XDomain;this.boxUUID=
b.UUID.create();this.globalRequestCount=1;this.keys={};if(this.dom_search=b.dom.g(this.settings.searchId))this.initQueryWord=this._bword(),this.dom_boxDiv=document.createElement("div"),this.dom_scriptDiv=document.createElement("div"),this.dom_content=this.settings.contentId?b.dom.g(this.settings.contentId):this.dom_search.parentNode,this.dom_content.appendChild(this.dom_boxDiv),this.dom_content.appendChild(this.dom_scriptDiv),this.dom_boxDiv.innerHTML=this._skinManager.htmlKeel.call(this,this.settings.skin),
this.dom_button=this.dom_search.parentNode.getElementsByTagName("BUTTON")[0],this.dom_submitform=this.submitform(),this.dom_refreshDiv=b.dom.g(this.settings.refreshId),this.hide(),this.settings.history&&b.util.updateHistory(this.settings.historyName,this._bword()),this.importCss(this.settings.css,function(){this._skinManager.event.call(this,this.settings.skin)})};b.util.extend(b.KuBox.prototype,{kUpdate:function(a,c){if(typeof a=="object"){var d=a.q;c&&this.log.endCost(d);b.util.isEmptyObject(this.repository[d])&&
(this.repository[d]=a);d==this._bword()&&(b.dom.cleanChild(this.dom_refreshDiv),this.show(d))}},yUpdate:function(a){if(typeof a=="object"){var c=a.q||"",d=a.dq||"";b.util.isEmptyObject(this.repository[c])&&(this.repository[c]=a);this.initQueryWord==""&&d!=""&&this.defaultWord(d);c==this._bword()&&(b.dom.cleanChild(this.dom_refreshDiv),this.show(c))}},cUpdate:function(){this.cleanRefresh();this.repository[""]="";this.keys[""]=""},show:function(a){this.settings.beforeShow.apply(this,arguments);var c=
!1;if(this.dom_refreshDiv.childNodes.length>0)b.dom.visible(this.dom_boxDiv)||(b.dom.show(this.dom_boxDiv),c=!0);else{var d=this.settings.appendItem.call(this.log,this._bword())||[],d=this._skinManager.htmlRefresh.call(this,this.settings.skin,this.repository[a||this._bword()],d),e=this.settings.appendHeader.call(this.log,this._bword(),d!="")||"",f=this.settings.appendFooter.call(this.log,this._bword(),d!="")||"",d=e+d+f;d!=""?(this.dom_refreshDiv.innerHTML=d,b.dom.show(this.dom_boxDiv),c=!0):this.hide();
this._resetIframe()}d=(e=this._dataItem(!1))?e.getAttribute("dataver"):"";e=e?e.getAttribute("boxtype"):"";("1"==e||"2"==e)&&c&&this.log.sendExposure({type:4,bword:this._uword(),wordtype:this._dataWordType(),dataver:d});c&&this.settings.afterShow.apply(this,arguments)},hide:function(){this.dom_refreshDiv.childNodes.length>0?(this.settings.beforeHide.apply(this,arguments),b.dom.visible(this.dom_boxDiv)&&(b.dom.hide(this.dom_boxDiv),this.settings.afterHide.apply(this,arguments))):b.dom.hide(this.dom_boxDiv)},
importCss:function(a,c){if(a=b.util.trim(a)){var d=document.getElementsByTagName("link");for(i=0;d&&i<d.length;i++)if(d[i].href&&d[i].href.indexOf(a)!=-1)return d[i];var e=document.createElement("link");e.rel="stylesheet";e.type="text/css";e.disabled=!1;this.dom_content.appendChild(e);this.cssCallback=b.util.timeOut(function(){if(!e.scallback)e.scallback=!0,c&&c.call(this)},300,this);b.events.listen(e,"load",b.events.bind(function(){this.cssCallback&&window.clearTimeout(this.cssCallback);if(!e.scallback)e.scallback=
!0,c&&c.call(this)},this));e.href=a}else c&&c.call(this)},vmopenform:function(){var a=document.createElement("form");a.setAttribute("id","sk_vmopen");a.setAttribute("method","get");a.setAttribute("target","_blank");document.body.appendChild(a);return document.getElementById("sk_vmopen")},submitform:function(){var a=this.dom_search;if(a)for(var c=0;c<4;c++){if(!a||!a.tagName||b.dom.isTag(a,"body"))break;if(b.dom.isTag(a,"form"))return a;a=a.parentNode}return null},_dataLis:function(a){var c=[];if(!this.dom_refreshDiv)return c;
var d=this.dom_refreshDiv.childNodes;if(b.util.isEmpty(d))return c;for(var e=0;e<d.length;e++){var f=d[e];if(b.dom.hasClass(f,"autocomplete")||b.dom.hasClass(f,"autolist")){if(f=a?b.dom.gc("current",f):f.childNodes,!b.util.isEmpty(f))for(var h=0;h<f.length;h++){var l=f[h];l&&!b.dom.hasClass(l,"first")&&!b.dom.hasClass(l,"empty")&&c.push(l)}}else b.dom.hasClass(f,"dir")&&(a&&b.dom.hasClass(f,"current")||!a)&&c.push(f)}return c},_dataItem:function(a){a=this._dataLis(a);if(!b.util.isNotEmpty(a))return null;
for(var c=0;c<a.length;c++){var d=a[c];if(d&&(d.getAttribute("dataver")||d.getAttribute("wordtype")))return d}return null},_dataItemByEvent:function(a){var c;if(a)for(var d=0;d<6;d++){if(!a||!a.tagName||a.getAttribute("id")==this.settings.refreshId||b.dom.isTag(a,"body"))break;if(b.dom.isTag(a,"li")||b.dom.hasClass(a,"dir")){c=a;break}a=a.parentNode}return c},_dataWordType:function(){var a="",c=this._dataLis(!1);if(b.util.isNotEmpty(c)){for(var d=0;d<c.length;d++){var e=c[d],e=e?e.getAttribute("wordtype"):
"";a+=e&&a.indexOf(e)==-1?e:""}return a}},cleanRefresh:function(){this.dom_refreshDiv.innerHTML="";this.hide()},defaultWord:function(a){this.dom_search.value=a;this.dom_search.defaultValue=a},timeRequest:function(){this.initTimeRequestWord=this._bword();b.util.interval(function(){var a=this._bword();if(a!=this.initTimeRequestWord)this.initTimeRequestWord=a,this._handler.remote.call(this)},150,this)},_ajax:function(a){if(a){var b=document.createElement("script");b.src=a;this.dom_scriptDiv.appendChild(b)}},
_resetIframe:function(){if(this.settings.iframe){var a=this.dom_boxDiv.childNodes[0],b=document.getElementById("sk_holder_iframe");if(a&&b)b.style.width=a.offsetWidth+"px",b.style.height=a.offsetHeight+"px"}},_bword:function(a){if(a)this.dom_search.value=a;return b.util.trim(this.dom_search.value)},_uword:function(a){(a==""||a)&&this.dom_search.setAttribute("xbox_userinput",a);return this.dom_search.getAttribute("xbox_userinput")?b.util.trim(this.dom_search.getAttribute("xbox_userinput")):""},_sub:function(a,
c,d,e){a=b.util.trim(a);if(a=="")return"";if(c&&(c=a.split(" "),c!=null&&c.length>0))for(var f=0,h=!0;f<c.length;f++,h=!1){var l=c[f];if(h)a=l;else{if(!/^[a-zA-Z]+$/.test(l))break;a+=" "+l}}c=a.length;d=/^[0-9a-zA-Z\s.,-]+$/.test(a)?d*2:d;if(d>=c)return a;return a.substring(0,d)+e},_hight:function(a,c,d){var e=this._bword(),f=e.length,h=a?a.length:0;if(f<=0||f>=h)return b.util.htmlEscape(a);if(a.substring(0,f).toLowerCase()==e.toLowerCase())return b.util.htmlEscape(a.substring(0,f))+c+b.util.htmlEscape(a.substring(f))+
d;return b.util.htmlEscape(a)},_touch:{stop:!1,start:function(a,b){this.stx=this.sty=this.etx=this.ety=this.curX=this.curY=0;this.stx=b.touches[0].pageX;this.sty=b.touches[0].pageY;a&&a.call(this,b);this._touch.stop&&(b.preventDefault(),b.stopPropagation())},move:function(a,b){this.curX=b.targetTouches[0].pageX-this.stx+this.etx;this.curY=b.targetTouches[0].pageY-this.sty+this.ety;a&&a.call(this,b);this._touch.stop&&(b.preventDefault(),b.stopPropagation())},end:function(a,b,d){this.etx=this.curX;
this.ety=this.curY;var e=Math.abs(this.etx),f=Math.abs(this.ety);(!b||e<10&&f<10)&&a&&a.call(this,d);this._touch.stop&&(d.preventDefault(),d.stopPropagation())}},_skinManager:{cons:{SIMPLE:"simple",CLASSICS:"classics"},htmlKeel:function(a){return a==this._skinManager.cons.SIMPLE?this._skinManager._simpleKeel.call(this):this._skinManager._classicsKeel.call(this)},htmlRefresh:function(a,b,d){return a==this._skinManager.cons.SIMPLE?this._skinManager._simpleHTML.call(this,b,d):this._skinManager._classicsHTML.call(this,
b,d)},event:function(a){a==this._skinManager.cons.SIMPLE?this._skinManager._simpleEvent.call(this):this._skinManager._classicsEvent.call(this)},_buildIframe:function(){return this.settings.iframe?'<iframe id="sk_holder_iframe" frameborder="0" scrolling="no" style="position: absolute; z-index: '+(b.browser.isIE()?-1:0)+'; top: -2px; left: -2px;"></iframe>':""},_appendOnLink:function(a){if(!a)return"";var b=a.indexOf(".youku.com/v_show/id_")>-1;switch(this.settings.site+""){case "1":case "2":case "3":b&&
(a+=a.indexOf("?")>-1?"&":"?",a+="from=s1.8-4.999");break;case "14":b&&(a+=a.indexOf("?")>-1?"&":"?",a+="from=y1.8-4.999")}return a},_simpleKeel:function(){var a=[];a.push('<div class="m_hotlist">');a.push(this._skinManager._buildIframe.call(this));a.push('<div id="'+this.settings.refreshId+'">');a.push("</div>");a.push("</div>");return a.join("")},_simpleHTML:function(a,c){if(b.util.isEmptyObject(a))return"";var d=a.q||"",e=a.r,f=a.vs||"",h=a.t||"",l=!1,s=!1,r=this.settings.size;if(!b.util.isNotEmpty(e)&&
!b.util.isNotEmpty(c))return"";b.util.isNotEmpty(c)&&(e=b.util.isNotEmpty(e)?c.concat(e):c,r+=c.length);var w=[],t=0;w.push('<ul class="autocomplete">');for(var x=0;x<e.length&&t<r;x++){var p=e[x],g=p.b||"",p=p.c,y=(x<9?"0":"")+(x+1)+"0",j=this._hight(p,'<em sk_live="word">',"</em>");g==1&&e.length==1&&!b.util.readCookie(this.settings.historyName)||(!s&&g=="3"&&(w.push('<li class="first"><span>\u70ed\u641c\u8bcd:</span></li>'),s=!0),w.push('<li sk_live="word" boxtype="'+h+'" wordtype="'+g+'" dataver="'+
f+'" windex="'+y+'" qword="'+p+'" ><a sk_live="word" ><span class="title" sk_live="word">'+j+'</span></a><div class="yk-sel" sk_live="puton" ><span class="yk-select" sk_live="puton" ></span></div></li>'),t++,l=!s&&d=="")}l&&w.push('<li sk_live="clean"><span class="title clean" sk_live="clean"><i class="m_btn btn_del" sk_live="clean"></i>\u6e05\u7a7a\u5386\u53f2\u8bb0\u5f55</span></li>');w.push("</ul>");return t>0?w.join(""):""},_classicsKeel:function(){var a=[],b=this.settings.site==14?" sk_youku":
this.settings.site==15?" sk_tudou":"";a.push('<div class="'+(this.settings.site==15?"for_tudou":"")+'">');a.push('<div class="sk_box'+b+'" style="display:block;">');a.push(this._skinManager._buildIframe.call(this));a.push('<div class="main" id="'+this.settings.refreshId+'">');a.push("</div>");a.push("</div>");a.push("</div>");return a.join("")},_classicsHTML:function(a,c){if(b.util.isEmptyObject(a))return"";var d=a.r||[],e=a.d||[],f=a.vs||"",h=a.t||"",l=2==h,s=1==h,r=0==h,w=this.settings.size,t=0,
x=0,p=' sk_live="word" class="dir" boxtype="'+h+'" dataver="'+f+'" log_pos="4" ';if(!b.util.isNotEmpty(d)&&!b.util.isNotEmpty(c))return"";b.util.isNotEmpty(c)&&(d=b.util.isNotEmpty(d)?c.concat(d):c,w+=c.length);for(var g=[],y=0;y<e.length&&x<1;y++){var j=e[y];if(j){var m=j.k,n=j.d||"",o=j.n||"",u=b.util._subString(o,12,20,"..."),v=j.i||"",z=this._skinManager._appendOnLink.call(this,j.u),B=this._skinManager._appendOnLink.call(this,j.t),E=j.c||"",A=j.y||"",F=j.r||"",G=j.h||"",H=j.a||"",C=j.m||"",D=
j.z==1,K=j.w||0,L=j.v||0,q=j.o||[],M=b.util.contain(q,"\u8ba4\u8bc1\u7528\u6237"),N=b.util.contain(q,"\u571f\u8c46\u8ba4\u8bc1"),q=j.e||[],I=j.t1||0,O=b.util._subString(I,5,8,"..."),J=j.t2||0,P=b.util._subString(J,5,8,"..."),Q=j.m1||0,j=j.m2||0;if(m==1||m==5){g.push("<div"+p+'qword="'+o+'" log_kct="'+m+'">');g.push('<div class="pic"><a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+v+'"></a></div>');g.push('<div class="info">');g.push('<p><span class="tit"><a sk_live="log_show" target="_blank" title="'+
o+'" href="'+n+'">'+u+'</a></span><span class="year">('+A+')</span><span class="type">'+E+"</span></p>");g.push("<p>"+(G||H)+"</p>");if(D||q.length==0)g.push('<div class="load_btn">'),g.push('<a sk_live="log_show" class="btn btn_play" target="_blank" href="'+n+'">\u67e5\u770b\u8be6\u60c5</a>');else{g.push('<div class="part_link">');for(m=0;m<q.length;m++)j=q[m],o=j.s,v=this._skinManager._appendOnLink.call(this,j.u),A=j.n==1,j=j.c==1,q.length>=4&&m==2&&q[1].s+1!=o&&g.push('<a sk_live="log_show" target="_blank" href="'+
n+'">\u2026\u2026</a>'),g.push('<a sk_live="log_show"'+(j?' class="long" ':"")+'target="_blank" href="'+v+'">'+o+(A?'<i class="ico ico_new"></i>':"")+(j?"<em>\u5927\u7ed3\u5c40</em>":"")+"</a>")}g.push("</div>");g.push("</div>");g.push("</div>")}else if(m==2)g.push("<div"+p+'qword="'+o+'" log_kct="'+(!D&&!z&&B?"25":m)+'">'),g.push('<div class="pic"><a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+v+'"></a></div>'),g.push('<div class="info">'),g.push('<p><span class="tit"><a sk_live="log_show" target="_blank" title="'+
o+'" href="'+n+'">'+u+'</a></span><span class="year">('+A+')</span><span class="type">'+E+"</span></p>"),g.push("<p>"+(G||H)+"</p>"),g.push('<div class="load_btn">'),D||!z&&!B&&!C?g.push('<a sk_live="log_show" class="btn btn_play" target="_blank" href="'+n+'">\u67e5\u770b\u8be6\u60c5</a>'):z?g.push('<a sk_live="log_show" class="btn btn_play" target="_blank" href="'+z+'">\u64ad\u653e\u6b63\u7247</a>'):(C&&g.push('<a sk_live="log_show" class="btn btn_buy" target="_blank" href="'+C+'">\u4e70\u7535\u5f71\u7968</a>'),
B&&g.push('<a sk_live="log_show" class="btn btn_notice" target="_blank" href="'+B+'">\u9884\u544a\u7247</a>'),!C&&F&&g.push('<span class="high">'+F+"\u4e0a\u6620</span>")),g.push("</div>"),g.push("</div>"),g.push("</div>");else if(m==3||m==8||m==9||m==17){g.push("<div"+p+'qword="'+o+'" log_kct="'+m+'">');g.push('<div class="pic"><a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+v+'"></a></div>');g.push('<div class="info">');g.push('<p><span class="tit"><a sk_live="log_show" target="_blank" title="'+
o+'" href="'+n+'">'+u+'</a></span><span class="type">'+E+"</span></p>");if(D||q.length==0)g.push("<p>"+(G||H)+"</p>"),g.push('<div class="load_btn">'),g.push('<a sk_live="log_show" class="btn btn_play" target="_blank" href="'+n+'">\u67e5\u770b\u8be6\u60c5</a>');else{g.push('<div class="item_list">');for(m=0;m<q.length;m++)j=q[m],o=j.s,n=b.util.htmlEscape(o),o=b.util._subString(o,20,28,"..."),v=this._skinManager._appendOnLink.call(this,j.u),u=j.d,A=j.n==1,g.push("<p>"),g.push('<a sk_live="log_show" target="_blank" title="'+
n+'" href="'+v+'"><span class="data">'+u+"</span> "+o+"</a>"+(A?'<i class="ico ico_new"></i>':"")),g.push("</p>")}g.push("</div>");g.push("</div>");g.push("</div>")}else if(m==20)n="http://z.soku.com/",g.push("<div"+p+'qword="'+I+"VS"+J+'" log_kct="'+m+'">'),g.push('<div class="live">'),g.push('<div class="game_pic">'),g.push('<a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+Q+'"></a>'),g.push("</div>"),g.push('<div class="game_info">'),g.push('<p class="tit"><a sk_live="log_show" target="_blank" title="'+
I+'" href="'+n+'">'+O+'</a><span class="vs">VS</span><a sk_live="log_show" target="_blank" title="'+J+'" href="'+n+'">'+P+"</a></p>"),g.push("<p>"+F+" "+o+"</p>"),g.push('<div class="load_btn">'),z?g.push('<a sk_live="log_show" target="_blank" class="btn btn_play" href="'+z+'">\u770b\u76f4\u64ad</a>'):g.push("<p>\u5373\u5c06\u76f4\u64ad</p>"),g.push("</div>"),g.push("</div>"),g.push('<div class="game_pic">'),g.push('<a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+j+'"></a>'),g.push("</div>"),
g.push("</div>"),g.push("</div>");else if(m==14)g.push("<div"+p+'qword="'+o+'" log_kct="'+m+'">'),g.push('<div class="user">'),g.push('<div class="pic"><a target="_blank" href="'+n+'"><img sk_live="log_show" src="'+v+'"></a></div>'),g.push('<div class="info">'),g.push('<p><span class="tit"><a sk_live="log_show" target="_blank" title="'+o+'" href="'+n+'">'+u+"</a></span> "),M?g.push('<i class="ico ico_certified"></i>'):N&&g.push('<i class="ico ico_mark_g"></i>'),g.push("</p>"),g.push("<p><span>\u89c6\u9891:"+
K+'</span><span class="type">\u64ad\u653e:'+L+"</span></p>"),g.push('<div class="load_btn">'),g.push('<a sk_live="log_show" class="btn btn_play" target="_blank" href="'+n+'">\u8fdb\u5165\u9891\u9053</a>'),g.push("</div>"),g.push("</div>"),g.push("</div>"),g.push("</div>");else continue;x++}}l&&g.push('<div class="hottit">\u4eca\u65e5\u70ed\u641c</div>');g.push('<ul class="autolist'+(l?" hotword":"")+'">');for(e=0;e<d.length&&t<w;e++){j=d[e];m=j.c||"";p=j.k||"";y=j.w||"";q=b.util.htmlEscape(y);A=j.y||
"";n=j.u||"";v=j.i||"";o=r&&p==2;u=j.z||"";j=this._skinManager._appendOnLink.call(this,j.r)||"javascript:;";z=this._hight(y,'<b sk_live="word">',"</b>");B=(t<9?"0":"")+(t+1)+"0";if(p==6)g.push('<li sk_live="word" log_pos="4" log_kct="23" boxtype="'+h+'" wordtype="'+p+'" dataver="'+f+'" qword="'+q+'" enterurl="'+n+'">'),g.push('<a sk_live="word" onclick="return false;"><span class="high" sk_live="word">'+z+'</span><b sk_live="word">\u89c6\u9891\u4e13\u8f91</b><i sk_live="word" class="ico_tip">\u4e13\u8f91</i></a>');
else if(p==7)g.push('<li sk_live="word" log_pos="1" boxtype="'+h+'" wordtype="'+p+'" dataver="'+f+'" windex="'+B+'" qword="'+q+'" enterurl="'+n+'">'),g.push('<a sk_live="word" onclick="return false;"><img sk_live="word" src="'+v+'"><span class="link" sk_live="word">'+y+" "+n+"</span></a>");else if(g.push('<li sk_live="word" log_pos="1" boxtype="'+h+'" wordtype="'+p+'" dataver="'+f+'" windex="'+B+'" qword="'+q+'" enterurl="'+n+'">'),l&&g.push('<span class="rank'+(e<3?" top3":"")+'">'+(e+1)+"</span>"),
g.push('<a sk_live="word" '+(s?'class="c_0"':"")+' onclick="return false;">'+z+"</a>"),o||A||m||u)g.push('<span sk_live="word" class="info">'+(o?"\u6700\u8fd1\u641c\u8fc7":"")+A+"  "+m+(u?'<a target="_blank" sk_live="log_show" log_pos="6" href="'+j+'">'+u+"</a>":"")+"</span>");g.push("</li>");t++}s&&t>0&&(g.push('<li sk_live="clean" class="empty">'),g.push('<em class="ico ico_empty" sk_live="clean"></em>'),g.push('<span onclick="return false;" sk_live="clean">\u6e05\u7a7a\u8bb0\u5f55</span>'),g.push("</li>"));
g.push("</ul>");return t>0||x>0?g.join(""):""},_simpleEvent:function(){this.settings.controlButton&&b.events.listen(this.dom_button,"click",b.events.bind(this._handler.bwSimpleClick,this));b.events.listen(this.dom_search,"click",b.events.bind(this._handler.searchClick,this));b.events.listen(this.dom_search,"input",b.events.bind(this._handler.searchInput,this));b.autoremind({enterOpen:this.settings.enterOpen,request:b.events.bind(this._handler.remote,this),enter:b.events.bind(this._handler.boxWordEnter,
this)});b.events.listenLive(this.dom_refreshDiv,"word","click",b.events.bind(this._handler.bwSimpleClick,this),!0);b.events.listenLive(this.dom_refreshDiv,"word","touchstart",b.events.bind(this._touch.start,this,this._handler.simpleAddCurrent),!0);b.events.listenLive(this.dom_refreshDiv,"word","touchend",b.events.bind(this._touch.end,this,this._handler.simpleRemoveCurrent,!1),!0);b.events.listenLive(this.dom_refreshDiv,"clean","click",b.events.bind(this._handler.simpleClean,this,this.log.cons.LOG_M_SELECT),
!0);b.events.listenLive(this.dom_refreshDiv,"puton","click",b.events.bind(this._handler.simplePuton,this),!0)},_classicsEvent:function(){this.settings.controlButton&&b.events.listen(this.dom_button,"click",b.events.bind(this._handler.boxWordClick,this));b.events.listen(document,"click",b.events.bind(this._handler.documentClick,this));b.events.listen(document,"touchstart",b.events.bind(this._handler.documentClick,this));b.events.listen(this.dom_search,"click",b.events.bind(this._handler.searchClick,
this));b.events.listen(this.dom_search,"touchstart",b.events.bind(this._handler.searchClick,this));b.events.listen(this.dom_search,"input",b.events.bind(this._handler.searchInput,this));b.autoremind({enterOpen:this.settings.enterOpen,request:b.events.bind(this._handler.remote,this),moveUp:b.events.bind(this._handler.boxWordMoveUp,this),moveDown:b.events.bind(this._handler.boxWordMoveDown,this),enter:b.events.bind(this._handler.boxWordEnter,this)});b.events.listenLive(this.dom_refreshDiv,"word","mouseout",
b.events.bind(this._handler.boxWordMouseOut,this));b.events.listenLive(this.dom_refreshDiv,"word","mouseover",b.events.bind(this._handler.boxWordMouseOver,this));b.events.listenLive(this.dom_refreshDiv,"word","click",b.events.bind(this._handler.boxWordClick,this),!0);b.events.listenLive(this.dom_refreshDiv,"hotword","click",b.events.bind(this._handler.hotWordClick,this),!0);b.events.listenLive(this.dom_refreshDiv,"clean","click",b.events.bind(this._handler.simpleClean,this,this.log.cons.LOG_MOUSE_SELECT),
!0);b.events.listenLive(this.dom_refreshDiv,"log_show","click",b.events.bind(this._handler.boxLogShow,this))}},_handler:{documentClick:function(a){var a=b.events.element(a),c=!1;if(a)for(var d=0;d<8;d++){if(!a||!a.tagName||b.dom.isTag(a,"body"))break;if(b.dom.hasClass(a,"sk_box")||b.dom.hasClass(a,"yk-kubox")||a.getAttribute("id")==this.settings.searchId){c=!0;break}a=a.parentNode}if(!c){if(this.initQueryWord==""&&this._bword()=="")this.dom_search.value=this.dom_search.defaultValue;b.util.timeOut(function(){this.hide();
this.log.sendCost()},100,this)}},searchClick:function(){if(this.initQueryWord==""&&this._bword()==this.dom_search.defaultValue)this.dom_search.value="";this._handler.remote.call(this)},searchInput:function(){this._bword()!=""&&b.util.timeOut(function(){this.closeClick?this.closeClick=!1:this._handler.remote.call(this)},300,this)},boxWordMoveUp:function(){var a=this._dataLis(!1);if(b.util.isNotEmpty(a)){for(var c=a.length-1,d=0;d<a.length;d++){var e=a[d];if(e&&b.dom.hasClass(e,"current")){c=d==0?a.length-
1:d-1;break}}this._handler._select.call(this,a[c]);this._bword(a[c].getAttribute("qword"))}},boxWordMoveDown:function(){var a=this._dataLis(!1);if(b.util.isNotEmpty(a)){for(var c=0,d=0;d<a.length;d++){var e=a[d];if(e&&b.dom.hasClass(e,"current")){c=d==a.length-1?0:d+1;break}}this._handler._select.call(this,a[c]);this._bword(a[c].getAttribute("qword"))}},boxWordEnter:function(){this.settings.beforeEnter.call(this,this._bword())&&this._handler._requestWord.call(this,this.log.cons.LOG_KEY_SELECT)},boxWordMouseOver:function(a){a=
this._dataItemByEvent(b.events.element(a));b.dom.hasClass(a,"dir")||this._handler._select.call(this,a)},boxWordMouseOut:function(a){a=this._dataItemByEvent(b.events.element(a));b.dom.removeClass(a,"current")},boxWordClick:function(a){b.events.stop(a);this._handler._requestWord.call(this,this.log.cons.LOG_MOUSE_SELECT)},hotWordClick:function(a){var c=this._bword(),d="",e="",f="";if(a=b.events.element(a))c=a.getAttribute("qword"),d=a.getAttribute("windex"),e=a.getAttribute("dataver"),f=a.getAttribute("wordtype");
c=this._handler._buildQueryUrl.call(this,{type:4,pos:"1",bword:this._uword(),wordtype:f,qword:c,dataver:e,operate:this.log.cons.LOG_MOUSE_SELECT,windex:d});this.log.sendCost();this.settings.target=="_blank"?window.open(c,"_blank"):document.location=c},boxLogShow:function(a){var c=b.events.element(a),d=this._dataItemByEvent(c),a=this._bword(),e=c.getAttribute("log_pos"),f="00",h="",l="",s="";d&&(a=d.getAttribute("qword"),h=d.getAttribute("windex"),l=d.getAttribute("dataver"),s=d.getAttribute("wordtype"),
f=this.log._fullBit(d.getAttribute("log_kct"),2),e=e||d.getAttribute("log_pos"));c=b.dom.isTag(c,"img")?c.parentNode.getAttribute("href"):c.getAttribute("href");this.log.sendUse({type:4,pos:e,kct:f,bword:this._uword(),wordtype:s,qword:a,dataver:l,url:c,operate:this.log.cons.LOG_MOUSE_SELECT,windex:h})},remote:function(){var a=this._bword();if(!(this._uword()==a&&b.dom.visible(this.dom_boxDiv))){this._uword(a);this.settings.whenInput.call(this,a);var c=this.repository[a];b.util.isEmptyObject(c)?a==
""?this._handler._remoteYun.call(this):this._handler._remoteKu.call(this,a):a!=""?this.kUpdate(c):this.yUpdate(c)}},_remoteKu:function(a){if(!(b.util.trim(this.settings.kUrl)==""||this.keys[a])){this.keys[a]=a;var c="";c+=(this.settings.kUrl.indexOf("?")>-1?"&":"?")+"jsoncallback=XBox.kUpdate";c+="&query="+encodeURIComponent(a);c+=this.settings.site!="1"?"&site="+this.settings.site:"";c+="&rm="+this.boxUUID+"-"+this.globalRequestCount++;var d=this.log._getAbtest(this.settings.abtest);c+=d?"&ver="+
d:"";c+="&h="+(new Date).getHours();this.log.startCost(a);this._ajax(this.settings.kUrl+c)}},_remoteYun:function(){b.util.trim(this.settings.yUrl)==""||this.keys[""]?this.hide():(this.keys[""]="search_yun",this._handler._requestYkYun.call(this))},_requestYkYun:function(){var a="";a+=(this.settings.yUrl.indexOf("?")>-1?"&":"?")+"jsoncallback=XBox.yUpdate";a+="&site="+this.settings.site;var c=this.settings.clientMark&&b.util.readCookie(this.settings.clientMark);a+=c?"&cm="+c:"";c=this.log._getAbtest(this.settings.abtest);
a+=c?"&ver="+c:"";a+="&t="+(new Date).getTime();this._ajax(this.settings.yUrl+a)},_requestTdYun:function(){this._handler._requestHistory.call(this,function(){})},simpleClean:function(a){if(window.confirm("\u786e\u8ba4\u6e05\u9664\u5168\u90e8\u5386\u53f2\u8bb0\u5f55?")){var c="";c+=(this.settings.cUrl.indexOf("?")>-1?"&":"?")+"jsoncallback=XBox.cUpdate";c+="&site="+this.settings.site;var d=this.settings.clientMark&&b.util.readCookie(this.settings.clientMark);c+=d?"&cm="+d:"";d=this.log._getAbtest(this.settings.abtest);
c+=d?"&ver="+d:"";c+="&t="+(new Date).getTime();this._ajax(this.settings.cUrl+c);d=(c=this._dataItem(!1))?c.getAttribute("dataver"):"";c&&c.getAttribute("boxtype");this.log.sendUse({type:4,pos:"5",bword:this._uword(),dataver:d,operate:a})}},simpleClose:function(){this.closeClick=!0;this.hide();this.log.sendCost()},simplePuton:function(a){var a=b.events.element(a),a=b.dom.isTag(a,"span")?a.parentNode:a,c=a.parentNode,d=b.dom.gc("selected",c.parentNode,"div");b.util.isArray(d)&&d.length>0&&b.dom.removeClass(d[0],
"selected");b.dom.addClass(a,"selected");if(a=c.getAttribute("qword"))this._bword(a),this._handler.remote.call(this)},bwSimpleClick:function(a){b.events.stop(a);a=b.events.element(a);a=b.dom.isTag(a,"a")?a.parentNode:b.dom.isTag(a,"span")?a.parentNode.parentNode:b.dom.isTag(a,"em")?a.parentNode.parentNode.parentNode:a;this._resetIframe();var c=this._bword(),d="",e="",f="";a&&(c=a.getAttribute("qword"),d=a.getAttribute("windex"),e=a.getAttribute("dataver"),f=a.getAttribute("wordtype"));a=this._handler._buildQueryUrl.call(this,
{type:4,pos:"1",bword:this._uword(),wordtype:f,qword:c,dataver:e,windex:d});this.log.sendCost();this.settings.target=="_blank"?window.open(a,"_blank"):document.location=a},simpleAddCurrent:function(a){for(var a=b.events.element(a),a=b.dom.isTag(a,"a")?a.parentNode:b.dom.isTag(a,"span")?a.parentNode.parentNode:b.dom.isTag(a,"em")?a.parentNode.parentNode.parentNode:a,c=a.parentNode.childNodes,d=0;d<c.length;d++){var e=c[d];if(e&&b.dom.hasClass(e,"current")){b.dom.removeClass(e,"current");break}}b.dom.addClass(a,
"current")},simpleRemoveCurrent:function(a){a=b.events.element(a);a=b.dom.isTag(a,"a")?a.parentNode:b.dom.isTag(a,"span")?a.parentNode.parentNode:b.dom.isTag(a,"em")?a.parentNode.parentNode.parentNode:a;b.dom.removeClass(a,"current")},_requestHistory:function(a){this.settings.crossHistory?this.XDomain.send({url:"http://www.soku.com/search/cookie.html?cn="+this.settings.historyName,success:function(b){a&&a.call(this,b)}}):a&&a.call(this,b.util.readCookie(this.settings.historyName))},_requestWord:function(a){var b=
this._bword(),d="",e="",f="",h="",l="",s="",r=this._dataItem(!0);if(r&&(a==this.log.cons.LOG_MOUSE_SELECT||b==r.getAttribute("qword")))b=r.getAttribute("qword"),d=r.getAttribute("windex"),e=r.getAttribute("dataver"),f=r.getAttribute("wordtype"),h=r.getAttribute("enterurl"),l=this.log._fullBit(r.getAttribute("log_kct"),2),s=r.getAttribute("log_pos")||"1";b={type:4,pos:s,kct:l,bword:this._uword(),wordtype:f,qword:b,dataver:e,operate:a,windex:d,enterurl:h};(d=this._handler._buildQueryUrl.call(this,b))&&
((d.indexOf("?")>-1?d.split("?")[0]:d).indexOf(".soku.com")>-1||this.log.sendUse(b));this.log.sendCost();this.settings.target=="_blank"||b.enterurl?a==this.log.cons.LOG_KEY_SELECT&&!this.settings.enterOpen&&this.dom_submitform?this.dom_submitform.setAttribute("action",d):window.open(d,"_blank"):document.location=d},_buildQueryUrl:function(a){var b=a&&a.enterurl||(a&&a.qword?this.settings.queryUrl.call(this,a.qword):"http://www.soku.com");if(!b)return"";a.url=b;b+=b.indexOf("?")==-1?"?f=1":"&f=1";
b+="&kb="+(this.log.getKB(a)||"");return b=b.substring(0,4)!="http"&&b.substring(0,1)!="/"?"http://"+b:b},_select:function(a){if(a&&!b.dom.hasClass(a,"current")){var c=this._handler._cancelSelectWord.call(this);b.dom.addClass(a,"current");if((a=this._handler._cancelSelectDetail.call(this))&&a[0])for(var d=0;d<c.length;d++){var e=c[d];if(e&&b.dom.hasClass(e,"current")){c=a[d];c.childNodes.length>0&&b.dom.show(c);break}}this._resetIframe()}},_cancelSelectWord:function(){var a=this._dataLis(!1);if(a&&
a[0])for(var c=0;c<a.length;c++){var d=a[c];if(d&&b.dom.hasClass(d,"current")){b.dom.removeClass(d,"current");break}}return a},_cancelSelectDetail:function(){var a=b.dom.gc("panel",this.dom_boxDiv,"div");if(a&&a[0])for(var c=0;c<a.length;c++){var d=a[c];if(d&&b.dom.visible(d)){b.dom.hide(d);break}}return a}}})})({});
